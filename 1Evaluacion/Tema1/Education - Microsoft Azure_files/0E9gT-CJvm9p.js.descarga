define("_generated/Less/MsPortalImpl.Controls/Controls/Toolbars/Toolbar.css",["module"],(function(t){"use strict";return{css:'.azc-toolbar ul{margin:0;padding:0;width:100%}.azc-toolbar-container{display:flex;padding:0;user-select:none}a.azc-toolbarButton-container{text-decoration:none!important}.azc-toolbar-group{display:flex;flex-wrap:nowrap}.azc-toolbarButton{display:inline-block;box-sizing:border-box;position:relative;height:36px}.azc-toolbarSeparator{display:flex;align-items:center}.azc-toolbarSeparator .azc-toolbarButton-icon{height:20px;width:17px}.azc-toolbarButton-groupPopup .azc-toolbarSeparator,.azc-toolbarButton-overflowPopup .azc-toolbarSeparator{height:0;width:100%;border-width:1px 0 0;border-style:solid;margin:auto;border-color:#d2d0ce}.azc-toolbarButton-groupPopup .azc-toolbarButton-container,.azc-toolbarButton-overflowPopup .azc-toolbarButton-container{height:auto;min-height:32px;box-sizing:border-box;padding:7px 8px}.azc-toolbarButton-groupPopup .azc-toolbarButton-label,.azc-toolbarButton-overflowPopup .azc-toolbarButton-label{white-space:normal}.azc-toolbarButton-groupPopup .azc-toolbarButton-icon,.azc-toolbarButton-overflowPopup .azc-toolbarButton-icon{align-self:flex-start;margin-top:1px}.azc-toolbar-item.azc-toolbarSeparator{fill:#d2d0ce!important}.azc-toolbarButton-container{position:relative;display:flex;align-items:center;padding:0 8px;height:36px}.azc-toolbar-container.azc-toolbarButton-small .azc-toolbarButton-container{padding-left:4px;padding-right:4px;height:16px}.azc-toolbarButton-container.fxs-portal-hover:hover .azc-toolbarButton-icon-chevron,.azc-toolbarButton-container.fxs-portal-hover:hover .azc-toolbarButton-icon-overflow{fill:#323130}.azc-toolbarButton-icon{flex:0 0 auto;height:16px;width:16px}.azc-toolbarButton-icon img,.azc-toolbarButton-icon svg{height:100%;width:100%}.azc-toolbarButton-icon-chevron{padding-left:8px;height:12px;width:12px;fill:#605e5c}.azc-toolbarButton-icon-overflow{fill:#605e5c}.azc-toolbarButton-label{flex:1 1 auto;font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:13px;line-height:normal;padding-left:8px;align-self:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.azc-toolbarButton-label.azc-toolbarButton-icon-hidden{padding-left:0}.azc-toolbarButton{cursor:pointer}.azc-toolbarItem-disabled{cursor:default!important}.azc-toolbarItem-disabled .azc-toolbarButton-container{cursor:default!important}.azc-toolbarButton-groupPopup,.azc-toolbarButton-overflowPopup{z-index:200;position:fixed;box-sizing:border-box;overflow-y:auto;overflow-x:hidden;max-width:320px}.fxc-groupPopup-hidden{visibility:hidden;left:-10000px;top:-10000px}.azc-toolbarButton-fileUpload-overlay{width:100%;height:0;opacity:0;font-size:0;display:block;cursor:pointer;overflow:hidden}.azc-toolbarButton-fileUpload-overlay:disabled{cursor:default}.azc-toolbarButton-container.azc-toolbarButton-menuItemCustomButton{display:flex;flex:1 1 auto;flex-direction:row;align-self:flex-start;padding:8px 11px 9px 9px;box-sizing:border-box;border-bottom:1px solid #e1dfdd}.azc-toolbarButton-menuItemCustomButtonIcon{flex:0 0 auto;height:25px;width:25px;padding-top:5px;padding-right:9px;align-self:flex-start}.azc-toolbarButton-menuItemCustomButtonContentContainer{display:flex;flex:1 1 auto;flex-direction:column;overflow:hidden}.azc-toolbarButton-menuItemCustomButtonContentContainer .azc-toolbarButton-label,.azc-toolbarButton-menuItemCustomButtonContentContainer .fxs-commandBar-item-text{min-height:20px;width:100%;line-height:20px;padding-left:0;color:#292827;font-weight:600;align-self:flex-start}.azc-toolbarButton-menuItemCustomButtonContentContainer .azc-toolbarButton-menuItemCustomButtonContent{flex:1 1 auto;color:#605e5c;font-size:12px}.fxs-mode-dark .azc-toolbarButton-icon-chevron,.fxs-mode-dark .azc-toolbarButton-icon-overflow{fill:#fff}.fxs-mode-dark .azc-toolbarButton-container.fxs-portal-hover:hover .azc-toolbarButton-icon-chevron,.fxs-mode-dark .azc-toolbarButton-container.fxs-portal-hover:hover .azc-toolbarButton-icon-overflow{fill:#fff}.fxs-mode-dark .azc-toolbarButton-menuItemCustomButtonContentContainer .azc-toolbarButton-label,.fxs-mode-dark .azc-toolbarButton-menuItemCustomButtonContentContainer .fxs-commandBar-item-text,.fxs-mode-dark .azc-toolbarButton-menuItemCustomButtonContentContainer .azc-toolbarButton-menuItemCustomButtonContent{color:#fff}.fxs-highcontrast-light a.azc-toolbarButton-container{color:var(--colorHighContrastButtonText)!important}.fxs-highcontrast-light a.azc-toolbarButton-container[aria-disabled="true"]{color:var(--colorHighContrastGreyText)!important}.fxs-highcontrast-light .fxs-notificationspane-button-unreadcount{border:1px solid #000}.fxs-highcontrast-dark a.azc-toolbarButton-container{color:var(--colorHighContrastButtonText)!important}.fxs-highcontrast-dark a.azc-toolbarButton-container[aria-disabled="true"]{color:var(--colorHighContrastGreyText)!important}',moduleId:t.id}})),
define("MsPortalImpl.Controls/Controls/Toolbars/Toolbar.Component",["require","exports","Weave","Weave/DirectMode","FxInternal/Weave","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Weave/Util","SharedUtilities/ClipboardUtils","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","FxInternal","MsPortalImpl/Weave/Components","_generated/Less/MsPortalImpl.Controls/Controls/Toolbars/Toolbar.css","MsPortalImpl/UI/UI.PopupPositioningMethods","Viva.Controls/Controls/Viva.Balloon","Viva.Controls/Controls/Viva.Balloon.Component","MsPortalImpl/Interactions/Interactions.PortalReader"],(function(t,e,o,a,n,i,s,l,r,c,m,d,u,p,b,h,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEV=e.ToolbarInner=void 0;const x=i.Clipboard.copied,C=i.Clipboard.pasted;let g;function B(t){const e=t.item,i=(0,n.toComputation)(e.icon),l=`Command-${e.name||e.telemetryName||ko.unwrap(e.label)||ko.unwrap(e.ariaLabel)||"UNKNOWN"}`;return a(o.Fragment,null,a(o.If,{condition:i,trueFn:()=>a("div",{className:"azc-toolbarButton-icon",image:i})}),a(o.If,{condition:t.showLabel||s.trueComputation,trueFn:()=>a("div",{className:["azc-toolbarButton-label fxs-commandBar-item-text",{"azc-toolbarButton-icon-hidden":!i||i.compose(s.negation)}],"data-telemetryName":l},(0,n.toComputation)(e.label))}))}e.ToolbarInner=function(t){const{vm:e,state:l}=t,d=(0,n.toComputation)(e.showLabels),p=(0,n.toComputation)(e.smallItemSize,s.falseComputation),b=L(l.overflowButton,l),h=(0,n.toComputation)(l.mappedToolbarItems).composeArray(m.identity).cMap((t=>{const e=(0,o.makeWritableComputation)(0),a=t.visible,i=ko.isObservable(a)?(0,n.toComputation)(a):s.trueComputation,l={item:t,measuredWidth:e},r=(0,o.composeComputation)([p,d,(0,n.toComputation)(t.label),(0,n.toComputation)(t.icon)],((e,o,a,n)=>S({type:t.type,hasIcon:!!n,showLabel:o,label:a,smallItemSize:e})));return(0,o.composeComputation)([i,r,e],((t,e,o)=>({itemRenderInfo:l,visible:t,estimatedWidth:e,lastMeasuredFullWidth:o})))})).cFilter((t=>t.visible)),f=p.compose(U),x=(0,o.makeWritableComputation)(1<<20),C=(0,o.composeComputation)([x,h,d,f],((t,e,o,a)=>{const n=e.map((t=>o&&t.lastMeasuredFullWidth||t.estimatedWidth));if(n.reduce(((t,e)=>t+e),0)<=t+1)return{itemsInBar:e.map(A),itemsInOverflowMenu:[]};{let o=t-a,i=0;for(;(o-=n[i])>=0;)++i;return{itemsInBar:e.slice(0,i).map(A),itemsInOverflowMenu:e.slice(i).map(A)}}})),g=C.compose((t=>t.itemsInBar)),v=C.compose((t=>t.itemsInOverflowMenu));let k;return a(o.LifetimeManagerScoped,{fn:m=>a(o.GetContext,{fn:h=>a(o.SetContext,{tabIndex:(0,o.makeConstantComputation)(-1)},a(o.Css,{css:u}),a("ul",{role:"toolbar",className:["azc-toolbar-container fxs-commandBar-itemList",{"azc-toolbarButton-small":p}],onResize:({width:t})=>{x(t),r.dismissByLogName(l.menuPopupLogName)},afterMount:(t,e)=>{k=new c.KeyboardNavigation(e,{element:$(t.parentElement||t),tabTriggers:12,itemSelector:".azc-toolbar-item > .azc-toolbarButton-container",parentTabIndexContextObservable:(0,n.toObservable)(e,h.tabIndex)}),(0,o.subscribe)(e,[g],(()=>{k.correctState()}))}},a(o.ForEach,{collection:g,fn:({item:{item:i,measuredWidth:s}})=>{const r=(0,n.toComputation)(l.itemAriaLabel(i)),c=(0,n.toComputation)(l.itemAriaDisabled(i)),u=(0,n.toComputation)(l.itemEnabled(i)),p=(0,n.toComputation)(l.itemTitle(i)),b=L(i,l),h=(0,n.toComputation)(l.itemDisabled(i)),f=i.type,x=({width:t})=>{e.showLabels()&&s(t)};return(0,o.subscribe)(m,[h],(()=>{k?.correctState(!0)})),a(o.SetContext,{disabled:h},"Group"!==i.type&&12!==f?a("li",{role:"presentation",className:["azc-toolbar-item azc-toolbarButton fxs-commandBar-item",{"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":h,"fxs-commandBar-item-checked":(0,n.toComputation)(i.checked),"azc-toolbarMenuButton":17===f},(0,n.toComputation)(i.cssClass)],title:p,onResize:x},14!==f&&15!==f&&20!==f&&21!==f&&22!==f&&18!==f&&8!==f?a(o.Fragment,null,a("div",{data:i,className:["azc-toolbarButton-container",{"fxs-portal-hover":u,"azc-toggleCommandButton-checked fxs-portal-selected":(0,n.toComputation)(i.checked)}],"aria-disabled":c,"aria-label":r,title:p,role:l.itemRole(i),"aria-checked":(0,n.toComputation)(l.itemChecked(i)),id:l.itemAriaLabelId(i),"aria-labelledby":l.itemGroupedByIds(i),"aria-haspopup":!!l.itemAriaHasPopup(i)||null,"aria-expanded":!l.itemAriaHasPopup(i)&&null,tabindex:"-1",onClick:b,onKeyDown:b},a(B,{item:i,showLabel:d}),a(_,{item:i,inOverflowPopup:!1})),a(w,{item:i}),a(I,{item:i,state:l,className:"azc-toolbar-menuItem"})):null,14===f?a("div",{onClick:b,onKeyDown:b,data:i,fxclick:i.onClick,"aria-disabled":c,"aria-label":r,title:p,role:l.itemRole(i),className:["azc-toolbarButton-container",{"fxs-portal-hover":u}]},a(B,{item:i,showLabel:d})):null,15===f?a("a",{onClick:b,onKeyDown:b,data:i,fxclick:i.onClick,"aria-disabled":c,"aria-label":r,title:p,role:l.itemRole(i),className:["azc-toolbarButton-container",{"fxs-portal-hover":u,"azc-toolbarItem-disabled":h}]},a(B,{item:i,showLabel:d})):null,20===f?a(F,{item:i,state:t.state,itemDisabled:h}):null,21===f?a(D,{item:i,state:t.state,itemDisabled:h}):null,a(P,{item:i,state:t.state,itemDisabled:h,showLabel:d})):null,12===i.type?a("li",{className:"azc-toolbar-item azc-toolbarButton azc-toolbarSeparator fxs-commandBar-item fxs-commandBar-item-separator",role:"separator",onResize:x},a("div",{className:"azc-toolbarButton-icon",image:MsPortalFx.Base.Images.Line()})):null)}}),a(o.If,{condition:v.compose(s.isNonEmptyArray),trueFn:()=>a("li",{className:"azc-toolbar-item azc-toolbarButton azc-toolbar-item-overflow fxs-commandBar-item fxs-commandBar-item-expandList",role:"presentation"},a("div",{"aria-label":(0,n.toComputation)(l.overflowButton.ariaLabel),title:(0,n.toComputation)(l.overflowButton.ariaLabel),role:"button","aria-haspopup":"true","aria-expanded":"false",data:l.overflowButton,className:["azc-toolbarButton-container",{"fxs-portal-hover":(0,n.toComputation)(l.itemEnabled(l.overflowButton))}],onClick:b,onKeyDown:b},a("div",{className:"azc-toolbarButton-icon azc-toolbarButton-icon-overflow",image:(0,n.toComputation)(l.overflowButton.icon)})),a("div",{className:["azc-toolbarButton-overflowPopup","fxs-dropmenu-content","msportalfx-shadow-level2","fxs-portal-bg-txt-br","fxc-groupPopup-hidden"],role:"menu",id:l.overflowButton.menuId},a(o.ForEach,{collection:v,fn:({item:{item:e}})=>{const i=(0,n.toComputation)(l.itemDisabled(e));return a(o.SetContext,{disabled:i},a(z,{item:e,state:t.state,className:"azc-toolbar-item fxs-commandBar-item",itemDisabled:i,inOverflowPopup:!0}),a(I,{item:e,state:t.state,className:"azc-toolbar-menuItem"}),a(y,{item:e,state:t.state,className:"azc-toolbar-item fxs-commandBar-item",itemDisabled:i}),a(F,{item:e,state:t.state,className:"azc-toolbar-item fxs-commandBar-item",itemDisabled:i,role:"menuitem"}),a(D,{item:e,state:t.state,className:"azc-toolbar-item fxs-commandBar-item",itemDisabled:i,role:"menuitem"}),a(O,{item:e,className:"azc-toolbar-item fxs-commandBar-item"}),a(P,{item:e,state:t.state,className:"azc-toolbar-item fxs-commandBar-item",itemDisabled:i}))}})))})),a(o.ForEach,{collection:(0,n.toComputation)(l.optionsGroupNames),fn:({item:t})=>a("div",{className:"fxs-hide-accessible-label",id:l.getGroup(t)?.id},i.Controls.Toolbar.optionsGroupAriaDesc.format(t))}))})})};const v=[5,11,19,16,7,17];function w(t){const e=t.item;return v.includes(e.type)?a("div",{className:"azc-toolbarButton-dialogContainer fxs-commandBar-listpopup"}):null}function I(t){const e=t.item;return 17===e.type?a("div",{className:["azc-toolbarButton-groupPopup","msportalfx-shadow-level2","fxs-portal-bg-txt-br","fxc-groupPopup-hidden"],role:"menu",id:e.menuId,style:{width:(0,n.toComputation)(e.popupWidthString),"max-width":(0,n.toComputation)(e.popupWidthString)}},a(o.ForEach,{collection:(0,n.toComputation)(e.buttons),fn:({item:e})=>{const i=(0,n.toComputation)(t.state.itemDisabled(e));return a(o.SetContext,{disabled:i},a(z,{item:e,state:t.state,className:t.className,itemDisabled:i,inOverflowPopup:!1}),a(y,{item:e,state:t.state,className:t.className,itemDisabled:i}),a(O,{item:e,className:t.className}),a(M,{item:e,state:t.state,className:t.className,itemDisabled:i}),a(P,{item:e,state:t.state,className:t.className,itemDisabled:i}),a(F,{item:e,state:t.state,className:t.className,itemDisabled:i,role:"menuitem"}),a(D,{item:e,state:t.state,className:t.className,itemDisabled:i,role:"menuitem"}))}})):null}function z(t){const e=t.item,i=e.type;if(14!==i&&15!==i&&12!==i&&20!==i&&21!==i&&22!==i&&18!==i&&8!==i){const s=t.state,l=L(e,s),r=(0,n.toComputation)(s.itemAriaLabel(e)),c=(0,n.toComputation)(s.itemAriaDisabled(e));return a(o.Fragment,null,a("div",{onClick:l,onKeyDown:l,data:e,className:["azc-toolbarButton-container",t.className,{"fxs-portal-hover":(0,n.toComputation)(s.itemEnabled(e)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":t.itemDisabled,"azc-toggleCommandButton-checked fxs-commandBar-item-checked fxs-portal-selected":(0,n.toComputation)(e.checked),"azc-toolbarMenuButton":17===i},(0,n.toComputation)(e.cssClass)],"aria-disabled":c,"aria-label":r,title:(0,n.toComputation)(s.itemTitle(e)),role:6===i?"menuitemradio":"menuitem","aria-checked":(0,n.toComputation)(s.itemChecked(e)),id:s.itemAriaLabelId(e),"aria-labelledby":s.itemGroupedByIds(e),"aria-haspopup":!!s.itemAriaHasPopup(e)||null,"aria-expanded":!s.itemAriaHasPopup(e)&&null},a(B,{item:e}),a(_,{item:e,inOverflowPopup:t.inOverflowPopup})),a(w,{item:e}))}return null}function y(t){const e=t.item,o=e.type;if(14===o||15===o){const i=t.state,s=e,l=L(e,i),r=(0,n.toComputation)(i.itemAriaDisabled(e)),c={data:e,onClick:l,onKeyDown:l,className:["azc-toolbarButton-container",t.className,{"fxs-portal-hover":(0,n.toComputation)(i.itemEnabled(e)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":t.itemDisabled},(0,n.toComputation)(s.cssClass)],fxclick:s.onClick,"aria-disabled":r,"aria-label":(0,n.toComputation)(i.itemAriaLabel(e)),title:(0,n.toComputation)(i.itemTitle(e)),role:"menuitem"};return a(14===o?"div":"a",{...c},a(B,{item:e}))}return null}function k(e){const i=e.item,s=(0,n.toComputation)(i.icon),l=(0,n.toComputation)(i.label),r=(0,n.toValueOrComputation)(i.content),c=`Command-${i.name||i.telemetryName||ko.unwrap(i.label)||ko.unwrap(i.ariaLabel)||"UNKNOWN"}`;return a(o.Fragment,null,a(o.If,{condition:s,trueFn:()=>a("div",{className:"azc-toolbarButton-menuItemCustomButtonIcon",image:s})}),a("div",{className:"azc-toolbarButton-menuItemCustomButtonContentContainer"},a(o.If,{condition:l,trueFn:()=>a("div",{className:"azc-toolbarButton-label fxs-commandBar-item-text","data-telemetryName":c},l)}),a(o.If,{condition:r,trueFn:()=>a("div",{className:"azc-toolbarButton-menuItemCustomButtonContent",id:e.subLabelId},a(d.TextOrKo,{content:r,require:t}))})))}function M(t){const e=t.item;if(22===e.type){const o=t.state,i=e,s=L(e,o),l=(0,n.toComputation)(o.itemAriaDisabled(e)),r=MsPortalFx.getUniqueId();return a("div",{onClick:s,onKeyDown:s,data:e,className:["azc-toolbarButton-container","azc-toolbarButton-menuItemCustomButton",t.className,{"fxs-portal-hover":(0,n.toComputation)(o.itemEnabled(e)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":t.itemDisabled},(0,n.toComputation)(i.cssClass)],fxclick:i.onClick,"aria-disabled":l,"aria-label":(0,n.toComputation)(o.itemAriaLabel(e)),"aria-describedby":r,title:(0,n.toComputation)(o.itemTitle(e)),role:"menuitem"},a(k,{item:e,subLabelId:r}))}return null}function P(t){const e=t.item,i=t.state,s=L(e,i),l=MsPortalFx.getUniqueId();return 18===e.type||8===e.type?a(o.Fragment,null,a("label",{data:e,className:["azc-toolbarButton-container","azc-toolbarButton-fileUpload",t.className,{"fxs-portal-hover":(0,n.toComputation)(i.itemEnabled(e)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":t.itemDisabled}],for:l,"aria-disabled":(0,n.toComputation)(i.itemAriaDisabled(e)),"aria-label":(0,n.toComputation)(i.itemAriaLabel(e)),title:(0,n.toComputation)(i.itemTitle(e)),role:i.itemRole(e),id:i.itemAriaLabelId(e),"aria-labelledby":i.itemGroupedByIds(e),tabindex:"-1",onClick:s,onKeyDown:s},a(B,{item:e,showLabel:t.showLabel})),a("input",{type:"file",data:e,className:"azc-toolbarButton-fileUpload-overlay fxs-commandBar-fileUpload-overlay",accept:(0,n.toValueOrComputation)(e.accept),multiple:e.maxFiles>1,tabindex:"-1",id:l,disabled:(0,n.toComputation)(e.disabled).compose((t=>!!t))})):null}function N(t){return a(o.GetContext,{fn:e=>a(o.LifetimeManagerScoped,{fn:o=>{g||(g=new f.PortalReader(o,{idPrefix:"toolbar"}));const n=new b.ViewModel({...t.options,ltm:o});n.renderMode(1),n.box((()=>(0,p.getBox)("#"+t.boxId)));const i=new b.WidgetUIState;return a("div",{className:["azc-dockedballoon-balloon","fxs-copyButton-balloon"],afterMount:(t,o)=>{o.registerForDispose(i),o.registerForDispose(new b.Widget($(t),n,{weaveContext:e,diContainer:e.diContainer},i))}},a(h.BalloonInner,{state:i,vm:n}))}})})}function F(t){const e=t.item;if(20===e.type){const i=t.state,s=e,r=function(t,e){return async e=>{const o=e.keyCode;if(!o||32===o||13===o){const e=t,o=await Promise.resolve(t.onClick());await async function(t){let e=JSON.stringify(t);e="string"==typeof t?t:JSON.stringify(t);await l.writeToClipboard(e)}(o),e.statusText(x),e.statusBalloonVisible(!0),g.read(x)}}}(e),c=(0,n.toComputation)(i.itemAriaDisabled(e)),m=MsPortalFx.getUniqueId(),d=e,u=function(t,e){return()=>{t.statusBalloonVisible(!1),t.statusText("")}}(e),p={id:m,data:e,onClick:r,onKeyDown:r,onMouseLeave:u,onFocusOut:u,className:["azc-toolbarButton-container",t.className,{"fxs-portal-hover":(0,n.toComputation)(i.itemEnabled(e)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":t.itemDisabled},(0,n.toComputation)(s.cssClass)],"aria-disabled":c,"aria-label":(0,n.toComputation)(i.itemAriaLabel(e)),title:(0,n.toComputation)(i.itemTitle(e)),role:t.role||"button"};return a(o.Fragment,null,a("div",{...p},a(B,{item:e})),a(N,{boxId:m,options:{ltm:void 0,content:d.statusText,visible:d.statusBalloonVisible}}))}return null}function D(t){const e=t.item;if(21===e.type){const i=t.state,s=e,r=function(t,e){return async e=>{const o=e.keyCode;if(!o||32===o||13===o){const e=await async function(){const t=await l.readFromClipBoard();try{const e=JSON.parse(t);if(e.hasOwnProperty("typeName")&&e.hasOwnProperty("data"))return e}catch{}return t}(),o=t;o.statusText(C),o.statusBalloonVisible(!0),g.read(C),t.onClick(e)}}}(e),c=(0,n.toComputation)(i.itemAriaDisabled(e)),m=MsPortalFx.getUniqueId(),d=e,u=function(t,e){return()=>{t.statusBalloonVisible(!1),t.statusText("")}}(e),p={id:m,data:e,onClick:r,onKeyDown:r,onMouseLeave:u,onFocusOut:u,className:["azc-toolbarButton-container",t.className,{"fxs-portal-hover":(0,n.toComputation)(i.itemEnabled(e)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":t.itemDisabled},(0,n.toComputation)(s.cssClass)],"aria-disabled":c,"aria-label":(0,n.toComputation)(i.itemAriaLabel(e)),title:(0,n.toComputation)(i.itemTitle(e)),role:t.role||"button"};return a(o.Fragment,null,a("div",{...p},a(B,{item:e})),a(N,{boxId:m,options:{ltm:void 0,content:d.statusText,visible:d.statusBalloonVisible}}))}return null}function O(t){return 12===t.item.type?a("div",{className:["azc-toolbarButton azc-toolbarSeparator",t.className],role:"separator"}):null}function _(t){return 17===t.item.type?a("div",{className:"azc-toolbarButton-icon azc-toolbarButton-icon-chevron",image:t.inOverflowPopup?MsPortalFx.Base.Images.Chevron():MsPortalFx.Base.Images.CaretDown()}):null}function L(t,e){return o=>e.logTelemetry(t,o.event)}const T=document.createElement("canvas").getContext("2d");function S(t){return 12===t.type?17:2*(t.smallItemSize?4:8)+(t.hasIcon?16:0)+(t.showLabel?(e=t.label,Math.max(0,T.measureText((""+(e||"")).trim()).width-2)):0)+(t.hasIcon&&t.showLabel?8:0)+(17===t.type?20:0);var e}function U(t){return S({type:14,hasIcon:!0,showLabel:!1,label:"",smallItemSize:t})}function A(t){return t.itemRenderInfo}T.font='13px az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif'})),
define("MsPortalImpl.Controls/Controls/Toolbars/Toolbar",["require","exports","MsPortalImpl.Controls/Controls/Base/Loadable","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Commands/Commands.OAuthCommand","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Base/Base.Selectable2","Fx/DependencyInjection","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/UI/UI.PopupPositioningMethods","FxInternal/Controls/ToolbarItems/MenuButton","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl.Controls/Controls/Toolbars/Toolbar.Component","WeaveDOM/DirectRender/DataAttribute"],(function(t,e,o,a,n,i,s,l,r,c,m,d,u,p,b,h,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Widget=e.InnerTsxComponent=e.WidgetUIState=void 0;var x=MsPortalFx.Base.Diagnostics.Telemetry,C=FxImpl.TelemetryContext;const g="fxc-toolbar azc-toolbar",B=".azc-toolbarButton-fileUpload-overlay",v=32;function w(t){const e=FxImpl.Po.getMetadataId(t);return e?e.split("-")[0]:""}function I(t,e,o,a,n){const i=n?t.width:0,s=o.offset().left+o.width()-(t.left+i),l=t.left+t.width-i,r=e.width()<=s||l<=s;let c=0;switch(a){case 1:case 2:default:r&&e.width()<=s?c=2:e.width()<=l&&(c=1);break;case 3:case 4:r&&e.width()<=s?c=4:e.width()<=l&&(c=3)}return c}function z(t,e,o,a,n){let i=0;return 0!==n?i=4===n||2===n?a?t.left+t.width:t.left:a?t.left-o.width():t.left+t.width-o.width():(a&&(i=t.left+t.width-o.width()),i<0&&e.width>=o.width()&&(i=(e.width-o.width())/2),i=Math.max(0,i)),i}function y(t,e,o,a){const n=(0,d.getBox)(t),i=(0,d.getBox)(o),s=function(t,e,o,a){const n=a?0:t.height,i=a?t.height:0;return t.top+n+e.height()<=o.offset().top+o.height()?2:t.top+i-(o.offset().top+v)>=e.height()?4:0}(n,e,o,a);if(0!==s){let t=0;t=1===s||2===s?a?n.top:n.top+n.height:a?n.top+n.height-e.height():n.top-e.height();const l=z(n,i,e,a,I(n,e,o,s,a));e.css({top:t,left:l})}else{const t=z(n,i,e,a,I(n,e,o,2,a));let s=i.top+v,l=i.height-v;if(i.height-v>e.height()){const t=(i.height-v-e.height())/2;s=i.top+v+t,l=e.height()}e.css({top:s,left:t,height:l})}e.removeClass("fxc-groupPopup-hidden"),e.addClass("fxs-dropmenu-is-open"),t.attr("aria-expanded",!0)}class k extends a.WidgetUIState{constructor(t){let e;if(super(),this.menuPopupLogName=MsPortalFx.getUniqueId(),this.mappedToolbarItems=ko.observable([]),this.optionsGroupNames=ko.observableArray([]),this.overflowButton=new u.MenuButton(this._ltm,{isOverflowButton:!0,icon:MsPortalFx.Base.Images.Ellipsis(),label:p.CommandBar.more,ariaLabel:p.CommandBar.more,telemetryName:"ToolbarOverflowButton"}),this._vm=t.vm,"composition"===t.diContainer.scope){const o=t.diContainer.get(b.CompositionProvenance);this.locator=o.locator,e={locationString:this.locator.toFriendlyString(),extensionName:this.locator.getExtensionLocator().name,instanceId:o.instanceId}}else e={};this.telemetryContext=MsPortalFx.extend2({locationString:"Toolbar",extensionName:w(this._vm),instanceId:null},e),t.vm.items.subscribeAndRun(this._ltm,(t=>{const e=[];this._groups={},t.forEach((t=>{const o=t;if(17===o.type){(o.buttons()||[]).forEach((t=>{this._processOptionsGroup(t)}))}else this._processOptionsGroup(o);e.push(o)})),this.optionsGroupNames(Object.keys(this._groups)),this.mappedToolbarItems(e)}))}logTelemetry(t,e){if("keydown"===e.type&&13!==e.keyCode&&32!==e.keyCode)return;const o=t;14!==o.type&&15!==o.type&&22!==o.type||m.dismissByLogName(this.menuPopupLogName);const a=o.name||o.telemetryName||ko.unwrap(o.label)||ko.unwrap(o.ariaLabel)||"No identifiable information",n={id:this.telemetryContext.locationString,instanceId:this.telemetryContext.instanceId};C.setContextValue(FxImpl.TelemetryContext.ContextType.Blade,n),C.provideContext((()=>{x.trace({action:"CommandExecuted",source:this.telemetryContext.locationString,name:a,extension:this.telemetryContext.extensionName,data:{invokedFromToolbar:!0}})}),C.ContextType.CompositionItem,{id:"toolbarItem",instanceId:a})}getGroup(t){return this._groups&&this._groups[t]}itemDisabled(t){return ko.pureComputed((()=>this._itemDisabled(t)))}itemEnabled(t){return ko.pureComputed((()=>!this._itemDisabled(t)))}itemAriaDisabled(t){return ko.pureComputed((()=>this._itemDisabled(t)?"true":void 0))}itemAriaLabel(t){const e=t;return ko.pureComputed((()=>ko.unwrap(e.ariaLabel)||ko.unwrap(e.label)))}itemTitle(t){const e=t;return ko.pureComputed((()=>this._itemDisabledOrUnauthorizedMessage(e)||ko.unwrap(e.tooltip)||ko.unwrap(e.ariaLabel)||ko.unwrap(e.label)))}itemChecked(t){if(6===t.type)return ko.pureComputed((()=>t.checked()?"true":"false"))}itemGroupedByIds(t){if(6===t.type&&t.optionGroupName)return[t.ariaLabelId,this._groups[t.optionGroupName].id].join(" ")}itemAriaLabelId(t){if(6===t.type&&t.optionGroupName)return t.ariaLabelId}itemRole(t){return 6===t.type?t.optionGroupName?"radio":"switch":15===t.type||2===t.type?"link":"button"}itemAriaHasPopup(t){if(17===t.type)return!0;const e=t;return 5===e.type&&!MsPortalFx.isNullOrUndefined(e.dialogOptions&&e.dialogOptions.type)&&4===e.dialogOptions.type}_itemDisabled(t){const e=ko.unwrap(this._vm.disabled),o=ko.unwrap(t.disabled),a=ko.unwrap(t.unauthorizedMessage),n=t.command&&!MsPortalFx.isNullOrUndefined(t.command.canExecute)&&!ko.unwrap(t.command.canExecute);return!!(e||o||a||n)}_itemDisabledOrUnauthorizedMessage(t){const e=ko.unwrap(t.disabled);if(e&&"string"==typeof e&&this._itemDisabled(t))return e;const o=ko.unwrap(t.unauthorizedMessage);return o||void 0}_processOptionsGroup(t){const e=t,o=e.optionGroupName;6===e.type&&o&&(e.ariaLabelId||(e.ariaLabelId=MsPortalFx.getUniqueId()),this._groups[o]?this._groups[o].items.push(e):this._groups[o]={type:"Group",id:MsPortalFx.getUniqueId(),optionGroupName:o,items:[e]})}}e.WidgetUIState=k,e.InnerTsxComponent=h.ToolbarInner;class M extends o.Widget{constructor(e,o,a,d){super(e,o,a,d),this._downloadCommandMap=new Map,this._fileUploadMap=new Map,this._optionsGroupFormatter=p.Controls.Toolbar.optionsGroupAriaDesc;const u=this.state.menuPopupLogName,b=d.locator;this.element.addClass(g);const h=(e,o)=>{if(o.stopPropagation(),o.preventDefault(),17!==e.type||!e.isOverflowButton){const t=e.command&&!MsPortalFx.isNullOrUndefined(e.command.canExecute)&&!ko.unwrap(e.command.canExecute);if(this.options.disabled()||e.disabled()||ko.unwrap(e.unauthorizedMessage)||t)return}const a={getForm:()=>$(o.currentTarget).siblings(".azc-toolbarButton-dialogContainer")[0],showForm:()=>{},hideForm:()=>{}};switch(e.type){case 6:{const t=e;t.command?t.command.canExecute()&&(this._handleCheckedState(t),t.command.execute({checked:t.checked(),context:ko.unwrap(t.commandContext)})):this._handleCheckedState(t);break}case 16:case 7:{m.dismissByLogName(u);const t=e;let n=this._downloadCommandMap.get(t);if(n)n.canExecute()&&n.execute(null);else{const i=16===e.type?"MsPortalImpl/Commands/Commands.FxFileDownloadCommand":"MsPortalImpl/Commands/Commands.FileDownloadCommand";MsPortalFx.Base.Promises.cancelOnDispose(this.ltm,MsPortalFx.require(i)).then((i=>{n=16===e.type?new i.FxFileDownloadCommand(t,c.container,a,o.currentTarget,b):new i.FileDownloadCommand(t.context(),c.container,a,o.currentTarget,b),this._downloadCommandMap.set(t,n),n.canExecute()&&n.execute(null)}))}break}case 18:case 8:{const t=e,a=o.target.files;MsPortalFx.Base.Promises.cancelOnDispose(this.ltm,MsPortalFx.require("MsPortalImpl.Controls/Controls/Toolbars/FileUploader")).then((o=>{let n=this._fileUploadMap.get(t);n||(18===e.type?(n=new o.FileUploader(this.ltm,t,this.state.telemetryContext.extensionName),t._msPortalFxUploadActionCallback((()=>n.reset()))):n=new o.LegacyFileUploader(this.ltm,t),this._fileUploadMap.set(t,n)),n.processFiles(a)}));break}case 9:{m.dismissByLogName(u);const t=e;(0,n.executeOAuthCommand)(t.value,t.requestUrl(),t.popupWidth(),t.popupHeight());break}case 11:case 5:{const t=e;this._diContainer.getAsync(l.DialogManager).then((n=>(5!==e.type||MsPortalFx.isNullOrUndefined(t.dialogOptions&&t.dialogOptions.type)||4===t.dialogOptions.type||m.dismissByLogName(u),n.showDialog(t.dialogOptions,a,o.currentTarget,{locator:b})))).then((e=>{t.command&&t.command.canExecute()&&t.command.execute(e)}));break}case 3:{const t=e;t.selectable.isSelected()||t.selectable.isSelected(!0);break}case 10:{const t=r.getOrCreate(this._diContainer,e.selectable);t&&t.onClick();break}case 2:{const a=e.clickableLink,n=i.sanitizeLinkUri(a.uri(),{diContainer:this._diContainer,localRequire:t,windowContext:this.state.telemetryContext.extensionName,contextData:{locator:this.state.telemetryContext.locationString}});n&&(window.open(n,a.target()),a.onLinkOpened&&a.onLinkOpened("keypress"===o.type));break}case 4:{const t=e;t.command?.canExecute()&&(m.dismissByLogName(u),t.command.execute(ko.unwrap(t.commandContext)).catch((t=>{const e=t?.extension;if(!e||"fx"===e)return Promise.reject(t)})));break}case 17:{const t=$(o.currentTarget),a="#"+e.menuId,n=t.siblings(a),i=t.parent().hasClass("azc-toolbarButton-overflowPopup"),l=t.closest(".fxs-portal-content")[0]||t.closest(".fxs-contextpane")[0]||t.closest("#web-container")[0]||t.closest("body")[0];y(t,n,$(l),i);const r=this.ltm.createChildLifetime(),c=t[0],d=t=>$.contains(n[0],t)||n[0]===t?0:2,p={dismissFn:e=>{var o,a;o=t,(a=n).addClass("fxc-groupPopup-hidden"),a.removeClass("fxs-dropmenu-is-open"),a.css({top:"",left:"",right:"",bottom:"",height:"auto"}),o.attr("aria-expanded",!1),m.unregister(p),r.dispose(),e===u&&m.validatePreviousFocusedElement(p,c)&&c.focus()},shouldDismissOnFocusOutFn:t=>$.contains(n[0],document.activeElement)||n[0]===t?0:1,shouldDismissOnMouseDownFn:d,shouldDismissOnMouseWheelFn:d,restoreFocus:()=>{m.validatePreviousFocusedElement(p,c)&&c.focus()},logName:u};m.register(p),new s.KeyboardNavigation(r,{element:n,tabTriggers:12,itemSelector:"> .azc-toolbarButton-container"});const b=n.children(".azc-toolbarButton-container:not(.azc-toolbarItem-disabled)")[0];b&&b.focus();break}case 19:{const t=e;this.trigger("itemSelected",null,{item:t.command,popupTarget:$(o.currentTarget).siblings(".azc-toolbarButton-dialogContainer")[0]});break}case 20:case 21:m.dismissByLogName(u)}};this.ltm.registerForDispose(this.element.setEvents(["click",".azc-toolbarButton-container",t=>{"true"!==$(t.target).attr("aria-disabled")&&!$(t.currentTarget).hasClass("azc-toolbarButton-fileUpload")&&h((0,f.getElementData)(t.currentTarget),t)}],["keydown",".azc-toolbarButton-container",t=>{if((13===t.keyCode||32===t.keyCode)&&"true"!==$(t.target).attr("aria-disabled"))if($(t.currentTarget).hasClass("azc-toolbarButton-fileUpload")){const e=$(t.currentTarget).attr("for"),o=e&&$(t.currentTarget).closest(".azc-toolbar-container").find("#"+e);o&&o.click()}else h((0,f.getElementData)(t.currentTarget),t)}],["click",B,t=>{t.stopPropagation(),$(t.target).val("")}],["change",B,t=>{h((0,f.getElementData)(t.currentTarget),t)}]))}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._cleanElement(g),this.element.removeClass(g),super.dispose())}get options(){return this._options}trigger(t,e,o){const a=this.options[t],n=this.element;return o=o||{},(e=e||$.Event(t)).type=t,e.target=n[0],n.trigger(e,o),!($.isFunction(a)&&!1===a.apply(n[0],[e].concat(o))||e.isDefaultPrevented())}_handleCheckedState(t){t.optionGroupName?t.checked()?t.checked(!1):(t.checked(!0),this.state.getGroup(t.optionGroupName).items.forEach((e=>{e!==t&&e.checked(!1)}))):t.checked(!t.checked())}}e.Widget=M})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.CommandBar.css",["module"],(function(t){"use strict";return{css:".fxs-commandBar{position:relative}",moduleId:t.id}})),
define("MsPortalImpl/Widgets/Widgets.CommandBar",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBarBase","FxInternal/Controls/ToolbarItems/BaseButton","MsPortalImpl.Controls/Controls/Toolbars/Toolbar","_generated/Less/MsPortalImpl/Widgets/Widgets.CommandBar.css","MsPortalImpl.Controls/Controls/Toolbars/Toolbar.Component"],(function(t,e,o,a,n,i,s,l,r,c,m,d,u,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Widget=e.WidgetUIState=e.CommandBar=e.ViewModel=e.AmdLinkButton=e.AmdButton=e.ToggleButton=e.CommandButton=e.OAuthButton=e.FileDownloadButton=e.PdlCommandButton=e.FileUploadButton=e.OpenBladeButton=e.OpenLinkButton=e.createItem=void 0;var b=MsPortalFx.Base,h=b.Promises,f=MsPortalFx.ViewModels.Toolbars,x=c.ItemViewModel;const C=window,g=MsPortalFx.forEachKey,B=MsPortalFx.require;let v,w;e.createItem=function(t,e,o,a,n){const i=e.type;if(12===i)return new x(t,new f.ToolbarButton(12,{type:12,icon:b.Images.Line(),disabled:!0}),o,n);!v&&(v={},w={},w[5]=c.DialogButton,w[7]=N,w[11]=z,w[10]=k,v[4]=D,v[3]=y,v[2]=I,v[6]=O,v[8]=M,v[9]=F,v[14]=_,v[15]=L);const s=v[i];if(s)return new s(t,e,o,n);const l=w[i];return l?new l(t,e,o,a,n):new x(t,e,o,n)};class I extends x{execute(t){const e=this._model,o=e&&e.clickableLink;if(o&&ko.isObservable(o.uri)){const t=ko.unwrap(o.target)||"_blank";C.open(o.uri(),t),o.onLinkOpened&&o.onLinkOpened(!1)}super.execute(t)}}e.OpenLinkButton=I;class z extends c.DialogButton{}class y extends x{constructor(t,e,o,a){super(t,e,o,a);const n=this.model;n&&n.selectable&&ko.isObservable(n.selectable.isSelected)&&ko.computed(this._ltm,(()=>{this.pressed(this.model.selectable.isSelected())}))}execute(t){const e=this.model.selectable;e&&ko.isObservable(e.isCommandSelected)&&e.isSelected(!0),super.execute(t)}}e.OpenBladeButton=y;class k extends x{constructor(t,e,o,a,i){super(t,e,o,i);const s=n.getOrCreate(a,e.selectable);this.pressed=s.isSelected,this.execute=t=>{s.onClick(),super.execute(t)}}}class M extends x{constructor(t,e,o,a){super(t,e,o,a),this._fileUploaderMap={};const n=this.model;this.fileInputOptions(new l.FileInputOptions(n.accept,n.maxFiles)),this.model.cancelAllUploads.subscribe(this._ltm,(t=>{t&&(this._cancelAllUploads(),n.cancelAllUploads(!1))}))}execute(t){super.execute(t),h.cancelOnDispose(this._executeLifetime,B("MsPortalImpl/Services/Services.FileUpload")).then((e=>{this._execute(e,t)}))}_execute(t,e){const o=[],a=this.fileInputOptions().files();if(a&&a.length>0){const e=this.model;e.cancelAllUploadsOnFileSelection()&&this._cancelAllUploads();const n=Math.min(a.length,e.maxFiles);for(let i=0;i<n;i++){let n=this._fileUploaderMap[a[i].name];n&&n.dispose(),n=new t.FileUploader(this._ltm,this._fileUploaderMap,a[i],e),this._fileUploaderMap[a[i].name]=n,o.push(n.uploadTask)}e.uploadTasks.push.apply(e.uploadTasks,o)}}_cancelAllUploads(){const t=this._fileUploaderMap;this._fileUploaderMap={},g(t,((t,e)=>{e.cancel(),e.dispose()}))}}e.FileUploadButton=M;class P extends m.BaseButton{constructor(t,e){super(t,{label:e.text,ariaLabel:e.ariaLabel,icon:e.icon,tooltip:e.tooltip,disabled:ko.pureComputed((()=>!e.fxEnabled()||!e.enabled()||e.unauthorized()))}),this.type=19,this.command=e,this.visible=MsPortalFx.initObservable(e.visible,!0),this.checked=MsPortalFx.initObservable(e.pressed,!1)}}e.PdlCommandButton=P;class N extends x{constructor(t,e,o,a,n){super(t,e,o,n),this._diContainer=a,this.visible(!0),i.isSafari&&i.webKitVersion<i.safari_11_webKitVersion&&(this.fxEnabled(!1),this.tooltip(s.FileDownloadCommand.safariDownload))}execute(t){super.execute(t),this.fxEnabled()&&h.cancelOnDispose(this._executeLifetime,B("MsPortalImpl/Commands/Commands.FileDownloadCommand")).then((t=>{if(!this._instance)return this._currentContext.getFormTarget().then((e=>{this._instance=new t.FileDownloadCommand(this.model.context(),this._diContainer,e,this._currentContext.target,this._locator),this._instance.execute(this.model.context())}));this._instance.execute(this.model.context())}))}}e.FileDownloadButton=N;class F extends x{execute(t){super.execute(t),h.cancelOnDispose(this._executeLifetime,B("MsPortalImpl/Commands/Commands.OAuthCommand")).then((t=>{const e=this.model;this.childWindow=t.executeOAuthCommand(e.value,e.requestUrl(),e.popupWidth(),e.popupHeight())}))}}e.OAuthButton=F;class D extends x{execute(t){const e=this._model;e.command&&e.command.execute(ko.unwrap(e.commandContext)).catch((t=>{const e=t?.extension;if(!e||"fx"===e)return Promise.reject(t)})),super.execute(t)}}e.CommandButton=D;class O extends x{constructor(t,e,o,a){super(t,e,o,a),this.checked=ko.observable(!1),this.model&&ko.isObservable(this.model.checked)&&ko.computed(this._ltm,(()=>{this.checked(this.model.checked())}))}execute(t){const e=this.model,o=!e.checked();e.checked(o),e.command&&e.command.execute({checked:o,context:e.commandContext&&e.commandContext()}),super.execute(t)}}e.ToggleButton=O;class _ extends x{constructor(t,e,o,a){super(t,e,o,a),this.buttonViewModel=e}execute(t){"function"==typeof this.buttonViewModel.onClick&&this.buttonViewModel.onClick({target:n.getOrCreateCachedFxElement(this?._currentContext?.target)}),super.execute(t)}}e.AmdButton=_;class L extends x{constructor(t,e,o,a){super(t,e,o,a),this.buttonViewModel=e}execute(t){if(this.buttonViewModel.onClick.uri){const t=this.buttonViewModel.onClick;if(ko.isObservable(t.uri)){const e=ko.unwrap(t.target)||"_blank";C.open(t.uri(),e),t.onLinkOpened&&t.onLinkOpened(!1)}}super.execute(t)}}e.AmdLinkButton=L;e.ViewModel=class{constructor(){this.controlType=62,this.vmKind="MsPortalFx",this.disabled=ko.observable(!1),this.showLabels=ko.observable(!0),this.loading=ko.observable(!1),this.items=ko.observable([]),this.itemSelected=$.noop,this.locator=null,this.menuItems=ko.observableArray([])}setItems(t){this.items(t)}},e.CommandBar=function(t){return o(a.GetContext,{fn:e=>o(a.LifetimeManagerScoped,{fn:()=>{const n=t.vm,i=new T({vm:t.vm,diContainer:e.diContainer});return o("div",{className:["fxs-commandBar",t.className],afterMount:(o,a)=>{a.registerForDispose(i),a.registerForDispose(new S($(o),t.vm,{weaveContext:e,diContainer:e.diContainer},i))}},o(a.Css,{css:u}),o(p.ToolbarInner,{state:i.toolbarState,vm:n}))}})})};class T{constructor(t){this.toolbarState=new d.WidgetUIState({vm:t.vm,diContainer:t.diContainer})}dispose(){this.toolbarState.dispose()}}e.WidgetUIState=T;class S extends r.Widget{constructor(t,e,o,a){super(t,e),this.ltm.registerForDispose(new d.Widget(t,e,o,a.toolbarState))}setFocus(){const t=this.element.find(".fxs-commandBar-item:not(.fxs-commandBar-item-separator)>.azc-toolbarButton-container").filter("[tabindex='0']")[0]||this.element.find(".fxs-commandBar-item:not(.fxs-commandBar-itemDisabled)>.azc-toolbarButton-container")[0];t&&t.focus()}}e.Widget=S}));