"use strict";var ko,FxImpl,MsPortalFx;!function(e){var t;e.Base||(e.Base={}),t=window,fx.bootstrapTelemetry.fxScriptsBegin=fx.getTimestamp(),t.performance.mark("MsPortalFxStart"),!fx.internalEnv.noOptMsPortalFxUris&&FxImpl.patchMsPortalFxNonAmd()}(MsPortalFx||(MsPortalFx={})),function(e){e.features=e.features||new e.Features}(FxImpl||(FxImpl={})),function(e){location.origin||(location.origin=location.protocol+"//"+location.host),e.origin=location.origin,e.protocol=e.origin.slice(0,e.origin.indexOf("/")),e.href=location.href;var t=[];e.onEnvironmentSet=function(e){t.push(e)},e.throwBeforeEnvironment=function(){};var r=function(e){e(MsPortalFx.getEnvironmentValue)};e.setEnvironment=function(){e.onEnvironmentSet=r,t.forEach(r)},e.ensureAbsoluteUri=function(t){return e.ensureAbsoluteUriCore(t,{origin:e.origin,protocol:e.protocol,appPath:MsPortalFx.getEnvironmentValue("applicationPath")})}}(FxImpl||(FxImpl={})),function(e){var t=window,r=fx.environment,n=FxImpl.internalEnv=fx.internalEnv;FxImpl.bootEnv||(FxImpl.bootEnv={}),FxImpl.postBootEnv||(FxImpl.postBootEnv={extensionRedirectMap:{},baseDomains:[]}),n.isShell?FxImpl.setEnvironment():FxImpl.features=new FxImpl.Features(FxImpl.bootEnv.shellFeatures),FxImpl.onEnvironmentSet((function(){if(!n.isShell){r=fx.environment;var e=fx.extensionEnv||{};FxImpl.features=new FxImpl.Features(FxImpl.bootEnv.shellFeatures,r.extensionName,[e.features,r.featuresFromConfig||{}]),r.features=FxImpl.features.value,Object.keys(e).forEach((function(t){"features"!==t&&(r[t]=e[t])}))}}));var i=t.parent;function a(e){return FxImpl.features.isEnabled(e)}e.isIFrame=i&&t.window!==i.window,e.getFeatureValue=function(e){return FxImpl.features.getValue(e)},e.isFeatureEnabled=a,e.getEnvironmentValue=function(e,t){var n=r[e];return null==n?t:n},e.isDevelopmentMode=FxImpl.isDevelopmentMode=a("clientDevelopmentMode"),e.isTestMode=FxImpl.isTestMode=n.isTestMode,e.isInWebWorker=FxImpl.inWebWorker=n.inWebWorker,e.sessionId=FxImpl.sessionId=n.sessionId,e.trace=FxImpl.trace=n.trace||{},e.portalUri=FxImpl.trustedParentOrigin=n.trustedParentOrigin,e.defineProperty=e.defineProperty||Object.defineProperty,r.javascriptObjectPropertiesAreEnumerable||(Object.defineProperty=function(t,r,n){return n&&n.get&&!0===n.enumerable&&(n.enumerable=!1),e.defineProperty(t,r,n)})}(MsPortalFx||(MsPortalFx={})),function(e){var t=new Uint8Array(20),r=new Array(20);function n(e,r,n){var i=t[e]&r;t[e]=i|n}var i=window.crypto||window.msCrypto,a="0123456789abcdef".split(""),o=new Array(256),s=0;function u(){var e=function(e){for(var t,r=new Array(e);e;){t=4294967296*Math.random()|0;for(var n=8;n--;){if(r[--e]=a[15&t],e<0)return r;t>>>=4}}}(36);return e[8]=e[13]=e[18]=e[23]="-",e[14]="4",e[19]=a[8+(3&a.indexOf(e[19]))],e.join("")}a.forEach((function(e){a.forEach((function(t){o[s++]=e+t}))})),e.createGuid=function(e,a){void 0===a&&(a=!1);var s=i?function(){i.getRandomValues(t),n(8,15,64),n(11,63,128);for(var e=0;e<20;e++)r[e]=o[t[e]];return r[4]=r[7]=r[10]=r[13]="-",r.join("")}():u();return s=a?s.split("-").join("").substring(0,32):s.substring(0,36),(e?"".concat(e,"_"):"")+s}}(FxImpl||(FxImpl={})),function(e){var t=window,r=Function,n=Math,i=Object,a=r.call,o=r.apply;function s(e){return function(){return a.apply(e,arguments)}}e.uncurryThis=s;var u=s(o);e.applyCall=u,e.applyUncurry=u;var c=Array.prototype,l=c.concat,d=c.push,f=s(c.filter),p=s(c.forEach),h=s(c.join),y=s(d),m=s(c.slice),v=s(c.sort),g=Array.isArray,_=String.prototype,b=s(_.split),x=s(_.substring),E=s(_.indexOf),P=s(_.toLowerCase),S=s(i.prototype.hasOwnProperty),I=i.freeze,M="function",C="string",w="number",F="object";e.isEmptyObject=function(e){var t;for(t in e)return!1;return!0};var D=i.keys,A=ko.utils.peekObservable;function k(e,t){return typeof e===t}function T(e){return e instanceof Date}var R=/\S/;function O(e){return e?D(e).length:0}function B(e){return void 0===e}function j(t){return!e.isNullOrUndefined(t)}e.keysLength=O,e.isEmpty=function(e){return!O(e)},e.isDisposable=function(e){return!!function(e){var t=e&&e.dispose;return k(t,M)&&t}(e)},e.isNull=function(e){return null===e},e.isUndefined=B,e.notNullOrUndefined=j,e.isNullOrWhiteSpace=function(t){return e.isNullOrUndefined(t)||k(t,C)&&!R.test(t)},e.isNumeric=function(t){return!isNaN(t)&&!e.isNullOrUndefined(t)&&k(t,w)};var N,H=t.Map;e.Map=H;var U={};function V(e){return U.error=e,U}function L(e,t){void 0===t&&(t={});var r=t.cacheFactory,n=t.checkResult,i=t.cacheFactory?r():new H,a=!n&&!t.noDebugCheck&&N,o=function(r){if(i.has(r))return i.get(r);var o=function(e,t,r){try{return t(e)}catch(e){return r(e)}}(r,e,V);if(o!==U){if(a&&a(o),!n||n(o,r,i))return i.set(r,o),o}else{var s=U.error,u=t.onError;u&&u(s,r,i)||Promise.resolve().then((function(){return Q.reject(s)}))}};return o.dispose=o.clear=function(){i.clear()},o.delete=function(e){return i.delete(e)},o.map=function(){return i},o}function z(e,r,n){!function(e,t,r){if(Q.isPromise(e))if(e.isFulfilled())t(e.inspect().value);else if(e.isPending())e.then(t,r);else{var n=e.inspect().reason;if(!r)throw n;r(n)}else e.then(t,r)}(FxImpl.requireReady,(function(){t.requirejs([e],r,(function(e){return function(e,t){var r,n;if(e.data&&void 0===e.data.status&&e.data.failedModules&&e.data.failedModules.length&&void 0===e.data.failedModules[0].status&&e.data.failedModules[0].moduleUrl){var i=e.data.failedModules[0],a=i.moduleUrl;FxImpl.Diagnostics.getStatusCode(a,(function(r,n,a){e.data.status=i.status=r,e.data.statusText=i.statusText=a,200!==r&&(e.message=i.message="Couldn't load \"".concat(i.name,'"; error code ').concat(r)),t(e)}))}else 0===(null===(r=e.data)||void 0===r?void 0:r.status)&&(null===(n=e.data.failedModules)||void 0===n?void 0:n.length)&&e.data.failedModules[0]&&e.data.failedModules[0].moduleUrl?(e.message=e.data.failedModules[0].message,t(e)):t(e)}(e,n)}))}),n)}function q(e){return e+""}function G(e,t,r,n,i){if(t){r=r||q;for(var o=[t,,,""],s=0,u=t.length;s<u;s++){var c=t[s];o[1]=c,o[2]=s,o[3]=void 0;var l=a.apply(r,o);if(!i||void 0===e[l]){o[3]=l;var d=n?a.apply(n,o):c;void 0!==d&&(e[l]=d)}}}return e}function W(e){return e=g(e)?m(e):arguments,function(){var t={};return p(arguments,(function(r,n){var i=e[n];void 0!==r&&(t[i]=r)})),t}}function K(e,t){return T(e)&&T(t)&&!(e>t||e<t)}function J(e){return ko.isObservable(e)&&g(e())}e.memoize=L,FxImpl.memoizePromise=function(e,t){return void 0===t&&(t={}),L(e,__assign(__assign({},t),{checkResult:(r=t.onError,function(e,t,n){return!(!e||!e.catch((function(e){if(n.delete(t),!r||!r(e,t,n))return Q.reject(e)})))})}));var r},e.retryPromise=function(t,r,n){return Q(Promise.resolve().then(t).catch((function i(a){return r-- >0?e.delay(n).then(t).catch(i):Q.reject(a)})))},FxImpl.unrequire=function(e){window.require.unrequire(e,!0)},e.require=function(e,t,r){var n,i=t;if(!i||i.normalize)return i&&(e=i.normalize(e)),Q((n=e,Q.Promise((function(e,t){z(n,e,t)}))));z(e,t,r||function(e){return Promise.reject(e)})},e.first=function(e){if(e)return e[0]},e.last=function(e){var t;if(e&&(t=e.length))return e[t-1]},e.merge=function(){var e=f(arguments,j);return l.apply([],e)},e.mapMany=function(t,r){return t?u(e.merge,null,t.map(r)):[]},e.stableSort=function(e,t){if(e.length<3){var r=e.slice();return e.length>1?r.sort(t):r}return e.map((function(e,t){return{i:t,v:e}})).sort((function(e,r){return t(e.v,r.v)||e.i-r.i})).map((function(e){return e.v}))},e.extendArrayIntoMap=G,e.extendStringMapIntoMap=function(t,r,n,i){var o=[r,,];return e.forEachKey(r,(function(e,r){if(!i||void 0===t[e]){o[1]=r,o[2]=e;var s=n?a.apply(n,o):r||e;void 0!==s&&(t[e]=s)}})),t},e.getStringMapFunc=W,e.applyStringMapFunc=function(e){return u(W,void 0,e)},e.getNameValue=W("name","value"),e.getEnumArray=function(t,r){var n=[];return e.forEachKey(t,(function(t,r){k(t,C)&&k(r,w)&&y(n,e.getNameValue(t,r))})),r?v(n,(function(e,t){return e.value-t.value})):n},e.areEqualDates=K,e.toSeconds=function(e){return e.getTime()/1e3|0},e.isObservableArray=J,e.isArrayOrObservableArray=function(e){return g(e)||J(e)};var $=b("0123456789abcdef",""),X=[];p($,(function(e){p($,(function(t){y(X,e+t)}))})),e.newGuid=FxImpl.createGuid;var Y=4095;function Z(e){return X[e>>4]+$[15&e]}function ee(t){t=t?t+"-":"";var r="",n=Y;return function(){return++n>Y&&(n=0),n||(r=t+x(e.newGuid(),0,33)),r+Z(n)}}function te(e){var t=typeof e;return t===F&&(null===e?t="null":g(e)?t="array":T(e)?t="date":e instanceof RegExp&&(t="regexp")),t}function re(e,t,r){if(r&&(e=r(e),t=r(t)),Object.is(e,t))return!0;if(!e||!t)return!1;var n=te(e);if(n!==te(t))return!1;switch(n){case"array":var i=e;return e.length===t.length&&i.every((function(e,n){return re(e,t[n],r)}));case"date":return e.getTime()===t.getTime();case F:var a=D(e);return a.length===O(t)&&a.every((function(n){return re(e[n],t[n],r)}));default:return!1}}e.getUniqueIdGenerator=ee,e.getIdGenerator=function(e){var t=-1,r=Y,n="";return function(){return++r>Y&&(r=0,t++,n=e+t.toString(16)+"-"),n+Z(r)}},e.getUniqueId=ee(),e.round=function(e,t){return t=n.pow(10,t||0),n.round(Number(e)*t)/t},e.truncate=function(e){return 0|e},e.xor=function(e,t){return e?!t:t},e.random=function(e,t){if(!(void 0===e||void 0===t||e>t))return n.floor(n.random()*(t-e+1))+e},e.setObjPropAsObservable=function(e,t,r){var n=S(e,t)&&e[t];n&&ko.isObservable(n)?n(r):e[t]=ko.observable(r)},e.areEqual=function(e,t){return e===t||K(e,t)},e.arrayEquals=function(e,t){if(e===t)return!0;if(e&&t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1},e.getTypeOf=te;var ne=ko.utils;function ie(t,r,n){if(!k(r,C))return!1;var i=(t=e.isNullOrUndefined(t)?"":String(t)).length;(void 0===n||n>i)&&(n=i),n-=r.length;var a=E(t,r,n);return-1!==a&&a===n}function ae(t,r){for(var n=r?ie:e.startsWith,i=t[0]||"";i;){for(var a=void 0,o=1,s=t.length;o<s;o++){var u=t[o];if(u&&n(i,u)){a=u;break}}if(!a)break;i=r?x(i,0,i.length-a.length):x(i,a.length)}return i}function oe(t,r){return t=t||"",e.startsWith(t,r)||(t=r+t),t}e.deepEquals=function(e,t,r){return re(e,t,r?ne.peekObservable:ko.unwrap)},e.isObject=function(e){return te(e)===F},e.map=function(t,r,n){var i=[t,,,n],o=D(t).map((function(e){return i[1]=t[e],i[2]=e,a.apply(r,i)}));return u(e.merge,null,o)},e.shallowCopyFromObject=function(e,t,r){r=r||D(t);for(var n=0;n<r.length;n++){var i=r[n],a=t[i];void 0!==a&&(e[i]=a)}},e.endsWith=ie,e.localeCompareIgnoreCase=function(t,r,n,i){return e.isNullOrUndefined(t)?-1:k(r,C)?t.toLocaleLowerCase().localeCompare(r.toLocaleLowerCase(),n,i):1},e.repeat=function(e,t){var r="";for(t=t<0?0:t;t--;)r+=e;return r},e.reverse=function(e){for(var t="",r=e.length;r;)t+=e[--r];return t},e.getJoinFunc=function(e){return function(){return h(arguments,e)}},e.getQuoteFunc=function(e,t){return e=e||"",t=t||e,function(r){return e+r+t}},e.replaceAll=function(t,r,n){return t.replace(new RegExp(e.regexEscape(r),"g"),n)},e.replaceMany=function(t,r){if(t&&r){var n=D(r).map(e.regexEscape);if(n.length){var i=new RegExp(h(n,"|"),"g");return t.replace(i,(function(e){return r[e]}))}}return t},e.split=function(e,t,r){var n=[];if(e&&t&&r){var i=0,a=t.length,o=0;for(r--;;){if(n.length>=r||(o=E(e,t,i))<0){y(n,x(e,i));break}y(n,x(e,i,o)),i=o+a}}return n},e.trimEnd=function(){return ae(arguments,!0)},e.trimStart=function(){return ae(arguments)},e.ensureSuffix=function(e,t){return ie(e=e||"",t)||(e+=t),e},e.ensurePrefix=oe,e.pathJoin=function(t,r){g(r)||(r=m(arguments,1));var n="";return p(r||[],(function(r){n?r&&(n=e.trimEnd(n,t)+oe(r,t)):n=r||""})),n},e.getUriAuthority=function(t,r){if(void 0===r&&(r=!0),t){if(e.startsWith(t,"//"))t=e.ensurePrefix(t,"https:");else-1===E(t,"://")&&(t=e.ensurePrefix(t,"https://"));var n=new URL(t);return r?n.host:n.hostname}return t},e.isSubdomain=function(e,t){if(!e||!t||e.length<t.length)return!1;var r=P(e),n=P(t);return r===n||ie(r,"."+n)},e.isUriAbsolute=function(t){return-1!==E(t,"://")||e.startsWith(t,"//")},e.tryImmediateFinally=function(e,t){var r=Q(e);return r.isPending()?r.finally(t):(t(),r)},e.wrap=function(e){return function(){return e}};var se={};function ue(e){return null===e||typeof e in se}p(["boolean","undefined",w,C,"symbol"],(function(e){se[e]=!0})),e.isPrimitive=ue,e.polyfill=function(t,r,n){var a=t.prototype;e.forEachKey(r,(function(e,t){!n&&a[e]||i.defineProperty(a,e,{value:t,configurable:!0,enumerable:!1,writable:!0})}))};for(var ce=50,le=[],de={},fe=0;fe<=ce;fe++){var pe=fe+"";le[fe]=pe,de[pe]=fe}function he(e){if(e>ce)throw new Error("The requiredMaxInteger("+e+") should be less than "+ce);if(e<=0)throw new Error("The requiredMaxInteger("+e+") should be greater than zero.")}e.isDevelopmentMode&&(I(le),I(de)),e.getIntToStringMap=function(e){return he(e),le},e.getStringToIntMap=function(e){return he(e),de},e.cloneAndRebindFunctions=function(e){var t=i.create(i.getPrototypeOf(e)),r=function(r){var n=e[r];k(n,M)&&!ko.isObservable(n)?t[r]=function(){return u(n,e,arguments)}:S(e,r)&&(t[r]=n)};for(var n in e)r(n);return t},e.lowerCaseAllStrings=function t(r){if(r){var n=typeof r;if(n===C)return(i=r)&&P(i);if(g(r))return r.map((function(e){return t(e)}));if(n===F)return e.forEachKey(r,(function(e,n){r[e]=t(n)})),r}var i;return r};var ye=Array.isArray,me=Object.keys,ve=JSON.stringify,ge=JSON.parse;e.clone=function(t,r,n){if(n&&ue(t))return t;var i=ye(t)?[]:{};return e.extend(i,t,r)};var _e=/[`><"'&\t\n\r\xa0-\xff]|([\x00-\x1f\x7f\x80-\x9f])|([\ud800-\udbff][\udc00-\udfff])/g,be={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&#34;","`":"&#96;"},xe=/^[\w\s.\-#]*$/;e.encodeHtml=e.isFeatureEnabled("fastencode")?function(t){return"string"==typeof t&&xe.test(t)?t:e.isNullOrUndefined(t)?"":(t+"").replace(_e,Ie)}:function(t){return e.isNullOrUndefined(t)?"":String(t).replace(_e,Ie)},e.encodeAttribute=function(t){return e.encodeHtml(t)},e.toSortedString=function(e,t){return ve(e||{},(function(r,n){var i=n===e;if(n&&typeof n===F&&!ye(n)){var a=i&&t?t:me(n);if(0===a.length)return i?{}:n;var o=new Se;return a.forEach((function(t){!function(t,r){if(t===e&&!t.hasOwnProperty(r))throw new Error("Missing property '".concat(r,"' on root object '").concat(ve(t),"'."))}(n,t),o.addProperty(t,n[t])})),o.toJSON()}return n}))};var Ee="Invalid sorted string, property array must contain objects";function Pe(e,t,r){return e[r]}e.parseSortedString=function(e){return ge(e,(function(t,r){if("#"!==t||!ye(r))return r;G(this,r,(function(t){try{return function(e){if(!e||typeof e!==F||ye(e))throw new Error(Ee+".");var t=me(e);if(1!==t.length)throw new Error(Ee+" with only one property.");return t[0]}(t)}catch(t){throw t.message=t.message+" String: '".concat(e,"'."),t}}),Pe)}))},e.disposeViewModelProperties=function(t){if(t)try{e.disposeDisposable(ko.unwrap(t.content),t.container)}catch(e){}},e.isSerializableProperty=function(t){return"constructor"!==t&&!e.startsWith(t,"###")};var Se=function(){function e(){this._propertyMap={}}return e.prototype.addProperty=function(e,t){void 0!==t&&typeof t!==M&&(this._propertyMap[e]=t)},e.prototype.toJSON=function(){var e=this._propertyMap,t=me(e);if(t.length>1){var r={};return r["#"]=v(t).map((function(t){var r={};return r[t]=e[t],r})),r}return e},e}();function Ie(e,t,r){var n=e.charCodeAt(0);return be[e]||(be[e]="&#"+(t?0:r?1024*(n-55296)+e.charCodeAt(1)-56320+65536:n)+";")}function Me(e,t){return B(e)?t:e}e.convertArrayToMap=function(e,t,r){return G({},e,t,r)},e.thunkArray=function(e,t){var r=ko.observableArray(),n=e.createChildLifetime();return ko.computed(n,(function(){r(t())})),r.dispose=function(){n.dispose()},r},e.canSendThroughPostMessage=function(t){for(var r=new e.Map,n=[[t]];n.length;)for(var i=n.pop(),a=D(i),o=0,s=a.length;o<s;o++){var u=i[a[o]],c=typeof u;if(c===M||u instanceof Error||u instanceof Node||u===document.all)return!1;u&&c===F&&!r.has(u)&&(r.set(u,!0),n.push(u))}return!0},e.compare=function(t,r){t=A(t),r=A(r);var n=!e.isNullOrUndefined(t),i=!e.isNullOrUndefined(r);if(n&&i){if(t.localeCompare)return t.localeCompare(r);t=+t,r=+r,n=!isNaN(t),i=!isNaN(r)}return n?i?t-r:-1:i?1:0},e.initValue=Me,e.initObservable=function(e,t){return ko.isObservable(e)?e:ko.observable(Me(e,t))},e.initObservableArray=function(e,t){return ko.isObservable(e)?e:ko.observableArray(Me(e,t))},e.markIgnoreHighDependenciesCount=e.noop}(MsPortalFx||(MsPortalFx={})),function(e){var t=/\{[\w$]*\}/g,r=/\{(\d+)\}/g;e.polyfill(String,{format:function(){var e,n=arguments,i=!1,a=2===n.length&&n[0]&&"object"==typeof n[0]&&("function"==typeof n[1]||null===n[1]),o=a?n[1]:null;if(1===n.length&&n[0]&&"object"==typeof n[0]||a){var s=n[0];e=this.replace(t,(function(e){var t=e.substring(1,e.length-1);if(s.hasOwnProperty(t)){i=!0;var r=s[t];return o?o(r):r}return e}))}return i||(e=this.replace(r,(function(e,t){if(t<n.length){var r=n[t];return o?o(r):r}return e}))),e}},!0)}(MsPortalFx||(MsPortalFx={})),function(e){var t;!function(t){!function(t){var r,n,i="content",a=e.forEachKey,o=e.trimStart;function s(e,t){throw new Error(e.format(t))}function u(){r=e.getEnvironmentValue("contentUriBasePath")||"/",n=e.getEnvironmentValue("contentVersionToken")||""}function c(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n="",i=!1;return e.forEach((function(e){if(e){n&&(e=o(e,"/"),n+="/");var t=e.length-1;(i="/"===e[t])&&(e=e.slice(0,t)),n+=e}})),i&&(n+="/"),t.isUriAbsolute(n)||n.startsWith("/")||(n="/"+n),n}function l(a,u,l){var d,f=(a=o(a,"/")).toLowerCase();if(f.startsWith(i)){var p=i.length;f.length!==p&&"/"!==f[p]||(d=p)}return 1===u||2===u?(t.isUriAbsolute(a)&&s("The '{0}' URI is not a valid content URI because it is an absolute URI.",a),d||s("The '{0}' URI is an application relative URI. However a content URI was expected. Did you mean to call getAppRelativeUri?",a),""!==n&&(a=c(a.slice(0,d),n,a.slice(d))),a=c(r,a)):t.isUriAbsolute(a)||(d&&s("The '{0}' URI is a content URI. However an application relative URI was expected. Did you mean to call getContentUri?",a),a=c(e.getEnvironmentValue("applicationPath"),a)),l&&!t.isUriAbsolute(a)&&(a=c(FxImpl.origin,a)),a}function d(e,t){return void 0===t&&(t=!0),l(e,2,t)}function f(e,n){return void 0===n&&(n=!0),e=e||"",t.isUriAbsolute(e)||(e=c(r,e),n&&!t.isUriAbsolute(e)&&(e=c(FxImpl.origin,e))),e}t.initialize=u,t.getImages=function(e){return function(e,t){return a(e,(function(e,r,n){"string"==typeof r&&(n[e]=t(r))}),{})}(e,(function(e){return d(c("Content/Images",e))}))},t.isUriAbsolute=e.isUriAbsolute,t.getContentUri=d,t.getScriptUri=function(e){return l(e,1,!1)},t.getAppRelativeUri=function(e){return l(e,0,!1)},t.getAbsoluteUri=function(e){return l(e,0,!0)},t.getVersionlessContentUri=f,FxImpl.onEnvironmentSet((function(){u()}));var p=f(c("Content/Static/"));function h(e,t,r,n){var i=t[r];return i||(t[r]=i={}),e.forEach((function(e){if("string"==typeof e){var r=-1!==(s=(o=e).lastIndexOf("."))?o.slice(0,s):o;i[r]=p+n+"_"+e}else a(e,(function(e,r){h(r,t,e,n+"/"+e)}));var o,s})),t}var y=new e.Map;t._getImageMap=function(e,t){var r=y.get(e);return r||(r=h(e,{},"",""),y.set(e,r)),r[t]}}(t.Resources||(t.Resources={}))}(t=e.Base||(e.Base={})),e.getImages=t.Resources._getImageMap}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){var t,r=window;e.addScriptErrorListener=function(e,t,r,n){var a=i(e,r,n,t.getAttribute("crossorigin")),o=function(e){t.removeEventListener("load",o),t.removeEventListener("error",a)};t.addEventListener("load",o),t.addEventListener("error",a)};var n=((t={})[3]="Initialize",t[4]="UnhandledError",t[6]="ScriptError",t);function i(e,t,i,o){var s,u=null!==(s=n[e])&&void 0!==s?s:"Unknown",c=r.parent===r?function(e,t){var r=e&&e.data&&0===e.data.statusCode?1:2,n="Portal Load Error: Error loading a script for module '"+i+"'";MsPortalFx.Base.Diagnostics.Log.writeEntry(r,"ScriptError",n,new MsPortalFx.Errors.Error({message:n,innerErrors:t,data:e}))}:function(e){r.parent.postMessage(e,MsPortalFx.portalUri)};return function(e){var r=e.message||e.filename||e.lineno||e.colno,n={error:MsPortalFx.getLogFriendlyMessage(e.error),url:t,crossOriginAttribute:o,moduleName:i,statusCode:r?200:0,httpMessage:r?"OK":"",details:{fileName:e.filename,lineNumber:e.lineno,columnNumber:e.colno,message:e.message}},s={signature:"###BOOT###",kind:u,data:n};r?c(s,e.error):a(t,(function(t,r){200!==t&&(n.statusCode=t,n.httpMessage=r),c(s,e.error)}))}}function a(e,t){try{var r=new XMLHttpRequest;r.onerror=function(){t(r.status,r.responseText,r.statusText)},r.onload=function(){t(r.status,200===r.status?"":r.responseText,r.statusText)},r.open("GET",e,!0),r.send()}catch(e){t(void 0,void 0)}}e.getScriptErrorHandler=i,e.getStatusCode=a}(e.Diagnostics||(e.Diagnostics={}))}(FxImpl||(FxImpl={})),function(e){!function(t){!function(t){var r=Date.now,n=window,i=e.trace,a=FxImpl.Base.Diagnostics.logFunctions,o=function(){},s=e.isFeatureEnabled("canmodifyextensions"),u=FxImpl.Base.Diagnostics.isExtractableError,c={hour:"numeric",minute:"numeric",second:"numeric"},l=e.isDevelopmentMode||!!i.diagnostics;function d(e){return!e||("string"==typeof e||e instanceof String?!e.trim():!("object"!=typeof e||!("message"in e)||!d(e.message))&&(!("name"in e)||d(e.name)))}var f=FxImpl.Base.Diagnostics.logHelper,p=o;function h(e){var t=e||"",r=t.lastIndexOf("/");return r>=0?t.slice(r+1):t}var y=function(t,n,i,a,o,s,c){var l;d(a)&&(a=new e.Errors.Error(__assign({message:"unspecified message logged"},(l=a)&&"object"==typeof l&&("message"in l||"name"in l||"stack"in l)?{innerErrors:a}:{data:a})));var p,h,y=e.getLogFriendlyMessage(a)+"";if(s=null!=s?s:[],t>=1&&i&&(y=[i,y].join(": ")),a&&u(a)&&(s=[].concat(a,s)),a&&t>=1&&"string"==typeof a&&(!s||!e.find(s,(function(e){return u(e)})))){var m=new e.Errors.Error({message:a,stack:e.getCurrentCallStack(!0,{removeStackLevels:2})});s=[].concat(m,s||[])}p=[],h=[],(s||[]).forEach((function(e){return u(e)?p.push(e):h.push(e)})),s=p.concat(h),"number"!=typeof o&&(o=null);var v={timestamp:c||r(),level:t,area:n,message:y,code:o,args:s&&s.map((function(e){var t;return u(e)?{error:FxImpl.Base.Diagnostics.extractErrorDetails(e,null===(t=FxImpl.NetDiagnostics.getCurrentBladeInstance())||void 0===t?void 0:t.context)}:e}))};f.log(v)},m=y;function v(t,r){var i=n.console||{},a=o;return[t,r].forEach((function(t){var r=t&&i[t];"function"==typeof r&&(a=function(t){try{var n=function(t){var r="["+e.getEnvironmentValue("extensionName")+"] ",n=[],i=0;return r&&(n[i++]=r),-1===t.level&&(n[i++]="[DEBUG]"),n[i++]=new Date(t.timestamp).toString(c),t.area&&(n[i++]=t.area),"number"==typeof t.code&&(n[i++]=t.code),t.message&&(n[i++]=t.message),t.args&&n.push.apply(n,t.args),n}(t);r.apply(i,n)}catch(e){}})})),a}function g(t,r){void 0===r&&(r=[]);var n,s=((n={})[0]=v("log","debug"),n[1]=v("warn"),n[2]=v("error"),n[-1]=i.debuglog?v("debug","log"):o,n),u=e.isNullOrUndefined(t)?-1:t;[-1,0,1,2].forEach((function(e){a[e]=e>=u?r[e]||s[e]:o}))}function _(e,t,r,n,i){("function"==typeof t?t():!!t)||(e.debugBreak,e.error(r,n,i))}FxImpl.Base.Diagnostics.writeEntry=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];m===y?y.apply(void 0,e):m(e[0],e[1],e[2],e[3],e[4],e[5])},t.setWriter=function(e){var t=m;return m=e||y,t},t.setupErrorDetection=function(e,t){var r=[2,1];[e,t].forEach((function(e,t){var n=r[t],i=a[n];a[n]=function(t){i(t),e(t)}}))},FxImpl.Diagnostics.setConsoleOutput=g;var b=function(){function t(e){this.debugBreak=!!i.assert,this._area=e,this._type=h(e)}return t.writeEntry=function(e,t,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];var a=e>=1?h(t):null;m(e,t,a,r,null,n)},t.writeEntry2=function(e,t,r,n,i){var a=e>=1?h(t):null;m(e,t,a,r,n,i)},t.initialize=function(t,r){var n=!e.isNullOrUndefined(t),i=!e.isNullOrUndefined(r),a=o;n||i?n&&!i?r=t:!n&&i&&(t=-1):(t=r=-1,a=_),f.init(r),g(t),p=a},t.disable=function(){t.initialize(3,3)},t.prototype.verbose=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];m(0,this._area,this._type,e,null,t)},t.prototype.warning=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];m(1,this._area,this._type,e,t,r)},t.prototype.error=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];m(2,this._area,this._type,e,t,r)},t.prototype.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];m(-1,this._area,this._type,e,null,t)},t.prototype.custom=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];m(-2,this._area,this._type,e,t,r)},t.prototype.assert=function(e,t,r,n){p(this,e,t,r,n)},t.prototype.writeEntry=function(e,t,r,n){m(e,this._area,this._type,t,r,n)},t.getEntries=f.entries,t.clear=f.empty,t.flush=f.flush,t._setBufferFullCallback=f.setCallback,t}();if(t.Log=b,l?b.initialize():s?b.initialize(1,1):b.initialize(2,1),e.isIFrame&&!e.isDevelopmentMode){var x={alert:void 0,confirm:!1,prompt:null},E=0;e.forEachKey(x,(function(e,t){E++,n[e]=function(n){var i=function(e,t,n){return{timestamp:r(),level:void 0===n?2:n,area:"MsPortalFx/Base/Base.Diagnostics",message:e,code:void 0,args:t}}("This call to ".concat(e," is not allowed in an extension."),[E,n]);return f.log(i),t}}))}}(t.Diagnostics||(t.Diagnostics={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){!function(e){var t=MsPortalFx.Base.Diagnostics.Log;e.loggingDiValue={writeEntry:t.writeEntry2,flush:t.flush,disable:t.disable,createLog:function(e){var r="string"==typeof e?e:e.normalize(void 0);return new t(r)}}}(e.Diagnostics||(e.Diagnostics={}))}(e.Base||(e.Base={}))}(FxImpl||(FxImpl={})),function(e){var t=window.document;e.createElement=function(e,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];r=r||{};var a=t.createElement(e);return MsPortalFx.forEachKey(r,(function(e,t){"class"===e?a.className=r.class:"trustedInnerHTML"===e?a.innerHTML=r.trustedInnerHTML:a.setAttribute(e,t)})),n&&n.forEach((function(e){"string"==typeof e?a.append?a.append(e):a.innerHTML+=e:a.appendChild(e)})),a}}(FxImpl||(FxImpl={})),function(e){var t="#fxSerialized#",r=new MsPortalFx.Base.Diagnostics.Log("FxImpl.Serialization"),n=new MsPortalFx.Base.Diagnostics.Log("Obsolete"),i=Object.getOwnPropertyNames,a=ko.isObservable;e.logObsoleteAPI=function(e,t,r){if(MsPortalFx.isFeatureEnabled("logobsoleteapis")){var i="".concat(e," is obsolete.");t&&(i+=" Please use ".concat(t," instead."));var a=new Error(i);r?n.warning(a):n.error(a)}},e.toSerializableObject=function(e){var r=c(e);return r[t]=!0,r},e.isSerializedObject=function(e){return e&&e.hasOwnProperty(t)},e.fromSerializableObject=function(e){return l(e)};var o={},s={v:MsPortalFx.generateNonSerializableProperty("object_cycle_detected")},u=function(e,t){r.error(e+"at callstack:"+MsPortalFx.getCurrentCallStack(!0))};function c(e,t,r){var n=a(e),l=n?e.peek():e,d={},f=t||new WeakMap,p=n||Array.isArray(e)||MsPortalFx.isObject(e);if(p){var h=f.get(e);if(h===o)return u("toSerializableObjectImpl detects a cycle. root: ".concat(MsPortalFx.getObjectDescriptor(e,!1)),e)||s;if(void 0!==h)return h;f.set(e,o)}var y=r||function(e){return c(e,f,y)};return n&&(d.t=1),Array.isArray(l)?n?(e.splice&&(d.t=2),d.v=y(l)):d.v=l.map(y):a(l)?d.v=y(l):l instanceof Date?(d.d=!0,d.v=l.valueOf()):MsPortalFx.isObject(l)?n?d.v=y(l):(d.v={},i(l).forEach((function(e){MsPortalFx.isSerializableProperty(e)&&(d.v[e]=y(l[e]))}))):d.v=l,p&&f.set(e,d),d}function l(e){var t,r=e.v,n=e.t,a=!1;r===s.v&&(r=void 0),n&&MsPortalFx.isObject(r)&&r.hasOwnProperty("v")&&(t=l(r),a=!0),a||(Array.isArray(r)?t=r.map(l):MsPortalFx.isObject(r)?(t={},i(r).forEach((function(e){MsPortalFx.isSerializableProperty(e)&&(t[e]=l(r[e]))}))):t=e.d?new Date(r):r);var o=t;return 1===n?o=ko.observable(t):2===n&&(o=ko.observableArray(t)),o}var d=[];e.registerGlobalState=function(e){d.push(e),e.reset()},e.resetGlobalState=function(){d.forEach((function(e){e.reset()}))},e.getErrorMap=function(t){return MsPortalFx.forEachKey(t,(function(t,r,n){n[t]=function(){var n=[].slice.call(arguments),i=function(e,t,r){var n="Code: '"+e+"'. ",i="";return t?i=t.format.apply(t,r):r&&r.length&&(i="\nParameters: "+[].join.call(r,",")+". "),n+i}(t,r,n);throw e.createError(i,r?void 0:{data:{args:n}})}}),{})},e.skipEval=function(e,t){return new MsPortalFx.Base.Diagnostics.Log(t).error(new Error("Eval detected.  Trying to eval: "+e)),MsPortalFx.isFeatureEnabled("nojqueryeval")};var f=function(){function e(e){this._map=new Map,this._key=e}return e.prototype.clear=function(){this._map.clear()},e.prototype.delete=function(e){return this._map.delete(this._key(e))},e.prototype.forEach=function(e,t){var r=this;this._map.forEach((function(n,i,a){e.call(t,n,i,r)}),t)},e.prototype.get=function(e){return this._map.get(this._key(e))},e.prototype.has=function(e){return this._map.has(this._key(e))},e.prototype.set=function(e,t){return this._map.set(this._key(e),t),this},e}();e.lowerCaseStringMap=function(){return new f((function(e){return(e||"").toLowerCase()}))},e.mapValues=function(e,t){return MsPortalFx.forEachKey(e,(function(r,n,i){i[r]=t(n,r,e)}),{})},e.partition=function(e,t){return(e||[]).reduce((function(e,r,n){return e[t(r)?0:1].push(r),e}),[[],[]])},e.getAllKeys=function(e){var t=new Set,r=e;do{if(r===Object.prototype)break;Object.getOwnPropertyNames(r).filter((function(e){return"constructor"!==e})).forEach((function(e){return t.add(e)}))}while(r=Object.getPrototypeOf(r));var n=[];return t.forEach((function(e){return n.push(e)})),n}}(FxImpl||(FxImpl={})),function(e){var t=window;e.knownCulturesMap=function(){var e=[s("be","Belgium","Belgien"),s("de","Germany","Deutschland"),s("li","Liechtenstein","Liechtenstein"),s("lu","Luxembourg","Luxemburg"),s("ch","Switzerland","Schweiz"),s("at","Austria","Österreich"),o("as","American Samoa"),o("ai","Anguilla"),o("ag","Antigua and Barbuda"),o("au","Australia"),o("bs","Bahamas"),o("bb","Barbados"),o("be","Belgium"),o("bz","Belize"),o("bm","Bermuda"),o("bw","Botswana"),o("io","British Indian Ocean Territory"),o("vg","British Virgin Islands"),o("cm","Cameroon"),o("ca","Canada"),o("029","Caribbean"),o("ky","Cayman Islands"),o("cx","Christmas Island"),o("cc","Cocos (Keeling) Islands"),o("ck","Cook Islands"),o("dm","Dominica"),o("er","Eritrea"),o("150","Europe"),o("fk","Falkland Islands"),o("fj","Fiji"),o("gm","Gambia"),o("gh","Ghana"),o("gi","Gibraltar"),o("gd","Grenada"),o("gu","Guam"),o("gg","Guernsey"),o("gy","Guyana"),o("hk","Hong Kong SAR"),o("in","India"),o("ie","Ireland"),o("im","Isle of Man"),o("jm","Jamaica"),o("je","Jersey"),o("ke","Kenya"),o("ki","Kiribati"),o("ls","Lesotho"),o("lr","Liberia"),o("mo","Macao SAR"),o("mg","Madagascar"),o("mw","Malawi"),o("my","Malaysia"),o("mt","Malta"),o("mh","Marshall Islands"),o("mu","Mauritius"),o("fm","Micronesia"),o("ms","Montserrat"),o("na","Namibia"),o("nr","Nauru"),o("nz","New Zealand"),o("ng","Nigeria"),o("nu","Niue"),o("nf","Norfolk Island"),o("mp","Northern Mariana Islands"),o("pk","Pakistan"),o("pw","Palau"),o("pg","Papua New Guinea"),o("ph","Philippines"),o("pn","Pitcairn Islands"),o("pr","Puerto Rico"),o("rw","Rwanda"),o("kn","Saint Kitts and Nevis"),o("lc","Saint Lucia"),o("vc","Saint Vincent and the Grenadines"),o("ws","Samoa"),o("sc","Seychelles"),o("sl","Sierra Leone"),o("sg","Singapore"),o("sx","Sint Maarten"),o("sb","Solomon Islands"),o("za","South Africa"),o("ss","South Sudan"),o("sh","St Helena, Ascension, Tristan da Cunha"),o("sd","Sudan"),o("sz","Swaziland"),o("tz","Tanzania"),o("tk","Tokelau"),o("to","Tonga"),o("tt","Trinidad and Tobago"),o("tc","Turks and Caicos Islands"),o("tv","Tuvalu"),o("um","U.S. Outlying Islands"),o("vi","U.S. Virgin Islands"),o("ug","Uganda"),o("gb","United Kingdom"),o("us","United States"),o("vu","Vanuatu"),o("001","World"),o("zm","Zambia"),o("zw","Zimbabwe"),u("ar","Argentina","Argentina"),u("bo","Bolivia","Bolivia"),u("cl","Chile","Chile"),u("co","Colombia","Colombia"),u("cr","Costa Rica","Costa Rica"),u("cu","Cuba","Cuba"),u("ec","Ecuador","Ecuador"),u("sv","El Salvador","El Salvador"),u("es","Spain, International Sort","España, alfabetización internacional"),u("us","United States","Estados Unidos"),u("ph","Philippines","Filipinas"),u("gt","Guatemala","Guatemala"),u("gq","Equatorial Guinea","Guinea Ecuatorial"),u("hn","Honduras","Honduras"),u("419","Latin America","Latinoamérica"),u("mx","Mexico","México"),u("ni","Nicaragua","Nicaragua"),u("pa","Panama","Panamá"),u("py","Paraguay","Paraguay"),u("pe","Peru","Perú"),u("pr","Puerto Rico","Puerto Rico"),u("do","Dominican Republic","República Dominicana"),u("uy","Uruguay","Uruguay"),u("ve","Venezuela","Venezuela"),c("dz","Algeria","Algérie"),c("be","Belgium","Belgique"),c("bf","Burkina Faso","Burkina Faso"),c("bi","Burundi","Burundi"),c("bj","Benin","Bénin"),c("cm","Cameroon","Cameroun"),c("ca","Canada","Canada"),c("km","Comoros","Comores"),c("cg","Congo","Congo"),c("cd","French Congo (DRC)","Congo, République démocratique du"),c("ci","Côte d’Ivoire","Côte d’Ivoire"),c("dj","Djibouti","Djibouti"),c("fr","France","France"),c("ga","Gabon","Gabon"),c("gp","Guadeloupe","Guadeloupe"),c("gq","Equatorial Guinea","Guinée équatoriale"),c("gn","Guinea","Guinée"),c("gf","French Guiana","Guyane française"),c("ht","Haiti","Haïti"),c("re","Réunion","La Réunion"),c("lu","Luxembourg","Luxembourg"),c("mg","Madagascar","Madagascar"),c("ml","Mali","Mali"),c("ma","Morocco","Maroc"),c("mq","Martinique","Martinique"),c("mu","Mauritius","Maurice"),c("mr","Mauritania","Mauritanie"),c("yt","Mayotte","Mayotte"),c("mc","Monaco","Monaco"),c("ne","Niger","Niger"),c("nc","New Caledonia","Nouvelle-Calédonie"),c("pf","French Polynesia","Polynésie française"),c("rw","Rwanda","Rwanda"),c("cf","Central African Republic","République centrafricaine"),c("bl","Saint Barthélemy","Saint-Barthélemy"),c("mf","Saint Martin","Saint-Martin"),c("pm","Saint Pierre and Miquelon","Saint-Pierre-et-Miquelon"),c("sc","Seychelles","Seychelles"),c("ch","Switzerland","Suisse"),c("sy","Syria","Syrie"),c("sn","Senegal","Sénégal"),c("td","Chad","Tchad"),c("tg","Togo","Togo"),c("tn","Tunisia","Tunisie"),c("vu","Vanuatu","Vanuatu"),c("wf","Wallis and Futuna","Wallis-et-Futuna"),["id-id","Indonesian (Indonesia)","Indonesia (Indonesia)‎"],["it-it","Italian (Italy)","Italiano (Italia)‎"],["it-sm","Italian (San Marino)","Italiano (San Marino)‎"],["it-ch","Italian (Switzerland)","Italiano (Svizzera)‎"],["hu-hu","Hungarian (Hungary)","Magyar (Magyarország)‎"],["nl-aw","Dutch (Aruba)","Nederlands (Aruba)‎"],["nl-be","Dutch (Belgium)","Nederlands (België)‎"],["nl-bq","Dutch (Bonaire, Sint Eustatius and Saba)","Nederlands (Bonaire, Sint Eustatius en Saba)‎"],["nl-cw","Dutch (Curaçao)","Nederlands (Curaçao)‎"],["nl-nl","Dutch (Netherlands)","Nederlands (Nederland)‎"],["nl-sx","Dutch (Sint Maarten)","Nederlands (Sint-Maarten)‎"],["nl-sr","Dutch (Suriname)","Nederlands (Suriname)‎"],["pl-pl","Polish (Poland)","Polski (Polska)‎"],l("br","Brazil","Brasil"),l("pt","Portugal","Portugal"),["sv-fi","Swedish (Finland)","Svenska (Finland)‎"],["sv-se","Swedish (Sweden)","Svenska (Sverige)‎"],["sv-ax","Swedish (Åland Islands)","Svenska (Åland)‎"],["tr-cy","Turkish (Cyprus)","Türkçe (Kıbrıs)‎"],["tr-tr","Turkish (Turkey)","Türkçe (Türkiye)‎"],["cs-cz","Czech (Czechia)","Čeština (Česko)‎"],["ru-by","Russian (Belarus)","Русский (Беларусь)‎"],["ru-kz","Russian (Kazakhstan)","Русский (Казахстан)‎"],["ru-kg","Russian (Kyrgyzstan)","Русский (Киргизия)‎"],["ru-md","Russian (Moldova)","Русский (Молдова)‎"],["ru-ru","Russian (Russia)","Русский (Россия)‎"],["ru-ua","Russian (Ukraine)","Русский (Украина)‎"],["zh-cn","Chinese (Simplified, China)","中文(中国)‎"],["zh-tw","Chinese (Traditional, Taiwan)","中文(台灣)‎"],["zh-sg","Chinese (Simplified, Singapore)","中文(新加坡)‎"],["zh-mo","Chinese (Traditional, Macao SAR)","中文(澳門特別行政區)‎"],["zh-hk","Chinese (Traditional, Hong Kong SAR)","中文(香港特別行政區)‎"],["ja-jp","Japanese (Japan)","日本語 (日本)‎"],["ko-kp","Korean (North Korea)","한국어 (조선민주주의인민공화국)‎"],["ko-kr","Korean (Korea)","한국어(대한민국)‎"]],t={};function r(e){var r=e[0];t[r]={locale:r,name:e[1],localizedName:e[2],neutralCulture:this,specificCulture:e[3]}}return[["de","German","Deutsch‎","de-de"],["en","English","English‎","en-us"],["es","Spanish","Español‎","es-es"],["fr","French","Français‎","fr-fr"],["it","Italian","Italiano‎","it-it"],["id","Indonesian","Indonesia‎","id-id"],["hu","Hungarian","Magyar‎","hu-hu"],["nl","Dutch","Nederlands‎","nl-nl"],["pl","Polish","Polski‎","pl-pl"],["pt","Portuguese","Português‎","pt-br"],["sv","Swedish","Svenska‎","sv-se"],["tr","Turkish","Türkçe‎","tr-tr"],["cs","Czech","Čeština‎","cs-cz"],["ru","Russian","Русский‎","ru-ru"],["zh","Chinese","中文‎","zh-cn"],["zh-hans","Chinese (Simplified)","中文(简体)‎","zh-cn"],["zh-chs","Chinese (Simplified) Legacy","中文(简体) 旧版‎","zh-cn"],["zh-hant","Chinese (Traditional)","中文(繁體)‎","zh-tw"],["zh-cht","Chinese (Traditional) Legacy","中文(繁體) 舊版‎","zh-tw"],["ja","Japanese","日本語‎","ja-jp"],["ko","Korean","한국어‎","ko-kr"],["qps-ploc","Pseudo (Pseudo)","[Þšéųδô (Ρŝέũδθ) !!! !!]‎","qps-ploc"]].forEach(r,!0),e.forEach(r,!1),t}();var r=function(e,t){var r={};this.getValue=function(n){var i="";n&&Object.keys(n).sort().forEach((function(e,t){t&&(i+=","),i+=e+":"+n[e]}));var a=r[i];if(!a){if(t){var o=MsPortalFx.clone(n);a=function(e,t,r){try{return new e(t,r)}catch(e){throw new Error("Intl.DateTimeFormat failed. format culture: {0}, options: {1}, Exception: {2}".format(t,JSON.stringify(r),e))}}(t,e,o)}else a={format:function(e){return e+""}};r[i]=a}return a}},n=function(e,t,n){this.displayLanguage=e,this.formatCulture=t,this.numbers=new r(this.formatCulture,n&&n.NumberFormat),this.dateTimes=new r(this.formatCulture,n&&n.DateTimeFormat),this.supported=function(e){return n?(e=n.DateTimeFormat.supportedLocalesOf(e),e=n.NumberFormat.supportedLocalesOf(e)):["en-us"]}};function i(e,r){return new n(e,r,t.Intl)}function a(t,r){var n=e.knownCulturesMap[t];return n&&!n.neutralCulture||(t=e.knownCulturesMap[r].specificCulture||r),t}function o(e,t){return["en-".concat(e),"English (".concat(t,")"),"English (".concat(t,")‎")]}function s(e,t,r){return["de-".concat(e),"German (".concat(t,")"),"Deutsch (".concat(r,")‎")]}function u(e,t,r){return["es-".concat(e),"Spanish (".concat(t,")"),"Español (".concat(r,")‎")]}function c(e,t,r){return["fr-".concat(e),"French (".concat(t,")"),"Français (".concat(r,")‎")]}function l(e,t,r){return["pt-".concat(e),"Portuguese (".concat(t,")"),"Português (".concat(r,")‎")]}e.IntlContext=n,e.createWithBrowserIntl=i,function(r){r.displayLanguage=e.internalEnv.displayLanguage,r.formatCulture=a(e.internalEnv.rawFormatCulture,r.displayLanguage),r.effectiveLocale="".concat(r.displayLanguage,".").concat(r.formatCulture);var n=i(r.displayLanguage,r.formatCulture);!function(e){function t(e){return n.numbers.getValue(e)}e.create=t,e.format=function(e){return t().format(e)}}(r.NumberFormat||(r.NumberFormat={})),function(e){var t="numeric",r="long";e.shortDatePattern={day:t,month:t,year:t},e.longDatePattern={weekday:r,year:t,month:r,day:t},e.fullDateTimePattern={weekday:r,year:t,month:r,day:t,hour:t,minute:t,second:t},e.monthDayPattern={month:r,day:t},e.shortTimePattern={hour:t,minute:t},e.longTimePattern={hour:t,minute:t,second:t},e.yearMonthPattern={year:t,month:r},e.weekDayPattern={weekday:r},e.create=function(e){return n.dateTimes.getValue(e)}}(r.DateTimeFormat||(r.DateTimeFormat={})),function(e){e.supportedLocalesOf=function(e){return n.supported(e)}}(r.Internal||(r.Internal={})),t.define("MsPortalFx/Globalization",e.Intl)}(e.Intl||(e.Intl={})),e.sanitizeFormatCulture=a}(FxImpl||(FxImpl={})),function(e){!function(t){t.getSharedSettings=function(){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().getSharedSettings()}))}}(e.Settings||(e.Settings={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r="/",n=e.isUndefined,i=e.isUriAbsolute,a=e.split,o=e.ensurePrefix,s=decodeURIComponent,u=encodeURIComponent,c=window.location;function l(e){return e||""}function d(e,t,r){return l(e).substr(t,r)}function f(e,t,n){var o="";return i(e)&&(o=(o=a(e,r,4).slice(t,n).join(r)).split("\\")[0]),o}var p=function(){function e(e,t){var r=this;if(this._qs=[],this._qsMap={},this._leadingSeparator=n(t)?"?":t,e){var i=e;i.startsWith(this._leadingSeparator)&&(i=d(i,1)),i.split("&").forEach((function(e){if(e){var t=e.indexOf("="),n=t>=0,i=n?d(e,0,t):e,a=n?d(e,t+1):"";i&&(i=s(i),a=s(a),r.setParameter(i,a))}}))}}return e.prototype.clear=function(){return this._qs=[],this._qsMap={},this},e.prototype.setParameters=function(e){for(var t in e)e.hasOwnProperty(t)&&this.setParameter(t,e[t]);return this},e.prototype._getParameterIndex=function(e){var t=e.toUpperCase();return this._qsMap[t]},e.prototype.setParameter=function(e,t){var r=e.toUpperCase(),i=this._qsMap[r],a=this._qs;return n(i)?(this._qsMap[r]=a.length,a.push(e),a.push(t)):(a[i]=e,a[i+1]=t),this},e.prototype.getParameter=function(e){var t,r=this._getParameterIndex(e);return n(r)||(t=this._qs[r+1]),t},e.prototype.getParameters=function(){for(var e={},t=this._qs,r=0,n=t.length;r<n;r+=2){void 0!==t[r]&&(e[t[r]]=t[r+1])}return e},e.prototype.removeParameters=function(e){return e.forEach(this.removeParameter,this),this},e.prototype.removeParameter=function(e){var t=this._getParameterIndex(e);if(!n(t)){var r=this._qs;r[t]=r[t+1]=void 0}return this},e.prototype.toString=function(e){void 0===e&&(e=!0);for(var t="",r=this._qs,i=r.length,a=0;a<i;){var o=r[a++],s=r[a++];n(o)||(t+="&",t+=u(o),t+="=",t+=u(s))}return t&&(t=d(t,1),e&&(t=this._leadingSeparator+t)),t},e}();t.QueryStringBuilder=p;var h=function(){function t(e){var t=l(e),r=t.indexOf("#"),n=r>=0,i=n?d(t,0,r):t,a=n?d(t,r):"",o=i.indexOf("?"),s=o>=0,u=s?d(i,0,o):i;this._oq=s?d(i,o):"",this.path=u,this.query=new p(this._oq),this.fragment=a}return t.prototype.getOriginalQuery=function(){return this._oq},t.prototype.toString=function(){var e=(this.query||"").toString(),t=l(this.fragment);return t&&(t=o(t,"#")),l(this.path)+e+t},t.prototype.getScheme=function(){var e=f(this.path,0,2);return e&&(e+="/"),e},t.prototype.getAuthority=function(){return f(this.path,2,3)},t.prototype.getSchemeAndAuthority=function(t){var r=f(this.path,0,3);return t&&e.startsWith(r,"//")&&(r=c.protocol+r),r},t.prototype.getRelativePath=function(){var e=this.path;return i(e)&&(e=o(a(e,r,4)[3],r)),e},t.prototype.setRelativePath=function(t){var n=this.path;if(i(n)){t=l(t),e.startsWith(t,r)&&(t=d(t,1));var o=a(n,r,4);o[3]=t,n=o.join(r)}else n=t;this.path=n},t}();t.UriBuilder=h}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){!function(e){e.Shell="fx",function(e){e.Hubs="HubsExtension",e.Billing="Microsoft_Azure_Billing",e.AzureExpert="Microsoft_Azure_Expert",e.AzureInsights="Microsoft_Azure_Insights",e.AzureMonitoring="Microsoft_Azure_Monitoring",e.ActiveDirectory="Microsoft_Azure_AD",e.ClassicResources="Microsoft_Azure_ClassicResources",e.Marketplace="Microsoft_Azure_Marketplace",e.Resources="Microsoft_Azure_Resources",e.Support="Microsoft_Azure_Support",e.Websites="WebsitesExtension"}(e.ExtensionNames||(e.ExtensionNames={})),function(e){e.ResourceGroups="ResourceGroups",e.BrowseAllBlade="BrowseAll",e.BrowseResourceBlade="BrowseResource",e.BrowseBlade="BrowseResource",e.BrowseAllResources="BrowseAllResources",e.BrowseRecentResources="BrowseRecentResources",e.BrowseAllBladeWithType="BrowseAllWithType",e.BrowseResourceGroupBlade="BrowseResourceGroup",e.Gallery="Gallery",e.StoreGallery="StoreGallery",e.Deployments="Deployments",e.ArmExplorer="ArmExplorer",e.WhatsNew="WhatsNew",e.BrowseDynamicResource="BrowseDynamicResource",e.BrowseDynamicAsset="BrowseDynamicAsset",e.SubscriptionDetail="Subscription",e.NonAssetResource="NonAssetResource"}(e.AssetNames||(e.AssetNames={})),function(e){e.Subscriptions="Microsoft.Resources/subscriptions",e.ResourceGroups="Microsoft.Resources/subscriptions/resourcegroups",e.AllResources="Microsoft.Resources/resources",e.RecentResources="Microsoft.Resources/recent"}(e.ResourceTypes||(e.ResourceTypes={})),function(e){!function(e){e.BrowseResourcePinnedPart="BrowseResourcePinnedPart",e.BrowseResourceGroupPinnedPart="BrowseResourceGroupPinnedPart"}(e.Hubs||(e.Hubs={}))}(e.PartNames||(e.PartNames={})),function(e){!function(e){e.SubscriptionsBlade="SubscriptionsBlade"}(e.Billing||(e.Billing={})),function(e){e.CreateHubBlade="PlusNewBlade",e.BrowseLinkBlade="BrowseLinkBlade",e.BrowseResourceBlade="BrowseResourceBlade",e.BrowseAllResourcesBlade="BrowseAllResourcesBlade",e.BrowseResourceGroupBlade="BrowseResourceGroupBlade",e.BrowseRecentResourcesBlade="BrowseRecentResourcesBlade",e.AssetMenuBlade="AssetMenuBlade",e.UnauthorizedAssetBlade="UnauthorizedAssetBlade",e.NotFoundAssetBlade="NotFoundAssetBlade",e.UnavailableAssetBlade="UnavailableAssetBlade",e.ResourceMenuBlade="ResourceMenuBlade",e.ResourceProperties="ResourceProperties",e.ResourceGroupMapBlade="ResourceGroupMapBlade"}(e.Hubs||(e.Hubs={})),function(e){e.GalleryFeaturedMenuItemBlade="GalleryFeaturedMenuItemBlade",e.GalleryResultsListBlade="GalleryResultsListBlade",e.LegalTermsV2Blade="PCLegalTermsV2Blade"}(e.Marketplace||(e.Marketplace={}))}(e.BladeNames||(e.BladeNames={})),function(e){e.FeatureAdoption="FeatureAdoption",e.FeatureObsolete="FeatureObsolete"}(e.Telemetry||(e.Telemetry={})),function(e){e.RegisterExtension="TelemetrySharing.registerExtension",e.TraceTelemetry="TelemetrySharing.traceTelemetry"}(e.TelemetrySharing||(e.TelemetrySharing={})),function(e){e.HomeMenuItem="home"}(e.GalleryMenuItems||(e.GalleryMenuItems={})),function(e){e.EditScopeId="editScopeId",e.ReferrerInfo="referrerInfo"}(e.BladeParameterNames||(e.BladeParameterNames={}))}(e.Constants||(e.Constants={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){var t="MsPortalFx.Errors.";function r(e,t,r){var n="string"!=typeof e?e:{dataSetName:e,errorData:t};return __assign(__assign({},r),n)}var n=function(e){function n(t,n){var i=this,a=r(t,n,{name:"DataError"});return(i=e.call(this,a)||this).dataSetName=a.dataSetName,i}return __extends(n,e),n.TypeName="".concat(t,"DataError"),n}(e.Error);e.DataError=n;var i=function(e){function n(t,n){var i=r(t,n,{name:"FetchDataError"});return e.call(this,i)||this}return __extends(n,e),n.TypeName="".concat(t,"FetchDataError"),n}(n);e.FetchDataError=i;var a=function(e){function n(t,n){var i=r(t,n,{name:"UnauthorizedDataError"});return e.call(this,i)||this}return __extends(n,e),n.TypeName="".concat(t,"UnauthorizedDataError"),n}(n);e.UnauthorizedDataError=a;var o=function(e){function n(t,n){var i=r(t,n,{name:"NotFoundDataError"});return e.call(this,i)||this}return __extends(n,e),n.TypeName="".concat(t,"NotFoundDataError"),n}(n);e.NotFoundDataError=o;var s=function(r){function n(t){var n=e.getErrorOptions(t,{name:"DisposedError"});return r.call(this,n)||this}return __extends(n,r),n.TypeName="".concat(t,"DisposedError"),n}(e.Error);e.DisposedError=s;var u=function(r){function n(t){var n=this,i=e.getErrorOptions(t,{name:"AjaxError"});return(n=r.call(this,i)||this).textStatus=i.textStatus,n.errorThrown=i.errorThrown,n.jqXHR=i.jqXHR,n.jqXHR&&(401===n.jqXHR.status||403===n.jqXHR.status?n.errorLevel=1:0===n.jqXHR.status&&(n.errorLevel=0)),n}return __extends(n,r),n.TypeName="".concat(t,"AjaxError"),n}(e.Error);e.AjaxError=u}(e.Errors||(e.Errors={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){e.Base;var r=Object,n=r.getOwnPropertyDescriptor,i=r.defineProperty,a=$.noop;t.NotProxied=function(e,t,r){r.enumerable=!1},t.ProxyCompatibilityMode=a,FxImpl.onEnvironmentSet((function(e){e("javascriptObjectPropertiesAreEnumerable",!0)&&(t.ProxyCompatibilityMode=function(e){var t,r=e.prototype;for(var a in r)(t=n(r,a))&&t.enumerable&&t.get&&(t.enumerable=!1,i(r,a,t))})}))}(e.Composition||(e.Composition={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){function r(e){e.finally||(e.finally=e.always),e.catch||(e.catch=e.fail)}var n;t.isXMLHttpRequestLike=function(t){return t&&e.isObject(t)&&"number"==typeof t.readyState&&"number"==typeof t.status&&"string"==typeof t.statusText},n=$.Deferred,$.Deferred=function(e){var t=n(e),i=t.promise;return r(t),t.promise=function(){var e=i.apply(this,arguments);return r(e),e},t}}(e.Helpers||(e.Helpers={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){!function(t){var r=e.getStringMapFunc("type","options");t.newImageData=function(e,t){return"number"==typeof t&&(t={palette:t}),r(e,t||null)}}(t.Image||(t.Image={}))}(e.Services||(e.Services={}))}(MsPortalFx||(MsPortalFx={})),function(e){MsPortalFx.Base;var t=ko.utils,r=MsPortalFx.uncurryThis,n=MsPortalFx.isUndefined,i="###knockoutArrayEditFixupTokenPropertyName###",a=Function.call,o=r(Array.prototype.push),s="added",u="deleted",c={fixedUp:"",fixedUpIndexes:"",createArraySplices:"",mapIntoChanges:""},l=e.getErrorMap(c);function d(e,t,r){var n=!1;return(t.deleteCount>0||t.spliceArguments.length>3)&&(t.spliceArguments[1]=t.startIndex,t.spliceArguments[2]=t.deleteCount,a.apply(r,t.spliceArguments),n=!0),t.deleteCount=0,t.startIndex=t.currentIndex,t.spliceArguments.length=3,n}function f(e,t,r,a){if(e[i])throw new Error("createArraySplices does not work against edits with indexes that have been adjusted by adjustArrayEdits.");var o,c,l,d=e.length;if(r){var f=0,p=new Array(d);for(c=0;c<d;c++)o=e[c],n(o.moved)&&o.status===s&&(p[f++]=o.value);p.length=f,l=a(p)}var h,y=new Array(d),m=0,v=0,g=0;for(c=0;c<d;c++){var _=(o=e[c]).status,b=!n(o.moved);if(_===s){var x=o.index,E=void 0;E=r?b?r[o.moved]:l[g++]:o.value,!h||t&&!!h.move!==b||x!==h.start+h.items.length?(h={start:x,deleteCount:0,items:[E]},t&&b&&(h.move=b),y[m++]=h):h.items.push(E),v++}else if(_===u){var P=o.index+v;!h||t&&!!h.move!==b||P!==h.start+h.items.length?(h={start:P,deleteCount:1,items:[]},t&&b&&(h.move=b),y[m++]=h):h.deleteCount++,v--}}return y.length=m,y}function p(e,t,r,n){for(var i=t?t.split("."):[];e&&i.length;)(e=r(e))&&(e=e[i.shift()]);if(!i.length)return n&&(e=r(e)),e}function h(e,t,r,n){var i=t.subscribe(r,n,"arrayChange");return e&&e.registerForDispose(i),i}function y(e,t,r,n,i,a){void 0===i&&(i=MsPortalFx.noop),void 0===a&&(a=function(e,t){if(t)throw e});var o=!0,s=e.subscribe(t,(function(e){var t=!n;if(n)try{t=n(e)}catch(e){a(e,!0)}t&&(o&&(o=!1,r&&r.call(s,e),i(e)),s.dispose())})),u=s.disposeCallback;return s.disposeCallback=function(){a(new MsPortalFx.Errors.CanceledError("fxawait promise disposed")),u.apply(this,arguments)},s.isDisposed&&a(new MsPortalFx.Errors.CanceledError("fxawait promise disposed")),s}t.adjustArrayEdits=function(e,t,r){e[i]&&l.fixedUpIndexes();var a=0,o=e.map((function(e){var i=MsPortalFx.clone(e);switch(e.status){case s:t&&(n(e.moved)?i.value=r(e.value):i.value=t[e.moved]),a++;break;case u:i.index+=a,a--;case"retained":t&&(i.value=t[e.index])}return i}));return o[i]=i,o},e.quickApplyArrayEdits=function(e,t,r){for(var n=r&&r.spliceFunc||Array.prototype.splice,i=r&&r.inplaceFixup,a={startIndex:0,currentIndex:0,spliceArguments:[e,0,0],deleteCount:0},s=0,u=0,c={added:1,deleted:-1},l=0,f=t.length;l<f;l++){var p=t[l],h=c[p.status]||0,y=p.index;i&&(h<0&&(y+=u),u+=h),a.currentIndex!==y&&(d(0,a,n)&&s++,a.startIndex=a.currentIndex=y),h>0?(a.currentIndex++,o(a.spliceArguments,p.value)):h<0&&a.deleteCount++}return d(0,a,n)&&s++,s},e.createArraySplicesInternal=f,t.createArraySplices=function(e,t,r,n){return f(e,t,r,n?function(e){return e.map(n)}:undefined)},t.applyArraySplices=function(e,t,r){var n=[];if(t.length){var i=void 0;t.length>1&&ko.isObservable(e)&&(e=(i=e).peek(),i.valueWillMutate()),t.forEach((function(t){var i;i=r?t.items.map(r):t.items;var a=[t.start,t.deleteCount],o=e.splice.apply(e,a.concat(i));t.move||n.push.apply(n,o)})),i&&i.valueHasMutated()}return n},t.twoWayBinding=function(e,t,r,i){e.registerForDispose||(i=r,r=t,t=e,e=null);var a=e&&e.createChildLifetime();i=i||function(e){return!n(e)};var o=t(),s=r(),u=!1,c=function(e){if(!u)try{u=!0,this(e)}finally{u=!1}};return i(o)?r(o):i(s)&&t(s),a?(t.subscribe(a,c,r),r.subscribe(a,c,t),a):[t.subscribe(c,r),r.subscribe(c,t)]},t.cleanDescendantNodes=function(e){$(e).contents().toArray().forEach((function(e){ko.cleanNode(e)}))},t.wrap=function(e){return ko.isObservable(e)?e:ko.observable(e)},t.wrapArray=function(e){return ko.isObservable(e)?e:ko.observableArray(e)},t.unwrapObservablePath=function(e,t,r){return void 0===r&&(r=!0),p(e,t,ko.unwrap,r)},t.peekObservablePath=function(e,r,n){return void 0===n&&(n=!0),p(e,r,t.peekObservable,n)},e.subscribeArrayEdits=h,ko.subscribable.fn.fxOnce=function(e,t,r){return y(this,e,t,r)},ko.subscribable.fn.fxAwait=function(e,t){var r,n=this,i=Q.promise((function(i,a){r=y(n,e,null,t,i,a)}));return i.subscription=r,i},ko.observableArray.fn.subscribeArrayEdits=function(e,t,r){return h(e,this,t,r)},ko.observableArray.fn.subscribeArrayChanges=function(e,t,r,i){var o=[i=i||this,null],s={added:t,deleted:r};return this.subscribeArrayEdits(e,(function(e){for(var t=0,r=e.length;t<r;t++){var i=e[t];if(n(i.moved)){var u=s[i.status];u&&(o[1]=i.value,a.apply(u,o))}}}))},ko.observableArray.fn.subscribeArrayBulkChanges=function(e,t,r){return r=r||this,this.subscribeArrayEdits(e,(function(e){for(var i=[],a=[],s={added:i,deleted:a},u=0,c=e.length;u<c;u++){var l=e[u];n(l.moved)&&o(s[l.status],l.value)}t.call(r,i,a)}))},ko.observableArray.fn.subscribeArrayAdds=function(e,t,r){return this.subscribeArrayChanges(e,t,null,r)},ko.observableArray.fn.subscribeArrayDeletes=function(e,t,r){return this.subscribeArrayChanges(e,null,t,r)},ko.observableArray.fn.mapInto=function(e,r,n){n||(n=ko.observableArray());var i=e.createChildLifetime(),a=function(e){return ko.ignoreDependencies((function(){var t=i.createChildLifetime();return{item:r(t,e),lifetime:t}}))},o=this.peek().map(a);n(o.map((function(e){return e.item})));var s=e.createChildLifetime(),u=!1;return n.subscribe(s,(function(){u||l.mapIntoChanges()})),this.subscribeArrayEdits(s,(function(e){var r=t.createArraySplices(e,!0,o,a),i=t.applyArraySplices(o,r);try{u=!0,t.applyArraySplices(n,r,(function(e){return e.item}))}finally{u=!1,i.forEach((function(e){e.lifetime.dispose()}))}})),n}}(FxImpl||(FxImpl={})),function(e){var t,r;e.QExtensions||(e.QExtensions={}),t=MsPortalFx.Errors.isInstanceOfErrorType,(r=Promise.prototype).catchError=function(e,r){return this.catch((function(n){return t(n,e)?r(n):Q.reject(n)}))},Q.QPromise.prototype.catchError=r.catchError}(FxImpl||(FxImpl={})),function(e){!function(t){!function(t){var r=e.Errors.CanceledError,n=new e.Base.Diagnostics.Log("MsPortalFx.Base.Promises");function i(t,r){var n=Q.defer(),a=n.promise,s=r.cancelation,u=s();if(u)n.reject(u);else{var c=new FxImpl.TriggerableLifetimeManager;s.subscribe(c,(function(e){e&&a.isPending()&&n.reject(e)})),a.finally((function(){c.dispose()})).catch(e.noop);var l=void 0;if(Q.isPromiseAlike(t))l=Q(t);else try{l=Q(t())}catch(e){l=Q.reject(e)}l.then((function(e){a.isPending()&&n.resolve(e)}),(function(e){a.isPending()&&n.reject(e)}),(function(e){r.canceled||n.notify(e)}))}var d=a.then;return a.then=function(e,t,n){if(t)return d.apply(a,arguments);var s=o(e,r),u=o(n,r);return s||u?i(d.call(a,s,t,u),r):a},a}!function(e){e.fulfilled="fulfilled",e.rejected="rejected"}(t.PromiseStates||(t.PromiseStates={})),t.makeCancelable=i,t.cancelOnDispose=function(e,t,o){var s=new a,u=function(){s.cancel(new r(o||"cancelOnDisposed"))},c=!(!e||e.isDisposed&&e.isDisposed())&&e.createChildLifetime();return c?c.registerForDispose(u):u(),i(t,s).finally((function(){if(c)try{c.dispose()}catch(e){n.error(e)}}))};var a=function(){function e(){this.cancelation=ko.observable()}return Object.defineProperty(e.prototype,"canceled",{get:function(){return!!this.cancelation.peek()},enumerable:!1,configurable:!0}),e.prototype.cancel=function(e){var t=this.cancelation,n=t.peek()||e||new r;return t(n),n},e}();function o(e,t){return e&&function(r){if(!t.canceled)return e(r)}}t.CancelationToken=a}(t.Promises||(t.Promises={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){!function(t){var r=e.keysLength,n=(0,e.uncurryThis)(Array.prototype.forEach),i=e.shallowCopyFromObject,a=e.disposeDisposable,o={keyNotFound:"",reservedKey:"",noPut:"",noRemove:"",noClear:""},s=FxImpl.getErrorMap(o),u=function(){function e(){this._modifyMap={},this._dependantMaps=[],this._observable=ko.observable({}),this._isInModifyBlock=!1,this.latch=this._observable}return e.prototype.put=function(e,t){var r=this;this._validateKey(e),this.modify((function(){r._modifyMap[e]=t,n(r._dependantMaps,(function(r){return r._putNotification(e,t)}))}))},e.prototype.lookup=function(e){return this._modifyMap[e]},e.prototype.modify=function(e){var t=!1,r=[];this._isInModifyBlock||(t=!0,this._isInModifyBlock=!0,this._modifyMap={},i(this._modifyMap,this._observable()),n(this._dependantMaps,(function(e,t){r.push((function(){return e.modify(r[t+1])}))})));try{r.push(e),r[0]()}finally{t&&(this._isInModifyBlock=!1,this._observable(this._modifyMap))}},e.prototype.clear=function(){var e=this;this.modify((function(){e._modifyMap={},n(e._dependantMaps,(function(t){return t._clearNotification(e)}),e)}))},Object.defineProperty(e.prototype,"count",{get:function(){return r(this._observable())},enumerable:!1,configurable:!0}),e.prototype.remove=function(e){var t=this;this._validateKey(e),e in this._observable()||s.keyNotFound(e),this.modify((function(){delete t._modifyMap[e],n(t._dependantMaps,(function(t){return t._removeNotification(e)}))}))},e.prototype.forEach=function(e,t){this.some((function(){return e.apply(this,arguments),!1}))},e.prototype.some=function(e,t){var r=this._observable(),n=t||this;for(var i in r){var a=r[i];if(e.call(n,a,i))return!0}return!1},e.prototype.every=function(e,t){return!this.some((function(){return!e.apply(this,arguments)}),t)},e.prototype.toArray=function(){var e=[];return this.forEach((function(t){e.push(t)})),e},e.prototype.dispose=function(){},e.prototype.subscribe=function(e,t,r,n){return this._observable.subscribe(e,t,r,n)},e.prototype.map=function(e,t){return new c(e,this,t)},e.prototype._addDependantMap=function(e){this._dependantMaps.push(e)},e.prototype._removeDependantMap=function(e){var t=this._dependantMaps.filter((function(t){return t!==e}));t.length!==this._dependantMaps.length&&(this._dependantMaps=t)},e.prototype._putNotification=function(e,t){},e.prototype._removeNotification=function(e){},e.prototype._clearNotification=function(e){},e.prototype._validateKey=function(e){for(var t in Object.prototype)t===e&&s.reservedKey(e)},e}();t.ObservableMap=u;var c=function(e){function t(t,r,n){var i=e.call(this)||this;return i._map=r,i._transform=n,r._addDependantMap(i),t.registerForDispose(i),i.modify((function(){r.forEach((function(t,r){e.prototype.put.call(i,r,i._transform(t,void 0))}))})),i}return __extends(t,e),t.prototype.dispose=function(){this._map._removeDependantMap(this)},t.prototype.put=function(e,t){s.noPut()},t.prototype.remove=function(e){s.noRemove()},t.prototype.clear=function(){s.noClear()},t.prototype._putNotification=function(t,r){var n=this.latch()[t],i=this._transform(r,n);n&&n!==i&&a(n),e.prototype.put.call(this,t,i)},t.prototype._removeNotification=function(t){var r=this.latch()[t];a(r),e.prototype.remove.call(this,t)},t.prototype._clearNotification=function(t){this.forEach((function(e){return a(e)})),e.prototype.clear.call(this)},t}(u);t.ObservableMapProjection=c;var l=function(e){function t(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=e.call(this)||this;return i._maps=r,t.registerForDispose(i),r.forEach((function(t){t._addDependantMap(i),i.modify((function(){t.forEach((function(t,r){e.prototype.put.call(i,r,t)}))}))})),i}return __extends(t,e),t.prototype.dispose=function(){var e=this;n(this._maps,(function(t){return t._removeDependantMap(e)}))},t.prototype.put=function(e,t){s.noPut()},t.prototype.remove=function(e){s.noRemove()},t.prototype.clear=function(){s.noClear()},t.prototype._putNotification=function(t,r){e.prototype.put.call(this,t,r)},t.prototype._removeNotification=function(t){e.prototype.remove.call(this,t)},t.prototype._clearNotification=function(t){var r=this;this._modifyMap={},n(this._maps,(function(n){n!==t&&n.forEach((function(t,n){e.prototype.put.call(r,n,t)}))})),n(this._dependantMaps,(function(e){e._clearNotification(r)}))},t}(u);t.ObservableMapUnion=l}(t.Internal||(t.Internal={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){var t=e.computed;MsPortalFx.noop;function r(e){for(var t=e.length-1,r=new Array(t),n=0;n<t;n++)r[n]=e[n+1];return r}function n(e){return e.map((function(e){return e&&e()}))}var i=e.computed=function(i,a){var o;if(i&&i.registerForDispose){if(2===arguments.length)o=t.call(this,a);else{var s=r(arguments),u=s[0],c=e.isSubscribable(u)&&[u]||Array.isArray(u)&&u;if(c){s.shift();var l=s[0];if("function"==typeof l)s[0]=function(){return e.ignoreDependencies(l,this,n(c))};else{var d=l.read;d&&(l.read=function(){return n(c),e.ignoreDependencies(d,this,null)})}}o=t.apply(this,s)}i.registerForDispose(o)}else o=t.apply(this,arguments);return o};e.explicitComputed=function(){return i.apply(this,arguments)},e.reactor=function(){i.apply(this,arguments)};var a=e.subscribable.fn;function o(e){var t=e.subscribe;e.subscribe=function(e,n){var i;if(e&&e.registerForDispose){if(2===arguments.length)i=t.call(this,n);else{var a=r(arguments);i=t.apply(this,a)}e.registerForDispose(i)}else i=t.apply(this,arguments);return i}}o(a),a.subscribeAndRun=function(){var t=this,r=this.subscribe.apply(this,arguments);return e.ignoreDependencies((function(){r.callback(t())})),r},a.fxOnceAndRun=function(e,t,r){r=r||function(e){return!!e};var n=this.fxOnce(e,t,r);return n.callback(this()),n},a.fxAwaitAndRun=function(e,t){t=t||function(e){return!!e};var r=this.fxAwait(e,t);return r.subscription.callback(this()),r};var s=e.extenders.trackArrayChanges;e.extenders.trackArrayChanges=function(e){var t=e.subscribe,r=s.apply(this,arguments);return e.subscribe!==t&&o(e),r};var u=e.hasPrototype;e.hasPrototype=function(r,n){return n===i&&(n=t),u.call(e,r,n)};var c=e.observableArray,l=c.fn.map,d=c.fn.filter;function f(e){return e&&(e.map=p,e.filter=h),e}function p(e,t){if(e&&e.registerForDispose){var r=l.call(this,{mappingWithDisposeCallback:function(r){var n=e.createChildLifetime();return{mappedValue:t(n,r),dispose:function(){n.dispose()}}}});return e.registerForDispose(r),f(r)}return f(l.apply(this,arguments))}function h(e,t){if(e&&e.registerForDispose){var r=d.call(this,t);return e.registerForDispose(r),f(r)}return f(d.apply(this,arguments))}f(c.fn)}(ko||(ko={})),function(e){e.Base.Diagnostics,Array.prototype}(MsPortalFx||(MsPortalFx={})),function(e){var t=FxImpl.Intl.DateTimeFormat,r=e.Resources.Strings.DatePolyfill;function n(e,t,r){return{limit:e,format:t,factorSeconds:r||0}}function i(e,t){return e.map((function(e){return t[e]}))}var a=e.uncurryThis(Date.prototype.toString),o=Date.parse,s=r.AgoStrings,u=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],c=["january","february","march","april","may","june","july","august","september","october","november","december"],l={days:i(u,r.Days),daysAbbr:i(u,r.DaysAbbr),months:i(c,r.Months),monthsAbbr:i(c,r.MonthsAbbr),ampm:["AM","PM"],ampmAbbr:[],dateSeparator:"/",timeSeparator:":",standard:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",f:"",F:"dddd, MMMM dd, yyyy h:mm:ss tt",g:"",G:"",m:"MMMM dd",M:"MMMM dd",r:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",R:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",s:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",t:"h:mm tt",T:"h:mm:ss tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",y:"MMMM, yyyy",Y:"MMMM, yyyy"},firstDayOfWeek:0},d=[n(60,s.lessThanAMinute),n(90,s.aMinute),n(3600,s.minutes,60),n(5400,s.anHour),n(86400,s.hours,3600),n(129600,s.aDay),n(604800,s.days,86400),n(907200,s.aWeek),n(2628e3,s.weeks,604800),n(3942e3,s.aMonth),n(31536e3,s.months,2628e3),n(47304e3,s.aYear),n(Number.POSITIVE_INFINITY,s.years,31536e3)];function f(){return l}function p(e){(l=e||l).ampmAbbr=[l.ampm[0][0]||"",l.ampm[1][0]||""];var t=l.standard;t.f=t.D+" "+t.t,t.g=t.d+" "+t.t,t.G=t.d+" "+t.T}function h(t,r){var n=t+"",i=r-n.length;return i>0&&(n=e.repeat("0",i)+n),n}function y(e,t){return(e+"").substr(-t)}function m(e,t){return y(h(e,t),t)}function v(e){for(var t="",r=0,n=e.length;r<n;r++)t+="\\",t+=e[r];return t}function g(e,t){var r,n=(t?t.getTime():Date.now())-e.getTime();n/=1e3;for(var i=0,a=d.length;i<a&&!(n<(r=d[i]).limit);i++);var o=r.format;return r.factorSeconds&&(o=o.format(Math.round(n/r.factorSeconds))),o}function _(t){if((t=t||0)&&FxImpl.postBootEnv.extensionName&&"HubsExtension"!==FxImpl.postBootEnv.extensionName){e.Base.Diagnostics.Log.writeEntry(2,"MsPortalFx/Globalization",new Error("getFirstDayOfWeek has been deprecated to improve portal performance and should not be used."))}var r=this.getDate(),n=t-this.getDay();return n>0&&(n-=7),new Date(this.getFullYear(),this.getMonth(),r+n)}e.getLocaleValues=f,e.setLocaleValues=p;var b={difference:g,timestamp:function(e,r){for(var n,i=function(e){var r=_.call(e,0);return[{limit:86400,format:function(t){return g(t,e)}},{limit:(e.getTime()-r.getTime())/1e3,format:t.create({weekday:"long"}).format},{limit:Number.POSITIVE_INFINITY,format:t.create(t.shortDatePattern).format}]}(r=r||new Date),a=(r.getTime()-e.getTime())/1e3,o=0,s=i.length;o<s&&!(a<(n=i[o]).limit&&n.limit>0);o++);return n.format(e)}};var x=e.uncurryThis(v);function E(){return function(){var r=this;if(arguments.length){var n=arguments[0];if("string"==typeof n){if(FxImpl.postBootEnv.extensionName&&"HubsExtension"!==FxImpl.postBootEnv.extensionName){e.Base.Diagnostics.Log.writeEntry(2,"MsPortalFx/Globalization",new Error("For globalization purposes, do not use date.toString(string) for formatting dates. Instead use date.toString(Intl.DateTimeFormat options)"))}n=(n=l.standard[n]||n).replace(/'([^']*)'/g,x);return e.reverse(e.reverse(n).replace(/(y{1,5}|M{1,4}|d{1,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{1,2}|z{1,3}|\/|:)(?!\\)/g,(function(t){return e.reverse(function(e,t){var r=t.length,n=2===r?m:y,i=f();switch(t[0]){case"y":var a=e.getFullYear();return 3===r?h(a,r):1===r?parseInt(y(a,2),10)+"":m(a,r);case"M":var o=e.getMonth();return 4===r?v(i.months[o]):3===r?v(i.monthsAbbr[o]):n(o+1,2);case"d":return 4===r?v(i.days[e.getDay()]):3===r?v(i.daysAbbr[e.getDay()]):n(e.getDate(),2);case"h":var s=!0;case"H":var u=e.getHours();return n(u=s?(u-1)%12+1:u,2);case"m":return n(e.getMinutes(),2);case"s":return n(e.getSeconds(),2);case"t":return(2===r?i.ampm:i.ampmAbbr)[e.getHours()<12?0:1];case"z":var c=-e.getTimezoneOffset()/60,l="+";c<0&&(c=-c,l="-");var d=parseInt(c+"",10),p=60*(c-d);return l+(3===r?h(d,2)+":"+h(p,2):h(d,r));case"/":return i.dateSeparator;case":":return i.timeSeparator}return""}(r,t))})).replace(/\\(?!\\)/g,""))}return t.create(n).format(this)}return a(this,arguments)}}function P(t){return"string"!=typeof t&&(t+=""),e.startsWith(t,"/Date(")?parseInt(t.slice(6),10):o.call(null,t)}e.getDateToStringFunc=E,e.dateParse=P,e.polyfill(Date,{getFirstDayOfWeek:_,toRelativeString:function(e,t){var r=b[e||"difference"];return r?r(this,t||new Date):void 0},toString:E()},!0),e.forEachKey({getLocaleValues:f,parse:P,setLocaleValues:p},(function(e,t){Object.defineProperty(Date,e,{value:t,configurable:!0,enumerable:!1,writable:!0})})),function(){try{return void new Date(1e4,1,1).toLocaleString()}catch(e){}var t=Date.prototype,r=function(e){return function(){try{return e.call(this)}catch(e){return this.toISOString()}}};e.polyfill(Date,{toLocaleDateString:r(t.toLocaleDateString),toLocaleString:r(t.toLocaleString),toLocaleTimeString:r(t.toLocaleTimeString)},!0)}(),p(l)}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){var t="MsPortalFx.Internal.Constants.RpcMethods.";!function(e){e.hubsGetResourceGroupsFromSubscription="Hubs."+t+"getResourceGroupsFromSubscription",e.getLockValidation="Hubs."+t+"isLocked",e.getSasUriForQueue=t+"AzureStorage.getSasUriForQueue",e.getClientIp=t+"UtilitiesController.getClientIp",e.getClientIpv6=t+"UtilitiesController.getClientIpv6",e.getHmacSha256=t+"UtilitiesController.getHmacSha256",e.getProvisioningRequest=t+"ParameterCollection.ShellProvisioner.fulfillProvisioningRequest",e.initiateProvisioningRequest=t+"ParameterCollection.ShellProvisioner.initiateProvisioningRequest",MsPortalFx.extendArrayIntoMap(e,["addClientNotification","addClientNotifications","addFxClientNotification","brokerExtensionService","canShowNps","deletePutConfirmation","entryPointGetBladeDefinition","entryPointGetReactModel","entryPointDisposeReactModel","entryPointGetCommandsDefinition","entryPointGetControlDefinition","entryPointGetDefinition","entryPointGetPartDefinition","entryPointInitialize","forwardEvent","getArmEndpoint","getAllAssetTypes","getAssetTypeInformation","getAuthorizationTokenForChallenge","getCatalogApiCacheContent","getExtensionGalleryServiceViewModel","getExtensionRegistration","getIrisContent","getLastResourceIdInJourney","getLocalGalleryPackagesEndpoints","getLocationDisplayNames","getLocations","getLocationsForCreate","getManifest","getManifestEnvironment","getProvisioningOperation","getRegisteredResourceProviderInfo","getResource","getResourceAssetInformation","getResourceGroup","getResourceTypeAssetTypeInformation","getSelectedSubscriptions","getSettings","getSharedSettings","getUserInfo","hasPermission","listTestExtensions","logFeatureAdoptionTelemetry","mapAssetIdToDynamicSelectionAndIcon","mapAssetIdToResourceId","mapResourceIdToAssetId","mapResourceIdToDynamicSelectionAndIcon","navigateToDashboard","networkTelemetry","notifyDeployment","pollDeployment","openDockedContextPane","internalDeploymentHelper","experimentationHelper","experimentationValuesHelper","notifyExtensionStatus","ping","pinParts","postBoot","registerLocalGalleryPackagesEndpoint","registerTestExtensions","sendIrisSignal","setExtensionFlights","showNps","submitProvisionerTelemetry","unregisterTestExtensions","updateSubscriptionInfo","updateTenantInfo","viewModels","tryEarlyGetViewModel","getDxContent"],null,(function(e){return t+e})),MsPortalFx.extendStringMapIntoMap(e,{registration:"register",shellReadUserSettings:"Shell.readUserSettings",shellWriteUserSettings:"Shell.writeUserSettings",shellWriteLastUsedUserSettings:"Shell.writeLastUsedUserSettings"},(function(e){return t+e}))}(e.RpcMethods||(e.RpcMethods={}))}(e.Constants||(e.Constants={}))}(FxImpl||(FxImpl={})),function(e){!function(t){!function(t){var r=e.Errors,n=r.Error,i=(r.ErrorLevel,window),a=e.isDiagnosticsEnabled,o=FxImpl.errorHandlingImpl,s=o.handleError,u=o.preinitialize,c=FxImpl.internalEnv,l=c.isShell,d=c.inWebWorker;u(FxImpl.features,!l&&function(t,r,n){var a={kind:2,data:__assign(__assign({error:e.getLogFriendlyMessage(t)},"number"==typeof r&&{code:r}),n&&{details:Array.from(n).map(e.getLogFriendlyMessage)})};d?self.postMessage(a):i.parent.postMessage(a,FxImpl.trustedParentOrigin)}),t.createLog=function(e){return new t.Log(e.normalize(void 0))},t.createIgnoreUnhandledRejectionError=function(t,r,i){var o,s=arguments.length>1&&arguments[arguments.length-1],u="object"==typeof s&&s,c=a?1:0;if(t&&"string"!=typeof t)o=new n,e.extend(o,t),o._sourceErrorLevel=c;else{var l={message:t,_sourceErrorLevel:c};"string"==typeof r&&(l.stack=r.slice(0,6e3)),o=new n(l)}if(u){var d=e.extend({},o.data);o.data=e.extend(d,u)}return o},function(e){e.handleError=function(t){s(t,e.lastError),e.lastError=null}}(t.ErrorReporter||(t.ErrorReporter={}))}(t.Diagnostics||(t.Diagnostics={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){var t;function r(e,r){s=null,(e===t.Part?[t.Blade,t.Part]:[e]).forEach((function(n){for(var i=u.length-1;i>=0;i--){var a=!u[i].hasValue(n),o=n===t.Blade&&e===t.Part?{id:r.bladeId,instanceId:r.bladeInstanceId}:r;if(u[i].setContextValue(n,o),!a)break}}))}function n(e){s=null;var r=c(u);r&&(e===t.Part?[t.Blade,t.Part]:[e]).forEach((function(e){for(var t=r.getValue(e),n=u.length-1;n>=0;n--){var i=u[n].getValue(e);if(t&&i!==t||u[n].resetContextValue(e),u[n].hasValue(e))break;t=i}}))}!function(e){e[e.Part=0]="Part",e[e.Blade=1]="Blade",e[e.CompositionItem=2]="CompositionItem"}(t=e.ContextType||(e.ContextType={})),e.setContextValue=r,e.resetContextValue=n;var i=Function.call;function a(e,t){return function(){var r=arguments[0];try{return i.apply(e,arguments),r()}finally{i.apply(t,arguments)}}}e.provideContext=a(r,n),e.getCurrentValue=function(e){for(var t=u.length-1;t>=0;t--){var r=u[t].getValue(e);if(r)return r}},e.getCurrentValues=function(){for(var e={},t=!1,r=0,n=u.length;r<n;r++)MsPortalFx.forEachKey(u[r].getValues(),(function(r,n){n&&(t=!0,e[r]=n)}));return t?e:void 0},e.getState=function(){return s||(s=new o(c(u)))},e.usingState=a((function(e){s=null,u.push(new o(e))}),(function(){s=null,u.length>1&&u.pop()}));var o=function(){function e(e){if(this._providers=[],e&&e._providers)for(var t=this._providers,r=e._providers,n=0,i=r.length;n<i;n++){var a=r[n];t[n]=a?a.slice():[]}}return e.prototype.setContextValue=function(e,t){(this._providers[e]||(this._providers[e]=[])).push(t)},e.prototype.resetContextValue=function(e){var t=this._providers[e];t&&t.length&&t.pop()},e.prototype.getValue=function(e){var t=this._providers[e];return t&&c(t)},e.prototype.getValues=function(){for(var e={},r=!1,n=this._providers,i=0,a=n.length;i<a;i++){var o=c(n[i]);o&&(r=!0,e[t[i]]=o)}return r?e:void 0},e.prototype.hasValue=function(e){var t=this._providers[e];return!(!t||!t.length)},e}(),s=null,u=[new o];function c(e){return MsPortalFx.last(e)}}(e.TelemetryContext||(e.TelemetryContext={}))}(FxImpl||(FxImpl={})),function(e){!function(e){!function(e){!function(e){!function(e){var t=FxImpl.TelemetryContext,r=t.ContextType,n=t.getCurrentValue;function i(e){return function(){return n(e)}}var a=r;e.getPartContext=i(a.Part),e.getBladeContext=i(a.Blade),e.getJourneyContext=function(){return{id:""}},e.getCompositionItemContext=i(a.CompositionItem)}(e.Context||(e.Context={}))}(e.Telemetry||(e.Telemetry={}))}(e.Diagnostics||(e.Diagnostics={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){!function(t){var r=(0,e.generateNonSerializableProperty)("poSpecialType");function n(e){return function(t){var n;if(t&&!t[r]){var i=FxImpl.Po.getOrCreateMetadata(t),a=i;i&&((n=a[e])||(n=a[e]={}))}return n}}function i(e){return function(t,r,n){var i=e(t);if(i)return arguments.length>2?i[r]=n:i[r]}}t.dataContainer=n("client"),t.disposableDataContainer=n("clientDisposables"),t.data=i(t.dataContainer),t.disposableData=i(t.disposableDataContainer),t.markNonSerializable=function(t){var r=FxImpl.Po.getOrCreateMetadata(t);r&&(r.isNonSerializableCallStack=e.getCurrentCallStack()||"(Unknown callstack)")}}(t.ProxiedObservables||(t.ProxiedObservables={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=MsPortalFx.Base,n=r.Diagnostics.Telemetry,i=window,a=new r.Diagnostics.Log("Base.ProxiedObservablesV2"),o=ko.subscribable.fn,s=o.notifySubscribers,u=MsPortalFx.noop,c=function(){return new Map},l=MsPortalFx.isPrimitive,d=MsPortalFx.getIdGenerator,f=(MsPortalFx.getObjectConstructorName,MsPortalFx.getObjectDescriptor),p=MsPortalFx.getCurrentCallStack,h=(MsPortalFx.isNullOrUndefined,MsPortalFx.isEmpty,MsPortalFx.arrayEquals),y=MsPortalFx.startTimer,m=String.fromCharCode(5),v=Array.prototype.push,g=ko.utils,_=g.adjustArrayEdits,b=g.compareArrays,x=JSON.stringify,E=Math,P=Object,S=P.create,I=P.getPrototypeOf,M=P.prototype,C=MsPortalFx.uncurryThis(M.hasOwnProperty),w=P.getOwnPropertyDescriptor,F=P.defineProperty,D=(P.defineProperties,P.preventExtensions,Q.isPromiseAlike),A=Q.isPromise,k=setInterval,T=MsPortalFx.nextTick,R=[void 0],O=/^(\w+-\w+-)(\w+-\w+)+(.*)$/,B="$1?$3",j=!0,N=!1,H=!1;function U(e){return e?Q.defer():Promise.withResolvers()}e.onEnvironmentSet((function(e){j=!e("enableFastViewModelProxying",!1),N=MsPortalFx.isFeatureEnabled("gctelemetry"),H=MsPortalFx.isFeatureEnabled("detailedgclog"),H||MsPortalFx.isFeatureEnabled("gclog")}));var V=3e4,L=100,z=54e3,q=MsPortalFx.isDevelopmentMode||MsPortalFx.trace.diagnostics,G=(MsPortalFx.trace.potrackobservable,"_deferred"),W="###isPoUndefined###";[$.prototype,$.Event&&$.Event.prototype||{},i].forEach((function(e){F(e,W,{configurable:!0,value:!0})}));var K=new WeakMap,J=[];function X(e){try{return l(e)?e:x(e)}catch(e){return e}}function Y(e,t){var r=Dt(e),n=r?r.id+":":"";try{return n+f(e,t)}catch(e){return n+"Failed to get descriptor:"+e}}function Z(e){return"string"!=typeof e||e.startsWith(m)?e:"removed:"+e.length}function ee(e){if(!e)return e;if(1===e.length)return[Z(e[0])];for(var t=[],r=e.length>50?50:e.length,n=0;n<r;n+=2){var i=e[n],a=e[n+1],o=i.split(m),s=void 0;switch(parseInt(o[1])){case 11:var u=a.length;s=new Array(u);for(var c=0;c<u;c++)s[c]=Z(a[c]);break;case 3:s=[];for(var l=0,d=a.length;l<d;l++)s.push(l%2==0?a[l]:Z(a[l]));break;default:s=Z(a)}t[n]=i,t[n+1]=s}return t}var te=u,re=[/\.activatedItems$/,/^Microsoft_Azure_Insights(.)*/,/\.notFoundMessage$/];function ne(t,r,n,i){var o="Po-"+t+": ";if(r&&(o+=r),o+="\r\n"+(l(n)?n:X(n)),n){var s="string"==typeof n?n:n.id||n.poId;if(s){if(s=s.replace(O,B),!q&&301===t&&function(e){return re.some((function(t){return t.test(e)}))}(s))return;o+="\r\nThe error occured in below callstack:\r\n"+s}}q&&e.Rpc.getMessageContext&&e.Rpc.getMessageContext()&&(o+="\r\n"+e.Rpc.getMessageContext().callStack),(241===t?a.error.bind(a):a.warning.bind(a))(o,t)}function ie(e,t,r,n){ne(e,t,r)}function ae(e,t){ne(e,"Please open a bug to Framework.",t)}function oe(e,t){ae(e,"Unsupported: "+t)}function se(e,t,r){t.raiseRemoteException("Po-"+e+": "+X(r))}function ue(e,t,r){t[r]=e.slice(0)}function ce(e,t,r){var n={id:e};return K.set(t,n),Array.isArray(t)&&ue(t,n,r.aId),r.isPrimary&&r.nc++===z&&T((function(){Ct(r,!0)})),n}function le(e,t){for(var r=Object.keys(t),n=0,i=r.length;n<i;n++){var a=r[n];e[a]=t[a]}return e}function de(e){return"function"==typeof e.reject&&e.promise||"function"==typeof e.then}function fe(e){return 95===e.charCodeAt(0)&&!(109===e.charCodeAt(1)&&115===e.charCodeAt(2)&&80===e.charCodeAt(3)&&111===e.charCodeAt(4)&&114===e.charCodeAt(5)&&116===e.charCodeAt(6)&&97===e.charCodeAt(7)&&108===e.charCodeAt(8)&&70===e.charCodeAt(9)&&120===e.charCodeAt(10))}function pe(e,t){if(!l(e)&&K.get(e)&&!t.get(e))switch(t.set(e,!0),typeof e){case"object":if(Array.isArray(e))for(var r=0;r<e.length;r++)pe(e[r],t);else if(de(e)){var n=Je(e);0!==n.getState()&&pe(n.getValue(),t)}else if(e instanceof Date||e instanceof RegExp);else{for(var i=Tt(e),a=(r=0,i.length);r<a;r++){var o=i[r];if(!fe(o)){if(j){var s=w(e,o);if(s.get||s.set)continue}pe(e[o],t)}}var u=I(e);u!==M&&pe(u,t)}break;case"function":ko.isObservable(e)&&pe(e.peek(),t)}}function he(e,t){t.length>300&&(e.freedIds=t.slice(100,300))}function ye(e,t){return e.freedIds.includes(t)}function me(e,t,r,n,i){var a=e.map[t]||e.pending[t];if(a)return a;ye(e,t)?te(207,{id:t,code:r}):ae(r,{id:t,d:e.disposed,v:Y(n),s:i&&p(!0)})}function ve(e,t){var r=K.get(e);if(!r){var n=Y(e)||"";235===t&&(n+=p()),ae(t,n)}return r}function ge(e,t){var r=K.get(e);return r?r[t]:e}function _e(e,t,r){var n=me(e,t,r);return!!n&&K.get(n).disallowRemoteMutations}var be=E.max(15,3),xe=MsPortalFx.getStringToIntMap(be),Ee=MsPortalFx.getIntToStringMap(be);function Pe(e,t,r){for(var n=t.id,i=0,a=J.length;i<a;i++){var o=J[i];(o.map[n]||o.pending[n])===e&&r(o)}}function Se(e,t,r,n,a){var o=e.gFuncCallId(),s=[],u=me(e,t,222,n,!0);if(u){var c,l=K.get(u).disallowRemoteMutations,d=[u];r===i?c=R:(c=xt(e,r,l,!0),d.push(r));for(var f=0,p=n.length;f<p;f++){var h=n[f];s.push(xt(e,h,l,!0)),d.push(h)}var y={cid:o,fid:t,t:c,a:s},m=Je(a);e.funcCalls[o]={promise:m,objs:d},e.onFunction(y);var v=m.promise,g=!1;v.hold=function(){return g=!0,{dispose:function(){delete e.roots[o],g=!1}}},v.then((function(t){g&&(e.roots[o]=t)}),(function(e){}))}}var Ie=[],Me=!1;function Ce(){for(Me=!0;Ie.length;){var e=Ie;Ie=[];for(var t=0,r=e.length;t<r;t++){var n=e[t];3===n.length?Pe.apply(null,n):Se.apply(null,n)}}Me=!1}var we=[Pe,function(e,t,r){Ie.push([e,t,r])},u],Fe=[Se,function(e,t,r,n,i){Ie.push([e,t,r,n,i])},u],De=Pe,Ae=Se;function ke(e){De=we[e],Ae=Fe[e]}function Te(e,t){var r=e[t];return void 0===r?0:r}function Re(e,t){var r=Te(e,t);return e[t]=++r,r}function Oe(e,t,r,n){r.desiredValue=n;try{t(n)}finally{r.desiredValue=void 0}}function Be(e,t){var r=t.o,n=t.a,i=t.fa;if(r)Et(e,r);else if(n)for(var a=0,o=n.length;a<o;a++){var s=n[a];0===s.k&&Et(e,s.v)}else for(a=0,o=i.length;a<o;a++)Et(e,i[a])}function je(e,t,r,n,i,a,o){var s=e.sId,u=n[s],c=t.sn,l=t.a,d=t.fa,f=c===u;if(a!==i+1&&f)return n[s]=u?u+1:1,n[o]=void 0,function(e,t,r){var n=[];if(t)for(var i=0,a=t.length;i<a;i++){var o=t[i],s=o.v;n.push({k:o.k,i:o.i,v:s?Y(Et(e,s)):null})}else if(r)for(i=0,a=r.length;i<a;i++)n.push(Y(Et(e,r[i])));return n}(e,l,d);if(!f){if(u&&(void 0===c||c<u))return;n[s]=c,n[o]=void 0}!function(e,t,r,n){var i=ko.isComputed(t),a=t.peek(),o=ge(a,e.aId);if(h(o,a)||(a.length=0,o.length&&v.apply(a,o)),i||t.valueWillMutate(),r)for(var s=0,u=r.length;s<u;s++){var c=r[s];switch(c.k){case 0:var l=Et(e,c.v);a.splice(c.i,0,l);break;case 1:a.splice(c.i,1)}}else for(a.splice(0,a.length),s=0,u=n.length;s<u;s++)a.push(Et(e,n[s]));ue(a,ve(a,240),e.aId),i?t(a):t.valueHasMutated()}(e,r,l,d),Te(n,o)===i&&(n[o]=a)}function Ne(e,t,r,n){var i=t.id;De(e,t,(function(e){var a=e.cnId,o=Re(t,a);if(e.receivedChanges[i]!==o){var s={id:i,cn:o};if(t[e.sId]&&1===t[a]){for(var u=[],c=0,l=n.length;c<l;c++)u.push(xt(e,n[c],!1));s.fa=u}else{r=ge(r,e.aId);var d=b(r,n,{sparse:!0}),f=(d=_(d)).map((function(r){switch(r.status){case"added":return{k:0,i:r.index,v:xt(e,r.value,t.disallowRemoteMutations,!0)};case"deleted":return{k:1,i:r.index};default:oe(106,r.status)}}));s.a=f}var p=t[e.sId];p&&(s.sn=p),e.onChange(s);var h=ve(n,235);h&&ue(n,h,e.aId)}}))}function He(e,t,r,n){var i=r===n,a=Array.isArray(r);i&&a?Ne(e,t,r,n):De(e,t,(function(r){var i=Re(t,r.cnId);if(r.receivedChanges[t.id]===i){if(!ko.isComputed(e)||n===t.desiredValue)return;i=++t[r.cnId]}var a={id:t.id,o:xt(r,n,t.disallowRemoteMutations,!0),cn:i};r.onChange(a)}))}function Ue(e,t){var r=e._poBuffer;e._poBuffer=t,r&&r()}o.notifySubscribers=function(e,t){var r=this,n=K.get(this);if(n)if("beforeChange"===t)!0===this._capturedOriginalValue&&ie(302,"Detected a cycle subscription. Please avoid pattern:\r\n observable.subscribe(() => { observable(1); }, null, 'beforeChange')",n.id),Ue(this),this._originalValue=this.peek(),this._capturedOriginalValue=!0,s.apply(this,arguments);else if(void 0===t){var i=this.peek();this._capturedOriginalValue?(this._capturedOriginalValue=!1,Ue(this,(function(){He(r,n,r._originalValue,i)}))):"function"==typeof this.push||e&&"function"==typeof e.push?Ue(this,(function(){Ne(r,n,i,e)})):Ue(this,(function(){He(r,n,i,e)}));try{s.apply(this,arguments)}finally{Ue(this),this._originalValue=void 0}}else s.apply(this,arguments);else s.apply(this,arguments)};var Ve={resolved:1,fulfilled:1,rejected:2,pending:0};function Le(e,t,r,n){De(e,t,(function(e){var i=e.pId;t[i]||e.disposed||e.onPromise({id:t.id,s:r,v:xt(e,n,t.disallowRemoteMutations,!0)}),t[i]&&t[i]--}))}var ze=function(){function e(){}return e.prototype.always=function(e){var t=this;this.promise.finally((function(){e(t.getValue())}))},e.prototype.alwaysHandled=function(e){var t=this,r=function(){e(t.getValue())};this.promise.then(r,r)},e.prototype.progress=function(e){this.promise.progress&&this.promise.progress(e).then(MsPortalFx.identity,MsPortalFx.noop)},e}(),qe=function(e){function t(t,r,n){var i=e.call(this)||this;return i.implementation=0,i._state=0,i.deferred=t,i.promise=r.then((function(e){return i._state=1,i._value=e}),(function(e){throw i._state=2,i._value=e,e})),i.type=n,i}return __extends(t,e),t.prototype.getState=function(){return this._state},t.prototype.getValue=function(){return this._value},t}(ze),Ge=function(e){function t(t,r,n){var i=e.call(this)||this;return i.implementation=1,i.deferred=t,i.promise=r,i.type=n,i}return __extends(t,e),t.prototype.getState=function(){var e=this.promise.inspect();return Ve[e.state]},t.prototype.getValue=function(){var e=this.promise.inspect();switch(e.state){case"pending":return;case"fulfilled":return e.value;case"rejected":return e.reason;default:throw new Error("Unexpected Promise State")}},t}(ze),We=function(e){function t(t,r,n){var i=e.call(this)||this;return i.implementation=2,i._state=0,i.deferred=t,i._promise=r,i.promise=r.then((function(e){return i._state=1,i._value=e,e}),(function(e){throw i._state=2,i._value=e,e})),i.type=n,i}return __extends(t,e),t.prototype.getState=function(){return this._state},t.prototype.getValue=function(){return this._value},t.prototype.progress=function(e){this._promise.progress&&this._promise.progress(e).then(MsPortalFx.identity,MsPortalFx.noop)},t}(ze);function Qe(e,t){e.progress((function(e){var r=ve(t,236);Le(t,r,0,e)})),e.always((function(r){0===arguments.length&&(r=e.getValue());var n=e.getState(),i=ve(t,237);switch(n){case 1:Le(t,i,1,r);break;case 2:Le(t,i,2,r);break;default:oe(100,n)}}))}function Ke(e,t,r,n,i){switch(t){case 1:e.deferred.resolve(r);break;case 2:e.deferred.reject(r);break;case 0:i||Qe(e,n);break;default:oe(101,t)}}function Je(e){var t;return"function"==typeof e.resolve&&"function"==typeof e.reject&&e.promise?t="function"==typeof e.promise?new We(e,e.promise(),7):e.promise instanceof Promise&&!A(e.promise)||kt(e.promise)?new qe(e,e.promise,7):new Ge(e,e.promise,7):A(e)?t=new Ge(e[G],e,6):e instanceof Promise||kt(e)?t=new qe(e[G],e,6):D(e)&&(t=new We(e[G],e,6)),function(e){var t=e.deferred,r=e.promise;t&&!r[G]&&F(r,G,{value:t,enumerable:!1})}(t),t}function $e(e,t,r,n){e.disposed||e.onPromise({id:n.cid,s:r,v:xt(e,t,_e(e,n.fid,220),!0)})}function Xe(e,t){return function(){var r=U(!0);Ae(e,t,this,arguments,r);var n=r.promise,i=n.hold,a=n.then(MsPortalFx.identity);return i&&(a.hold=i),a}}function Ye(e,t,r,n){var i=K.get(t),a=e.map;if(i){if(i.id?n=i.id:i.id=n,a[n])return n;var o=e.pending;if(o[n])return a[n]=t,delete o[n],r.push([n,t]),e.revivedIds[n]=t,n;Array.isArray(t)&&ue(t,i,e.aId)}else ce(n,t,e);return a[n]=t,r.push([n,t]),n}function Ze(e,t){var r=w(t,e);return r.get||r.set}function et(e,t,r,n){for(var i,a,o=[],s=Tt(t),u=0,c=s.length;u<c;u++)if(i=s[u],!t.hasOwnProperty||C(t,i)){if(95===i.charCodeAt(0)&&(109!==i.charCodeAt(1)||115!==i.charCodeAt(2)||80!==i.charCodeAt(3)||111!==i.charCodeAt(4)||114!==i.charCodeAt(5)||116!==i.charCodeAt(6)||97!==i.charCodeAt(7)||108!==i.charCodeAt(8)||70!==i.charCodeAt(9)||120!==i.charCodeAt(10)))continue;if(j&&Ze(i,t))continue;switch(typeof(a=t[i])){case"function":if("constructor"===i)continue;break;case"object":if(!a){o.push(i,a);continue}if(a[W])continue;break;default:o.push(i,a);continue}o.push(i,m+Ye(e,a,n,r+"."+i))}return o}function tt(e,t,r,n){for(var i,a=[],o=0,s=t.length;o<s;o++)switch(typeof(i=t[o])){case"object":a[o]=i?i[W]?void 0:m+Ye(e,i,n,r+"."+o):i;break;case"function":a[o]=m+Ye(e,i,n,r+"."+o);break;default:a[o]=i}return a}var rt=Ee[1],nt=rt+m+"u",it=rt+m+"n",at=Ee[0],ot=at+m+"1",st=Ee[10],ut=Ee[4],ct=Ee[5],lt=Ee[3],dt=Ee[11],ft=lt+m+"n",pt=Ee[13],ht=m+14,yt=m+"1"+m,mt=m+m;var vt=[];function gt(e,t,r,n){for(var i=0,a=n.length;i<a;i+=2){var o=n[i],s=n[i+1];if(s&&s[0]===m){var u=s.substring(1),c=e[u]||t[u];c?r[o]=c:(r[o]=u,vt.push(o))}else r[o]=s}}function _t(e,t,r){for(var n=0,i=r.length;n<i;n++){var a=r[n];if(a&&a[0]===m){var o=a.substring(1),s=e[o]||t[o];s?r[n]=s:(r[n]=o,vt.push(""+n))}}return r}function bt(e,t){var r,n,i,a=e.map,o=e.pending,s=[],u=t.length-1;function c(r){n?n[r]&&ae(213,r):n={},n[r]=!0;for(var i=r+m,a=i.length,o=u-1;o>=2;o-=2){var s=t[o];if(s.substring(0,a)===i)return t[u+1]=s,t[u+2]=t[o+1],t[o]=ht,t[o+1]=null,void(u+=4)}ae(214,{id:r,f:ye(e,r)})}for(;u>0;){var l=t[u-1],d=t[u],f=l.split(m);i=f[0];var p=xe[f[1]],h=void 0;switch(p){case 3:var y=f[2];if(y)if("n"===y)h=S(null);else{var v=a[y]||o[y];v?h=S(v):(c(y),r=!0)}else h={};r||(gt(a,o,h,d),vt.length&&(s.push([3,h,vt]),vt=[]));break;case 11:h=_t(a,o,d),vt.length&&(s.push([11,h,vt]),vt=[]);break;case 4:h=new Date(d);break;case 5:var g=d.lastIndexOf(m),_=d.substring(0,g),b=d.substring(g+1);h=new RegExp(_,b);break;case 10:h=Xe(e,i);break;case 0:h=ko.observable();var x=void 0;if(f[2])x=d;else if(!(x=a[d]||o[d])){s.push([p,h,d]);break}h(x);break;case 1:h=ko.observableArray();var E=void 0;if(f[2])E="u"===f[2]?void 0:null;else if(!(E=a[d]||o[d])){s.push([p,h,d]);break}h(E);break;case 7:case 6:var P=6===p,I=Je(U(!!xe[f[2]])),M=xe[f[4]];h=P?I.promise:I.deferred;var C=void 0;if(f[3])C=d;else if(!(C=a[d]||o[d])){s.push([p,I,d,M]);break}Ke(I,M,C,h,P);break;case 13:h=d;break;case 14:r=!0;break;default:ae(108,{pId:e.id,t:p,d:ee(t)})}r?r=!1:(ce(i,h,e),a[i]=h),u-=2}return s.length&&function(e,t){for(var r=0,n=e.length;r<n;r++){var i=e[r],a=i[0],o=i[1],s=i[2];switch(a){case 11:for(var u=0,c=s.length;u<c;u++){var l=s[u];o[l]=me(t,o[l],243)}ue(o,Dt(o),t.aId);break;case 3:for(u=0,c=s.length;u<c;u++){var d=s[u];o[d]=me(t,o[d],232)}break;case 0:case 1:o(f=me(t,s,233));break;case 7:case 6:var f=me(t,s,234);Ke(o,i[3],f,7===a?o.deferred:o.promise,!1);break;default:ae(107,t.id)}}}(s,e),a[i]}function xt(e,t,r,n){var i;if(l(t))return[t];try{return ke(1),function(e,t,r,n){var i,a=[],o=e.map;if(t[W])return R;var s=[],c=K.get(t);if(c){var d=c.id;if(o[d]){if(c.disallowRemoteMutations=r,!Array.isArray(t))return[d,void 0];var f=ge(t,e.aId);if(h(t,f))return[d,void 0];s.push([d,t]),ue(t,c,e.aId)}}var p=[];for(Ye(e,t,s,e.gId());s.length;){var y=s.shift(),v=y[0],g=y[1],_=typeof g,b=void 0,x=void 0;switch(_){case"function":if(ko.isObservable(g)){var E=g.peek();"splice"in g||"map"in g?E&&Array.isArray(E)?(b=rt,x=Ye(e,E,s,v+"(a)")):void 0===E?b=nt:null===E?b=it:ie(303,"Attempting to serialize an observable array whose value is not an array, null, or undefined.",v):(ko.isPureComputed(g)&&(g[e.kId]=g.subscribe(u)),l(E)?(b=ot,x=E):(b=at,x=Ye(e,E,s,v+"(o)")))}else b=st,x=void 0;break;case"object":if(de(g)){var P=Je(g);0===P.getState()&&Qe(P,g);var S=P.getValue(),C=void 0;l(S)?(C=yt,x=S):(C=mt,x=Ye(e,S,s,v+"()")),b=Ee[P.type]+m+Ee[P.implementation]+C+P.getState()}else if(g instanceof Date)b=ut,x=g.getTime();else if(g instanceof RegExp){b=ct;var w=g.source+m;g.global&&(w+="g"),g.ignoreCase&&(w+="i"),g.multiline&&(w+="m"),x=w}else if(Array.isArray(g))b=dt,x=tt(e,g,v,s);else if(g instanceof Error){b=lt;var F={message:g.message,name:g.name,stack:null===(i=g.stack)||void 0===i?void 0:i.slice(0,6e3),extension:e.lWinId};le(F,g),x=et(e,F,v,s)}else if(g instanceof ArrayBuffer)b=pt,x=g;else{var D=I(g);b=D===M?lt:null===D?ft:lt+m+Ye(e,D,p,v+"(p)"),x=et(e,g,v,s)}break;default:ae(105,{pId:e.id,t:_})}r&&(Dt(g).disallowRemoteMutations=!0),a.push(v+m+b,x),!s.length&&p.length&&(s=p,p=[])}return a}(e,t,r)}catch(r){throw ie(241,null,{message:r.message,callstack:null===(i=r.stack)||void 0===i?void 0:i.slice(0,6e3),pId:e.id,data:Y(t)}),r}finally{ke(0)}}function Et(e,t){if(0!==t.length){if(1===t.length)return t[0];if(2===t.length&&void 0===t[1]&&t[0].indexOf(m)<0)return me(e,t[0],245);try{return ke(2),bt(e,t)}finally{ke(0)}}}function Pt(e,t,r,n){var i=K.get(e);i&&i[t]&&(i[t]=void 0);var a=e[r];a&&(a.dispose(),e[r]=void 0),i&&i[n]&&(i[n]=void 0)}function St(e,t){e.roots[t]||ae(206,t),delete e.roots[t],e.isPrimary&&e.dc++}function It(e){var t=e.roots,r=e.funcCalls,n=c();for(var i in t){pe(t[i],n)}for(var a in r){var o=r[a].objs;for(var s in o)pe(o[s],n)}return n}var Mt;function Ct(e,t){if(function(e){for(var t in e)return!1;return!0}(e.pending)){var r=function(e){var t=It(e),r=e.map,n=e.pending,i=[];for(var a in r){var o=r[a];t.get(o)||(i.push(a),n[a]=r[a],delete r[a])}return i}(e);r.length&&(e.gcI=t,N&&(e.gcTk=n.start({source:"PO",action:"GC",name:e.id})),e.onRelease({iIds:r}))}}var wt=function(){function e(){this.nc=0,this.dc=0,this.ops=[],this.map={},this.pending={},this.roots={},this.receivedChanges={},this.funcCalls={},this.freedIds=[],this.revivedIds={}}return e.prototype.serialize=function(e,t,r){var n=xt(this,e,t);if(!l(e)&&!e[W]){var i=K.get(e);this.roots[i.id]=e}return n},e.prototype.proxyBuffer=function(){Ie.length&&Ce()},e.prototype.deserialize=function(e,t){var r=Et(this,e);if(!l(r)){var n=K.get(r);this.roots[n.id]=r}return r},e.prototype.applyPromise=function(e){if(!this.disposed){var t=this.funcCalls[e.id];t?function(e,t,r){var n=Et(e,t.v),i=e.funcCalls,a=t.id,o=r.promise,s=o.deferred,u=t.s;switch(l(n)||i[a].objs.push(n),u){case 1:s.resolve(n);break;case 2:s.reject(n);break;case 0:s.notify&&s.notify(n);break;default:oe(103,u)}0!==u&&o.alwaysHandled((function(){T((function(){delete i[a]}))}))}(this,e,t):function(e,t){var r=Et(e,t.v),n=me(e,t.id,221,r);if(n){var i=Je(n);if(0===i.getState()){var a=ve(n,238);if(a.disallowRemoteMutations)se(242,e,{id:a.id,msg:"Remote mutation is not allowed"});else{var o=e.pId;a[o]?a[o]++:a[o]=1;var s=i.deferred;switch(t.s){case 1:s.resolve(r);break;case 2:s.reject(r);break;case 0:s.notify&&s.notify(r);break;default:oe(101,t.s)}}}else te(244,t.id)}}(this,e)}},e.prototype.applyChange=function(e){var t=e.id;if(!this.disposed){var r=function(e,t){return e.map[t]||e.pending[t]}(this,t);if(!r)return Be(this,e),void(!this.isPrimary&&function(e,t){var r=e.gcIIds;if(r){var n=e.gcIIdMap;if(!n){n={};for(var i=0,a=r.length;i<a;i++)n[r[i]]=!0;e.gcIIdMap=n}return n[t]}}(this,t)||ae(224,{id:t,freed:ye(this,t),data:ee(e.o)}));if(this.revivedIds[e.id])Be(this,e);else{var n=K.get(r),i=e.cn,a=this.cnId,o=Te(n,a),s=this.receivedChanges;if(n.disallowRemoteMutations)return n[a]=i,void se(216,this,{id:n.id,msg:"Remote mutation is not allowed"});s[t]=o+1;try{var u=e.o?function(e,t,r,n,i,a,o){var s=Et(e,t.o);if(a!==i+1&&r.peek()!==s)return e.isPrimary?Re(n,o):Oe(0,r,n,s),Y(s);try{Oe(0,r,n,s)}finally{Te(n,o)===i&&(n[o]=a)}}(this,e,r,n,o,i,a):je(this,e,r,n,o,i,a);u&&ie(301,"Detected a simultaneous change.",{id:t,from:this.rWinId,remote:i,local:o,serial:n[this.sId],changes:u})}finally{delete s[t]}}}},e.prototype.applyRelease=function(e){if(!this.disposed)if(e.rId)St(this,e.rId);else if(e.iIds){var t=e.iIds;!function(e,t){e.gcIIds=t,e.gcIIdMap=void 0}(this,t);var r=function(e,t){for(var r=It(e),n=[],i=e.map,a=[],o=e.aId,s=e.kId,u=e.cnId,c=e.freedIds,l=0,d=t.length;l<d;l++){var f=t[l],p=i[f];p?r.get(p)||(n.push(f),delete i[f],Pt(p,o,s,u),c.push(f)):(n.push(f),a.push(f))}return a.length&&ae(231,{pId:e.id,objs:a}),he(e,c),n}(this,t);this.onRelease({cIds:r})}else!function(e,t){var r=function(e){for(var t={},r=0,n=e.length;r<n;r++)t[e[r]]=!0;return t}(t),i=e.map,a=e.pending,o=e.aId,s=e.kId,u=e.cnId,c=e.freedIds;for(var l in a){var d=a[l];r[l]?(Pt(d,o,s,u),c.push(l)):i[l]=d}he(e,c),N&&n.completeTrace(e.gcTk,{disposed:t.length,created:e.nc,immediate:e.gcI||!1}),e.pending={},e.revivedIds={},e.nc=0,e.dc=0,e.gcTk=void 0,e.gcLt=y()}(this,e.cIds)},e.prototype.invoke=function(e){var t,r=this,n=!1;if(!this.disposed){var i=me(this,e.fid,225);if(i){var a=Et(this,e.t);void 0===a&&e.t.length>1&&ae(209);var o=e.a.map((function(e){return Et(r,e)}));try{t=i.apply(a,o),n=!0}finally{if(t&&de(t)){var s=Je(C(t,"_underlyingPromise")?t._underlyingPromise:t),u=s.getState();0===u?(s.progress((function(t){$e(r,t,0,e)})),s.always((function(t){$e(r,t,s.getState(),e)}))):$e(this,s.getValue(),u,e)}else $e(this,t,n?1:2,e)}}}},e.prototype.release=function(e){if(!l(e)){var t=ve(e,239);St(this,t.id),this.onRelease({rId:t.id})}},e.prototype.dispose=function(){if(!this.disposed){this.disposed=!0;var e=this.map,t=this.pending,r=this.aId,a=this.kId,o=this.cnId;i.clearInterval(this.gcH);for(var s=0,u=J.length;s<u;s++)if(J[s]===this){J.splice(s,1);break}for(var c in e)Pt(e[c],r,a,o);for(var c in t)Pt(t[c],r,a,o);this.gcTk&&n.completeTrace(this.gcTk,{disposed:-1,created:this.nc}),this.map=null,this.pending=null,this.roots=null}},e}();function Ft(e){return function(t){e(t),Ie.length&&!Me&&Ce()}}function Dt(e){return K.get(e)}function At(e){if(!l(e)){var t=K.get(e);return t||(t={id:null},K.set(e,t)),t}}function kt(e){return!!e._cancelationToken&&D(e)}function Tt(e){return function(e){var t,r=null===(t=e.constructor)||void 0===t?void 0:t.toString();return null==r?void 0:r.startsWith("class ")}(e)?Object.getOwnPropertyNames(e).filter((function(t){var r=Object.getOwnPropertyDescriptor(e,t);return r.enumerable||"function"==typeof r.value})):Object.keys(e)}t.ProxiedObjectManager=wt,t.createPoMgr=function(e,t,r,n,i,a,o,s,u){var c=new wt,l=e+J.length;return c.id=l,c.cnId="c-"+l,c.aId="a-"+l,c.kId="k-"+l,c.pId="p-"+l,c.sId="s-"+l,c.raiseRemoteException=t,c.onChange=Ft(r),c.onPromise=Ft(n),c.onFunction=Ft(i),c.onRelease=a,c.gId=d(l),c.gFuncCallId=d(l+"f"),c.rWinId=s,c.lWinId=o,c.gcLt=y(),o===s&&ae(210,o),c.isPrimary=function(e,t){return"fx"===e||"fx"!==t&&("HubsExtension"===e||"HubsExtension"!==t&&e>t)}(o,s),!c.isPrimary||Mt||u||(Mt=k((function(){var e=J.filter((function(e){return e.isPrimary&&(e.nc>L||e.dc)}));if(e.length){var t=0,r=function(){Ct(e[t++]),t<e.length&&T(r)};r()}}),V)),J.push(c),c},t.getMetadata=Dt,t.getMetadataId=function(e){var t=Dt(e);return t&&t.id},t.getOrCreateMetadata=At,t.disallowRemoteMutations=function(e){var t=At(e);t&&(t.disallowRemoteMutations=!0)},t.getDiagnostics=function(){return{compatibilityMode:j,diagnostics:q,metadataMap:K,managers:J}}}(e.Po||(e.Po={}))}(FxImpl||(FxImpl={})),function(e){!function(t){var r=e.isNullOrUndefined,n=".";function i(e){return r(e)||e>=0}function a(e,t){return e===t?0:r(e)?-1:r(t)||e>t?1:-1}function o(e){var t=(e=e||"").split(n),r=null,a=t.length;if(a>=2){var o=new s;o.major=parseInt(t[0]),o.minor=parseInt(t[1]),o.build=a>=3?parseInt(t[2]):null,o.revision=t[3]?parseInt(/\d+/.exec(t[3])):null,i(o.major)&&i(o.minor)&&i(o.build)&&i(o.revision)&&(r=o)}return r}t.getVersionFromString=function(e){if(!e){var t=new s;return t.major=0,t.minor=0,t.build=0,t.revision=0,t}var r=o(e);if(!r)throw new Error("value is not a valid version string.");return r},t.tryParseVersion=o;var s=function(){function e(){}return e.prototype.toString=function(){var e=[this.major,this.minor],t=this.build;if(!r(t)){e.push(t);var i=this.revision;r(i)||e.push(i)}return e.join(n)},e.prototype.compareTo=function(e){var t=a(this.major,e.major);return t||(t=a(this.minor,e.minor))||(t=a(this.build,e.build))||(t=a(this.revision,e.revision)),t},e}()}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=MsPortalFx.Base.Diagnostics,n=e.TelemetryContext,i=e.Po,a=MsPortalFx.disposeDisposable,o={sameWindow:""},s=e.getErrorMap(o);var u=function(e){function t(t,r,n,i,a){var o=e.call(this)||this;return o._poMgr=t,o._connectionId=r,o._ltm=n,o._sendHandlerPortMessage=i,o._initialObject=void 0,o._handlerBuffer=[],o._messageHandler=void 0,o._disallowRemoteMutations=!a.allowRemoteChanges,o}return __extends(t,e),t.prototype.transferInitialObject=function(e){this._initialObject=e;var t=this._handlerBuffer.length?4:0;this._sendHandlerPortMessage({channelObjects:void 0,connectionId:this._connectionId,flags:1|t,initialObject:this._serializeObject(e),metadata:void 0});for(var r=0,n=this._handlerBuffer;r<n.length;r++){var i=n[r];this._transferObjectCore(i.handlerData,i.proxiedObjects)}this._handlerBuffer=null,this._poMgr.proxyBuffer()},t.prototype.transferObjects=function(e,t){this._handlerBuffer?this._handlerBuffer.push({handlerData:e,proxiedObjects:t}):(this._transferObjectCore(e,t),this._poMgr.proxyBuffer())},t.prototype.handleMessage=function(e){this._messageHandler(e.data)},t.prototype.releaseObject=function(e){this._handlerBuffer||this._poMgr.release(e)},t.prototype.onMessage=function(e){this._messageHandler=e},t.prototype.dispose=function(){this._ltm.dispose(),this._initialObject&&this._poMgr.release(this._initialObject),e.prototype.dispose.call(this)},t.prototype._transferObjectCore=function(e,t){var r;if(t){r=[];for(var n=0,i=t;n<i.length;n++){var a=i[n];r.push(this._serializeObject(a))}}this._sendHandlerPortMessage({channelObjects:r,connectionId:this._connectionId,flags:2,initialObject:void 0,metadata:e})},t.prototype._serializeObject=function(e){return this._poMgr.serialize(e,this._disallowRemoteMutations,!1)},t}(t.DisposableValue);function c(e,t,r){var i=r.channelObjects;return i&&n.usingState((function(){for(var t=[],r=0,n=i;r<n.length;r++){var a=n[r];t.push(e.deserialize(a))}return t}),t)}var l=function(e){function t(t,r,i,a){var o=e.call(this,function(e,t,r){if(1&r.flags)return n.usingState((function(){return e.deserialize(r.initialObject)}),t)}(t,r,a))||this;return o._poMgr=t,o._telemetryContext=r,o._sendInvokerPortMessage=i,o._handlerBuffer=[],o._messageHandler=void 0,o._connectionId=a.connectionId,o.isChannelEnabled=!!(4&a.flags),o.handleMessage(a),o}return __extends(t,e),t.prototype.handleMessage=function(e){var t,r,n;2&e.flags&&(t=this._messageHandler,r=this._handlerBuffer,n={body:e.metadata,obj:c(this._poMgr,this._telemetryContext,e)},t?t(n):r.push(n))},t.prototype.postMessage=function(e){this._sendInvokerPortMessage({connectionId:this._connectionId,data:e})},t.prototype.onObject=function(e){this._messageHandler=e,this._handlerBuffer.forEach(this._messageHandler),this._handlerBuffer.length=0},t}(t.DisposableValue),d=function(){function e(e,r,o,s,u,c){var d=this;this._clientCtx=e,this._remoteWindowId=o,this.remoteInstanceIndex=s,this._pendingObjRequest=u,this._sender=c,this._msgRelay=new t.MessageMultiplexer((function(e){d._sender(e,d._remoteWindowId)}),7),this._sendInvokerPortMessage=this._msgRelay.registerHandler(4,(function(e){var t=d._handlerPortContexts.getValue(e.connectionId);t&&t.handleMessage(e)})),this._sendHandlerPortMessage=this._msgRelay.registerHandler(5,(function(e){var t=e.connectionId,r=d._invokerPortContexts.getValue(t);if(r)r.handleMessage(e);else{var n=d._pendingObjRequest.getMetadata(t);n?((r=new l(d._poMgr,n.telemetryContext,d._sendInvokerPortMessage,e)).onDispose((function(){d._sendReleaseConnection(t)})),d._pendingObjRequest.resolve(t,d._invokerPortContexts.setValue(t,r))):d._sendReleaseConnection(t)}})),this._sendReleaseConnection=this._msgRelay.registerHandler(6,(function(e){a(d._handlerPortContexts.getValue(e))})),this._handlerPortContexts=new t.DisposableValueDictionary,this._invokerPortContexts=new t.DisposableValueDictionary((function(e,t){d._clientCtx&&d._clientCtx.setRefCount(d._remoteWindowId,e,1,t)})),this._poMgr=i.createPoMgr([r,o,s].join("-"),(function(e){d._clientCtx.raiseRemoteException(e,d._remoteWindowId)}),this._msgRelay.registerHandler(0,(function(e){var t=i.getMetadata(e);n.usingState((function(){d._poMgr.applyChange(e)}),t)})),this._msgRelay.registerHandler(1,(function(e){d._poMgr.applyPromise(e)})),this._msgRelay.registerHandler(2,(function(e){d._poMgr.invoke(e)})),this._msgRelay.registerHandler(3,(function(e){d._poMgr.applyRelease(e)})),r,o)}return e.prototype.createConnection=function(e,t,r){return this._handlerPortContexts.setValue(e,new u(this._poMgr,e,t,this._sendHandlerPortMessage,r))},e.prototype.handleEventMessage=function(e){this._msgRelay.handleMessage(e)},e.prototype.dispose=function(){a(this._invokerPortContexts,this._handlerPortContexts,this._poMgr)},e}(),f=function(){function e(e,r,n,i,a){this.remoteId=e,this._clientCtx=r,this._sendAcquireObjRequest=n,this._sendConnectionMessage=i,this._log=a,this._pendingPoInvocations=new t.PendingObjectTable(this.remoteId,this._clientCtx,2,!1,this._log),this._poContext=void 0}return e.prototype.getPoContext=function(e){this._checkConnection(e.srcInstanceIndex);var t=this._poContext||(this._poContext=new d(this._clientCtx,e.destWindowId,e.srcWindowId,e.srcInstanceIndex,this._pendingPoInvocations,this._sendConnectionMessage));return t.remoteInstanceIndex===e.srcInstanceIndex?t:null},e.prototype.acquireObject=function(e,t){var r=this;return Q(this._pendingPoInvocations.create(e,(function(n){r._sendAcquireObjRequest({connectionId:n,name:e,arg:t},r.remoteId)}),n.getState()))},e.prototype.handleAcquireObjResponseError=function(e){this._pendingPoInvocations.reject(e.connectionId,e)},e.prototype.reset=function(e){this._pendingPoInvocations.handleResetMessage(e),this._checkConnection(e.instanceIndex+1)},e.prototype._checkConnection=function(e){this._poContext&&this._poContext.remoteInstanceIndex<e&&(this._poContext&&(this._poContext.dispose(),this._poContext=null),this._sendConnectionMessage(null,this.remoteId))},e.prototype.dispose=function(){a(this._poContext,this._pendingPoInvocations)},e}(),p=function(){function e(e,r,n){var i=this;this._routedMsgClientCtx=e,this._endpoints=r,this._log=n,this._targetWindows=Object.create(null);var a=e.routedMessageRelay;this._sendIntiateConnectionRequest=a.registerHandler(9,(function(e,r){var n=i._getPoContext(r);n&&i._endpoints.invokeEndPoint(e.name,e.arg,r,(function(t,r){return n.createConnection(e.connectionId,t,r)}),(function(e,t){t.transferInitialObject(e)}),(function(n){i._sendConnectionInitiationError({connectionId:e.connectionId,error:t.createRpcError(n)},r.srcWindowId)}))})),this._sendConnectionInitiationError=a.registerHandler(10,(function(e,t){i._getWindowContext(t.srcWindowId).handleAcquireObjResponseError(e)})),this._sendPoEventMessage=a.registerHandler(11,(function(e,t){var r=i._getPoContext(t);r&&e&&r.handleEventMessage(e)}))}return e.prototype._getWindowContext=function(e){return e===this._routedMsgClientCtx.localWindowId&&s.sameWindow(),this._targetWindows[e]||(this._targetWindows[e]=new f(e,this._routedMsgClientCtx,this._sendIntiateConnectionRequest,this._sendPoEventMessage,this._log))},e.prototype._getPoContext=function(e){return this._getWindowContext(e.srcWindowId).getPoContext(e)},e.prototype.acquireObject=function(e,t,r){return this._getWindowContext(t).acquireObject(e,r)},e.prototype.reset=function(e){this._getWindowContext(e.windowId).reset(e)},e.prototype.dispose=function(){for(var e in this._targetWindows)this._targetWindows[e].dispose()},e}(),h=function(n){function i(t){return n.call(this,t,(function(e){r.ErrorReporter.lastError=e,r.ErrorReporter.handleError({})}),{createLog:function(e){return new r.Log(e)},writeEntry:r.Log.writeEntry2,flush:r.Log.flush,disable:r.Log.disable},e.features)||this}return __extends(i,n),i.prototype.registerObjectFactory=function(e,t){this._poEndPoints.registerEndPoint(e,t)},i.prototype.acquireObject=function(e,t,r){return this._assertReady(),Q(this._poClient.acquireObject(e,this._windowRedirectMap[t]||t,r))},i.prototype.start=function(e){n.prototype.start.call(this,e),this._poClient=this._dispatcher.createClient(p,this._poEndPoints,this._log,this._features,null)},i.prototype.reset=function(){n.prototype.reset.call(this),this._poClient&&(this._poClient.dispose(),this._poClient=null),this._poEndPoints=new t.EndPointTable(this._registrationTimeoutInMs,this._reportError,this._log)},i}(t.CoreClient);t.Client=h,t.client=new h(3e4),e.registerGlobalState(t.client),t.start=function(e){t.client.start(e)};var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.invoke=function(e,t,r){return Q(e.invokeRpc(this.name,t,r))},t}(t.ActionEndPointDefinitionBase);t.ActionEndPointDefinition=y;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.invoke=function(e,t,r){return Q(e.invokeRpc(this.name,t,r))},t}(t.FuncEndPointDefinitionBase);t.FuncEndPointDefinition=m;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.registerObjectFactory=function(e,t){e.registerObjectFactory(this.name,t)},t.prototype.acquireObject=function(e,t,r){return Q(e.acquireObject(this.name,t,r))},t}(t.EndPointDefinition);t.ProxiedObjectTypeDefinition=v}(e.Rpc||(e.Rpc={}))}(FxImpl||(FxImpl={})),function(e){!function(t){var r=e.Rpc;t.extensionStatusEndPoint=new r.ActionEndPointDefinition(e.Constants.RpcMethods.notifyExtensionStatus),t.postBootEndPoint=new r.ActionEndPointDefinition(e.Constants.RpcMethods.postBoot),t.waitForExtensionIdleEndPoint=new r.FuncEndPointDefinition("waitForExtensionIdle"),t.onNewReactViewEndPoint=new r.ActionEndPointDefinition("onNewReactView"),t.onReactViewInteractiveEndPoint=new r.ActionEndPointDefinition("onReactViewInteractive"),t.onReactViewDisposed=new r.ActionEndPointDefinition("onReactViewDisposed"),t.traceToExtensionEndPoint=new r.ActionEndPointDefinition("traceToExtension"),t.endTraceToExtensionEndPoint=new r.FuncEndPointDefinition("endTraceToExtension")}(e.Extension||(e.Extension={}))}(FxImpl||(FxImpl={})),function(e){!function(t){!function(t){var r=e.Base,n=e.Services.Image,i=e.Base.Images,a=n.newImageData;function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.filter((function(e){return e}));return r.length>0?r.join(" "):void 0}t.CustomImageWithBadge=function(t,r){return{type:t.type,data:t.data,options:e.extend2(t.options,{badge:r})}},t.CustomImageWithOptions=function(t,r){return t&&{type:t.type,data:t.data,options:e.extend2(t.options,r,{customClass:o(t.options&&t.options.customClass,r.customClass)})}};var s=e.memoize(a);function u(e){return function(t){return t?a(e,t):s(e)}}function c(t,r){e.extendStringMapIntoMap(t,r,u)}t.ImageUri=function(e){return{type:2,data:e}},t.Number=function(e,t){var n="";return e<0||e>99?new r.Diagnostics.Log("MsPortalFx/Base/Base.Images").error("MsPortalFx.Base.Images.Number("+ +e+"), "+ +e+" is outside valid range of 0 - 99"):n='<svg class=\'fxs-svg-number msportalfx-svg-placeholder\' viewBox="0 0 19 19" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svg="http://www.w3.org/2000/svg"><g><circle class=\'msportalfx-svg-c23 fxs-svg-circle\' stroke="#b3d2ff" cx="9.5" cy="9.5" r="9"></circle><text class=\'msportalfx-font-bold fxs-svg-text\' text-anchor="middle" x="9.3" y="13">'+ +e+"</text></g></svg>",{type:899+e,data:n,options:t}},c(i,{Add:4,AddAlternate:259,AddBoxed:300,AddTeamMember:82,AddTile:318,Alert:383,AllServices:344,ArrowDown:260,ArrowLeft:261,ArrowRight:262,ArrowUp:263,Attachment:83,AvatarDefault:84,AvatarUnknown:85,AzurePortal:334,AzureQuickstart:161,Backlog:86,Blank:0,BlankDashboard:396,Book:10,Canceled:74,Capture:355,CaretDown:286,CaretUp:287,Check:12,Clock:75,Clone:76,CloudUpload:367,Code:94,Collapse:298,Columns:264,Commit:96,Commits:210,Connect:132,Console:333,Copy:338,Customize:296,Delete:17,Diagnostics:279,Disable:98,Disabled:18,Discard:19,Disconnect:133,DoubleChevron:345,Download:174,Edit:99,EditInverted:100,Ellipsis:176,Error:77,Expand:299,Favorite:101,Feedback:228,File:102,Filter:22,FilterRemove:349,FolderAlternate:265,ForPlacementOnly:177,Gear:103,GearAlternate:249,GetMoreLicense:104,GetStarted:105,Globe:285,Go:108,Guide:218,Hamburger:313,HeartPulse:211,Help:130,HideItems:360,History:109,Hyperlink:31,Inactive:110,Info:225,InfoFilled:418,Insert:339,InstallVisualStudio:111,Json:395,Key:266,LaunchCurrent:227,Line:348,Link:35,Lock:37,Log:112,Mail:267,Message:268,Monitoring:193,Move:356,MoveAcrossResourceGroups:399,MoveAcrossSubscriptions:400,MoveAcrossRegions:401,NewChat:413,NewChatAlternate:416,NotificationBell:363,Notifications:342,NumberError:364,NumberSuccess:365,OpenInMobile:405,Paused:79,Pending:43,Person:44,PersonWithFriend:45,Pin:46,Plus:297,Postpone:114,PowerUp:216,Print:394,Properties:48,Publish:162,Query:270,Question:49,Queued:80,QuickStart:50,Redo:157,Refresh:51,Reimage:354,Release:115,Request:116,ResourceFlat:351,Retain:117,Save:52,SaveAll:271,Search:248,ShareIt:417,Shield:414,ShieldFilled:419,Settings:341,ShowItems:361,Signout:226,SmileyHappy:319,SmileyNeutral:320,SmileySad:321,Star:283,Start:61,StatusUpsell:343,Stop:62,Subtract:65,Support:219,Swap:66,Tag:239,Tags:246,Tasks:119,TermsOfUse:415,TermsOfUseFilled:420,Tools:159,Tour:275,TrendDown:204,TrendUp:205,Triangle:120,Undo:272,Unknown:366,Unlock:69,Unpin:70,Unshare:397,Upload:121,Variables:206,View:387,Warning:317,WebHostingPlan:236,Wrench:160,Chevron:158,Close:55,ShellCustomize:314,Dots:169,ExitPeekMode:347,Fullscreen:323,ShellGear:247,HeaderDots:273,Maximize:58,Mini:322,Minimize:289,PeekMode:346,Restore:59,Share:324,Trash:284,TrashOutline:327,TripleArrow:257}),t.GitLogo=u(106),t.GitLogoBox=u(107),t.VisualStudio=u(123),t.VisualStudioLogoBox=u(124),t.Logos||(t.Logos={}),c(i.Logos,{Bitbucket:181,BitbucketBox:182,Channel9:277,CodePlex:183,CodePlexBox:184,Dropbox:185,DropboxBox:186,ExternalRepositoryBox:212,Git:187,GitBox:188,GitHub:189,GitHubBox:190,Microsoft:220,MicrosoftSquares:258,Redis:229,StackOverflow:278,VisualStudio:191,VisualStudioBox:192}),function(t){t.EllipsisSquare=u(295);var r=e.memoize((function(e){return{type:e,options:{customClass:"msportalfx-svg-fabric-rotate360"}}}));function n(e){return function(){return r(e)}}t.Spinner=n(328),t.Loader=n(329)}(t.Loading||(t.Loading={})),function(e){e.Happy=u(242)}(t.Emoticon||(t.Emoticon={})),function(e){e.Azure=u(379),e.Blue=u(380),e.Dark=u(381),e.Light=u(382),e.System=u(421)}(t.Themes||(t.Themes={})),function(e){c(e,{ActiveDirectory:3,Advisor:336,AllServices:385,ApiManagement:301,AppInsights:135,Automation:164,AvailabilitySet:136,AzurePortal:403,Backlog:87,Backup:137,BillingHub:92,BizTalk:302,BlobBlock:231,BlobPage:232,SuccessCheckmark:402,Branch:240,Browser:138,Bug:11,Builds:93,Cache:230,Cdn:303,Certificate:194,Chart:241,ClearDBDatabase:178,Clock:195,CloudService:13,Code:95,Commit:97,Controls:14,ControlsHorizontal:196,CostAlerts:357,CostAnalysis:358,CostBudgets:359,Counter:250,Cubes:15,CustomDomain:139,Dashboard:350,Database:16,DevConsole:213,Discs:244,Download:20,ErrorIcon:274,EventGrid:340,EventHub:304,Extensions:237,File:254,Files:255,FolderBlank:23,FolderCube:24,FolderWebsite:25,Ftp:26,Functions:337,Gear:27,Globe:140,GlobeError:222,GlobeSuccess:223,GlobeWarning:224,Grid:28,Guide:29,Heart:30,HeartPulse:410,Image:256,Info:32,InputOutput:197,Insights:362,IpAddress:141,JourneyHub:33,Key:34,LaunchPortal:142,Learn:371,LoadBalancer:143,LoadTest:144,Location:36,Lock:411,Log:145,LogAnalytics:353,LogDiagnostics:146,LogStreaming:147,ManagementPortal:276,Media:38,MediaFile:39,Mobile:40,MobileEngagement:305,Module:198,Monitoring:41,NetworkInterfaceCard:148,Notification:42,NotificationBell:363,OperationalInsights:306,Owl:332,Power:291,Powershell:47,PowerUp:199,Preview:294,ProcessExplorer:251,ProductionReadyDb:214,QuickStart:384,RemoteApp:307,ResourceDefault:149,ResourceGroup:179,ResourceGroupList:208,ResourceLinked:150,ResourceList:207,ResourceRole:288,Scale:118,Scheduler:308,Search:53,SearchGrid:54,ServerFarm:151,ServiceBus:309,SiteRecovery:310,SqlDatabase:165,SqlDataBaseServer:152,SSD:280,SslCustomDomains:60,Storage:63,StorageAzureFiles:290,StorageContainer:233,StorageQueue:234,Store:64,StorSimple:311,StreamAnalytics:312,Support:200,Table:235,Tags:386,TeamProject:67,TfsVcRepository:153,Toolbox:68,Tools:412,TrafficManager:166,Versions:203,VirtualMachine:71,VirtualNetwork:245,WebEnvironment:167,WebHosting:154,WebJobs:168,Website:72,WebsitePower:73,WebsiteStaging:155,WebSlots:215,WebTest:156,Workbooks:352,Workflow:180,AddSubscription:388,ContentErrorGeneric:368,ContentErrorNotFound:369,ContentErrorUnauthorized:370,CornerCheck:221,DefaultBlade:57,AzureGithub:404,FreeTrialVariant1:406,FreeTrialVariant2:407,FreeTrialVariant3:408,ManageAccess:389,StudentTools:390,ResourceSandboxTrial:409}),e.PolyTrafficManagerDisabled=u(201),e.PolyTrafficManagerEnabled=u(202),e.TrafficManagerDisabled=u(201),e.TrafficManagerEnabled=u(202)}(t.Polychromatic||(t.Polychromatic={})),function(e){c(i.Shell,{Add:325,AddSubscription:388,ArrowWideDown:281,ArrowWideUp:282,Chevron:158,Close:55,Collapse:56,ContentErrorGeneric:368,ContentErrorNotFound:369,ContentErrorUnauthorized:370,CornerCheck:221,Customize:314,DefaultBlade:57,Dots:169,ExitPeekMode:347,Filter:326,Fullscreen:323,Gear:247,HeaderDots:273,ManageAccess:389,Maximize:58,Mini:322,Minimize:289,PeekMode:346,Pin:331,Restore:59,Save:330,Share:324,StudentTools:390,Trash:284,TrashOutline:327,TripleArrow:257}),function(e){e.Home=u(127),e.Alerts=u(129),e.Journey=u(128),e.Browse=u(126),e.Billing=u(92),e.Create=u(125)}(e.JumpBar||(e.JumpBar={}))}(t.Shell||(t.Shell={})),function(e){e.Canceled=u(89),e.Critical=u(292),e.Disabled=u(90),e.Error=u(6),e.Failed=u(252),e.Info=u(78),e.None=u(7),e.Pending=u(88),e.Stopped=u(131),e.Success=u(8),e.Unknown=u(91),e.Update=u(373),e.Upsell=u(372),e.Warning=u(9),function(e){e.Canceled=u(374),e.Critical=u(293),e.Disabled=u(375),e.Error=u(170),e.Failed=u(253),e.Info=u(171),e.None=u(376),e.Pending=u(377),e.Stopped=u(175),e.Success=u(172),e.Unknown=u(209),e.Update=u(238),e.Upsell=u(378),e.Warning=u(173)}(e.Outline||(e.Outline={})),function(e){e.Error=u(315),e.Info=u(316),e.Warning=u(317),e.Unknown=u(366)}(e.Solid||(e.Solid={}))}(t.StatusBadge||(t.StatusBadge={}));var l=e.memoize((function(e){return a(e)}));function d(e){return function(){return l(e)}}!function(e){e.CollectionPartWithRollup=d(1e3),e.CollectionSummary=d(1001),e.DonutChart=d(1002),e.DonutChartPartial=d(1003),e.Extensions=d(1004),e.GridWithMoreData=d(1005),e.Map=d(1006),e.MultiLineChartMultiTrendLine=d(1007),e.MultiScatterChart=d(1008),e.MultiStackedBarChart=d(1009),e.MutliLineChart=d(1010),e.PricingTier=d(1011),e.QuotaGauge=d(1012),e.ResourceMap=d(1013),e.SingleAreaChart=d(1014),e.SingleAreaChartSingleThreshold=d(1015),e.SingleAreaChartSingleTrendline=d(1016),e.SingleBarChartLarge=d(1017),e.SingleBarChartSmall=d(1018),e.SingleLineChart=d(1019),e.SingleScatterChart=d(1020),e.SingleScatterSingleThreshold=d(1021),e.SingleValueGauge=d(1022),e.SplitBarChart=d(1023),e.StackedAreaChart=d(1024)}(t.PartGallery||(t.PartGallery={}))}(t.Images||(t.Images={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r,n,i,a=MsPortalFx.Base,o=a.Constants.Shell,s=a.Diagnostics.Telemetry,u=e.Constants.RpcMethods.networkTelemetry,c=e.Rpc.client,l="Framework",d=!0,f=1,p=[],h=new Map,y=ko.observableArray(),m=function(e){var t;return!n&&MsPortalFx.require("FxInternal/NetDiagnostics",(function(e){var t=e.nameNetworkCall;return n=t})),(null===(t=null==n?void 0:n(e))||void 0===t?void 0:t.commandName)||"[UNKNOWN]"};function v(e){y.push(e),Promise.race([MsPortalFx.delay(6e4),e.promise.catch((function(){}))]).finally((function(){y.remove(e)}))}function g(e){return __awaiter(this,arguments,void 0,(function(e,t){var r,n,i,a,o,u,c,l,p,h,y,m,v,g,_,b,E,P,M,C,w,F,D,A,k;return void 0===t&&(t=d),__generator(this,(function(d){switch(d.label){case 0:return r=e.request,n=e.response,i=e.startTime,a=e.endTime,o=e.reactViewBladeContext,r.skipTelemetry||!MsPortalFx.isFeatureEnabled("networktelemetry")?[2]:(u=S(),c="reactViewBladeContext"in e,[4,MsPortalFx.require("FxInternal/NetDiagnostics")]);case 1:return l=d.sent(),p=l.nameNetworkCall,h=l.getBatchItemsData,l.CallKind,y=MsPortalFx.isFeatureEnabled("fixajaxnames")&&!c,(m=p(r,{suppressHighVolume:t,emitDiagnostics:y}))?(v=("ARMBATCH"===m.kind||"MSGRAPHBATCH"===m.kind)&&h(m.kind,e.request,n.responseText,y),t&&"ARMBATCH"===m.kind&&v.every((function(e){return e.name.commandName.includes("Notifications.load")}))?[2]:(g=c?o:null===(k=m.bladeInstance)||void 0===k?void 0:k.context,_=r.headers||{},b=_["x-ms-client-request-id"]||"placeHolder_"+f++,E=a-i,M=[__assign(__assign({requestId:String(b),status:n.status,dataSent:r.dataSentBytes,dataReceived:n.dataReceivedBytes,method:r.type||"GET",startTime:i,endTime:a,token:r.token,responseCorrelationId:n.responseCorrelationId,uri:m.uri},v&&{batchRequests:v.map((function(e){var t=e.name,r=e.status,n=e.responseCorrelationId,i=e.dataReceived;return __assign(__assign({},(delete t.kind,t)),{status:r,responseCorrelationId:n,dataReceived:i})}))}),{scrubbedUri:m.scrubbedUri})],(C=g)?(D={},w=[__assign(__assign({},g),{interrupted:(null==u?void 0:u.context.instanceId)!==g.instanceId})],g.id.toLowerCase().endsWith(".ReactView".toLowerCase())?(A={},[4,I(g).then((function(e){return e?(i>=e).toString():"indeterminate"}))]):[3,3]):[3,5])):[2];case 2:return A.interactive=d.sent(),F=A,[3,4];case 3:F=m.bladeInstance&&{settled:!!m.bladeInstance.settled},d.label=4;case 4:D.blade=__assign.apply(void 0,w.concat([F])),C=D,d.label=5;case 5:return P=__assign.apply(void 0,[__assign.apply(void 0,M.concat([C])),{wwwAuthenticateReceived:n.wwwAuthenticateReceived}]),x({source:null==g?void 0:g.id,action:"Ajax",actionModifier:n.isError?s.ActionModifier.Cancel:s.ActionModifier.Complete,duration:E,name:m.commandName,data:P}),[2]}}))}))}function _(){var e=navigator.connection;if(!performance||!navigator.hardwareConcurrency||!e)return{};var t=performance.getEntries&&performance.getEntries(),r=t&&t[0];if(!r||"number"!=typeof r.transferSize)return{};var n={},i={},a={},o={},s=0,u=0;return t.forEach((function(e){if("resource"===e.entryType){var t=e.initiatorType;a[t]=(a[t]||0)+e.transferSize,o[t]=(o[t]||0)+e.duration,s+=e.transferSize||0,u+=e.duration,e.transferSize?i[t]=(i[t]||0)+1:n[t]=(n[t]||0)+1}})),{connection:{rtt:e.rtt,downlink:e.downlink,effectiveType:e.effectiveType,saveData:e.saveData},uncachedCountByGroup:i,homepageTransferBytes:r.transferSize,cachedCountByGroup:n,totalBytesTransferred:s,totalTransferMsByGroup:o,totalBytesTransferredByGroup:a,hardwareConcurrency:navigator.hardwareConcurrency,totalTransferMs:u}}function b(e,t,r,n){n=n||{};var i=r-t;return x({timestamp:Math.round(r+(n.epochAdjustment||0)),source:l,action:e,name:n.name,actionModifier:s.ActionModifier.Complete,duration:i,data:P(n.data)}),i}function x(t){e.internalEnv.isShell?s.trace(t):c.invokeRpc(u,o,t)}function E(e){return e?"string"==typeof e?e.length:-1:0}function P(e){for(var t={},r=e;r&&r!==Object;)Object.keys(r).forEach((function(e){t[e]=void 0})),r=Object.getPrototypeOf(r);return MsPortalFx.forEachKey(t,(function(r){var n=e[r];"function"!=typeof n?t[r]=n:delete t[r]})),t}function S(){return p.length>0?p[p.length-1]:void 0}function I(e){var t,r=e.instanceId;return(null===(t=h.get(r))||void 0===t?void 0:t.promise)||Promise.resolve(void 0)}t.listenForBlade=function(e,t){r=t;var n={context:e};p.push(n);var i=e.instanceId,a=function(e){var t;null===(t=h.get(i))||void 0===t||t.resolve(e)};return h.set(i,Promise.withResolvers()),{onDisposed:function(){var e=p.lastIndexOf(n);e>=0&&p.splice(e,1),a(void 0),h.has(i)&&setTimeout((function(){h.delete(i)}),3e5)},onSettled:function(){n.settled=!0},onInteractive:a}},t.pendingCallCount=ko.pureComputed((function(){return y().length})),t.pendingAjaxCalls=(i=[],y.subscribe(new e.TriggerableLifetimeManager,(function(e){i.splice.apply(i,__spreadArray([0,i.length],e,!1))})),i),t.noteAjaxCall=v,t.createTelemetry=function(e,t){var n;if(void 0===t&&(t=d),v({name:m(e),promise:new Promise((function(e){n=e}))}),r){var i=r;r=null,i()}var a=Date.now(),o=performance.now();return e=MsPortalFx.clone(e,!0),function(r,i){var s,u;n();var c=E(r.responseText),l=performance.now(),d=a+(l-o),f=!0===e.setAuthorizationHeader?"arm":(e.setAuthorizationHeader||{}).resourceName;g({request:__assign(__assign({},e),{dataSentBytes:E(e.data),token:f}),response:{status:r.status,dataReceivedBytes:c,isError:i,responseCorrelationId:(null===(s=r.getResponseHeader)||void 0===s?void 0:s.call(r,"x-ms-correlation-request-id"))||(null===(u=r.getResponseHeader)||void 0===u?void 0:u.call(r,"client-request-id")),responseText:r.responseText},startTime:a,endTime:d},t)}},t.traceReactViewAjax=function(e){g(__assign(__assign({},e),{reactViewBladeContext:e.bladeContext}))},t.registerTelemetrySubmissionHandler=function(){c.registerRpcEndPoint(u,{allowedOrigin:null,handler:function(e,t){s.trace({extension:t.srcWindowId,timestamp:e.timestamp,source:e.source,action:e.action,actionModifier:e.actionModifier,name:e.name,duration:e.duration,data:e.data,optional:e.optional})}})},t.getPerformanceTelemetry=_,t.getBootstrapTelemetry=function(){var e=fx.bootstrapTelemetry,t=performance.timing;return t?(e.timing=t.toJSON&&t.toJSON(),e.appCacheLoad=t.domainLookupStart-t.fetchStart,e.requestTime=t.responseStart-t.requestStart,e.pageLoad=t.loadEventEnd-t.responseEnd,e.navigationTime=b("DocumentNavigationTime",t.fetchStart,t.responseEnd),e.ttfb=b("DocumentFirstByte",t.fetchStart,t.responseStart),e.domainLookup=b("DocumentDnsTime",t.domainLookupStart,t.domainLookupEnd),e.unloadTime=b("DocumentUnloadTime",t.navigationStart,t.fetchStart),e.performanceTelemetry=_(),e):e},t.getCurrentBladeInstance=S}(e.NetDiagnostics||(e.NetDiagnostics={}))}(FxImpl||(FxImpl={})),function(e){var t,r=new MsPortalFx.Base.Diagnostics.Log("FxImpl/Base.Net"),n=e.internalEnv;function i(i,a){var o,s=[e.origin,n.fxGraphEndpoint,n.fxMsGraphEndpoint,e.trustedParentOrigin,e.baseArmAuthorityLowerCase,MsPortalFx.ensurePrefix(e.baseArmAuthorityLowerCase,"*."),t,"*.prometheus.monitor.azure.com","*.prometheus.monitor.azure.us"];if(null===(o=e.internalEnv.dArmDomains)||void 0===o?void 0:o.length)for(var u=0,c=e.internalEnv.dArmDomains;u<c.length;u++){var l=c[u];s.push(l),s.push("*.".concat(l))}var d=MsPortalFx.union(s,i||[]),f=new Set,p=[];(d||[]).filter((function(e){return!!e})).forEach((function(e){var t=MsPortalFx.trimEnd(e.toLowerCase().trim(),"/");if(t.startsWith("*.")){var r=MsPortalFx.trimEnd(m(t),"*",".");p.push({configValue:r,regex:new RegExp("^".concat(r.replaceAll(".","\\.").replaceAll("*",".*"),"$"))})}else{t.indexOf("://")>-1&&(t=m(new MsPortalFx.Base.UriBuilder(t).getAuthority())),f.add(t)}}));var h=Array.from(f.keys()).concat(p.map((function(e){return e.configValue}))).toString(),y=MsPortalFx.isFeatureEnabled("atblock");function m(e){var t=e.lastIndexOf("@");t>-1&&(e=e.substring(t+1));var r=e.lastIndexOf(":");return r>-1&&(e=e.substring(0,r)),e}return{validateDomain:function(t){var n,i=t&&new MsPortalFx.Base.UriBuilder(t),o=i&&(i.getAuthority()||i.path.split("/")[0]),s=o&&m(o.toLowerCase()),u=!1;if(s)if(s!==encodeURIComponent(s))n="XSS";else if(o.includes("@")&&y)n="ContainsAtCharacter";else if(f.has(s))u=!0;else{for(var c=0,l=p;c<l.length;c++){if(l[c].regex.test(s)){u=!0;break}}u||(n="NotInTrustedDomains")}else n="NoDomain";return u?f.add(s):a&&r.warning('URI "{0}" (domain "{1}") failed validateDomain; reason: "{2}"; effective locale: "{3}"; trustedDomains: {4}'.format(t,s,n,e.Intl.effectiveLocale,Array.from(f.keys()).concat(p.map((function(e){return e.configValue}))).toString())),u},trustedDomainsList:h,fxTrustedDomains:s}}function a(t){return e.memoizePromise((function(e){return Promise.all([MsPortalFx.require("Fx/DependencyInjection"),MsPortalFx.require("Fx/Experimentation")]).then((function(t){var r=t[0],n=t[1];return r.container.get(n.Experimentation).shellAssignments.getBooleanValue(e)}))}))(t)}function o(e,t,r,n){var i=(r||"GET").toUpperCase(),a=1===e,o=["providers/microsoft.compute/virtualmachines/","providers/microsoft.storage/storageaccounts/","providers/microsoft.web/sites/","providers/microsoft.compute/virtualmachinescalesets/"];if(MsPortalFx.isFeatureEnabled("ameblockatmdelete")&&o.push("providers/microsoft.network/trafficmanagerprofiles/"),"POST"===r&&t.includes("/bulkdelete?")){for(var s=(null==n?void 0:n.EntityIds)||[],u=[],c=function(e){if(!a)return u.push(e),"continue";var t=(e||"").toLowerCase();o.reduce((function(e,r){return e||t.includes(r)}),!1)&&u.push(e)},l=0,d=s;l<d.length;l++){c(d[l])}return u}var f=["DELETE"];if(a||f.push("PUT"),!f.includes(i))return[];var p=t.toLowerCase();return p.includes("/subscriptions/")?a?o.reduce((function(e,t){return e||p.includes(t)}),!1)?[new MsPortalFx.Base.UriBuilder(t).getRelativePath()]:[]:[new MsPortalFx.Base.UriBuilder(t).getRelativePath()]:[]}!function(){t=n.fxArmEndpoint;var i=e.features.getValue("armendpointprefix");if(i)if(!!/^[a-zA-Z0-9-]+$/.test(i)){var a=new MsPortalFx.Base.UriBuilder(t),o=a.getAuthority();e.baseArmAuthorityLowerCase=o.toLowerCase(),t=[a.getScheme(),MsPortalFx.ensureSuffix(i,"."),o,a.getRelativePath(),a.getOriginalQuery()].join("")}else r.error("Attempted to prefix ARM endpoint with unsafe value");else e.baseArmAuthorityLowerCase=new MsPortalFx.Base.UriBuilder(t).getAuthority().toLowerCase()}(),e.extensionName="",e.onEnvironmentSet((function(t){var r,a;e.extensionName=t("extensionName"),r=t("trustedDomains"),a=MsPortalFx.union(r||[],n.azsEndpoints?Object.values(n.azsEndpoints):[]),e.authTokenDomainValidator=i(a,!0)})),e.nonCaeArmAliasLowerCase="noncaearm",e.ameCancelledErrorCode="AmeCancelled",e.getArmEndpoint=function(){return t},e.getHashCode=function(e){for(var t=0,r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t|=0}return t},e.getDomainValidator=i,e.validateDomain=function(t){return!!e.authTokenDomainValidator&&e.authTokenDomainValidator.validateDomain(t)},e.getExperimentBooleanValue=a,e.isAjaxInterceptedViaPolyfill=function(){var t=this;return e.memoizePromise((function(){return __awaiter(t,void 0,void 0,(function(){var e,t;return __generator(this,(function(r){switch(r.label){case 0:return[4,Promise.all([a("blockuntrusteddomains"),a("useajaxpolyfillexp")])];case 1:return e=r.sent(),t=e[0],[2,e[1]&&t]}}))}))}))()},e.getSensitiveResourceIdsFromAjaxRequest=function(e,t,r){return o(0,e,t,r)},e.getHighlySensitiveResourceIdsFromAjaxRequest=function(e,t,r){return o(1,e,t,r)}}(FxImpl||(FxImpl={})),function(e){!function(t){var r=e.Base,n=r.Constants,i=FxImpl.NetDiagnostics,a=e.isUndefined,o=e.isEmpty,s=r.Diagnostics.Telemetry,u=FxImpl.Extension,c=e.Errors,l=(c.ErrorLevel,e.isInWebWorker),d=e.getUniqueIdGenerator(),f="Failed to get authorization token.",p=FxImpl.getArmEndpoint()+"batch?api-version=".concat(e.getFeatureValue("batchapiversion")||"2020-06-01"),h=new r.Diagnostics.Log("MsPortalFx/Base/Base.Net"),y=e.memoize((function(e){return e<=1?1:y(e-1)+y(e-2)}));!function(t){var m=function(e){return $.ajax(e)},v=m,g={log:function(){return h.error.apply(h,arguments)},sanitize:e.sanitizeMessage},_="no-cache",b={};b[0]=b[500]=b[502]=b[503]=b[504]=!0;var x,E={};function P(e){return!e||b[e.status]||E[e.status]&&!e.getResponseHeader("x-ms-request-id")}function S(e,t,r){a(e[t])&&(e[t]=r)}function I(t){return function(){var r=t.headers||{};return{uri:g.sanitize(t.uri),type:t.type||"GET",pathAndQuery:g.sanitize(r["x-ms-path-query"]),requestId:r["x-ms-client-request-id"],failureCause:g.sanitize(r["x-ms-failure-cause"]),sessionId:e.sessionId,commandName:t.setTelemetryHeader}}}function M(t,r,n){var i=t();return e.isObject(r)&&e.extend(i,{status:r.status,statusText:r.statusText}),n&&e.extend(i,n),i}function C(){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(r){switch(r.label){case 0:return x||(x=__awaiter(t,void 0,void 0,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,FxImpl.Rpc.client.invokeRpc("MsPortalFx.Internal.Constants.RpcMethods.experimentationValuesHelper",n.ExtensionNames.Hubs,["tempTrustedDomains"])];case 1:t=r.sent();try{return[2,JSON.parse(t[0]||"{}")]}catch(r){return h.warning('Failed to get untrusted domains overrides from ExP. Actual value: "'.concat(t[0],'". Error details: ').concat(e.getLogFriendlyMessage(r))),[2,{}]}return[2]}}))}))),[4,x];case 1:return[2,r.sent()]}}))}))}E[401]=E[403]=!0,t.isRetryable=P,t.disableAjaxServerVersionCheck=function(){F()},t.setAjaxLogFunc=function(e,t){g.log=e||g.log,g.sanitize=t||g.sanitize},t.setAjaxFunc=function(e){return v=e||m,m},function(t){var m=e.getUriAuthority(FxImpl.internalEnv.fxGraphEndpoint);function b(){var t=(e.getEnvironmentValue("extensionName")||"").toLowerCase();return[n.Shell.toLowerCase(),n.ExtensionNames.Hubs.toLowerCase()].includes(t)}function E(){return FxImpl.getArmEndpoint()}function F(r,n,i,a,o){var s=!a||r.duration()<=a;if(r.retryCount&&s&&(!o||o())){r.retryCount--;var u=r.retryDuration&&r.retryDuration()||0,c=y(i-r.retryCount)*t.environment.betweenRetry;return e.delay(Math.max(c-u,0)).then(n),!0}return!1}FxImpl.registerGlobalState({reset:function(){t.environment={betweenRetry:400}}}),t.getArmEndpoint=E,t.ajaxExtended=function(e){return r.Net2.ajaxExtended(e)};var D=function(){function t(){this.ajaxStatus=ko.observable({code:0}),this.unknownErrorStatusCode=0,this._initialized=Q.defer(),this._unknownErrors=0,this._backgroundTask=Q.defer()}return t.prototype.initialize=function(t,r,n){var i=this;this._version=e.getEnvironmentValue("version");var a,s=this._backgroundTask;s.resolve(),a=s,setInterval((function(){a===s&&s.resolve()}),6e4);var u=n&&n.split(".");this._acceptLanguage=u&&u[0],this._effectiveLocale=n,this._getAuthTokenFunc=function(e){return Q(t(e))},o(r)||(this._extensionFlags=JSON.stringify(r)),this._blockUntrustedDomains=FxImpl.internalEnv.blockUntrustedDomains||e.isFeatureEnabled("blockuntrusteddomains"),x=null,FxImpl.isAjaxInterceptedViaPolyfill().then((function(e){i._isAjaxInterceptedViaPolyfill=e,i._initialized.resolve()}))},t.prototype.postJSON=function(e,t){return function(e,t){e.contentType="application/json",e.data=JSON.stringify(t),e.type="POST"}(e,t),this.ajax(e)},t.prototype.ajaxExtended=function(e){return this._executeAjaxCall(e,new A(I(e)))},t.prototype.ajax=function(e){return this.ajaxExtended(e).then((function(e){return e.content}))},t.prototype._ajaxFuncImpl=function(t){var n=t.settings,i=t.isRelativeUri,a=t.deferred,o=t.token,s=t.executionContext,u=n.headers||{};n.setAuthorizationHeader&&(u.Authorization=o);var c=this._acceptLanguage;c&&S(u,"Accept-Language",c);var l=E().toLowerCase(),f=i&&l;if(!n.useFxArmEndpoint||f){var p;if(n.invokeApi){var h=void 0;n.useFxArmEndpoint&&f?(h=encodeURI(n.url),p=new r.UriBuilder(f+e.trimStart(n.invokeApi,"/"))):e.getEnvironmentValue("useFxArmEndpoint")&&f?(p=new r.UriBuilder(f),h=encodeURI(n.url),p.setRelativePath(n.invokeApi)):((p=new r.UriBuilder(n.url)).query.clear(),h=encodeURI(p.getRelativePath()+p.getOriginalQuery()),p.setRelativePath(n.invokeApi)),S(u,"Cache-Control",_),n.uri=n.url=p.toString(),S(u,"x-ms-path-query",h)}else n.useFxArmEndpoint&&f&&(p=new r.UriBuilder(f+e.trimStart(n.url,"/")),n.uri=n.url=p.toString());FxImpl.extensionName&&new r.UriBuilder(n.uri.toLowerCase()).getAuthority().endsWith(FxImpl.baseArmAuthorityLowerCase)&&(e.isNullOrUndefined(n.setTelemetryHeader)||!n.setTelemetryHeader.startsWith(FxImpl.extensionName)&&!n.setTelemetryHeader.startsWith("{"))&&(n.setTelemetryHeader="".concat(FxImpl.extensionName,".").concat(n.setTelemetryHeader||"")),n.setTelemetryHeader&&(u["x-ms-command-name"]=n.setTelemetryHeader.substring(0,256)),S(u,"x-ms-effective-locale",this._effectiveLocale),S(u,"x-ms-client-request-id",d()),S(u,"x-ms-client-session-id",e.sessionId),i&&this._version&&S(u,"x-ms-version",this._version);var y=this._extensionFlags;i&&y&&(u["x-ms-extension-flags"]=y),n.headers=u,this._worker(n,s,a)}else{var m="useFxArmEndpoint was set but ".concat(l?"the provided URL was not a relative URL":"armEndpoint is null",'. setTelemetryHeader: "').concat(n.setTelemetryHeader,'"');a.reject(m,{error:m,responseText:m,errorLevel:2},null)}},t.prototype._execAjaxWithGetAuth=function(t){var n=this,i=t.settings,o=t.deferred,u=t.executionContext,c=!e.isUriAbsolute(i.uri),l=(i.headers||{})["WWW-Authenticate"],d={};!0!==i.setAuthorizationHeader&&(d={resourceName:i.setAuthorizationHeader.resourceName,authConfigStamp:e.getFeatureValue("authstamp")}),!e.isFeatureEnabled("strictarmcae")||new r.UriBuilder(i.uri.toLowerCase()).getAuthority().endsWith(FxImpl.baseArmAuthorityLowerCase)||a(i.setAuthorizationHeader)||!0!==i.setAuthorizationHeader&&i.setAuthorizationHeader.resourceName||(d=__assign(__assign({},d),{resourceName:FxImpl.nonCaeArmAliasLowerCase})),l&&(d=__assign(__assign({},d),{wwwAuthHeader:l})),!e.isFeatureEnabled("loggraphcallwitharmtoken")||!0!==i.setAuthorizationHeader&&d.resourceName||!i.uri.includes(m)||s.trace({source:"Base.Net",action:"IncorrectGraphToken",data:{extensionName:FxImpl.extensionName,setAuthorizationHeaderValue:i.setAuthorizationHeader}}),e.tryImmediateResolve(this._getAuthTokenFunc(d),(function(t){if(!t&&e.isFeatureEnabled("failajaxonnulltoken")&&(h.verbose("Expected auth header but it is null. URI: {0}, Method: {1}".format(e.getLogFriendlyMessage(i.uri),i.type||"GET")),b()))return Q.reject("Null auth header.");n._ajaxFuncImpl({deferred:o,executionContext:u,isRelativeUri:c,settings:i,token:t})})).catch((function(r){if(!F(u,(function(){return n._execAjaxWithGetAuth(t)}),i.maxRetry,i.maxRetryDuration)){var a=i.maxRetry-u.retryCount+1,s=!i.maxRetryDuration||u.duration()<=i.maxRetryDuration,c=i.performRetry?"Retryable ajax call failed after several ".concat(a," attempts. ").concat(s?"":"Exceed maximum retry duration(".concat(i.maxRetryDuration,").")," Actual duration: ").concat(u.duration(),"."):f;t.settings.detailedError?o.reject(c,{error:e.getLogFriendlyMessage(r),responseText:f,errorLevel:r.errorLevel},null):o.reject(c,r,null)}}))},t.prototype._executeAjaxCall=function(t,o){var c,d=this,f=t.url=t.originalUri=t.uri||t.url;t.maxRetry=null!==(c=t.maxRetry)&&void 0!==c?c:12;var y={retryCount:t.performRetry?t.maxRetry:0,duration:e.startTimer()},m=t.headers=t.headers||Object.create(null),v=!e.isUriAbsolute(f);l&&!t.useFxArmEndpoint&&(t.uri=t.url=t.originalUri=FxImpl.ensureAbsoluteUri(f)),t.skipDomainValidation&&!b()&&h.warning("The 'skipDomainValidation' property should not be used when making an ajax request. Please remove this property from the request for uri: ".concat(f));var g=FxImpl.authTokenDomainValidator,_=Promise.resolve(!0);if(!this._isAjaxInterceptedViaPolyfill&&!t.skipDomainValidation&&g&&!v&&(t.setAuthorizationHeader||(t.headers||{}).Authorization)&&!g.validateDomain(f)){var x=new r.UriBuilder(f).getAuthority(),E="Security issue: Request to send auth token to untrusted domain '{0}'. Only a fixed set of domains should be configured to receive auth tokens. Command name: {1}".format(x,t.setTelemetryHeader||"<not provided>"),P=function(){return o.reject(E,{error:E,responseText:E,errorLevel:2},null)};FxImpl.isDevelopmentMode?(_=Promise.resolve(!1),P()):_=__awaiter(d,void 0,void 0,(function(){var e,t,n,i,a,o,u,c,l;return __generator(this,(function(d){switch(d.label){case 0:return(t=this._blockUntrustedDomains)?[3,2]:[4,FxImpl.getExperimentBooleanValue("blockuntrusteddomains")];case 1:t=d.sent(),d.label=2;case 2:return n=!1,(e=t)?[4,Promise.all([r.Security.getUserInfo(),C()])]:[3,4];case 3:i=d.sent(),a=i[0].directoryId,o=i[1],u=FxImpl.getHashCode(a.toLowerCase()),(null===(l=o[u])||void 0===l?void 0:l.length)&&(c=FxImpl.getDomainValidator(__spreadArray([],o[u],!0),!0),n=c.validateDomain(f),s.trace({source:"Base.Net",action:"BypassTrustedDomains",actionModifier:n?"Bypassed":"Blocked",data:{domain:x,uri:f,bypassDomains:c.trustedDomainsList}})),d.label=4;case 4:return e&&!n?(h.warning(E),P(),[2,!1]):(h.error(E),[2,!0])}}))}))}return _.then((function(c){return __awaiter(d,void 0,void 0,(function(){var l,d,h,g,_,x=this;return __generator(this,(function(E){if(c){if(t.useRawAjax)return this._worker(t,y,o),[2,o.getPromise()];if(a(t.setAuthorizationHeader)&&(t.setAuthorizationHeader=v),l=this._initialized.promise,t.isBackgroundTask&&(d=this._backgroundTask,l=l.then((function(){return d.promise})),h=this._backgroundTask=Q.defer(),o.finally((function(){h.resolve()}))),b()&&(f.startsWith(FxImpl.trustedParentOrigin)||v)){g=Object.create(null);try{g=JSON.parse(m["x-ms-feature-flags"]||"{}")}catch(e){}m["x-ms-feature-flags"]=JSON.stringify(g)}_=function(){var i;if(t.setAuthorizationHeader){var a=null,c=(t.type||"GET").toUpperCase(),l=[];if(null===(i=FxImpl.postBootEnv)||void 0===i?void 0:i.isWriteDisallowedTenant){var d=e.isFeatureEnabled("ameconfirmationdialog"),f=e.isFeatureEnabled("armbreakglass"),h=(t.url||"").toLowerCase(),m=t.useFxArmEndpoint||new r.UriBuilder(h).getAuthority().endsWith(FxImpl.baseArmAuthorityLowerCase),g=h!==p.toLowerCase();if(m&&g&&(f||d)){var _=f?FxImpl.getHighlySensitiveResourceIdsFromAjaxRequest:FxImpl.getSensitiveResourceIdsFromAjaxRequest,b=h.includes("/bulkdelete?"),E=_(t.url,t.type,t.data);E.length&&(l.push.apply(l,E.map((function(e){return{httpMethod:b?"DELETE":t.type,resourceId:e}}))),f?(t.headers["x-ms-arm-internal-break-glass"]="true",s.trace({source:"MsPortalFx.Base.Net",action:"ArmBreakGlassAdded",data:{uri:e.sanitizeMessage(h),httpMethod:t.type}})):a=Q(u.invokeAmeConfirmationDialogEndPoint.invoke(FxImpl.Rpc.client,n.Shell,l)).then((function(e){return s.trace({source:"MsPortalFx.Base.Net",action:"AMEConfirmation",actionModifier:e?"Approved":"Canceled",data:{deletePutResources:l,httpMethod:c,isBulkDelete:b}}),e})))}}return null!==a?a.then((function(r){if(!r){var n=e.Resources.Strings.DeleteCommand.Failure.ameCancelledDescription,i={status:403,statusText:"Forbidden",responseJSON:{error:{code:FxImpl.ameCancelledErrorCode,message:n,target:t.url}},readyState:XMLHttpRequest.DONE,getResponseHeader:function(){return null},getAllResponseHeaders:function(){return null},state:function(){return"rejected"},always:function(e){e()},then:function(e,t){t(i,"","")}};return o.reject(n,null,i)}return x._execAjaxWithGetAuth({deferred:o,executionContext:y,settings:t})})):x._execAjaxWithGetAuth({deferred:o,executionContext:y,settings:t})}x._ajaxFuncImpl({deferred:o,executionContext:y,isRelativeUri:v,settings:t,token:null})},t.initiationContext||(t.initiationContext={stack:e.isFeatureEnabled("fixajaxnames")&&e.getCurrentCallStack(),bladeInstance:i.getCurrentBladeInstance()}),l.isFulfilled()?_():l.then(_)}return[2,o.getPromise()]}))}))}))},t.prototype.cachedAjax=function(t){return t.headers=e.extend({"x-ms-cache-tag":'"0"'},t.headers),this.ajaxExtended(t).then((function(e){var t=e.content,r=e.textStatus,n=e.jqXHR;return{cachedAjax:!0,data:t,modified:"success"===r,textStatus:r,cacheTagValue:200===n.status?n.getResponseHeader("x-ms-cache-tag"):null,jqXHR:n}}))},t.prototype._worker=function(t,r,n){var a=this;if(!this._stall){r.retryDuration=e.startTimer();var o=i.createTelemetry(t);if(t.data&&t.data.length<5e5&&t.url===p&&e.isFeatureEnabled("simplebatch")&&FxImpl.postBootEnv.usePortalArmToken){var s=JSON.parse(t.data);t.contentType="text/plain",s.headers={},e.forEachKey(t.headers,(function(e,t){s.headers[e]=t.split(";")})),s.headers["content-type"]=["application/json"],t.data=JSON.stringify(s),delete t.headers}var u=v(t);u.always((function(){if(!a._stall)switch(u.state()){case"resolved":o(u),a._unknownErrors&&(a._unknownErrors=0,a.ajaxStatus({code:0})),u.then((function(e,t,r){n.resolve(e,t,r)}));break;case"rejected":o(u,!0),t.isBackgroundTask||t.ignoreUnknownNetworkError||u.status!==a.unknownErrorStatusCode?429!==u.status||t.type&&"GET"!==t.type||a.ajaxStatus({code:6,data:{uri:t.originalUri,type:t.type,correlationId:u.getResponseHeader("x-ms-correlation-request-id"),clientRequestId:(t.headers||{})["x-ms-client-request-id"],retryAfter:u.getResponseHeader("Retry-After")}}):(a._unknownErrors++,a._unknownErrors>=3&&(a._unknownErrors=0,a.ajaxStatus({code:4,data:{uri:t.uri,type:t.type,correlationId:u.getResponseHeader("x-ms-correlation-request-id"),clientRequestId:(t.headers||{})["x-ms-client-request-id"]}}))),u.then(null,(function(i,o,s){var l,d=M(I(t),i,{duration:r.duration()}),f=u.status;f>=500&&g.log(i,1,d);var p=!t.maxRetryDuration||r.duration()<=t.maxRetryDuration,y=u.getResponseHeader("WWW-Authenticate"),m=null===(l=t.setAuthorizationHeader)||void 0===l?void 0:l.resourceName,v=(e.getEnvironmentValue("extensionName")||"").toLowerCase(),b=(e.getFeatureValue("xmscc")+"").toLowerCase().split(",").includes(v);if((e.isFeatureEnabled("retryonwwwauthenticate")||b)&&401===f&&y&&!r.retriedWithWwwAuthenticate)a._getAuthTokenFunc({resourceName:m,wwwAuthHeader:y}).then((function(i){var o=t.url=t.originalUri=t.uri||t.url,s=!e.isUriAbsolute(o);return r.retriedWithWwwAuthenticate=!0,a._ajaxFuncImpl({deferred:n,executionContext:r,isRelativeUri:s,settings:t,token:i})}));else if(F(r,(function(){return a._worker(t,r,n)}),t.maxRetry,t.maxRetryDuration,(function(){return P(i)})));else if(403===f&&!0!==t.skipRetryOnForbidden&&"gateway"===(u.getResponseHeader("x-ms-failure-cause")||"").toLowerCase()){var x=e.clone(t,!0);x.skipRetryOnForbidden=!0,x.headers=x.headers||{},x.headers["Cache-Control"]=_,a._worker(x,r,n)}else{if(t.performRetry&&r.retryCount<t.maxRetry){var E=t.maxRetry-r.retryCount+1;if(E>1){var S=i.status||i.readyState?2:1,C="Retryable ajax call failed after several ".concat(E," attempts. ").concat(p?"":"Exceed maximum retry duration(".concat(t.maxRetryDuration,").")," Actual duration: ").concat(r.duration(),".");2===S?(s=new c.Error({message:C,innerErrors:s}),g.log(C,0,d)):h.warning(C,0,d)}}t.detailedError?n.reject(o,{error:s,responseText:u.responseText,errorLevel:s.errorLevel},i):n.reject(o,s,i)}}))}}))}},t}();t.AjaxCaller=D;var A=function(t){var r=Q.defer(),n=e.startTimer();this.resolve=function(e,t,n){r.resolve({content:e,jqXHR:n,textStatus:t})},this.reject=function(i,a,o){var s=new c.AjaxError({message:"ajaxExtended call failed",data:M(t,o,{duration:n()}),jqXHR:o,textStatus:i,errorThrown:a,errorLevel:e.isNullOrUndefined(null==a?void 0:a.errorLevel)?2:a.errorLevel,stack:null,create:r.promise.stack});r.reject(s)},this.getPromise=function(){return r.promise},this.finally=function(t){r.promise.finally(t).catch(e.noop)}};t.reset=function(){w=new t.AjaxCaller}}(t.Internal||(t.Internal={}));var w=new t.Internal.AjaxCaller;function F(){w.skipVersionCheck=!0}t.postJSON=function(e,t){return w.postJSON(e,t)},t.ajax=function(e){return w.ajax(e)},t.ajaxExtended=function(e){return w.ajaxExtended(e)},t.getSingleton=function(){return w},t.cachedAjax=function(e){return w.cachedAjax(e)},t.invalidateCacheHeader=function(e){e&&delete e["x-ms-cache-tag"]},t.setCacheHeader=function(t,r){return e.extend(t,{"x-ms-cache-tag":r})},t.initialize=function(t){w.initialize(t,e.getEnvironmentValue("featuresFromConfig",{}),FxImpl.Intl.effectiveLocale)},t.status=ko.pureComputed((function(){return w.ajaxStatus()})),t.disableVersionCheck=F,$.support.cors=!0,$.ajaxTransport("+binary",(function(e,t,r){if(e.dataType&&"binary"===e.dataType)return{send:function(t,r){var n=new XMLHttpRequest,i=e.url,a=e.type,o=e.data||null;for(var s in n.addEventListener("load",(function(){var t={};t[e.dataType]=n.response,r(n.status,n.statusText,t,n.getAllResponseHeaders())})),n.open(a,i,!0),n.responseType="blob",t)n.setRequestHeader(s,t[s]);n.send(o)},abort:function(){r.abort()}}}))}(t.Net2||(t.Net2={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=e.Base,n=r.Net2,i=new r.Diagnostics.Log("MsPortalFx/Base/Base.Debouncer"),a=[1,5,10,30,60],o=function(){function t(t,r,n,o,s){var u,c=n||0,l=(s=s||{}).optionalDataInterval||10*c+1,d=s.retryOnFailureWithBackoff,f=s.maxBatchSize||1e3;o=!!o;var p=!1,h=[],y=[],m=[],v=Q(),g=0,_=0,b=e.noop,x=function(e){u=setTimeout(b,e),_=g},E=s.shouldFlush?function(){return M()||s.shouldFlush(h,y)}:M,P=o?function(e,t){if(E())I(!0,!!t),g=_=0;else{var r=e||c;g=Date.now()+r,b=function(){if(u=0,g){var e=g-Date.now();e<=0?(I(!0,!!t),g=_=0):x(e)}},_>g&&(clearTimeout(u),u=0),u||x(r)}}:function(e,t){E()?I(!0,!!t):u||(u=setTimeout((function(){u=null,I(!0,!!t)}),e||c))};function S(){p||u&&!E()||P(l,!0)}function I(n,o,s){if(s=s||0,(h.length||o&&y.length)&&!p){var u=m;m=[];var c=t(y,h);h=[],y=[],p=!0,v=Q(r(c)).then((function(){u.forEach((function(e){var t;try{null===(t=e.resolve)||void 0===t||t.call(e)}catch(e){i.error(e)}}))}),(function(r){var l,f,y,v=null===(l=null==r?void 0:r.jqXHR)||void 0===l?void 0:l.status,g=function(){return h=t(c,h),m.unshift.apply(m,u),p=!1,I(!0,o,s+1)};if(d&&s<a.length&&([401,403,429].includes(v)||v>=500))return e.delay((f=s,y=Math.floor(Math.random()*(f+1))-f,60*(a[f]+y)*1e3)).then(g);if(n&&s<1)return g();if(u.forEach((function(e){var t;try{null===(t=e.reject)||void 0===t||t.call(e,r)}catch(e){i.error(e)}})),0!==v)throw i.error(r),r;i.warning("AjaxError with jqXHR status 0 (no network)")})).finally((function(){p=!1,P(void 0,void 0)}))}else y.length&&!p&&S();return v}function M(){return h.length+y.length>=f}this.execute=function(e,r,n,i){m.push({resolve:n,reject:i}),r?(y=t(y,e),S()):(h=t(h,e),p||P(void 0,void 0))},this.flush=function(){return h.length?Q(v).then((function(){return I(!1,!1)})):Q(v)}}return t.getMergeIntoArrayDataMerger=function(){return e.merge},t.getPostArrayExecutor=function(e){return function(t){var r,i;if(Array.isArray(t)&&t.length)i=JSON.stringify(t);else{if("string"!=typeof t)return;i=t}var a={contentType:"application/json",type:"POST",uri:e.uri,headers:e.headers,isBackgroundTask:!!e.isBackgroundTask,performRetry:e.performRetry,setAuthorizationHeader:null===(r=e.setAuthHeader)||void 0===r||r,skipTelemetry:!!e.skipTelemetry,data:i};return n.ajax(a)}},t}();t.Debouncer=o}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){var t,r=MsPortalFx.Base,n=MsPortalFx.Base.Debouncer,i=e.Base.Diagnostics,a={},o=new r.Diagnostics.Log("MsPortalFx/Base/Base.Debouncer"),s=e.features.isEnabled("selftoken"),u={};function c(e,t){var r="{",n=!1;for(var i in e){var a=e[i],o=MsPortalFx.notNullOrUndefined(a)&&t(i,a);o&&o[1]&&(n&&(r+=",")||(n=!0),r+=JSON.stringify(o[0])+":"+o[1])}return r+"}"}e.onEnvironmentSet((function(){u=e.features.value})),e.getStandardDebouncer=function(t){var r,a,u,l=0,d=t.interval||1e4,f=t.maxBatchSize||2e3,p=!!t.skipTelemetry,h=s&&t.setAuthorizationHeader,y=t.serializer||(r=t.sanitizeData,a=function(e){try{var t=typeof e,n=JSON.stringify(e,i.serializationPrivacyReplacer);return(r&&"string"===t||"object"===t)&&(n=i.sanitizeMessageFull(n)),n}catch(e){return'"_SERIALIZATION_ERROR_"'}},u=function(e){var t=MsPortalFx.getTypeOf(e);if("function"!==t)return"array"===t?function(e,t){for(var r="[",n=!1,i=0,a=e;i<a.length;i++){var o=a[i],s=void 0!==o&&t(o);s&&(n&&(r+=",")||(n=!0),r+=s)}return r+"]"}(e,a):a(e)},function(e){return MsPortalFx.isObject(e)?e.toJSON?a(e):c(e,(function(e,t){return[e,u(t)]})):u(e)});function m(e){var t;if(MsPortalFx.notNullOrUndefined(e))try{return y(e)}catch(e){o.warning("Error serializing entry",null,null===(t=e.stack)||void 0===t?void 0:t.slice(0,6e3))}}function v(e){return e&&e.length?e.reduce((function(e,t){return e+t.length}),e.length):0}var g,_=new n(n.getMergeIntoArrayDataMerger(),(g=t.uri,function(r){var i="[".concat(r.join(","),"]");return n.getPostArrayExecutor({uri:g,headers:e.getStandardHeaders(t.extensionName),isBackgroundTask:!l,performRetry:t.performRetry,setAuthHeader:h||!0,skipTelemetry:p})(i)}),d,!0,{maxBatchSize:f,shouldFlush:function(e,t){return v(e)+v(t)>=2e6},retryOnFailureWithBackoff:t.retryOnFailureWithBackoff});return{execute:function(e,t,r,n){_.execute(e.map(m).filter(MsPortalFx.notNullOrUndefined),t,r,n)},flush:function(){var e=_.flush();return Q.isPending(e)?(l++,Q(_.flush()).finally((function(){l--}))):Q(e)}}},e.getStandardHeaders=function(r,n){var i=MsPortalFx.getEnvironmentValue,o=!1===i("isShell"),s=i("pageVersion"),c=i("shellVersion"),l={"x-ms-version":n||"","x-ms-client-version":n||i("version"),"x-ms-client-query":t=t||JSON.stringify(MsPortalFx.extend2(u,a)),"x-ms-extension-name":r,"x-ms-sdk-version":i("sdkVersion"),"x-ms-shell-client-version":o?c:s,"x-ms-extension-client-version":s,"x-ms-time-zone-offset":(new Date).getTimezoneOffset()+""};return e.isDevelopmentMode&&(l["x-ms-client-settings"]="devmode"),l},e.topLevelStringifier=c,e.addQueryOverride=function(e){MsPortalFx.extend(a,e)}}(FxImpl||(FxImpl={})),function(e){!function(t){var r;(function(t){var r,n,i=MsPortalFx.Base,a=i.Constants,o=a.TelemetrySharing,s=i.Diagnostics,u=e.Base.Diagnostics,c=MsPortalFx.Errors.Error,l=i.QueryStringBuilder,d=Promise.resolve(),f=MsPortalFx.noop,p=e.Rpc.client,h=new s.Log("FxImpl.Base.Diagnostics.Metric"),y=a.Shell,m=Date.now,v=JSON.stringify,g=u.sanitizeMessageFull,_=MsPortalFx.forEachKey,b=MsPortalFx.isFeatureEnabled("consoletelemetry"),x=MsPortalFx.isFeatureEnabled("disableMetricDataMax"),E="Metric dimension was dropped due to exceeding the maximum recommended length of ".concat(1024," characters."),P=function(e){function t(t){e.forEach((function(e){try{t(e)}catch(e){h.error(e)}}))}var r=function(e){return!e||""!==e.name&&null!==e.name&&void 0!==e.name?!e||null!==e.value&&void 0!==e.value?!(e&&e.dimensions&&Object.keys(e.dimensions).length>5&&(h.error(new c("Metric event '".concat(e.name,"' contains more than ").concat(5," custom dimensions")),0,e),1)):(h.error(new c("Metric event value was not provided."),0,e),!1):(h.error(new c("Metric event name was not provided."),0,e),!1)};this.metricEventProcessors=e,this.record=function(e){var n=e.timestamp,i=function(e){var t=v(e.dimensions),r=void 0===t?void 0:JSON.parse(t),n={timestamp:m(),dimensions:r};return MsPortalFx.shallowCopyFromObject(n,e,["value","extension","name","dimensions","lowPriority"]),n}(e);i.timestamp=n||i.timestamp,function(e){r(e)&&t((function(t){t.record(e)}))}(i)},this.flush=function(){var e=[];return t((function(t){e.push(t.flush())})),Promise.allSettled(e)}},S={metricEventProcessors:[],record:f,flush:(r=d,function(){return r})};function I(e){S.record(e)}!function(t){t.initialize=function(t){var r=t.extensionName,n=t.processors,i=S.metricEventProcessors,a="";e.postBootEnv.thirdPartyExtension||(a=e.internalEnv.extensionMetricUri)||(a=e.ensureAbsoluteUri(MsPortalFx.getEnvironmentValue("metricUri","api/Metric")));var o=t.userQuery;if(o&&!a.includes("?")){var s=new l(o);s.removeParameters(["feature.msaljs","msaljsscript","feature.msaljslogin"]),a+=o=s.toString()}var u=n&&n.length?n.slice(0):[e.Services.getMetricEventProcessor(a,r)];if(b){var c=e.Services.getConsoleMetricEventProcessor();u.push(c)}return S=new P(u),i},t.getTelemetryPrivacySerializer=function(){var t=[];return function(r){return e.topLevelStringifier(r,(function(e,n){switch(e){case"value":case"extension":case"timestamp":return[e,v(n)];case"dimensions":try{return _(n,(function(e,t){!x&&t.length>1024?(t="EXCEEDED_MAX_LENGTH",n[e]=t,h.error(E,0,r)):t=g(t),n[e]=t})),[e,v(n,u.serializationPrivacyReplacer)]}catch(e){h.warning("Error serializing the metric data property",null,e,__assign(__assign({},r),{data:void 0}))}break;case"name":return[e,g(v(n))];case"lowPriority":break;default:!function(e,r){t.includes(e)||(t.push(e),h.warning("Unexpected property when serializing metric event: ".concat(e," with type ").concat(r)))}(e,typeof n)}}))}}}(n=t.Internal||(t.Internal={})),t.initialize=function(e){return n.initialize({extensionName:e})},t.registerForShellMetrics=function(e){p.invokeRpc(o.RegisterExtension,y,void 0),p.registerRpcEndPoint(o.TraceTelemetry,{allowedOrigin:[y],handler:function(t){e?e.record(t):I(t)}})},t.record=I,t.flush=function(){return S.flush()},t.addProcessor=function(e){S.metricEventProcessors.push(e)}})((r=t.Diagnostics||(t.Diagnostics={})).Metric||(r.Metric={}))}(e.Base||(e.Base={}))}(FxImpl||(FxImpl={})),function(e){!function(t){var r;(function(r){var n=e.Base,i=n.Constants,a=i.TelemetrySharing,o=e.isNullOrUndefined,s=n.Diagnostics,u=FxImpl.TelemetryContext,c=FxImpl.Base.Diagnostics,l=e.Errors.Error,d=Q(),f=e.noop,p=e.startTimer,h=FxImpl.Rpc.client,y=new s.Log("MsPortalFx.Base.Diagnostics.Telemetry"),m=i.Shell,v=Date.now,g=JSON.stringify,_=c.sanitizeMessageFull,b=e.isFeatureEnabled("consoletelemetry"),x=e.isFeatureEnabled("disableTelemetryDataMax"),E="Telemetry data length exceeded the maximum size of ".concat(15e3,"."),P="start",S="complete",I="reset",M="cancel",C="mark";!function(e){e.Start=P,e.Complete=S,e.Reset=I,e.Cancel=M,e.Mark=C}(r.ActionModifier||(r.ActionModifier={}));var w=function(e){var t={},r=1;function n(e){var t=u.getCurrentValues();o(t)||(e.context=t)}function i(t){e.forEach((function(e){try{t(e)}catch(e){y.error(e)}}))}var a=function(e){(function(e){return!(e&&e.duration&&(e.duration<0||e.duration>0xfffffffffffff800)&&(y.error(new l("Event duration is not in UInt64 range."),0,e),1))})(e)&&i((function(t){t.trace(e)}))};function s(e,t,r){var n=T(e._evt);return n.actionModifier=t,n.duration=n.duration||e._timer(),(r=r||a)(n),n.duration}function c(e){e._evt.duration=0,e._timer=p()}function d(e){return function(n){var i=T(n),a="telemetry_"+r++,o={_evt:i,_timer:null};return i.actionModifier=P,c(o),t[a]=o,e(i),a}}this.telemetryEventProcessors=e,this.trace=function(e){var t=e.timestamp,r=T(e);r.actionModifier=r.actionModifier||C,r.timestamp=t||r.timestamp,n(r),function(e){var t,r;o(e.name)&&(e.name=null===(r=null===(t=FxImpl.NetDiagnostics.getCurrentBladeInstance())||void 0===t?void 0:t.context)||void 0===r?void 0:r.id)}(r),a(r)},this.start=d(f),this.startTrace=d(a),this.endTrace=function(e,r,i){var u=t[e];if(u){"boolean"==typeof r&&(r=r?S:M);var c=s(u,r,(function(e){o(i)||(e.data=i),n(e),a(e)}));return delete t[e],c}},this.resetTrace=function(e){var r,n=t[e];n&&(s(r=n,I),c(r))},this.flush=function(){var e=[];return i((function(t){e.push(Q(t.flush()))})),e.every((function(e){return!Q.isPending(e)}))?Q():Q(Q.all(e))}};function F(e){return function(){return e}}var D,A={telemetryEventProcessors:[],trace:f,start:F(""),startTrace:F(""),endTrace:F(0),resetTrace:f,flush:F(d)};function k(e){A.trace(e)}function T(t){var r=g(t.data),n=void 0===r?void 0:JSON.parse(r),i={timestamp:v(),data:n};return e.shallowCopyFromObject(i,t,["source","action","actionModifier","assetType","context","duration","extension","name","journeyId","serviceTreeId","optional","lowPriority"]),i}!function(r){r.initialize=function(r){var n=r.extensionName,i=r.processors,a=A.telemetryEventProcessors,o="";FxImpl.postBootEnv.thirdPartyExtension||(o=FxImpl.internalEnv.extensionTelemetryUri,e.getEnvironmentValue("enablePortalLogging")&&o&&"localhost"!==window.location.hostname||(o=FxImpl.ensureAbsoluteUri(e.getEnvironmentValue("telemetryUri","api/Telemetry"))));var s=r.userQuery;if(s&&!o.includes("?")){var u=new t.QueryStringBuilder(s);u.removeParameters(["feature.msaljs","msaljsscript","feature.msaljslogin"]),o+=s=u.toString()}var c=i&&i.length?i.slice(0):[e.Services.getTelemetryEventProcessor(o,n)];if(b){var l=e.Services.getConsoleTelemetryEventProcessor();c.push(l)}return A=new w(c),a},r.getTelemetryPrivacySerializer=function(){var e=[];return function(t){return FxImpl.topLevelStringifier(t,(function(r,n){switch(r){case"duration":case"extension":case"timestamp":return[r,g(n)];case"data":var i=void 0;try{var a=(i=g(n,c.serializationPrivacyReplacer)).length;if(!x&&a>15e3){var o=i.slice(0,15e3);i=g(_(o)+" ... [truncated after 15KB]");var s=new l({message:E+" Please reduce the size of the telemetry event. See original event's details in 'json' field.",stack:"N/A"});y.error("".concat(E," (").concat(t.action,")"),null,s,{originalEvent:__assign(__assign({},t),{data:"<TRUNCATED>"}),serializedSize:a})}else i=_(i);return[r,i]}catch(e){y.warning("Error serializing the telemetry data property",null,e,__assign(__assign({},t),{data:void 0}))}break;case"action":case"actionModifier":case"source":case"name":case"serviceTreeId":case"journeyId":case"assetType":case"context":return[r,_(g(n))];case"optional":case"lowPriority":break;default:!function(t,r){e.includes(t)||(e.push(t),y.warning("Unexpected property when serializing telemetry event: ".concat(t," with type ").concat(r)))}(r,typeof n)}}))}}}(D=r.Internal||(r.Internal={})),r.initialize=function(e){return D.initialize({extensionName:e})},r.registerForShellTelemetry=function(e){h.invokeRpc(a.RegisterExtension,m,void 0),h.registerRpcEndPoint(a.TraceTelemetry,{allowedOrigin:[m],handler:function(t){e?e.trace(t):k(t)}})},r.trace=k,r.start=function(e){return A.start(e)},r.startTrace=function(e){return A.startTrace(e)},r.cancelTrace=function(e,t){return A.endTrace(e,!1,t)},r.completeTrace=function(e,t){return A.endTrace(e,!0,t)},r.endTrace=function(e,t,r){return A.endTrace(e,t,r)},r.resetTrace=function(e){A.resetTrace(e)},r.flush=function(){return Q(A.flush())},r.addProcessor=function(e){A.telemetryEventProcessors.push(e)}})((r=t.Diagnostics||(t.Diagnostics={})).Telemetry||(r.Telemetry={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){!function(e){!function(e){function t(e,t,r,n){t.activatedItems.subscribeArrayChanges(e,r,n)}function r(t,r,n){return function(i){e.trace(function(e,t,r){return $.extend({source:e,action:t},r)}(t,r,n(i)))}}e.addActivatedItemsWatcher=t,e.addActivatedItemsTelemetryWatcher=function(e,n,i,a,o,s){t(e,n,r(i,a,s),r(i,o,s))}}(e.Telemetry||(e.Telemetry={}))}(e.Diagnostics||(e.Diagnostics={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){!function(t){!function(t){var r,n=e.Base.Diagnostics.Log;function i(t){t?(r=FxImpl.getStandardDebouncer({uri:FxImpl.ensureAbsoluteUri(t),skipTelemetry:!0,extensionName:e.getEnvironmentValue("extensionName"),sanitizeData:!0,setAuthorizationHeader:{resourceName:"telemetryToken"},retryOnFailureWithBackoff:!0}),n._setBufferFullCallback((function(e){return r.execute(e),[]}))):n._setBufferFullCallback((function(){return[]}))}t.initialize=i,t.upload=function(){},t.flush=function(){return n.flush(),r?r.flush():Q()},FxImpl.onEnvironmentSet((function(e){if(!FxImpl.postBootEnv.thirdPartyExtension){var t=FxImpl.internalEnv.extensionTraceUri;e("enablePortalLogging")&&t&&"localhost"!==window.location.hostname||(t=e("clientTraceUri","api/ClientTrace")),i(t)}}))}(t.Upload||(t.Upload={}))}(t.Diagnostics||(t.Diagnostics={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r,n,i,a,o,s,u,c="Hex_",l=6;!function(e){e[e.Hex_fcd116=0]="Hex_fcd116",e[e.Hex_eb3c00=1]="Hex_eb3c00",e[e.Hex_ba141a=2]="Hex_ba141a",e[e.Hex_b4009e=3]="Hex_b4009e",e[e.Hex_442359=4]="Hex_442359",e[e.Hex_002050=5]="Hex_002050",e[e.Hex_0072c6=6]="Hex_0072c6",e[e.Hex_008272=7]="Hex_008272",e[e.Hex_007233=8]="Hex_007233",e[e.Hex_7fba00=9]="Hex_7fba00",e[e.Hex_a0a5a8=10]="Hex_a0a5a8",e[e.Hex_fff100=11]="Hex_fff100",e[e.Hex_ff8c00=12]="Hex_ff8c00",e[e.Hex_e81123=13]="Hex_e81123",e[e.Hex_ec008c=14]="Hex_ec008c",e[e.Hex_68217a=15]="Hex_68217a",e[e.Hex_00188f=16]="Hex_00188f",e[e.Hex_00bcf2=17]="Hex_00bcf2",e[e.Hex_00b294=18]="Hex_00b294",e[e.Hex_009e49=19]="Hex_009e49",e[e.Hex_bad80a=20]="Hex_bad80a",e[e.Hex_bbc2ca=21]="Hex_bbc2ca",e[e.Hex_fffc9e=22]="Hex_fffc9e",e[e.Hex_ffb900=23]="Hex_ffb900",e[e.Hex_dd5900=24]="Hex_dd5900",e[e.Hex_f472d0=25]="Hex_f472d0",e[e.Hex_9b4f96=26]="Hex_9b4f96",e[e.Hex_4668c5=27]="Hex_4668c5",e[e.Hex_6dc2e9=28]="Hex_6dc2e9",e[e.Hex_00d8cc=29]="Hex_00d8cc",e[e.Hex_55d455=30]="Hex_55d455",e[e.Hex_e2e584=31]="Hex_e2e584",e[e.Hex_d6d7d8=32]="Hex_d6d7d8",e[e.Hex_807900=33]="Hex_807900",e[e.Hex_804600=34]="Hex_804600",e[e.Hex_740912=35]="Hex_740912",e[e.Hex_760046=36]="Hex_760046",e[e.Hex_34113d=37]="Hex_34113d",e[e.Hex_000c48=38]="Hex_000c48",e[e.Hex_005e79=39]="Hex_005e79",e[e.Hex_084c41=40]="Hex_084c41",e[e.Hex_063d20=41]="Hex_063d20",e[e.Hex_3d460a=42]="Hex_3d460a",e[e.Hex_32383f=43]="Hex_32383f",e[e.Hex_bfb500=44]="Hex_bfb500",e[e.Hex_bf6900=45]="Hex_bf6900",e[e.Hex_ae0d1a=46]="Hex_ae0d1a",e[e.Hex_b10069=47]="Hex_b10069",e[e.Hex_4e195c=48]="Hex_4e195c",e[e.Hex_00126b=49]="Hex_00126b",e[e.Hex_008db5=50]="Hex_008db5",e[e.Hex_00856f=51]="Hex_00856f",e[e.Hex_0f5b2f=52]="Hex_0f5b2f",e[e.Hex_8ba208=53]="Hex_8ba208",e[e.Hex_464f59=54]="Hex_464f59",e[e.Hex_fcf37e=55]="Hex_fcf37e",e[e.Hex_ffba66=56]="Hex_ffba66",e[e.Hex_f1707b=57]="Hex_f1707b",e[e.Hex_f466ba=58]="Hex_f466ba",e[e.Hex_a47aaf=59]="Hex_a47aaf",e[e.Hex_6674bc=60]="Hex_6674bc",e[e.Hex_66d7f7=61]="Hex_66d7f7",e[e.Hex_66d1bf=62]="Hex_66d1bf",e[e.Hex_66c592=63]="Hex_66c592",e[e.Hex_d6e86c=64]="Hex_d6e86c",e[e.Hex_8f9ca8=65]="Hex_8f9ca8",e[e.Hex_fffccc=66]="Hex_fffccc",e[e.Hex_ffe8cc=67]="Hex_ffe8cc",e[e.Hex_facfd3=68]="Hex_facfd3",e[e.Hex_fbcce8=69]="Hex_fbcce8",e[e.Hex_e1d3e4=70]="Hex_e1d3e4",e[e.Hex_ccd1e9=71]="Hex_ccd1e9",e[e.Hex_ccf2fc=72]="Hex_ccf2fc",e[e.Hex_ccf0ea=73]="Hex_ccf0ea",e[e.Hex_ccecdb=74]="Hex_ccecdb",e[e.Hex_f0f7b2=75]="Hex_f0f7b2",e[e.Hex_63707e=76]="Hex_63707e",e[e.max=77]="max"}(r=t.AllRawColorCode||(t.AllRawColorCode={})),function(e){e[e.a1=0]="a1",e[e.b1=1]="b1",e[e.c1=2]="c1",e[e.d1=3]="d1",e[e.e1=4]="e1",e[e.f1=5]="f1",e[e.g1=6]="g1",e[e.h1=7]="h1",e[e.i1=8]="i1",e[e.j1=9]="j1",e[e.k1=10]="k1",e[e.a0=11]="a0",e[e.b0=12]="b0",e[e.c0=13]="c0",e[e.d0=14]="d0",e[e.e0=15]="e0",e[e.f0=16]="f0",e[e.g0=17]="g0",e[e.h0=18]="h0",e[e.i0=19]="i0",e[e.j0=20]="j0",e[e.k0=21]="k0",e[e.a2=22]="a2",e[e.b2=23]="b2",e[e.c2=24]="c2",e[e.d2=25]="d2",e[e.e2=26]="e2",e[e.f2=27]="f2",e[e.g2=28]="g2",e[e.h2=29]="h2",e[e.i2=30]="i2",e[e.j2=31]="j2",e[e.k2=32]="k2",e[e.a0s2=33]="a0s2",e[e.b0s2=34]="b0s2",e[e.c0s2=35]="c0s2",e[e.d0s2=36]="d0s2",e[e.e0s2=37]="e0s2",e[e.f0s2=38]="f0s2",e[e.g0s2=39]="g0s2",e[e.h0s2=40]="h0s2",e[e.i0s2=41]="i0s2",e[e.j0s2=42]="j0s2",e[e.k0s2=43]="k0s2",e[e.a0s1=44]="a0s1",e[e.b0s1=45]="b0s1",e[e.c0s1=46]="c0s1",e[e.d0s1=47]="d0s1",e[e.e0s1=48]="e0s1",e[e.f0s1=49]="f0s1",e[e.g0s1=50]="g0s1",e[e.h0s1=51]="h0s1",e[e.i0s1=52]="i0s1",e[e.j0s1=53]="j0s1",e[e.k0s1=54]="k0s1",e[e.a0t1=55]="a0t1",e[e.b0t1=56]="b0t1",e[e.c0t1=57]="c0t1",e[e.d0t1=58]="d0t1",e[e.e0t1=59]="e0t1",e[e.f0t1=60]="f0t1",e[e.g0t1=61]="g0t1",e[e.h0t1=62]="h0t1",e[e.i0t1=63]="i0t1",e[e.j0t1=64]="j0t1",e[e.k0t1=65]="k0t1",e[e.a0t2=66]="a0t2",e[e.b0t2=67]="b0t2",e[e.c0t2=68]="c0t2",e[e.d0t2=69]="d0t2",e[e.e0t2=70]="e0t2",e[e.f0t2=71]="f0t2",e[e.g0t2=72]="g0t2",e[e.h0t2=73]="h0t2",e[e.i0t2=74]="i0t2",e[e.j0t2=75]="j0t2",e[e.k0t2=76]="k0t2",e[e.max=77]="max"}(n=t.ColorCode||(t.ColorCode={}));var d=11,f=[n.a0,n.a1,n.b2,n.b0,n.c2,n.b1,n.c0,n.c1,n.d0,n.d1,n.e2,n.e0,n.e1,n.f1,n.f0,n.g1,n.g0,n.g2,n.h2,n.h0,n.h1,n.i1,n.i0,n.i2,n.j1,n.j0,n.j2],p=[n.g0,n.f0,n.e0,n.h0,n.i0,n.j0,n.a1,n.b1,n.c1,n.d1,n.e1,n.f1,n.g1,n.h1,n.i1,n.j1,n.b2,n.c2,n.e2,n.g2,n.h2,n.i2,n.j2,n.a0,n.b0,n.c0,n.d0],h={0:[n.a0s2,n.a0s1,n.a0,n.a0t1,n.a0t2],1:[n.b0s2,n.b0s1,n.b0,n.b0t1,n.b0t2],2:[n.c0s2,n.c0s1,n.c0,n.c0t1,n.c0t2],3:[n.d0s2,n.d0s1,n.d0,n.d0t1,n.d0t2],4:[n.e0s2,n.e0s1,n.e0,n.e0t1,n.e0t2],5:[n.f0s2,n.f0s1,n.f0,n.f0t1,n.f0t2],6:[n.g0s2,n.g0s1,n.g0,n.g0t1,n.g0t2],7:[n.h0s2,n.h0s1,n.h0,n.h0t1,n.h0t2],8:[n.i0s2,n.i0s1,n.i0,n.i0t1,n.i0t2],9:[n.j0s2,n.j0s1,n.j0,n.j0t1,n.j0t2],10:[n.k0s2,n.k0s1,n.k0,n.k0t1,n.k0t2]};function y(t){var n=r[t];return e.isNullOrUndefined(n)?null:"#"+n.slice(c.length)}function m(e){return n[e]}function v(e){var t=e.length,r=c.length;if(t===l)return e;if(t===l+1){if(e.startsWith("#"))return e.slice(1)}else if(t===l+r&&e.startsWith(c))return e.slice(r);return null}function g(t){var n=v(t);if(!e.isNullOrUndefined(n)){var i=r[c+n];if(!e.isNullOrUndefined(i))return i}return null}function _(t){return e.isNullOrUndefined(t)?0:t.length>=l?g(t):n[t]}function b(e){return h[e%=d]}function x(t,r){var n=new Array(t&&t.length),i=t.length,a=e.isNullOrUndefined(r)?0:r;if(r){for(var o=0;o<i;o++)n[o]=t[(o+a)%i];return n}return t}function E(e){return x(f,e)}function P(e){return x(p,e)}t.getRawColorString=y,t.getColorCodeString=m,t.getRawColorCode=v,t.getRawColorIndex=g,t.getColorIndex=_,t.getColorCodeTintSet=function(t,r){var n=_(t);if(!e.isNullOrUndefined(n)){var i=b(n);return r?i.map(y):i.map(m)}return null},t.getColorCodeTintSetIndex=b,t.getAllColorCodeIndexes=function(){if(e.isNullOrUndefined(u)){var t=0;for(u=new Array(33),t=0;t<u.length;t++)u[t]=t}return u},t.getRotatedArray=x,t.getGradientColorCodeIndexes=E,t.getRainbowColorCodeIndexes=P,t.getGradientColorCode=function(t){return e.isNullOrUndefined(i)&&(i=E().map(m)),x(i,t)},t.getRawGradientColorCode=function(t){return e.isNullOrUndefined(a)&&(a=E().map(y)),x(a,t)},t.getRainbowColorCode=function(t){return e.isNullOrUndefined(o)&&(o=P().map(m)),x(o,t)},t.getRawRainbowColorCode=function(t){return e.isNullOrUndefined(s)&&(s=P().map(y)),x(o,t)}}(e.ColorUtil||(e.ColorUtil={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=e.initObservable,n=function(e,t){this.startDateTime=r(e,null),this.endDateTime=r(t,null)};t.DateTimeRange=n}(e.DateUtil||(e.DateUtil={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=void 0,n=e.Resources.Strings.UnitConversion,i=1e-4,a=1e-5,o={dividend:1,divisor:1},s=86400,u=[{dividend:1,divisor:Math.pow(10,6)},{dividend:1,divisor:Math.pow(10,3)},o,{dividend:60,divisor:1},{dividend:3600,divisor:1},{dividend:s,divisor:1},{dividend:604800,divisor:1},{dividend:2592e3,divisor:1}],c=u.indexOf(o),l=FxImpl.UnitConversionUtil.higherByteOffset,d=3,f=FxImpl.UnitConversionUtil.perTimeBit,p=[function(e){return{dividend:Math.pow(10,3*e),divisor:1}},function(e){return{dividend:Math.pow(2,10*e),divisor:1}},function(e){return u[e]}].map((function(e){return u.map((function(t,r){return e(r)}))})),h={},y={},m={},v=FxImpl.UnitConversionUtil.UnitType;function g(e){return{original:e,unitType:e>>l,index:127&e,perTime:!!(e&f)}}var _=e.getEnumArray,b=_(v,!0),x=_(t.Unit).map((function(e){return g(e.value)})),E=b.map((function(e){return 0===e.value?[]:x.filter((function(t){return t.unitType===e.value})).map((function(e){return e.original})).sort((function(e,t){return e-t}))}));function P(e,t,r){var n=p[e],i=n[t],a=n[r];return{dividend:a.dividend*i.divisor,divisor:a.divisor*i.dividend}}function S(e,t){var r=function(e,t){var r,n=null,i=!1;if(e===t)return o;if(r=function(e,t){var r=h[e];if(r)return r[t];return null}(e,t),r)return r;var a=g(e),s=g(t);if(a.unitType===s.unitType){switch(s.unitType){case v.DecimalPerTime:i=!0;case v.Decimal:n=0;break;case v.BytesPerTime:i=!0;case v.Bytes:n=1;break;case v.BytesPerTime_SI:i=!0;case v.Bytes_SI:n=0;break;case v.Time:n=2;case v.None:}if(null!==n)return I(e,t,r=i?function(e,t,r){var n=t.index-d,i=r.index-d,a=Math.max(0,n),o=Math.max(0,i),s=-Math.min(0,n),u=-Math.min(0,i),l=P(e,a,o),f=P(2,u+c,s+c);return{dividend:l.dividend*f.dividend,divisor:l.divisor*f.divisor}}(n,a,s):P(n,a.index,s.index)),I(t,e,{dividend:r.divisor,divisor:r.dividend}),r}throw"Not supported: conversion from unit "+e+"("+M(e)+") to unit "+t+"("+M(t)+") is not supported."}(e,t);return r.dividend/r.divisor}function I(e,t,r){var n=h[e];n||(n=h[e]={}),n[t]=r}function M(e,t){var n;return!0===t?(n=m[e])===r&&(n=m[e]=C(e,!0)):(n=y[e])===r&&(n=y[e]=C(e,!1)),n}function C(e,r){switch(e){case t.Unit.Count:return"";case t.Unit.Thousand:return n.thousand;case t.Unit.Million:return n.million;case t.Unit.Billion:return n.billion;case t.Unit.Trillion:return n.trillion;case t.Unit.Bytes:case t.Unit.Bytes_SI:return n.bytes;case t.Unit.Kilobytes:return r?n.kilobytesSI:n.kilobytes;case t.Unit.Kilobytes_SI:return n.kilobytesSI;case t.Unit.Megabytes:return r?n.megabytesSI:n.megabytes;case t.Unit.Megabytes_SI:return n.megabytesSI;case t.Unit.Gigabytes:return r?n.gigabytesSI:n.gigabytes;case t.Unit.Gigabytes_SI:return n.gigabytesSI;case t.Unit.Terabytes:return r?n.terabytesSI:n.terabytes;case t.Unit.Terabytes_SI:return n.terabytesSI;case t.Unit.Petabytes:return r?n.petabytesSI:n.petabytes;case t.Unit.Petabytes_SI:return n.petabytesSI;case t.Unit.BytesPerDay:case t.Unit.BytesPerDay_SI:return n.bytesPerDay;case t.Unit.BytesPerHour:case t.Unit.BytesPerHour_SI:return n.bytesPerHour;case t.Unit.BytesPerMinute:case t.Unit.BytesPerMinute_SI:return n.bytesPerMinute;case t.Unit.BytesPerSecond:case t.Unit.BytesPerSecond_SI:return n.bytesPerSecond;case t.Unit.KilobytesPerSecond:return r?n.kilobytesPerSecondSI:n.kilobytesPerSecond;case t.Unit.KilobytesPerSecond_SI:return n.kilobytesPerSecondSI;case t.Unit.MegabytesPerSecond:return r?n.megabytesPerSecondSI:n.megabytesPerSecond;case t.Unit.MegabytesPerSecond_SI:return n.megabytesPerSecondSI;case t.Unit.GigabytesPerSecond:return r?n.gigabytesPerSecondSI:n.gigabytesPerSecond;case t.Unit.GigabytesPerSecond_SI:return n.gigabytesPerSecondSI;case t.Unit.TerabytesPerSecond:return r?n.terabytesPerSecondSI:n.terabytesPerSecond;case t.Unit.TerabytesPerSecond_SI:return n.terabytesPerSecondSI;case t.Unit.PetabytesPerSecond:return r?n.petabytesPerSecondSI:n.petabytesPerSecond;case t.Unit.PetabytesPerSecond_SI:return n.petabytesPerSecondSI;case t.Unit.CountPerDay:return n.countPerDay;case t.Unit.CountPerHour:return n.countPerHour;case t.Unit.CountPerMinute:return n.countPerMinute;case t.Unit.CountPerSecond:return n.countPerSecond;case t.Unit.ThousandPerSecond:return n.thousandPerSecond;case t.Unit.MillionPerSecond:return n.millionPerSecond;case t.Unit.BillionPerSecond:return n.billionPerSecond;case t.Unit.TrillionPerSecond:return n.trillionPerSecond;case t.Unit.MicroSeconds:return n.microSeconds;case t.Unit.MilliSeconds:return n.milliSeconds;case t.Unit.Seconds:return n.seconds;case t.Unit.Minutes:return n.minutes;case t.Unit.Hours:return n.hours;case t.Unit.Days:return n.days;case t.Unit.Percentage:return n.percentage;default:return""}}t.getAppropriateUnit=function(t,r,n){return $.isNumeric(t)?function(t,r,n){var o,s,u,c,l=g(r),d=r,f=t,p=e.isNullOrUndefined(n)?r:n;if(l.unitType>0&&(s=(o=E[l.unitType]).indexOf(r),c=(u=t>1?1:-1)>0?o.length-1:0,1!==t)){for(;s!==c;){if(f=t/S(r,o[s+u])+a,u>0){if(f<1)break}else if(f>=1){s+=u;break}s+=u}d=o[s],u<0&&0===s&&f<i&&(d=p)}return d}(Math.abs(t),r,n):r},t.getConversionFactor=S,t.toString=M}(e.UnitConversionUtil||(e.UnitConversionUtil={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r,n=e.UnitConversionUtil,i=e.isNullOrUndefined,a=FxImpl.Intl.NumberFormat.create,o="{0} {1}";function s(e,t,r){var a=i(r)?null:d(r);return f(n.getAppropriateUnit(e,d(t),a))}function u(e,t){return n.getConversionFactor(d(e),d(t))}function c(e,t){return n.toString(d(e),t)}function l(e,t,r,n,s,l,d){var f=s||o,p=n||{minimumFractionDigits:0,maximumFractionDigits:2},h=u(t,r),y=r,m="";return 0===e?(m=a(p).format(e),y=i(l)?r:l):h&&(m=a(p).format(e/h)),f.format(m,c(y,d))}function d(e){return n.Unit[r[e]]}function f(e){return r[n.Unit[e]]}!function(e){e[e.None=0]="None",e[e.Percentage=1]="Percentage",e[e.Bytes=2]="Bytes",e[e.Kilobytes=3]="Kilobytes",e[e.Megabytes=4]="Megabytes",e[e.Gigabytes=5]="Gigabytes",e[e.Terabytes=6]="Terabytes",e[e.Petabytes=7]="Petabytes",e[e.BytesPerDay=8]="BytesPerDay",e[e.BytesPerHour=9]="BytesPerHour",e[e.BytesPerMinute=10]="BytesPerMinute",e[e.BytesPerSecond=11]="BytesPerSecond",e[e.KilobytesPerSecond=12]="KilobytesPerSecond",e[e.MegabytesPerSecond=13]="MegabytesPerSecond",e[e.GigabytesPerSecond=14]="GigabytesPerSecond",e[e.TerabytesPerSecond=15]="TerabytesPerSecond",e[e.PetabytesPerSecond=16]="PetabytesPerSecond",e[e.Count=17]="Count",e[e.Thousand=18]="Thousand",e[e.Million=19]="Million",e[e.Billion=20]="Billion",e[e.Trillion=21]="Trillion",e[e.MicroSeconds=22]="MicroSeconds",e[e.MilliSeconds=23]="MilliSeconds",e[e.Seconds=24]="Seconds",e[e.Minutes=25]="Minutes",e[e.Hours=26]="Hours",e[e.Days=27]="Days",e[e.CountPerDay=28]="CountPerDay",e[e.CountPerHour=29]="CountPerHour",e[e.CountPerMinute=30]="CountPerMinute",e[e.CountPerSecond=31]="CountPerSecond",e[e.ThousandPerSecond=32]="ThousandPerSecond",e[e.MillionPerSecond=33]="MillionPerSecond",e[e.BillionPerSecond=34]="BillionPerSecond",e[e.TrillionPerSecond=35]="TrillionPerSecond",e[e.Bytes_SI=36]="Bytes_SI",e[e.Kilobytes_SI=37]="Kilobytes_SI",e[e.Megabytes_SI=38]="Megabytes_SI",e[e.Gigabytes_SI=39]="Gigabytes_SI",e[e.Terabytes_SI=40]="Terabytes_SI",e[e.Petabytes_SI=41]="Petabytes_SI",e[e.BytesPerDay_SI=42]="BytesPerDay_SI",e[e.BytesPerHour_SI=43]="BytesPerHour_SI",e[e.BytesPerMinute_SI=44]="BytesPerMinute_SI",e[e.BytesPerSecond_SI=45]="BytesPerSecond_SI",e[e.KilobytesPerSecond_SI=46]="KilobytesPerSecond_SI",e[e.MegabytesPerSecond_SI=47]="MegabytesPerSecond_SI",e[e.GigabytesPerSecond_SI=48]="GigabytesPerSecond_SI",e[e.TerabytesPerSecond_SI=49]="TerabytesPerSecond_SI",e[e.PetabytesPerSecond_SI=50]="PetabytesPerSecond_SI"}(r=t.Unit||(t.Unit={})),t.getAppropriateUnit=s,t.getConversionFactor=u,t.toString=c,t.getConvertedValue=function(e,t,r,n,i,a){return l(e,t,s(e,t,i),r,n,i,a)},t.getConvertedValueForTargetUnit=l,t._convertUnitToInternalConversionUnit=d,t._convertInternalConversionUnitToUnit=f}(e.UnitConversion||(e.UnitConversion={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){!function(t){var r=e.isObject,n=e.isUndefined,i="aux-type",a={};function o(e){return"string"==typeof e}function s(e,t){var r=e.name;return e&&t[r.namespaceIndex]+"."+r.name}function u(e){return e?a[e]:null}function c(e,t){var r=d(e,t);return r&&r.itemType||null}function l(e,t){return u(c(e,t))}function d(e,t){var r=o(e)?u(e):e,n=r&&r.properties;return n&&n[t]}function f(e,t){var r=d(e,t);return!(!r||!r.isArray)}function p(e){var t=[],r=e&&e.properties;if(r)for(var n in r)r.hasOwnProperty(n)&&t.push(n);return t}function h(e){var r=o(e)?t.getTypeMetadata(e):e;return r&&r.idProperties||null}function y(e){return h(e)}function m(e,t,n){if(t)if(Array.isArray(ko.unwrap(e)))n.visitArray&&n.visitArray(e,t),ko.unwrap(e).forEach((function(e){m(e,t,n)}));else if(r(e))for(var i in e)e.hasOwnProperty(i)&&m(e[i],c(t,i),n)}function v(t,r){r&&!r.name&&((r=e.clone(r)).name=t),a[t]=r}function g(e,t){return void 0===e?t:e}t.getTypeMetadata=u,t.getPropertyType=c,t.getPropertyTypeMetadata=l,t.getPropertyMetadata=d,t.getPropertyCardinality=f,t.getProperties=p,t.typeHasId=function(e){var t=h(e);return t&&t.length>0},t.getItemId=function(e,r){for(var i,a,s=y(o(r)?t.getTypeMetadata(r):r),u=[],c=0,l=s.length;c<l;c++){if(i=s[c],a=ko.unwrap(e[i]),n(a))return;null===a&&(a="NULL-VALUED-ID-PROPERTY"),u.push(a)}return u.join(",")},t.getIdPropertyNames=y,t.decorateWithType=function(e,t){m(e,t,{visitArray:function(e,t){$.data(e,i,t)}})},t.visitTypedData=m,t.getArrayItemType=function(e){return $.data(e,i)},t.createEmptyObject=function e(t){var r=o(t)?a[t]:t,n={};return r&&p(r).forEach((function(t){var i=l(r,t);if(f(r,t))n[t]=ko.observableArray();else if(!i||i.entityType)n[t]=ko.observable();else{if(!i.name)throw new Error("Cannot create entity.");n[t]=ko.observable(e(i.name))}})),n},t.typeIsEntityType=function(e){return e&&e.entityType},t.setTypeMetadata=v,t.setTypesMetadata=function(e){var t=e.namespaces,r=e.metadata,i=r.map((function(e){var i={};!function(e){for(var t=(e+"Type").split("."),r=window,i=t.length,a=i-1,o=0;o<i;o++){var s=t[o],u=r[s];if(o===a){if(u!==e){if(!n(u))throw new Error("Cannot create namespace for '".concat(e,"' because it already exists."));r[s]=e}}else if("object"!=typeof u){if(!n(u))throw new Error("Cannot create namespace for '".concat(e,"' at the segment '").concat(s,"' because it already exists."));u={},r[s]=u}r=u}}(s(e,t));var a=e.properties;for(var o in a){var u=a[o],c=g(u.typeIndex,-1);i[o]={isArray:!!g(u.isArray,!1),isDate:!!g(u.isDate,!1),itemType:-1===c?null:s(r[c],t),trackEdits:!!g(u.trackEdits,!0),persistEdits:!!g(u.persistEdits,!0)}}return{name:s(e,t),properties:i,idProperties:e.idProperties,entityType:e.entityType,hasGloballyUniqueId:e.hasGloballyUniqueId}})),a=e.rootTypeIndex;return i.forEach((function(e){v(e.name,e)})),"number"==typeof a&&a>=0&&i[a]||null},function(e){e.clearAllTypesMetadata=function(){a={}}}(t.Internal||(t.Internal={}))}(t.Metadata||(t.Metadata={}))}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){!function(e){e[e.Unsorted=0]="Unsorted",e[e.Ascending=1]="Ascending",e[e.Descending=2]="Descending"}(e.SortOrder||(e.SortOrder={}))}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r="This callback is already registered.",n=function(){function t(e){this._resetListeners=[],this._partialErrors=e||ko.observableArray()}return Object.defineProperty(t.prototype,"partialErrors",{get:function(){return this._partialErrors},enumerable:!1,configurable:!0}),t.prototype.resetNavigation=function(){var e=this._resetListeners.map((function(e){return e()}));return Promise.all(e)},t.prototype.addResetNavigationListener=function(e){if(this._resetListeners.includes(e))throw new Error(r);this._resetListeners.push(e)},t.prototype.removeResetNavigationListener=function(e){var t=this._resetListeners.indexOf(e);if(t<0)throw new Error(r);this._resetListeners.splice(t,1)},t=__decorate([__metadata("fx:diagnostics",[require,"DataNavigatorBase"]),e.Composition.ProxyCompatibilityMode,__metadata("design:paramtypes",[Function])],t)}();t.DataNavigatorBase=n}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){e.ArgBrowseFeatureValueToEnumMap={forceoptin:2,force:3,forcenoarmfallback:3,disable:4},e.RemappedArgBrowseFeatureValueToEnumMap={allowoptin:{mappedOption:2,mappedOptionString:"ForceOptIn"}},e.ArgBrowseFeatureValueToFallbackEnumMap={allowoptin:0,forceoptin:0,force:0,forcenoarmfallback:1,disable:0}}(e.Extension||(e.Extension={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){!function(e){e[e.All=0]="All",e[e.Any=1]="Any"}(e.SetRequirement||(e.SetRequirement={}))}(e.Extension||(e.Extension={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){!function(t){var r=FxImpl.Rpc.client;t.registerCallback=function(e,t,n){var i=n&&n.allowedOrigins;return r.registerRpcEndPoint(e,{allowedOrigin:i,handler:function(e){return t.apply(null,e)}})},t.invokeCallback=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return Q(r.invokeRpc(t,e,n))},function(t){t.Decorator=function(t){return function(r){e.require("FxInternal/Events").then((function(e){e.registerEventHandler(t,r)}))}}}(t.EventHandler||(t.EventHandler={}))}(t.Rpc||(t.Rpc={}))}(e.Services||(e.Services={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=e.initObservable,n=function(e,t,n,i,a){this.uri=r(e),this.target=r(t,"_blank"),this.windowFeatures=r(n),this.onLinkOpened=i,this.telemetryName=a,FxImpl.logObsoleteAPI("MsPortalFx.ViewModels.ClickableLink","Fx/Composition ClickableLink")};t.ClickableLink=n}(e.ViewModels||(e.ViewModels={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){var t=function(e,t,r){this.partName=e,this.parameters=t,this.options=r||{}};e.PartReference=t;var r=function(){};e.ResourcePartReference=r}(e.Composition||(e.Composition={}))}(MsPortalFx||(MsPortalFx={})),function(e){var t,r={supplyConflict:"",recieveConflict:"",syncConflict:"",supplyBladeConflict:""},n=MsPortalFx.initObservable,i=e.getErrorMap(r);function a(e,t){var r="_msPortalFxShell";return t?e[r]=t:t=e[r],t}e.shellInterface=a,function(e){var t=function(e,t,r,i,a){this.uri=n(e),this.target=n(t,"_blank"),this.windowFeatures=n(r),this.onLinkOpened=i,this.telemetryName=a};e.ClickableLink=t}(e.CompositionCore||(e.CompositionCore={})),function(t){!function(t){var r=function(){function e(e,t){this.parameters=e,this._msPortalFxCallbacks=t}return e.prototype.clone=function(t){return new e(t,this._msPortalFxCallbacks)},e}();t.BladeReference=r;var n=function(e){function t(t,r,n,i){var a=this,o=n&&n.parameters,s=n&&n.callbacks;return(a=e.call(this,o,s)||this).bladeName=t,a.extensionName=r,a.options=n,a.metadata=i,a}return __extends(t,e),t}(r);t.PdlBladeReference=n;var o=function(e){function t(t,r,n,i,o){var s=e.call(this,t,r,i,o)||this;if(function(e){return"string"!=typeof e&&"assetType"in(e||{})}(n))return a(s,{type:19792,createAssetTypeOptions:n}),s;if(function(e){return!("string"!=typeof e&&"id"in(e||{}))}(n))return a(s,{type:19792,marketplaceOptions:{id:n,launchingContext:void 0}}),s;var u=n.launchingContext,c=n.id,l=n.alternateCreateFlowOptions,d=__rest(n,["launchingContext","id","alternateCreateFlowOptions"]);return a(s,{type:19792,marketplaceOptions:__assign({id:c,launchingContext:u,alternateCreateFlowOptions:l},d)}),s}return __extends(t,e),t}(n);t.ProvisioningBladeReference=o;var s=function(e){function t(t,r,n,i,a){var o=e.call(this,t,n,i,a)||this;return o.menuId=r,o.contentBladeReference=i&&i.contentBladeReference,o}return __extends(t,e),t}(n);t.MenuBladeReference=s;var u=function(t){function r(r,n,o,s){var u=t.call(this,r,n,o,s)||this;o.editScopeAccessor?(o.receiveResult||o.supplyInitialData)&&i.supplyConflict():o.receiveResult||i.recieveConflict();var c=ko.observable();function l(t){var r=new e.TriggerableLifetimeManager;t(o.editScopeAccessor.getEditableObservable(r)),r.dispose()}return a(u,{type:20560,bladeConfig:c,getBladeConfig:function(e){var t=null;o.supplyInitialData?t=o.supplyInitialData():o.editScopeAccessor&&l((function(e){t=e()}));var r={config:o.supplyProviderConfig?o.supplyProviderConfig():void 0,initialState:t};return c(r),r},receiveResult:function(e){o.receiveResult?o.receiveResult(e):l((function(t){t(e)}))}}),u}return __extends(r,t),r}(n);t.ParameterProviderBladeReference=u;var c=function(){};t.SelectableBase=c;var l=function(e){function t(t){var r=e.call(this)||this,n=t.supplyBladeReference,o=t.supplyBladeReferenceAsync,s=ko.observable();function u(e,t){var r=function(e,t,r,n){return{timestamp:r,reason:e,flags:0,bladeReference:t,operationId:n||MsPortalFx.getUniqueId()}}(1,e,t);return r}return n||o||i.syncConflict(),n&&o&&i.supplyBladeConflict(),a(r,{type:21298,flags:1,fetchRequest:n?function(e){var t=n();return s(t),u(t,e)}:function(e){return Q(o()).then((function(t){return s(t),u(t,e)}))},currentBladeReference:s}),r}return __extends(t,e),t}(c);t.Selectable2=l}(t.Selectable||(t.Selectable={}))}(t=e.Composition||(e.Composition={}));var o=t.Selectable;function s(e,t){var r=e;if(r&&!0===r._msPortalFxIsSelectableViewModel){var n=!!r._msPortalFxSelectable2;return t?n:!!r._msPortalFxSelectable||n}return!1}e.BladeReference=o.BladeReference,e.initializeSelectableViewModel=function(e,t){var r=e;r._msPortalFxIsSelectableViewModel=!0,t&&(r._msPortalFxSelectable=t),e.configureSelectable=u.configureSelectable.bind(e)},e.assignSelectable=function(e,t){e._msPortalFxSelectable=t},e.tryGetSelectableViewModelContract=function(e){return s(e)?e:null},e.isSelectableViewModel=s,e.isSelectable2=function(e){var t=e&&a(e);return t&&21298===t.type},e.invokeCallback=function(e,t,r){var n=e._msPortalFxCallbacks;n&&n[t]&&"function"==typeof n[t]&&n[t].apply(n,r)};var u=new(function(){function e(){}return e.prototype.configureSelectable=function(e){var r=new t.Selectable.Selectable2(e),n=this._msPortalFxSelectable;return n&&(n.dispose(),delete this._msPortalFxSelectable),this._msPortalFxSelectable2=r,r},e}())}(FxImpl||(FxImpl={})),function(e){!function(e){!function(e){e.TimeRangeValueType="MsPortalFx.Composition.Configuration.ValueTypes.TimeRange"}(e.Configuration||(e.Configuration={}))}(e.Composition||(e.Composition={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){var t=MsPortalFx.deepEquals,r=MsPortalFx.union,n=MsPortalFx.clone,i=new MsPortalFx.Base.Diagnostics.Log("MsPortalFx/ViewModels/ViewModels.Part");function a(e){return"object"==typeof e?n(e,!0):e}var o=function(){function e(e,t){this._configChangedHandler=t}return e.prototype.setValues=function(e){this._persistedValues=a(e)},e.prototype.getValues=function(){var e=this._persistedValues;return e.parameters,a(e)},e.prototype.updateValues=function(e,n){if(void 0===n&&(n=!0),!this._persistedValues)throw new Error("This 'updateValues' method cannot be called until the associated Part/Blade has been initialized.  Typically, 'updateValues' is called in the 'receiveResult' callback for a ParameterCollector opening a configuration Blade.");var o,s=e.parameters,u=e.settings,c=this._persistedValues,l=c.parameters,d=c.settings,f=l.values,p=s&&s.values||{},h=l.metadata,y=s&&s.metadata||{};return r(Object.keys(p),Object.keys(y)).forEach((function(e){if(h.hasOwnProperty(e)){var r;if(h&&h[e]&&Array.isArray(h[e].bindingSources)&&h[e].bindingSources.length>0){var n=y[e],s=n&&n.activeBindingSourceName;if(s!==h[e].activeBindingSourceName){if(!(!s||MsPortalFx.findIndex(h[e].bindingSources,(function(e){return e.name===s}))>=0))throw new Error("The name '".concat(s,"' supplied as 'activeBindingSourceName' does not match a binding source in 'bindingSources'."));h[e].activeBindingSourceName=s,o=!0}r=!!s}var u=p[e];r||t(u,f[e])||(f[e]=a(u),o=!0)}else i.error("Parameter named '".concat(e,"' is not a recognized parameter for this Part."))})),Object.keys(u).forEach((function(e){var r=!0,n=u[e];void 0===n&&(r=!1),r?t(n,d[e])||(d[e]=a(n),o=!0):void 0!==d[e]&&(d[e]=void 0,o=!0)})),o?this._configChangedHandler(a(this._persistedValues),n):Q()},e}();e.Configuration=o}(e.Composition||(e.Composition={}))}(FxImpl||(FxImpl={})),function(e){!function(e){!function(e){e[e.Default=0]="Default",e[e.ComingSoon=1]="ComingSoon",e[e.NoSubscription=2]="NoSubscription",e[e.Unauthorized=3]="Unauthorized"}(e.NoticeImageType||(e.NoticeImageType={}));var t=function(){};e.ContainerContract=t,function(e){e.markAsPreview=function(e,t){void 0===t&&(t=!0),e.preview(!!t)}}(e.Internal||(e.Internal={}))}(e.ViewModels||(e.ViewModels={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){var t;!function(e){!function(e){e[e.None=0]="None",e[e.Success=1]="Success",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Dirty=4]="Dirty",e[e.Info=5]="Info",e[e.Upsell=6]="Upsell",e[e.Complete=7]="Complete"}(e.InternalContentState||(e.InternalContentState={}))}(t=e.Internal||(e.Internal={})),e.ContentState=t.InternalContentState}(e.ViewModels||(e.ViewModels={}))}(MsPortalFx||(MsPortalFx={})),function(e){e.ViewModels||(e.ViewModels={})}(FxImpl||(FxImpl={})),function(e){!function(e){var t=FxImpl.Rpc.FuncEndPointDefinition,r=FxImpl.Constants.RpcMethods;e.createDialogRef=function(){return{value:null}},function(t){t.createSelectableViewModel=function(t,r){return new e.Selectable({selectedValue:2!==arguments.length||r,isSelected:!!(t&&t.container&&t.container.selectable.isSelected),isCommandSelected:!!(t&&t.container&&t.container.selectable.isCommandSelected)})},t.createClickableLinkViewModel=function(e,t){return new FxImpl.CompositionCore.ClickableLink(e,t)}}(e.Part||(e.Part={})),e.navigateToDashboardEndPoint=new t(r.navigateToDashboard);var n=function(){};e.PartContainerContract=n}(e.ViewModels||(e.ViewModels={}))}(MsPortalFx||(MsPortalFx={})),function(e){e.toAbsoluteUrisRequire=function(t){var r=(e.postBootEnv.hostingServiceBaseDomains||[]).filter((function(e){return/^https:\/\/[\w.\-]+$/.test(e)}));e.toAbsoluteUrisRequireCore(t,{origin:e.origin,protocol:e.protocol,appPath:MsPortalFx.getEnvironmentValue("applicationPath"),baseDomains:r})},function(t){var r=e.Rpc,n=r.ActionEndPointDefinition,i=r.FuncEndPointDefinition,a=r.ProxiedObjectTypeDefinition,o=e.Constants.RpcMethods;t.invokeAmeConfirmationDialogEndPoint=new i(o.deletePutConfirmation),t.getExtensionGalleryService=new a(o.getExtensionGalleryServiceViewModel),t.getBladeDefinitionEndPoint=new i(o.entryPointGetBladeDefinition),t.getPartDefinitionEndPoint=new i(o.entryPointGetPartDefinition),t.downloadBladeBundlesEndPoint=new n("downloadBladeBundles"),function(e){e.getExtensionConfigurationEndPoint=new i(o.getManifestEnvironment),e.registerTestExtensionsEndPoint=new i(o.registerTestExtensions),e.unregisterTestExtensionsEndPoint=new i(o.unregisterTestExtensions),e.listTestExtensionsEndPoint=new i(o.listTestExtensions),e.getDxContentEndPoint=new i(o.getDxContent)}(t.CreateUiDef||(t.CreateUiDef={})),t.getReactModelEndPoint=new n(o.entryPointGetReactModel),t.disposeReactModelEndPoint=new n(o.entryPointDisposeReactModel),t.getCommandsDefinitionEndPoint=new i(o.entryPointGetCommandsDefinition),t.pingEndPoint=new i(o.ping),t.getLastResourceIdInJourneyEndPoint=new i(o.getLastResourceIdInJourney),t.getCatalogApiCacheContentEndPoint=new i(o.getCatalogApiCacheContent),t.getExtensionRegistrationEndPoint=new i(o.getExtensionRegistration),t.getManifestEndPoint=new i(o.getManifest),t.getAuthorizationTokenEndPoint=new i("getAuthenticationToken"),t.getAuthorizationTokenForChallengeEndPoint=new i(o.getAuthorizationTokenForChallenge),t.getPopTokenEndPoint=new i("getPopToken"),t.getSshCertTokenEndPoint=new i("getSshCertToken"),t.getSharedSettingsEndPoint=new i(o.getSharedSettings),t.getLocalGalleryPackagesEndpointsDefinition=new i(o.getLocalGalleryPackagesEndpoints),t.getLocalGalleryPackagesEndpointDefinition=new i(o.registerLocalGalleryPackagesEndpoint),t.hasPermissionsToShell=new i(o.hasPermission),t.mapAssetIdToResourceIdEndPoint=new i(o.mapAssetIdToResourceId),t.mapResourceIdToAssetIdEndPoint=new i(o.mapResourceIdToAssetId),t.mapAssetIdToDynamicSelectionAndIconEndPoint=new i(o.mapAssetIdToDynamicSelectionAndIcon),t.mapResourceIdToDynamicSelectionAndIconEndPoint=new i(o.mapResourceIdToDynamicSelectionAndIcon),t.getAssetTypeInformationEndPoint=new i(o.getAssetTypeInformation),t.getResourceTypeAssetTypeInformationEndPoint=new i(o.getResourceTypeAssetTypeInformation),t.getResourceAssetInformationEndPoint=new i(o.getResourceAssetInformation),t.getResourceEndPoint=new i(o.getResource),t.getRuntime=function(){return{getLocalGalleryPackagesEndpoints:function(){return Q(t.getLocalGalleryPackagesEndpointsDefinition.invoke(e.Rpc.client,"fx",void 0))}}},function(e){e.getIrisContentEndPoint=new i(o.getIrisContent),e.sendIrisSignalEndPoint=new i(o.sendIrisSignal)}(t.IrisNotifications||(t.IrisNotifications={}))}(e.Extension||(e.Extension={}))}(FxImpl||(FxImpl={})),function(e){!function(e){e.AutomationGroupId="automation_group",e.ManagementGroupId="management_group",e.SupportGroupId="support_group",e.QuickAccessGroupId="quickaccess_group",e.MonitoringGroupId="monitoring_group",e.EventLogsItemId="eventlogs",e.ExportTemplateItemId="exporttemplate",e.MyAccessItemId="access",e.ResourceProvidersItemId="resourceproviders",e.ResourceHealthItemId="resourcehealth",e.ResourceGroupsItemId="resourceGroups",e.ResourcesItemId="resources",e.PreviewFeaturesItemId="previewfeatures",e.SubscriptionCertsItemId="subcerts",e.SubscriptionQuotasItemId="quotas",e.SupportHelpRequestItemId="supportrequest",e.TagsItemId="tags",e.LocksItemId="locks",e.TroubleshootItemId="troubleshoot",e.UsersItemId="users",e.PropertiesItemId="properties",e.AlertsItemId="alerts",e.DiagnosticsItemId="diagnostics",e.MetricsItemId="metrics",e.LogSearchItemId="logsearch",e.ResourceAdvisorItemId="resourceadvisor",e.AnalyticsItemId="analytics",e.AutomationApisId="automationapis",e.ResourceVisualizer="resourcevisualizer"}(e.Assets||(e.Assets={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=MsPortalFx.Errors,n=e.Rpc.client,i="MenuDetailBladeReferenceLifeExtenderObject",a=new Map;t.supplyMenuDetailBladeReferenceAsync=function(e,t,o){var s,u=!1;return e.registerForDispose((function(){u=!0})),a.has(o)?s=a.get(o):(s=Q(n.acquireObject(i,t.name,{})).then((function(t){return e.registerForDispose(t),t.value})),a.set(o,s),e.registerForDispose((function(){a.delete(o)}))),Q(s).then((function(e){return u?Q.reject(new r.DisposedError({message:"supplyMenuDetailBladeReferenceAsync's input lifetime is already disposed",errorLevel:0})):e.supplyBladeReferenceAsync(o).then((function(e){var r;if(!e)throw(r=new MsPortalFx.Errors.Error("supplyBladeReference returned null/undefined for resource menu item '".concat(o.id,"'"))).extension=t.name,r;if(!e.bladeName)throw(r=new MsPortalFx.Errors.Error("supplyBladeReference returned blade reference with null/undefined for bladeName for resource menu item '".concat(o.id,"'"))).extension=t.name,r;return e})).catch((function(e){var n=r.Error.isBaseOf(e)?e:new r.Error(MsPortalFx.getLogFriendlyMessage(e));return n.extension=t.name,n._sourceErrorLevel=0,Q.reject(n)}))}))};var o=function(){function e(){this.value=ko.observable()}return e.prototype.supplyBladeReferenceAsync=function(e){var t=this,r=function(e){return t.value(e),e};if(e.supplyBladeReference){var n=e.supplyBladeReference();return Q(r(n))}return Q(e.supplyBladeReferenceAsync()).then((function(e){return r(e)}))},e}();n.registerObjectFactory(i,{allowedOrigin:["HubsExtension","fx"],allowRemoteChanges:!0,handler:function(){return new o}})}(e.Assets||(e.Assets={}))}(FxImpl||(FxImpl={})),function(e){!function(e){!function(e){e.ConnectView=function(e,t,r,n,i){t.items.filter(e,n).map(e,(function(e,t){return ko.ignoreDependencies((function(){return i(t)}))})).subscribeAndRun(e,(function(e){if(e.length){var t=FxImpl.lowerCaseStringMap();e.forEach((function(e){t.set(e.resourceId,!0)}));var n=r().filter((function(e){return!t.has(e.resourceId)}));n.push.apply(n,e),r(n)}}))}}(e.SupplementalDataStreamHelper||(e.SupplementalDataStreamHelper={}))}(e.Assets||(e.Assets={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=FxImpl.Composition.Selectable;function n(e,t){return(e&t)===t}function i(e,t){return Q(new r.PdlBladeReference(e.detailBlade,e.extension,{parameters:e.detailBladeInputs,onClosed:t}))}function a(t,r){return Q(e.require("FxInternal/ExtensionRuntime")).then((function(e){return e.getInnerRuntime().mapAssetIdToDynamicSelectionAndIcon(t,r)}))}function o(t,r){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().mapResourceIdToDynamicSelectionAndIcon(t,r)}))}t.supportsContract=n,t.assetTypeInformationSupportsContract=function(e,t){return e&&e.viewModel&&n(e.contracts,t)},t.mapDynamicBladeSelectionToBladeReference=i,t.mapAssetIdToResourceId=function(t){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().mapAssetIdToResourceId(t)}))},t.mapResourceIdToAssetId=function(t){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().mapResourceIdToAssetId(t)}))},t.mapAssetIdToDynamicSelectionAndIcon=a,t.mapAssetIdToDynamicSelection=function(t,r){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().mapAssetIdToDynamicSelectionAndIcon(t,r)})).then((function(e){return e.selection}))},t.mapAssetIdToBladeReference=function(e){return Q(a(e,!0)).then((function(e){return i(e.selection)}))},t.mapResourceIdToDynamicSelectionAndIcon=o,t.mapResourceIdToDynamicSelection=function(e,t){return o(e,t).then((function(e){return e.selection}))},t.mapResourceIdToBladeReference=function(e,t){return Q(o(e,!0).then((function(e){return i(e.selection,t)})))},t.getAssetTypeInformation=function(t,r){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().getAssetTypeInformation(t,r)}))},t.getResourceTypeAssetTypeInformation=function(t){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().getResourceTypeAssetTypeInformation(t)}))},t.getResourceAssetInformation=function(t){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().getResourceAssetInformation(t)}))},t.signalResourcesChanged=function(e){return Q()}}(e.Assets||(e.Assets={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){function t(e,t){return e+"_"+t}e.getAssetTypeOrResourceTypeId=function(e,r){return t(e,r)},e.getAssetTypeOrResourceTypeIdByWindowId=t}(e.Assets||(e.Assets={}))}(FxImpl||(FxImpl={})),function(e){!function(e){var t=function(){function e(){this._init()}return e.prototype.add=function(e,t){if(e){var r=void 0,n=this._entries;if(t){var i=this._names;void 0===(r=i[t])&&(r=n.length,i[t]=r)}else r=n.length;n[r]=e}return this},e.prototype.remove=function(e){var t=this._entries;if("string"==typeof e){var r=this._names,n=r[e];isNaN(n)||(delete r[e],t[n]=null)}else t.forEach((function(r,n){r===e&&(t[n]=null)}));return this},e.prototype.clear=function(){return this._init(),this},e.prototype.fire=function(e){return this._entries.forEach((function(t){t&&t(e)})),this},e.prototype._init=function(){this._entries=[],this._names={}},e}();e.Callbacks=t}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){!function(e){e.Shell="fx",function(e){e.Hubs="HubsExtension",e.Billing="Microsoft_Azure_Billing",e.AzureExpert="Microsoft_Azure_Expert",e.AzureInsights="Microsoft_Azure_Insights",e.AzureMonitoring="Microsoft_Azure_Monitoring",e.ActiveDirectory="Microsoft_Azure_AD",e.ClassicResources="Microsoft_Azure_ClassicResources",e.Marketplace="Microsoft_Azure_Marketplace",e.Resources="Microsoft_Azure_Resources",e.Support="Microsoft_Azure_Support",e.Websites="WebsitesExtension"}(e.ExtensionNames||(e.ExtensionNames={})),function(e){e.ResourceGroups="ResourceGroups",e.BrowseAllBlade="BrowseAll",e.BrowseResourceBlade="BrowseResource",e.BrowseBlade="BrowseResource",e.BrowseAllResources="BrowseAllResources",e.BrowseRecentResources="BrowseRecentResources",e.BrowseAllBladeWithType="BrowseAllWithType",e.BrowseResourceGroupBlade="BrowseResourceGroup",e.Gallery="Gallery",e.StoreGallery="StoreGallery",e.Deployments="Deployments",e.ArmExplorer="ArmExplorer",e.WhatsNew="WhatsNew",e.BrowseDynamicResource="BrowseDynamicResource",e.BrowseDynamicAsset="BrowseDynamicAsset",e.SubscriptionDetail="Subscription",e.NonAssetResource="NonAssetResource"}(e.AssetNames||(e.AssetNames={})),function(e){e.Subscriptions="Microsoft.Resources/subscriptions",e.ResourceGroups="Microsoft.Resources/subscriptions/resourcegroups",e.AllResources="Microsoft.Resources/resources",e.RecentResources="Microsoft.Resources/recent"}(e.ResourceTypes||(e.ResourceTypes={})),function(e){!function(e){e.BrowseResourcePinnedPart="BrowseResourcePinnedPart",e.BrowseResourceGroupPinnedPart="BrowseResourceGroupPinnedPart"}(e.Hubs||(e.Hubs={}))}(e.PartNames||(e.PartNames={})),function(e){!function(e){e.SubscriptionsBlade="SubscriptionsBlade"}(e.Billing||(e.Billing={})),function(e){e.CreateHubBlade="PlusNewBlade",e.BrowseLinkBlade="BrowseLinkBlade",e.BrowseResourceBlade="BrowseResourceBlade",e.BrowseAllResourcesBlade="BrowseAllResourcesBlade",e.BrowseResourceGroupBlade="BrowseResourceGroupBlade",e.BrowseRecentResourcesBlade="BrowseRecentResourcesBlade",e.AssetMenuBlade="AssetMenuBlade",e.UnauthorizedAssetBlade="UnauthorizedAssetBlade",e.NotFoundAssetBlade="NotFoundAssetBlade",e.UnavailableAssetBlade="UnavailableAssetBlade",e.ResourceMenuBlade="ResourceMenuBlade",e.ResourceProperties="ResourceProperties",e.ResourceGroupMapBlade="ResourceGroupMapBlade"}(e.Hubs||(e.Hubs={})),function(e){e.GalleryFeaturedMenuItemBlade="GalleryFeaturedMenuItemBlade",e.GalleryResultsListBlade="GalleryResultsListBlade",e.LegalTermsV2Blade="PCLegalTermsV2Blade"}(e.Marketplace||(e.Marketplace={}))}(e.BladeNames||(e.BladeNames={})),function(e){e.FeatureAdoption="FeatureAdoption",e.FeatureObsolete="FeatureObsolete"}(e.Telemetry||(e.Telemetry={})),function(e){e.RegisterExtension="TelemetrySharing.registerExtension",e.TraceTelemetry="TelemetrySharing.traceTelemetry"}(e.TelemetrySharing||(e.TelemetrySharing={})),function(e){e.HomeMenuItem="home"}(e.GalleryMenuItems||(e.GalleryMenuItems={})),function(e){e.EditScopeId="editScopeId",e.ReferrerInfo="referrerInfo"}(e.BladeParameterNames||(e.BladeParameterNames={}))}(e.Constants||(e.Constants={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r,n,i=e.Errors,a=new t.Diagnostics.Log("MsPortalFx/Base/Base.Scheduler"),o=Date.now,s=!e.isFeatureEnabled("nodataperf"),u={recurring:"",autoRecurring:"",concurrent:"",positiveInt:""},c=FxImpl.getErrorMap(u),l=[],d=function(){var e;try{h(l[0]);var t=l.shift();if(t)if(s)e=Promise.resolve().then((function(){return t.scheduledTask.apply(t,t.args||[])})).catch((function(e){return Q.reject(y(t,e))})).finally((function(){t.recurring&&f.scheduleTask(t)}));else try{var r=t.scheduledTask.apply(t,t.args||[]);e=Q(r)}catch(r){var n=y(t,r);a.error(n),e=Q.reject(n)}finally{t.recurring&&f.scheduleTask(t)}}finally{p()}return e},f=function(){function t(){}return t.scheduleTask=function(t,r){t.recurring&&(t.absoluteTime&&c.recurring(),t.isAsync&&c.autoRecurring()),!r&&l.includes(t)&&c.concurrent(),t.name||(t.name="Anonymous "+e.getUniqueId());var n=o(),i=t,a=i.absoluteTime;if(!a){var s=i.delayInMs;(isNaN(s)||s<=0)&&c.positiveInt(),a=n+s}i.scheduledExecutionTime=a;for(var u=0,d=l.length;u<d&&!(l[u].scheduledExecutionTime>a);u++);l.splice(u,0,i),0===u&&h(),p()},t.deleteTask=function(e){var t=l.filter((function(t){return t!==e}));t.length!==l.length&&(l=t,function(e){return e===n&&r}(e)&&h(),p())},t}();function p(){if(!r){var t=e.first(l);if(t){for(var i=o(),a=[t],u=!1,c=1,f=1,p=l.length;f<p;f++){var h=l[f];if(!(h.scheduledExecutionTime<=i))break;c++,h!==t?a.push(h):u=!0}u&&(l=a.concat(l.slice(f)));var y=0;s&&(y=1e3*(c>>>2)),r=setTimeout(d,Math.max(y,t.scheduledExecutionTime-i)),n=t}}}function h(e){r&&(clearTimeout(r),r=null,n=null)}function y(e,t){var r,n="Error executing \n'".concat(function(e){var t="task:";try{t+=JSON.stringify(e,(function(e,t){var r=t;return"args"===e&&(r=void 0),"function"==typeof t&&(r=t+""),r}))}catch(r){t+="{\nname: ".concat(e.name," \nFunc: ").concat(e.scheduledTask+""," }")}return t}(e),"'")+t?"\nerror:"+t.message:"";if(i.isInstanceOfErrorType(t,i.Error))t.message=n,r=t;else{var a=new i.Error(n);a.innerErrors.push(t),r=a}return r}t.Scheduler=f}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){!function(t){t.createAuthTokenCache=function(e,t){return new FxImpl.Security.AuthTokenCacheImpl(e,t)},t.getAuthorizationToken=function(t){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().getAuthorizationToken(t)}))},t.getUserInfo=function(){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().getUserInfo()}))},t.hasPermission=function(t,r){return Promise.all([e.require("Fx/DependencyInjection"),e.require("FxInternal/ResourceManagement/Permissions")]).then((function(e){var n=e[0],i=e[1];return n.container.get(i.PermissionChecker).hasPermission(t,r)}))},t.assetHasPermission=function(t,r){return e.require("FxInternal/ExtensionRuntime").then((function(e){return e.getInnerRuntime().assetHasPermission(t,r)}))}}(t.Security||(t.Security={}))}(e.Base||(e.Base={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=MsPortalFx.Base,n=r.Diagnostics.Telemetry,i=new r.Diagnostics.Log("MsPortalFx/Base/Internal/Base.Security"),a=MsPortalFx.isFeatureEnabled("enableauthtelemetry"),o={"graph.microsoft.com":"00000003-0000-0000-c000-000000000000","graph.windows.net":"00000002-0000-0000-c000-000000000000"};function s(t,r){var n=e.createError(t&&t.errorMessage||"Token Error",{data:r});return MsPortalFx.extend(n,t),Q.reject(n)}function u(t){return __awaiter(this,void 0,void 0,(function(){var r,i,a,s,u,c,l,d,f,p,h,y,m,v,g,_,b,x;return __generator(this,(function(E){switch(E.label){case 0:return r=t.token,i=t.msalExpiresAtInMs,a=t.telemetrySource,[4,e.getExperimentBooleanValue("msaljstokenexpvalidation")];case 1:return s=E.sent(),[4,(P="msaljstokenexpvalidationdurationinms",e.memoizePromise((function(e){return Promise.all([MsPortalFx.require("Fx/DependencyInjection"),MsPortalFx.require("Fx/Experimentation")]).then((function(t){var r=t[0],n=t[1];return r.container.get(n.Experimentation).shellAssignments.getNumberValue(e)}))}))(P))];case 2:return u=E.sent()||36e5,[4,e.getExperimentBooleanValue("validateaudappid")];case 3:return c=E.sent(),r&&r.startsWith("Bearer")?(l=function(e){try{var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(window.atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(r)}catch(e){n.trace({source:"Base.Security",action:"errorParsingJwtToken",data:{exception:e.message||e.toString()}})}}(r),!l||[void 0,2].includes(l.appidacr)?[2,!0]:(d=l.aud,f=l.appid,p=t.expectedClaims,h=p.aud,y=p.appId,m=[],v="",c&&(h&&h!==d&&(g=MsPortalFx.getUriAuthority(h)||"",(v=o[g])&&v===d||m.push("aud")),y&&f!==y&&m.push("appid")),s&&(_=1e3*l.exp,b=Math.abs(_-i),x=Date.now(),b<u&&_>x||(m.push("exp"),n.trace({source:a,action:"calculatedDiff",data:{diffInMs:b,acceptedDiffDurationInMs:u,estsExpiresAtInMs:_,msalExpiresAtInMs:i,now:x,aud:l.aud,appid:l.appid,appidacr:l.appidacr,exp:l.exp,tid:l.tid}}))),m.length&&n.trace({source:a,action:"invalidClaimsSummary",data:{actualAppId:l.appid,actualAppIdAcr:l.appidacr,actualAud:l.aud,actualExp:l.exp,actualTid:l.tid,expectedAppId:y,expectedAud:h,resolvedGuidValue:v,invalidClaims:JSON.stringify(m)}}),[2,!m.length])):[2,!0]}var P}))}))}function c(e,t){if(t?t.token=e:t={token:e},e&&e.expiresAt>0){var r=Date.now(),n=e.expiresAt-6e5;t.expiresAt=e.expiresAt,t.refreshAfter=n<r?-1:n}else t.expiresAt=-1,t.refreshAfter=-1;return t}t.validateTokenClaims=u,t.tokenErrors={unknown:"Unknown",accessDenied:"AccessDenied",sessionEnded:"SessionEnded",credentialsExpired:"CredentialsExpired",networkError:"NetworkError",requiresMFA:"RequiresMfa",accountDisabled:"AccountDisabled",tooManyRequests:"TooManyRequests",badRequest:"BadRequest",appNotProvisioned:"AppNotProvisioned",missingBrokerReplyUrl:"MissingBrokerReplyUrl",brokerTimeout:"BrokerTimeout",deviceUncompliant:"DeviceUncompliant",passthroughUserError:"PassthroughUserError",interactionRequiredAuthError:"InteractionRequiredAuthError"};var l=function(){function r(e,t){var r=this;this._getTokenWorker=e,this._cachedTokenMap={},MsPortalFx.forEachKey(t,(function(e,t){r._cachedTokenMap[e]=c(t)}))}return r.prototype.getToken=function(e){var t=this._stalledPromise;if(t)return t;var r=(e=e||{}).resourceName||"",o={audience:e.audience,authConfigStamp:e.authConfigStamp,resourceName:r,tenantId:e.tenantId,wwwAuthHeader:e.wwwAuthHeader},s=Date.now(),u=this._cachedTokenMap,c=u[r];c||(u[r]={token:null,expiresAt:-1,refreshAfter:-1},c=u[r]);var l=c.refreshAfter,d=c.expiresAt,f=function(e){n.trace({source:"Base.Security",action:e,data:{resourceName:r,tokenExpiresAt:d,tokenRefreshAfter:l,currentTime:s}})},p=MsPortalFx.isFeatureEnabled("retryonwwwauthenticate")&&!!e.wwwAuthHeader;if(!p&&c.token&&l>s)return Q(c.token);if(p||!c.token||d>0&&d<s){a&&f("CacheMiss".concat(p?"_WwwAuth":""));var h=p||!!c.token;return c.token=null,c.expiresAt=-1,c.refreshAfter=-1,this._refreshTokenWorker(o,h,e.isBackground,c)}return l>0&&l<s&&(a&&f("CacheUpdateInBackground"),this._refreshTokenWorker(o,!0,!0,c)),d<s&&i.warning("Returning expired token for '{0}'. Current time: {1}, Expiration time: {2}".format(e.resourceName,s,d)),Q(c.token)},r.prototype.getTokenExpiresAt=function(e){return e=e||"",(this._cachedTokenMap[e]||{}).expiresAt},r.prototype._refreshTokenWorker=function(e,t,r,n){if(n.tokenPromise)return n.tokenPromise;var i=MsPortalFx.extend(e,{isBackground:r,ignoreRejection:!1,skipCache:t});return n.tokenPromise=this._refreshTokenWorkerInternal(i,{retryDelay:1e3,maxRetryCount:4},n).catch((function(e){var t=e;if(i.ignoreRejection){var r=new MsPortalFx.Errors.CanceledError("GetAuthorizationTokenOptionsExtended2.ignoreRejection === true");r.innerErrors.push(e),t=r}else t&&t.message&&(t.message="Base.Security: Unexpected failure getting token. Error:".concat(t.message,"."));return Q.reject(t)})).finally((function(){n.tokenPromise=null}))},r.prototype._refreshTokenWorkerInternal=function(r,a,o){var l=this;return Q(this._getTokenWorker(r)).then((function(d){return __awaiter(l,void 0,void 0,(function(){var l,f,p,h,y,m,v,g,_,b=this;return __generator(this,(function(x){switch(x.label){case 0:return(f=(l=d||{}).token)&&f.header?[4,u({token:f.header,expectedClaims:{aud:r.audience,appId:null},msalExpiresAtInMs:f.expiresAt,telemetrySource:"ExtensionTokenCache"})]:[3,2];case 1:return x.sent()?c(f,o):n.trace({source:"Base.Security",action:"tokenCachingSkippedInvalidExpiration",name:e.extensionName,data:{audience:r.audience,extensionName:e.extensionName,isBackground:r.isBackground,msalTokenExpiresAt:f.expiresAt,resourceName:r.resourceName,skipCache:r.skipCache,tenantId:r.tenantId}}),[2,f];case 2:if(p=l.error,h=l.errorMessage,y={options:r,retryOptions:a},r.isBackground)return r.ignoreRejection=!0,[2,s(d,y)];switch(p){case t.tokenErrors.accountDisabled:case t.tokenErrors.credentialsExpired:case t.tokenErrors.sessionEnded:i.warning("Failed to get token, promise will be stalled. ServerMessage:".concat(h,". ServerErrorCode:").concat(p,".")),(v=this._stalledPromise)||(this._stalledPromise=v=Q.defer().promise),m=v;break;case t.tokenErrors.brokerTimeout:case t.tokenErrors.unknown:if(g=a.retryDelay,(_=a.maxRetryCount)<=0){r.ignoreRejection=!0,m=s(d,y);break}i.warning("Failed to get token, operation will be retried ".concat(_," more time").concat(1===_?"":"s",".ServerMessage: ").concat(h,".ServerErrorCode: ").concat(p,".")),m=MsPortalFx.delay(g).then((function(e){var t=g>=6e4?6e4:g;return o.tokenPromise=null,b._refreshTokenWorkerInternal(r,{retryDelay:t,maxRetryCount:_-1},o)}));break;case t.tokenErrors.interactionRequiredAuthError:case t.tokenErrors.requiresMFA:case t.tokenErrors.accessDenied:default:i.warning("Failed to get token, operation will not be retried.ServerMessage: ".concat(h,".ServerErrorCode: ").concat(p,".")),r.ignoreRejection=!0,m=s(d,y)}return[2,m]}}))}))}))},r}();t.AuthTokenCacheImpl=l}(e.Security||(e.Security={}))}(FxImpl||(FxImpl={})),function(e){!function(e){!function(e){!function(e){e[e.Minimized=0]="Minimized",e[e.Normal=1]="Normal",e[e.Maximized=2]="Maximized"}(e.DisplayState||(e.DisplayState={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large",e[e.XLarge=3]="XLarge",e[e.Menu=51]="Menu"}(e.BladeWidth||(e.BladeWidth={})),function(e){e[e.Action=1]="Action",e[e.Info=2]="Info",e[e.Create=3]="Create",e[e.Context=4]="Context",e[e.Help=5]="Help",e[e.Basic=6]="Basic",e[e.ContextAction=7]="ContextAction",e[e.BasicWithCommands=8]="BasicWithCommands",e[e.Hub=9]="Hub",e[e.HubSubMenu=10]="HubSubMenu",e[e.ResourceSetting=11]="ResourceSetting",e[e.App=12]="App"}(e.BladeStyle||(e.BladeStyle={}))}(e.Internal||(e.Internal={}))}(e.Blades||(e.Blades={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=MsPortalFx.Base,n=MsPortalFx.Errors,i=r.Promises.makeCancelable,a=Q.resolve(void 0),o=function(){function t(e,t,n){var i=this;this._loadedCacheEntry=ko.observable(null),this._isDisposed=!1,this._requestInProgress=ko.observable(),this._dataSource=e,this._errorNotificationTarget=t,this._interceptNotFound=!n||void 0===n.interceptNotFound||n.interceptNotFound,r.ProxiedObservables.markNonSerializable(this);var a=this._lifetime=t;this._isLoading=ko.computed(a,(function(){return!!i._requestInProgress()})),a.registerForDispose((function(){i._isDisposed=!0,i._cancelInProgressRequest(),i._releaseCurrentContents()}))}return Object.defineProperty(t.prototype,"loading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),t.prototype.fetch=function(t){var n,o=this,s=this._requestInProgress;if(this._isDisposed)return a;var u=this._currentCacheEntryDisposer,c=function(){u&&u.dispose()};if(this._currentParams=t,this._cancelInProgressRequest(),null===this._currentParams||void 0===this._currentParams)return this._loadedCacheEntry(null),c(),a;this._currentCacheEntryDisposer=new e.TriggerableLifetimeManager;var l=this._dataSource.fetch(t,this._currentCacheEntryDisposer),d=new r.Promises.CancelationToken,f={cancelationToken:d,cancelablePromise:i(l,d),externalPromise:null};c(),s(f);var p=null===(n=null==l?void 0:l._getStatusPromise)||void 0===n?void 0:n.call(l);return p&&!p.isPending()?(s(null),this._loadedCacheEntry(p.isFulfilled()?p.valueOf():null)):f.cancelablePromise.then((function(e){o._loadedCacheEntry(e),s(null)}),(function(){s(null),o._loadedCacheEntry(null)})),f.externalPromise=f.cancelablePromise.then(MsPortalFx.noop),f.externalPromise.then(null,(function(e){o._handleFetchRejections(e)})),f.externalPromise},t.prototype._cancelInProgressRequest=function(){var e=this._requestInProgress;e()&&(e().cancelationToken.cancel(),e(null))},t.prototype._releaseCurrentContents=function(){this._currentCacheEntryDisposer&&(this._currentCacheEntryDisposer.dispose(),this._currentCacheEntryDisposer=null)},t.prototype._handleFetchRejections=function(e){e instanceof n.NotFoundDataError&&(!1!==this._interceptNotFound&&(e.handled=!0,"function"==typeof this._interceptNotFound?this._interceptNotFound(this._currentParams):this._errorNotificationTarget.notFound&&this._errorNotificationTarget.notFound()))},t=__decorate([__metadata("fx:diagnostics",[require,"ObjectView"]),MsPortalFx.Composition.ProxyCompatibilityMode,__metadata("design:paramtypes",[Object,Object,Object])],t)}();t.ObjectView=o;var s=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;return i._partialErrors=ko.observableArray(),ko.reactor(r,(function(){var e=i._loadedCacheEntry();i._partialErrors(e&&e.partialErrors()||[])})),i}return __extends(t,e),Object.defineProperty(t.prototype,"_refreshableDataSource",{get:function(){return this._dataSource},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"partialErrors",{get:function(){return this._partialErrors},enumerable:!1,configurable:!0}),t.prototype.refresh=function(){var e=this._requestInProgress;if(this._isDisposed)return a;var t=this._currentCacheEntryDisposer;if(!t)return a;if(!e()){if(!this._loadedCacheEntry())return this.fetch(this._currentParams);var n=new r.Promises.CancelationToken;e({cancelationToken:n,cancelablePromise:i(this._refreshableDataSource.refresh(this._currentParams,t),n),externalPromise:null});var o=function(){e(null)};e().cancelablePromise.then(o,o),e().externalPromise=e().cancelablePromise.then(MsPortalFx.noop)}return e().externalPromise},t=__decorate([__metadata("fx:diagnostics",[require,"DataView"]),MsPortalFx.Composition.ProxyCompatibilityMode,__metadata("design:paramtypes",[Object,Object,Object])],t)}(o);t.DataView=s}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(t){var r=MsPortalFx.Base,n=MsPortalFx.Data,i=function(){function e(){r.ProxiedObservables.markNonSerializable(this),this._atomizationCache=new n.ObjectCache({serializeKey:function(e){return JSON.stringify([e.type,e.id])},supplyValue:function(e,t){return null}})}return e.prototype.getEntity=function(e,t,r){var n,i={type:e,id:t};return this._atomizationCache.hasEntry(i)&&(n=this._atomizationCache.getValue(i,r)),n},e.prototype.addEntity=function(e,t,r,n){this._atomizationCache.insertValueIfNotPresent({type:e,id:t},r,n)},e.prototype.releaseEntities=function(e,t,r){},e}();t.RefCountingAtomizationContext=i,function(t){t.atomizationContextCollection={};t.get=function(r){r=r||"__default__";var n=t.atomizationContextCollection[r];return n||(n=e.Data.AtomizationContext.createInstance(),t.atomizationContextCollection[r]=n),n},t.canAtomizeType=function(e){if(!e)return!1;var t=n.Metadata.getTypeMetadata(e);return!!(t&&t.hasGloballyUniqueId&&n.Metadata.typeHasId(e))},t.createInstance=function(){return new e.Data.RefCountingAtomizationContext}}(t.AtomizationContext||(t.AtomizationContext={}))}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(t){var r=MsPortalFx.Base,n=MsPortalFx.Data,i=0,a=0,o=(new r.Diagnostics.Log("MsPortalFx/Data/Internal/Internal.Data.DataCache"),{loaderConflict:"",getSerialize:"",dataCacheProps:"",establishDataSet:""}),s=e.getErrorMap(o),u=function(){function e(e){var t=this;if(r.ProxiedObservables.markNonSerializable(this),this._cacheName=[e.cacheName,e.entityTypeName,"DataCache",++i].filter((function(e){return!!e})).join(":"),e.loader)this._loader=e.loader,(e.sourceUri||e.httpMethod)&&s.loaderConflict();else if(e.sourceUri||e.supplyData&&e.serializeParams){this._loader=new n.DataCacheLoader2(e),e.httpMethod&&"GET"!==e.httpMethod.toUpperCase()&&!e.serializeParams&&s.getSerialize()}else s.dataCacheProps();var a={supplyValue:function(e,r){var n=t._createUniqueDataSetName(),i=t._supplyValue(n,e,r),a=Q(i);return a!==i&&a.catch((function(){})),i._getStatusPromise=function(){return a},i},tryFindValueInRelatedCache:function(e,r){var n=t._tryFindDataInRelatedCache(e,r);if(n){var i=ko.toJS(n),a=t._createUniqueDataSetName(),o=t._establishDataSet(a,e,i,r),s=Q(o);return s.dataSetName=a,t._doesPoll()&&t._supplyValue(a,e,r),{value:s}}return null},serializeKey:function(e){return t._loader.serializeParams(e)},evictionDelay:e.evictionDelay,extendEntryLifetimes:e.extendEntryLifetimes,onEntryDisposed:function(e){var r=function(){t._loader.disposeDataSet(e)};e.state&&"pending"!==e.state()||e.isFulfilled&&e.isFulfilled()||e.isRejected&&e.isRejected()?r():e.then(r,r)}};this._cacheByParams=new n.ObjectCache(a)}return e.prototype.fetch=function(e,t){var r=this._cacheByParams,n=r.getValue(e,t);return n.then(null,(function(){r.immediatelyEvictEntry(e)})),n},e.prototype.refresh=function(e,t){var r=this._cacheByParams.hasEntry(e),n=this.fetch(e,t);return r?this._loader.refreshDataSet(n):n},e.prototype.refreshAll=function(e){var t=this;this._forEachEntry((function(e,r){t._loader.refreshDataSet(r)}),e)},e.prototype.forceRemove=function(e){this._cacheByParams.immediatelyEvictEntry(e)},e.prototype.applyChanges=function(e,t){var r=this;this._forEachEntry((function(t,n,i){i&&e(t,i);var a=n.dataSetName,o=r._loader;o.isLoadingDataSet(a)&&o.refreshDataSet(n)}),t)},e.prototype.dispose=function(){this._cacheByParams.dispose()},e.prototype._doesPoll=function(){return this._loader._doesPoll()},e.prototype._findEntity=function(e,t){var r,n=this;return this._forEachEntry((function(i,a,o){if(o){var s=n._getDataFromDataSet(o);r=e(i,s,t)}}),(function(){return!r})),r},e.prototype.dump=function(e){var t=[];if(this._forEachEntry((function(e,r,n){t.push(ko.toJS({key:e,data:n?n.data:"<null dataSet>"}))})),e)return t;console.log(JSON.stringify(t,null,4))},e.prototype._tryFindDataInRelatedCache=function(e,t){return null},e.prototype._forEachEntry=function(e,t){var r=this,n=MsPortalFx.memoize((function(e){return r._loader.getLoadedDataSet(e)}));this._cacheByParams.forEachEntry((function(r,i){t&&!t(r)||e(r,i,n(i.dataSetName))}))},e.prototype._supplyValue=function(e,t,r){return this._loader.loadDataSetForParams(e,t,r)},e.prototype._establishDataSet=function(e,t,r,n){return this._loader.establishDataSet||s.establishDataSet(),this._loader.establishDataSet(e,t,r,n)},e.prototype._createUniqueDataSetName=function(){return"".concat(this._cacheName,":").concat(++a)},e}();t.DataCache=u}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(t){var r=MsPortalFx.Base,n=MsPortalFx.Data,i=e.Rpc,a=e.Data;function o(t,r){return Q.reject(e.createError(t,r))}t.saveSerializedEditScopeEndPoint=new i.ActionEndPointDefinition("FxImpl.Data.saveSerializedEditScope"),t.loadSerializedEditScopeEndPoint=new i.FuncEndPointDefinition("FxImpl.Data.loadSerializedEditScope"),t.onEditScopeDiscardedEndPoint=new i.ActionEndPointDefinition("FxImpl.Data.onEditScopeDiscarded"),t.updateEditScopeIsSavingStateEndPoint=new i.ActionEndPointDefinition("FxImpl.Data.updateEditScopeIsSavingState");var s,u="",c={dataCachePolling:u,viewUnloaded:u,serializeParams:u,fetchPrereq:u,existingPrereq:u,newPrereq:u},l=e.getErrorMap(c);!function(e){e[e.LoadOriginalDataFailed=0]="LoadOriginalDataFailed",e[e.LoadEditsFailed=1]="LoadEditsFailed",e[e.ApplyEditsFailed=2]="ApplyEditsFailed"}(s=t.FetchEditScopeError||(t.FetchEditScopeError={}));var d=function(){function e(e){void 0===e&&(e=i.client);var r=this;this._caches=[],t.onEditScopeDiscardedEndPoint.register(e,["fx"],(function(e){r._caches.forEach((function(t){t.onEditScopeDiscarded(e)}))}))}return e.prototype.register=function(e){this._caches.push(e)},e.prototype.deregister=function(e){MsPortalFx.remove(this._caches,e)},e}();t.EditScopeDiscardedReceiver=d,t.editScopeDiscardedReceiver=new d;var f=function(){function u(e,i){var a=this;this._ltm=c.allLifetimes.createChildLifetime(),this._editScopeEditsChangedSubs={},this._loadEdits=i&&i.loadEdits||c._remoteLoadEdits,this._saveEdits=i&&i.saveEdits||c._remoteSaveEditScope,this._updateEditScopeIsSavingState=i&&i.updateEditScopeIsSavingState||c._remoteUpdateEditScopeIsSavingState;var o=(this._options=MsPortalFx.clone(e)).dataCache;o&&o._doesPoll()&&l.dataCachePolling(),r.ProxiedObservables.markNonSerializable(this),this._cacheByParams=new n.ObjectCache({supplyValue:function(e,t){var r=a._getEditScopeForKey(e,t),n=Q(r);return n!==r&&n.catch((function(){})),r._getStatusPromise=function(){return n},r},serializeKey:function(e){return a._serializeKey(e)},onEntryDisposed:function(e,t){var r=a._serializeKey(t),n=a._editScopeEditsChangedSubs[r];n&&(a._editScopeEditsChangedSubs[r]=null,n.dispose()),e.then((function(e){e.dispose()}))}}),t.editScopeDiscardedReceiver.register(this)}var c;return c=u,u.prototype.createView=function(e,t){return new n.EditScopeView(this,e,t||{})},u.prototype.fetch=function(e,t){return this._cacheByParams.getValue(e,t)},u.prototype.forEachEditScope=function(e){var t=[];return this._cacheByParams.forEachEntry((function(r,n){t.push(n.then((function(t){e(r.editScopeId,t)})))})),Promise.all(t)},u.prototype.dispose=function(){var e=this._cacheByParams;e&&(e.dispose(),this._cacheByParams=null),this._ltm.dispose(),t.editScopeDiscardedReceiver.deregister(this)},u.prototype.disposeAndDiscardEdits=function(e,t){var r=t.editScope();r||l.viewUnloaded(),r.dispose(),c._remoteSaveEdits(e,{edits:[]})},u.prototype.onEditScopeDiscarded=function(e){return this.forEachEditScope((function(t,r){t!==e||r.saving()||r.revertAll()}))},u._remoteSaveEditScope=function(e,t){c._remoteSaveEdits(e,t.getEdits())},u._remoteSaveEdits=function(e,r){t.saveSerializedEditScopeEndPoint.invoke(i.client,"fx",{editScopeId:e,edits:r})},u._remoteLoadEdits=function(e){return Q(t.loadSerializedEditScopeEndPoint.invoke(i.client,"fx",e)).catch((function(e){return o("Loading of EditScope edits from user settings service failed.",{innerErrors:e})}))},u._remoteUpdateEditScopeIsSavingState=function(e,r){t.updateEditScopeIsSavingStateEndPoint.invoke(i.client,"fx",{editScopeId:e,isSaving:r})},Object.defineProperty(u.prototype,"_isDisposed",{get:function(){return null===this._cacheByParams},enumerable:!1,configurable:!0}),u.prototype._serializeKey=function(e){var t=e.editScopeId,r=e.params;if(r){var n=this._options,i=n.serializeParams;if(!i&&!(i=n.serializeKeyOrQuery)){var a=typeof r;"number"===a||"string"===a?i=JSON.stringify:l.serializeParams()}t+=":"+i(r)}return t},u.prototype._getEditScopeForKey=function(e,t){var r;if(!e.editScopeId)return Promise.resolve().then((function(){return l.fetchPrereq()}));var i=this._options,a=e.params;if(void 0!==a)if(i.supplyExistingData)r=function(){return Q(i.supplyExistingData(a,t))};else{if(!i.dataCache)return Promise.resolve().then((function(){return l.existingPrereq()}));r=function(){return Q(MsPortalFx.Base.Promises.cancelOnDispose(t,(function(){return i.dataCache.createView(t)})).then((function(e){return e.fetch(a).then((function(){return e.data}))})))}}else if(i.supplyNewData)r=function(){return Q(i.supplyNewData())};else{if(!i.entityTypeName)return Promise.resolve().then((function(){return l.newPrereq()}));r=function(){return Q(n.Metadata.createEmptyObject(i.entityTypeName))}}return this._acquireEditScope(e,r,t,i.entityTypeName)},u.prototype._acquireEditScope=function(e,t,r,n){var i,o,s,u=this,c=this._ltm.createChildLifetime();return r.registerForDispose(c),Q(MsPortalFx.Base.Promises.cancelOnDispose(c,(function(){return t()})).then((function(t){var c,l=u._options;return l.refreshEditScope?c=function(t){var n=r.createChildLifetime();return Q(MsPortalFx.Base.Promises.cancelOnDispose(n,(function(){return l.refreshEditScope(e.params,n,t)})).finally((function(){n.dispose()})))}:l.dataCache&&(c=function(t){var n=r.createChildLifetime();return Q(MsPortalFx.Base.Promises.cancelOnDispose(n,(function(){return l.dataCache.createView(n)})).then((function(t){return t.fetch(e.params).then((function(){return t.data}))})).finally((function(){n.dispose()})))}),s=r.createChildLifetime(),i=e.editScopeId,o=a.createEditScope(s,t,{kind:l.kind,typeName:n,refresh:c,save:l.saveEditScopeChanges&&function(t,r,n){u._updateEditScopeIsSavingState(i,!0);var a=s.createChildLifetime();return u._cacheByParams.getValue(e,a),t.saving.subscribe(a,(function(e){e||(a.dispose(),u._updateEditScopeIsSavingState(i,!1))})),l.saveEditScopeChanges(e.params,t,r,a,n)}}),l.onEditScopeCreated&&l.onEditScopeCreated(r,o),u._loadAndApplyEdits(o,i)})).then((function(){var t=u._serializeKey(e),r=u._editScopeEditsChangedSubs[t];return r&&r.dispose(),r=u._editScopeEditsChangedSubs[t]=c.createChildLifetime(),o.editsChanged.subscribe(r,(function(){u._saveEdits(i,o)})),o})).catch((function(e){return s&&s.dispose(),Q.reject(e)})))},u.prototype._loadAndApplyEdits=function(e,t){var r=this;return Q(this._loadEdits(t)).then((function(t){if(!r._isDisposed)return t&&!e.applyEdits(t)?o("".concat(s[s.ApplyEditsFailed],": Application of EditScope edits from user settings service failed."),{data:t}):void 0})).catch((function(e){return o("".concat(s[s.LoadEditsFailed]),{innerErrors:e})}))},u.allLifetimes=new e.TriggerableLifetimeManager,u=c=__decorate([__metadata("fx:diagnostics",[require,"1"]),MsPortalFx.Composition.ProxyCompatibilityMode,__metadata("design:paramtypes",[Object,Object])],u)}();t.EditScopeCache=f}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(t){var r=MsPortalFx.Base,n=e.Rpc,i=MsPortalFx.Data,a=new r.Diagnostics.Log("MsPortalFx/Data/Internal/Internal.Data.EditScopeCache"),o=e.Data.editScopeDiscardedReceiver,s={noEditScope:"",missingSerializeParams:"",missingSupplyExistingData:"",fetchNewPrereq:"",fetchExistingPrereq:""},u=e.getErrorMap(s),c=function(){function s(t,n){var a=this;this._ltm=new e.TriggerableLifetimeManager,this._editScopeEditsChangedSubs={},this._loadEdits=n&&n.loadEdits||c._remoteLoadEdits,this._saveEdits=n&&n.saveEdits||c._remoteSaveEditScope,this._options=MsPortalFx.clone(t),r.ProxiedObservables.markNonSerializable(this),this._cacheByParams=new i.ObjectCache({supplyValue:function(e,t){var r=a._getEditScopeForKey(e,t),n=Q(r);return n!==r&&n.catch((function(){})),r._getStatusPromise=function(){return n},r},serializeKey:function(e){return a._serializeKey(e)},onEntryDisposed:function(e,t){var r=a._serializeKey(t),n=a._editScopeEditsChangedSubs[r];n&&(a._editScopeEditsChangedSubs[r]=null,n.dispose()),e.then((function(e){e.dispose()}))}}),o.register(this)}var c;return c=s,s.prototype.createView=function(e,t){return new i.EditScopeView(this,e,t||{})},s.prototype.fetch=function(e,t){return this._cacheByParams.getValue(e,t)},s.prototype.forEachEditScope=function(e){var t=[];return this._cacheByParams.forEachEntry((function(r,n){t.push(n.then((function(t){e(r.editScopeId,t)})))})),Promise.all(t)},s.prototype.dispose=function(){var e=this._cacheByParams;e&&(e.dispose(),this._cacheByParams=null),this._ltm.dispose(),o.deregister(this)},s.prototype.disposeAndDiscardEdits=function(e,t){var r=t.editScope();r||u.noEditScope(),r.dispose(),c._remoteSaveEdits(e,{edits:[]})},s.prototype.onEditScopeDiscarded=function(e){return this._revertEditScope(e)},s._remoteSaveEditScope=function(e,t){c._remoteSaveEdits(e,t.getEdits())},s._remoteSaveEdits=function(e,r){t.saveSerializedEditScopeEndPoint.invoke(c._rpcClient,"fx",{editScopeId:e,edits:r})},s._remoteLoadEdits=function(e){return t.loadSerializedEditScopeEndPoint.invoke(c._rpcClient,"fx",e).then(null,(function(e){throw a.error("Loading of EditScope edits from user settings service failed."),e}))},Object.defineProperty(s.prototype,"_isDisposed",{get:function(){return null===this._cacheByParams},enumerable:!1,configurable:!0}),s.prototype._revertEditScope=function(e){return this.forEachEditScope((function(t,r){t===e&&r.revertAll()}))},s.prototype._serializeKey=function(e){var t=e.editScopeId,r=e.params;if(r){var n=this._options,i=n.serializeParams;if(!i&&!(i=n.serializeKeyOrQuery)){var a=typeof r;"number"===a||"string"===a?i=JSON.stringify:u.missingSerializeParams()}t+=":"+i(r)}return t},s.prototype._getEditScopeForKey=function(e,t){var r,n=this._options,a=e.params;return e.editScopeId&&(a||null===a)?(n.supplyExistingData||u.missingSupplyExistingData(),r=function(){return n.supplyExistingData(a,t)}):e.editScopeId&&void 0===a&&n.supplyNewData?r=function(){return Q.resolve(n.supplyNewData())}:e.editScopeId&&!a&&n.entityTypeName?r=function(){return Q.resolve(i.Metadata.createEmptyObject(n.entityTypeName))}:n.supplyNewData||n.entityTypeName?u.fetchExistingPrereq():u.fetchNewPrereq(),this._acquireEditScope(e,r,t,n.entityTypeName)},s.prototype._acquireEditScope=function(r,n,i,a){var o,s=this,u=Q.defer(),c=u.promise,l=r.editScopeId;return n().then((function(t){if(!s._isDisposed){var n=s._options;o=new e.TriggerableLifetimeManager;var c=e.Data.createEditScope(o,t,{kind:n.kind,typeName:a,refresh:n.refreshEditScope&&function(e){var t=i.createChildLifetime();return n.refreshEditScope(r.params,t,e).finally((function(){t.dispose()}))},save:n.saveEditScopeChanges&&function(e,t,i){var a=o.createChildLifetime();return n.saveEditScopeChanges(r.params,e,t,a,i).finally((function(){a.dispose()}))}});n.onEditScopeCreated&&n.onEditScopeCreated(i,c),s._loadAndApplyEdits(c,l).then((function(){if(!s._isDisposed){var e=s._serializeKey(r),t=s._editScopeEditsChangedSubs[e];t&&t.dispose(),t=s._editScopeEditsChangedSubs[e]=s._ltm.createChildLifetime(),c.editsChanged.subscribe(t,(function(){s._saveEdits(l,c)})),u.resolve(c)}}),(function(e){u.reject(e)}))}}),(function(){u.reject(t.FetchEditScopeError.LoadOriginalDataFailed)})),c.catch((function(e){o&&o.dispose()})),c},s.prototype._loadAndApplyEdits=function(e,r){var n=this;return this._loadEdits(r).then((function(r){if(!n._isDisposed){var i=Q.defer();return r?e.applyEdits(r)?i.resolve():(a.warning("Application of EditScope edits from user settings service failed."),i.reject(t.FetchEditScopeError.ApplyEditsFailed)):i.resolve(),i.promise}}),(function(){return t.FetchEditScopeError.LoadEditsFailed}))},s._rpcClient=n.client,s=c=__decorate([__metadata("fx:diagnostics",[require,"1"]),MsPortalFx.Composition.ProxyCompatibilityMode,__metadata("design:paramtypes",[Object,Object])],s)}();t.EditScopeCacheOld=c}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(t){var r=MsPortalFx.forEachKey,n={delayAndLifetime:"",maxEvictionDelay:"",nullKey:"",nullCreateCallback:"",cacheDisposed:""},i=e.getErrorMap(n);var a=function(){function e(e){this._isDisposed=!1,this._evictionDelayMilliseconds=null,this._evictionTimeoutHandlesByKey={},this._entriesByKey={},this._entriesByReferrerThenKey={},MsPortalFx.Base.ProxiedObservables.markNonSerializable(this),e&&(e.onEntryDisposed&&(this._onDisposeEntryCallback=function(t,r){e.onEntryDisposed(r,t)}),this._evictionDelayMilliseconds=function(e){return e.evictionDelay&&e.extendEntryLifetimes&&i.delayAndLifetime(),e.extendEntryLifetimes?105e3:(e.evictionDelay>6e4&&i.maxEvictionDelay(6e4),e.evictionDelay)}(e))}return e.prototype.getEntry=function(e,t,r){e||i.nullKey(),r||i.nullCreateCallback(),this._isDisposed&&i.cacheDisposed();var n=this._entriesByKey[e];return n||(n=new o(e,r()),t&&(this._entriesByKey[e]=n)),t?(this._ensureReferenceExists(n,t),this._cancelAnyDelayedEviction(n.key)):this._evictionTimeoutHandlesByKey[n.key]||this._immediateEvictEntryIfNoReferences(n),n.value},e.prototype.hasEntry=function(e){return e in this._entriesByKey},e.prototype.dissociateEntry=function(e,t){var r=this._entriesByKey[e];if(r){r.dissociate(t);var n=this._entriesByReferrerThenKey[t];n&&(delete n[e],MsPortalFx.isEmptyObject(n)&&delete this._entriesByReferrerThenKey[t]),this._delayedEvictEntryIfNoReferences(r)}},e.prototype.immediatelyEvictEntry=function(e){var t=this,r=this._entriesByKey[e];r&&(r.dissociateFromAllReferrers().forEach((function(r){var n=t._entriesByReferrerThenKey[r];n&&delete n[e]})),this._immediateEvictEntryIfNoReferences(r))},e.prototype.disposeReferrer=function(e){var t=this;r(this._entriesByReferrerThenKey[e],(function(r){t.dissociateEntry(r,e)}))},e.prototype.forEachEntry=function(e){r(this._entriesByKey,(function(t,r){e(t,r.value)}))},e.prototype.dispose=function(){var e=this;this._isDisposed=!0;var t=this._onDisposeEntryCallback;t&&this.forEachEntry(t),this._entriesByKey={},this._entriesByReferrerThenKey={},r(this._evictionTimeoutHandlesByKey,(function(t){e._cancelAnyDelayedEviction(t)}))},e.prototype._ensureReferenceExists=function(e,t){var r=this._entriesByReferrerThenKey[t];r||(r={},this._entriesByReferrerThenKey[t]=r);var n=e.key;n in r||(r[n]=e,e.associate(t))},e.prototype._cancelAnyDelayedEviction=function(e){var t=this._evictionTimeoutHandlesByKey[e];t&&(delete this._evictionTimeoutHandlesByKey[e],clearTimeout(t))},e.prototype._delayedEvictEntryIfNoReferences=function(e){var t=this;if(e.hasNoReferences()){var r=e.key;this._cancelAnyDelayedEviction(r),null===this._evictionDelayMilliseconds||void 0===this._evictionDelayMilliseconds?this._immediateEvictEntryIfNoReferences(e):this._evictionTimeoutHandlesByKey[r]=setTimeout((function(){t._immediateEvictEntryIfNoReferences(e)}),this._evictionDelayMilliseconds)}},e.prototype._immediateEvictEntryIfNoReferences=function(e){if(e.hasNoReferences()){var t=e.key,r=e.value;delete this._entriesByKey[t];var n=this._onDisposeEntryCallback;n&&n(t,r),this._cancelAnyDelayedEviction(t)}},e}();t.RefCountCache=a;var o=function(){function e(e,t){this._referrerIds=new Map,this.key=e,this.value=t}return e.prototype.hasNoReferences=function(){return!this._referrerIds.size},e.prototype.associate=function(e){this._referrerIds.set(e,e)},e.prototype.dissociate=function(e){this._referrerIds.delete(e)},e.prototype.dissociateFromAllReferrers=function(){var e=[],t=this._referrerIds;return t.forEach((function(t,r){return e.push(r)})),t.clear(),e},e}()}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(e){!function(e){function t(e,t){var r=e[t];return ko.isObservable(r)&&!MsPortalFx.isObservableArray(r)}e.unwrapObjectPropertyValue=function(e,r){var n=e[r];return t(e,r)?n():n},e.isObservableObjectPropertyValue=t,e.unwrapArrayOrObservableArray=function(e){if(!MsPortalFx.isArrayOrObservableArray(e))throw new Error("Only an array or an observable array is expected here.");return ko.unwrap(e)}}(e.Shared||(e.Shared={}))}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(e){var t=MsPortalFx.Data.Metadata,r=MsPortalFx.isArrayOrObservableArray,n=MsPortalFx.isObject,i=function(){function i(e,t){var r=this,n=t,i=this._callbacks={};["visitEntityArray","visitNonEntityArray","visitArray","visitArrayItem","visitEntity","visitNonEntityObject","visitObject","shouldVisitObjectProperty","visitEntityTypedObjectPropertyValue","visitNonEntityTypedObjectPropertyValue","visitObjectPropertyValue","visitDate","visitScalar","visitFunction"].forEach((function(e){i[e]=n[e]||function(){return r[e].apply(r,arguments)}}))}return i.prototype.visit=function(e,t,r){return this._visit(e,t,r)},i.prototype.visitEntityArray=function(e,t,r){return this._callbacks.visitArray(e,t,r)},i.prototype.visitNonEntityArray=function(e,t,r){return this._callbacks.visitArray(e,t,r)},i.prototype.visitArray=function(t,r,n){for(var i=this._callbacks.visitArrayItem,a=e.Shared.unwrapArrayOrObservableArray(t),o=0,s=a.length;o<s;o++)i(a[o],o,r,n)},i.prototype.visitArrayItem=function(e,t,r,n){if(ko.isObservable(e))throw new Error("Data can't include arrays whose items are observables.  Only scalar- and object-typed array items are supported.");return this._visit(e,r,n)},i.prototype.visitEntity=function(e,t,r){return this._callbacks.visitObject(e,t,r)},i.prototype.visitNonEntityObject=function(e,t,r){return this._callbacks.visitObject(e,t,r)},i.prototype.visitObject=function(e,t,r){for(var n=this.getObjectPropertiesToVisit(e,t),i=0,a=n.length;i<a;i++)this.visitObjectPropertyValueDispatch(n[i],e,t,r)},i.prototype.shouldVisitObjectProperty=function(e,t,r){return"function"!=typeof ko.unwrap(t[e])},i.prototype.visitEntityTypedObjectPropertyValue=function(t,n,i,a){var o=e.Shared.unwrapObjectPropertyValue(n,t),s=r(o)?this._callbacks.visitEntityArray:o?this._callbacks.visitEntity:void 0;return s&&s(o,i,a)},i.prototype.visitNonEntityTypedObjectPropertyValue=function(e,t,r,n){return this._callbacks.visitObjectPropertyValue(e,t,r,n)},i.prototype.visitObjectPropertyValue=function(t,r,n,i){return this._visit(e.Shared.unwrapObjectPropertyValue(r,t),n,i)},i.prototype.visitDate=function(e,t){},i.prototype.visitScalar=function(e,t){},i.prototype.visitFunction=function(e,t){},i.prototype.getObjectPropertiesToVisit=function(e,t){var r=this._callbacks.shouldVisitObjectProperty;return Object.keys(e).filter((function(n){return r(n,e,t)}))},i.prototype.visitObjectPropertyValueDispatch=function(e,r,n,i){var a=t.getPropertyTypeMetadata(n,e),o=t.typeIsEntityType(a),s=this._callbacks;return(o?s.visitEntityTypedObjectPropertyValue:s.visitNonEntityTypedObjectPropertyValue).call(null,e,r,a,i)},i.prototype._visit=function(e,t,i){var a;if(r(e)?a=this._visitArrayDispatch:n(e)&&(a=this._visitObjectDispatch),a)return a.call(this,e,t,i);var o=this._callbacks,s=o.visitScalar;return e instanceof Date?s=o.visitDate:"function"==typeof e&&(s=o.visitFunction),s.call(null,e,i)},i.prototype._visitArrayDispatch=function(e,r,n){var i=this._callbacks,a=i.visitNonEntityArray;return t.typeIsEntityType(r)&&(a=i.visitEntityArray),a.call(null,e,r,n)},i.prototype._visitObjectDispatch=function(e,r,n){var i=this._callbacks,a=i.visitNonEntityObject;return t.typeIsEntityType(r)&&(a=i.visitEntity),a.call(null,e,r,n)},i}();e.Visitor=i}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(e){var t=MsPortalFx.isObservableArray,r=function(r){function n(e,t){return r.call(this,e,t)||this}return __extends(n,r),n.prototype.clone=function(e,t){return this._visit(e,t)},n.prototype.visitArray=function(r,n){var i=this,a=e.Shared.unwrapArrayOrObservableArray(r).map((function(e,t){return i._callbacks.visitArrayItem(e,t,n)}));return t(r)&&(a=r.splice?ko.observableArray(a):ko.observable(a)),a},n.prototype.visitObject=function(e,t){var r=this,n={};return this.getObjectPropertiesToVisit(e,t).forEach((function(i){n[i]=r.visitObjectPropertyValueDispatch(i,e,t)})),n},n.prototype.visitEntityTypedObjectPropertyValue=function(e,t,r){return this._callbacks.visitObjectPropertyValue(e,t,r)},n.prototype.visitObjectPropertyValue=function(t,r,n){var i=r[t],a=e.Shared.isObservableObjectPropertyValue(r,t),o=this._visit(a?i():i,n);return a?ko.observable(o):o},n.prototype.visitDate=function(e){return new Date(e.getTime())},n.prototype.visitScalar=function(e){return e},n.prototype.visitFunction=function(e){throw new Error("Cloning functions is not supported.")},n}(e.Visitor);e.CloneVisitor=r}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(t){var r=MsPortalFx.Data.Metadata,n=MsPortalFx.areEqual,i=MsPortalFx.isArrayOrObservableArray,a=MsPortalFx.isObject,o=MsPortalFx.isObservableArray,s=ko.utils,u=s.compareArrays,c={cannotMerge:"",handleAddAndDeleteRequired:"",dataNotTypeCompatible:"",missingId:""},l=e.getErrorMap(c),d=function(e){function c(t,r){var n=e.call(this,t,r)||this;return n._clone=t.clone,n._onDetach=t.onDetach,n}return __extends(c,e),c.prototype.merge=function(t,r,n){e.prototype._visit.call(this,t,n,r)||l.cannotMerge()},c.prototype.visitObject=function(e,t,r){var n=this;return this.getObjectPropertiesToVisit(e,t).every((function(i){return n.visitObjectPropertyValueDispatch(i,e,t,r)}))},c.prototype.visitObjectPropertyValueDispatch=function(n,i,a,s){var u=e.prototype.visitObjectPropertyValueDispatch.call(this,n,i,a,s);if(!u){var c=s[n],d=t.Shared.unwrapObjectPropertyValue(i,n),f=t.Shared.unwrapObjectPropertyValue(s,n);if(ko.isObservable(c)&&o(d)!==o(f)&&l.dataNotTypeCompatible(),ko.isObservable(c)){u=!0;var p=r.getPropertyTypeMetadata(a,n);f&&this._onDetach(f,p),c(this._clone(d,p))}else u=!1}return u},c.prototype.visitEntityTypedObjectPropertyValue=function(e,t,r,n){return this._callbacks.visitObjectPropertyValue(e,t,r,n)},c.prototype.visitNonEntityTypedObjectPropertyValue=function(e,t,r,n){return this._callbacks.visitObjectPropertyValue(e,t,r,n)},c.prototype.visitObjectPropertyValue=function(e,r,o,s){var u,c=t.Shared.unwrapObjectPropertyValue(r,e),l=t.Shared.unwrapObjectPropertyValue(s,e);return i(c)?i(l)&&(u=this._visitArrayDispatch(c,o,l)):a(c)?a(l)&&(u=this._visitObjectDispatch(c,o,l)):("function"==typeof c||n(c,l))&&(u=!0),u},c.prototype.visitArray=function(e,t,r){return this._mergeArray(e,t,r)},c.prototype._mergeArray=function(e,n,i,a){var o=this;if(!!(a=a||{}).handleAdd!=!!a.handleDelete&&l.handleAddAndDeleteRequired(),!a.getEdits){var c=void 0,d=void 0;if(r.typeHasId(n)){var f=function(e){var t=r.getItemId(e,n);return void 0===t&&l.missingId(),t};c=function(e,t){var r=e.map(f),n=t.map(f),i=u(n,r);return i.forEach((function(r){r.value=MsPortalFx.find("added"===r.status?e:t,(function(e){return f(e)===r.value}))})),i},d=function(e,t){var r=f(e);return MsPortalFx.find(t,(function(e){return f(e)===r}))}}else c=function(e,t){return u(t,e)},d=null;MsPortalFx.extend(a,{getEdits:c,getSourceItem:d})}for(var p,h=t.Shared.unwrapArrayOrObservableArray(e),y=t.Shared.unwrapArrayOrObservableArray(i),m=ko.isObservable(i),v=m&&i,g=v&&v(),_=function(e){var t=e.index;switch(e.status){case"added":var r=o._clone(e.value,n);if(a.handleAdd)a.handleAdd(r,t);else{if(!m)return!1;p=!0,g.splice(t,0,r)}break;case"deleted":var i=e.value;if(a.handleDelete)a.handleDelete(i,t);else{if(!m)return!1;o._onDetach(i,n),p=!0,g.splice(t,1)}break;case"retained":if(a.getSourceItem){var s=e.value,u=a.getSourceItem(s,h);if(!o._callbacks.visitObject(u,n,s)){if(!m)return!1;o._onDetach(s,n),p=!0,g.splice(g.indexOf(s),1,o._clone(u,n))}}}return!0},b=s.adjustArrayEdits(a.getEdits(h,y)),x=!0,E=0;E<b.length;E++){if(!_(b[E])){x=!1;break}}return p&&v(g),x},c}(t.Visitor);t.MergeVisitor=d}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(e){var t=function(e){function t(t,r,n){var i=e.call(this,n)||this;return i._currentSkipTakeParams=ko.observable(null),i._allItems=r,i.items=ko.computed(t,(function(){var e,t=i._allItems;return(e=i._currentSkipTakeParams())&&t()?t().slice(e.skip,e.take?e.skip+e.take:void 0):[]})),i.metadata=ko.computed(t,(function(){return{totalItemCount:i._allItems().length}})),i}return __extends(t,e),t.prototype.loadBySkipTake=function(e,t,r){return this._currentSkipTakeParams({skip:e||0,take:t}),Q(!0)},t}(e.DataNavigatorBase);e.LocalDataNavigator=t}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=function(t){function r(e,r,n,i,a){var o=t.call(this,a)||this;if(o._continuationTokenFilter=null,o._continuationTokenSort=[],o._continuationTokenResetRequested=!0,o._queryParams=null,!e)throw new Error("Argument cannot be null: lifetime");return o.items=r,o.metadata=n,o._options=i,o._options.loadBySkipTake||(o.loadBySkipTake=null),o._options.loadByContinuationToken||(o.loadByContinuationToken=null),o}return __extends(r,t),r.prototype.loadBySkipTake=function(e,t,r,n){if(!this._options.loadBySkipTake)throw new Error("This data navigator does not support skip/take.");return this._options.loadBySkipTake(this.metadata(),this._getClonedQuery(),e,t,r,n)},r.prototype.loadByContinuationToken=function(){if(!this._options.loadByContinuationToken)throw new Error("This data navigator does not support continuation tokens.");var e=this._continuationTokenResetRequested;return this._continuationTokenResetRequested=!1,this._options.loadByContinuationToken(this.metadata(),this._getClonedQuery(),e,this._continuationTokenFilter,this._continuationTokenSort)},r.prototype.resetLoadByContinuationToken=function(e,t){this._continuationTokenResetRequested=!0,this._continuationTokenFilter=e,this._continuationTokenSort=t},r.prototype.setQuery=function(e){return this._queryParams=e,this.resetNavigation()},r.prototype._getClonedQuery=function(){return e.clone(this._queryParams,!0)},r}(t.DataNavigatorBase);t.RemoteDataNavigator=r}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){!function(r){function n(r,i,a){Array.isArray(r)?r.forEach((function(e){n(e,i,a)})):e.isObject(r)&&Object.getOwnPropertyNames(r).forEach((function(e){var o=t.Metadata.getPropertyMetadata(i,e),s=o&&o.itemType;a(r,e,o)&&s&&n(r[e],s,a)}))}r.DataContractJsonSerializer={processResult:function(e,t,r,i,a){return a&&n(t.data,a,(function(e,t,r){var n,i=!0;if(r&&(r.isDate||"System.DateTime"===r.itemType)){var a=e[t];"string"==typeof a&&(e[t]=(n=a).startsWith("/Date(")?new Date(parseInt(n.slice(6),10)):new Date(n)),i=!1}return i})),!0}}}(t.DataProvider||(t.DataProvider={}))}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){!function(e){function t(e){var t,r=e.property,n=e.operator,i=e.value;switch("string"==typeof i?i="'"+i+"'":i&&i instanceof Date&&(i="datetime'"+i.toISOString()+"'"),n){case"<":t=r+" lt "+i;break;case"<=":t=r+" le "+i;break;case"==":t=r+" eq "+i;break;case"!=":t=r+" ne "+i;break;case">=":t=r+" ge "+i;break;case">":t=r+" gt "+i;break;case"StartsWith":t="startswith("+r+","+i+") eq true";break;case"EndsWith":t="endswith("+r+","+i+") eq true";break;case"Contains":t="substringof("+i+","+r+") eq true";break;default:throw new Error("The operator '"+n+"' is not supported.")}return t}function r(e){return e.descending?e.property+" desc":e.property}e.OData={shapeQuery:function(e){var n={},i=e.filter;i&&i.length&&(n.$filter=i.map(t).join(" and "));var a=e.sort;a&&a.length&&(n.$orderby=a.map(r).join());var o=e.paging;return o&&o.skip&&(n.$skip=o.skip),o&&o.take&&(n.$top=o.take),e.includeTotalCount&&(n.$inlinecount="allpages"),n}}}(e.DataProvider||(e.DataProvider={}))}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=FxImpl.Data.AtomizationContext,n=e.Data.Metadata,i=e.Base.ProxiedObservables,a=e.isUndefined,o=e.isObject,s=e.isNullOrUndefined,u=(new e.Base.Diagnostics.Log("MsPortalFx/Data/Data.DataSet"),Array.isArray),c="aux-lockState",l="",d={missingId:l,incorrectOptions:l,invalidEditKind:l,multipleIds:l,invalidMergeTarget:l,addToNonArray:l,removeFromNonArray:l,noObservableToReceiveMergeChange:l,mergeSubscriberRaisedException:l,observableChangeFailed:l},f=FxImpl.getErrorMap(d);function p(e,t){i.data(e,c,t)}function h(e){return u(e)||o(e)?i.data(e,c):null}function y(e){i.data(e,c,void 0)}function m(e){var t=ko.unwrap(e);return u(t)?e:t}function v(e,t){var r=ko.unwrap(e[t]);return u(r)?e[t]:r}function g(e,t){return e===t}function _(e,r,n){var i=h(e);return!i||(1!==n||i.editKind!==t.EditKind.Add)&&(!r||i.unlockedAt&&r>=i.unlockedAt)}function b(e,t){return t&&t.indexOf?t.indexOf(e):-1}function x(e,t,r,n){ko.isObservable(t)&&F(e,n,(function(){t.valueWillMutate()}));var i=ko.unwrap(t);i.splice.apply(i,[0,i.length].concat(r)),ko.isObservable(t)&&F(e,n,(function(){t.valueHasMutated()}))}function E(e,t,r){var n,i,o,s,u,c,l=e.length;for(n=r-1;n>=0;n--)if((i=b(e[n],t))>=0){o=i+1,s=r-n;break}for(n=r+1;n<l;n++)if((i=b(e[n],t))>=0){u=i,c=n-r;break}return i=a(s)&&a(c)?t.length:(s||1e5)<(c||1e5)?o:u}function P(e,t,r){var n,i,a,c=ko.unwrap(e);if(!s(c)){if(n=!1,r++,u(c))for(i=0,a=c.length;i<a&&((n=t(v(c,i)))||P(v(c,i),t,r),!n);i++);else if(o(c)&&(1===r&&(n=t(c)),!n))for(var l in c)if(!/^jQuery\d+$/.test(l)&&(n=P(v(c,l),t,r)))break;return n}}var S=function(){function i(t,n,i){this._data=null,this._navigationMetadata=ko.observable(null),this._partialErrors=ko.observableArray(),e.Base.ProxiedObservables.markNonSerializable(this),this._type=t||null,i&&!n&&f.incorrectOptions(),this._lifetime=n,this._atomizationContext=i&&r.get(i.atomizationContextId)}var o;return o=i,Object.defineProperty(i.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lifetime",{get:function(){return this._lifetime},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"navigationMetadata",{get:function(){return this._navigationMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"partialErrors",{get:function(){return this._partialErrors},enumerable:!1,configurable:!0}),i.lockItem=function(e,r){t.EditKind[r]||f.invalidEditKind(),p(e,{editKind:r})},i.hasUnmergedClientChanges=function(e){return P(e,(function(e){var t=h(e);return!(!t||!t.unlockedAt)}),0)},i.unlockItem=function(e,t){if(t=1===arguments.length||t){var r=h(e);r&&(r.unlockedAt=Date.now())}else y(e)},i.isLockedItem=function(e){var t=h(e);return!(!t||t.unlockedAt)},i.getIdPropertyNames=function(e){e instanceof o&&(e=e.data);var t=n.getArrayItemType(e);return t&&n.getIdPropertyNames(t&&n.getTypeMetadata(t))},i.getIdPropertyName=function(e){var t=this.getIdPropertyNames(e),r=null;return t&&(t.length>1&&f.multipleIds(),r=t[0]||null),r},i.mergeWithoutAtomization=function(e,t,r){I(null,e,t,(r=r||{}).type||n.getArrayItemType(t),r,null)||f.invalidMergeTarget()},i.prototype.addItems=function(e,r,i,o,s){var c,l=this;i=i||{},s?c=i.type||n.getArrayItemType(s):(s=this.data,c=this.type),u(ko.unwrap(s))||f.addToNonArray(),o=!!a(o)||o;var d=r.map((function(e){var r=D(null,e,c,i,l);return o&&p(m(r),{editKind:t.EditKind.Add}),r}));s.splice.apply(s,[e,0].concat(d))},i.prototype.removeItems=function(e,t,r,i){i?r=r||n.getArrayItemType(i):(i=this.data,r=this.type),u(ko.unwrap(i))||f.removeFromNonArray();var a=i.splice(e,t);this._atomizationContext&&this._atomizationContext.releaseEntities(r,a,this.lifetime)},i.prototype.removeItem=function(e,t,r){r||(r=this.data);var n=b(e,ko.unwrap(r));n>=0&&this.removeItems(n,1,t,r)},i.prototype.setProperty=function(e,t,r,n){var i;r=r||{},n?i=r.type:(n=this.data,i=this.type),I(null,t,n[e],i,r,this)||w(null,n,e,t,i,r,this)},i.prototype.merge=function(e,t){t=t||{},I(".",e,this.data,this.type,t,this)||w(".",this,"_data",e,this.type,t,this)},i.prototype.hasUnmergedClientChanges=function(){return o.hasUnmergedClientChanges(this.data)},i=o=__decorate([__metadata("fx:diagnostics",[require,"1"]),e.Composition.ProxyCompatibilityMode,__metadata("design:paramtypes",[String,Object,Object])],i)}();function I(e,t,r,n,i,a){var s=!0,c=ko.unwrap(r);return u(c)?M(e,t,r,n,i,a):o(c)?C(e,t,r,n,i,a):s=!1,s}function M(e,t,r,i,o,s){var u=n.getArrayItemType(r)||i,c=n.typeHasId(u);o.preserveNewItemsOrdering?function(e,t,r,i,o,s,u){var c,l,d,f,p,h,y,v=ko.unwrap(r),b=v.length,P=ko.unwrap(t),S=P.length,I=o&&P.map((function(t){var r=n.getItemId(ko.unwrap(t),i);return a(r)&&T(e,s),r})),M=s.preventItemRemoval,w=s.fetchStart,F=[],A=P.slice(0);for(c=0;c<b;c++){if(l=v[c],d=void 0,h=!1,o&&S>0)for(d=n.getItemId(ko.unwrap(l),i),a(d)&&T(e,s),f=0;f<S;f++)p=P[f],g(d,I[f])&&(C(e,p,l,i,s,u),P.splice(f,1,l),A[f]=null,h=!0);h||!M&&_(m(l),w,1)||F.push(c)}for(f=0;f<S;f++)(p=A[f])&&(P[f]=D(e,p,i,s,u));var k=F.length;for(y=0;y<k;y++)l=v[c=F[y]],f=E(v,P,c),P.splice(f,0,l);x(e,r,P,s)}(e,t,r,u,c,o,s):function(e,t,r,i,o,s,u){var c,l,d,f,p,h,y=ko.unwrap(r),v=y.slice(0),g=ko.unwrap(t),b=o&&function(e,t,r,i){for(var o={},s=[],u=0,c=t.length;u<c;u++){var l=t[u],d=n.getItemId(l,r);a(d)?T(e,i):(o[d]=l,s.push(d))}return{index:o,ids:s}}(e,g,i,s),E=s.preventItemRemoval,P=s.fetchStart,S=[],I={},M=0,w=!1;for(c=y.length-1;c>=0;c--)l=y[c],p=null,o&&(d=n.getItemId(ko.unwrap(l),i),a(d)&&T(e,s),p=b.index[d]),p?(C(e,p,l,i,s,u),I[d]=!0,M++):!E&&_(m(l),P,1)&&(v.splice(c,1),w=!0);if(M!==g.length){for(f=0,h=g.length;f<h;f++)p=g[f],o&&I.hasOwnProperty(b.ids[f])||S.push(D(e,p,i,s,u));S.length>0&&(v.push.apply(v,S),w=!0)}w&&x(e,r,v,s)}(e,t,r,u,c,o,s)}function C(e,t,r,i,a,c){if(_(m(r),a.fetchStart,0)){y(m(r));var l=ko.unwrap(r),d=function(r){if(t.hasOwnProperty(r)){var d=ko.unwrap(l[r]),p=ko.unwrap(t[r]),h=n.getPropertyType(i,r),y=k(e,r);if(null===p)null!==d&&(ko.isObservable(l[r])?F(y,a,(function(){l[r](null)})):f.observableChangeFailed(a.dataSetName,y));else if(u(p))u(d)?M(y,p,l[r],h||null,a,c):w(y,l,r,p,h,a,c);else if(o(p))s(d)?w(y,l,r,p,h,a,c):d instanceof Date?(d>p||d<p)&&w(y,l,r,p,h,a,c):C(y,p,d,h||null,a,c);else{if("function"==typeof p)return"continue";w(y,l,r,p,h,a,c)}}};for(var p in t)d(p)}}function w(e,t,r,n,i,a,o){var s=D(e,n,i,a,o);if(t[r]&&ko.isObservable(t[r]))F(e,a,(function(){t[r](ko.unwrap(s))}));else{var u=ko.isObservable(s)?s:ko.observable(s);t[r]=u}}function F(t,r,n){try{n()}catch(n){f.mergeSubscriberRaisedException(r.dataSetName,t,e.getLogFriendlyMessage(n))}}function D(e,t,r,i,a){var o=A(e,t,r,i,a);return n.decorateWithType(o,r),o}function A(e,t,r,i,a){var s;return s=u(ko.unwrap(t))?ko.observableArray(ko.unwrap(t).map((function(t){return A(e,t,r,i,a)}))):o(t)?function(e,t,r,i,a){var o,s,u=a&&a.lifetime&&a._atomizationContext&&FxImpl.Data.AtomizationContext.canAtomizeType(r);if(u){s=n.getItemId(t,r);var c=a._atomizationContext.getEntity(r,s,a.lifetime);c&&(C(e,t,c,r,i,a),o=c)}if(!o){for(var l in o={},t)if(t.hasOwnProperty(l)){var d=A(k(e,l),t[l],n.getPropertyType(r,l),i,a);o[l]=ko.isObservable(d)?d:ko.observable(d)}u&&a._atomizationContext.addEntity(r,s,o,a.lifetime)}return o}(e,t,r,i,a):t,s}function k(e,t){return e&&"".concat(e,"/").concat(t)}function T(e,t){f.missingId(t.dataSetName,e)}t.DataSet=S}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){!function(e){e[e.Copy=0]="Copy",e[e.InPlace=1]="InPlace"}(e.EditScopeKind||(e.EditScopeKind={})),function(e){e[e.None=0]="None",e[e.Created=1]="Created",e[e.Deleted=2]="Deleted",e[e.Updated=3]="Updated"}(e.EditState||(e.EditState={})),function(e){e[e.AcceptClientChanges=0]="AcceptClientChanges",e[e.DiscardClientChanges=1]="DiscardClientChanges",e[e.RefreshFromServerImplicitly=2]="RefreshFromServerImplicitly",e[e.ServerChangesAppliedManually=3]="ServerChangesAppliedManually",e[e.ServerDataReturned=4]="ServerDataReturned"}(e.AcceptEditScopeChangesAction||(e.AcceptEditScopeChangesAction={}))}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=MsPortalFx.Data.Metadata,n=MsPortalFx.Data.EditState,i=e.Data.Shared,a=MsPortalFx.Data.AcceptEditScopeChangesAction,o=e.Data.Visitor,s=e.Data.CloneVisitor,u=e.Data.MergeVisitor,c=MsPortalFx.Data.EditScopeKind,l=MsPortalFx.isArrayOrObservableArray,d=MsPortalFx.areEqual,f=MsPortalFx.isUndefined,p=MsPortalFx.isNullOrUndefined,h=MsPortalFx.isObject,y=MsPortalFx.getUniqueId,m=MsPortalFx.Data.DataSet,v=MsPortalFx.Base.ProxiedObservables,g=i.unwrapArrayOrObservableArray,_=i.unwrapObjectPropertyValue,b=i.isObservableObjectPropertyValue,x=Array.isArray,E=r.typeIsEntityType,P=r.getPropertyTypeMetadata,S=new MsPortalFx.Base.Diagnostics.Log("MsPortalFx/Data/Data.EditScope"),I=void 0,M=MsPortalFx.isDevelopmentMode,C="Turn on development mode to generate diagnostic information for this error.",w=MsPortalFx.forEachKey,F=MsPortalFx.isEmpty,D="",A={accessorLifetime:D,scopeInputType:D,scopeOptsTypes:D,missingMeta:D,noRefresh:D,noSave:D,entityDupe:D,saveInProg:D,nullMerge:D,resetInProg:D,noEntityRoot:D,resetType:D,newInputObs:D,newEditObs:D,diffEditInput:D,missingIdProp:D,targetArrObs:D,editsUnavail:D,mergeUnavail:D,noImpl:D,serialize:D,namedMeta:D,disposed:D,nestedEntities:D,makeObs:D,entityEdit:D,resetObs:D,moveEditState:D},k=e.getErrorMap(A);t.allowNonPersistentEdits=!1,t.createEditScope=function(t,r,n){var i=n&&n.kind;return t.createChildLifetime||(n=r,r=t,t=new e.TriggerableLifetimeManager),i===c.InPlace?new U(t,r,n):new H(t,r,n)},t.logEditsToConsole=function(e){var t=Y(e);if(t.length){var r=t.map((function(e){var t={state:n[e.state]},r=e.entityReference;return r&&r.type&&(t.entityType=r.type,t.entityId=r.id),e.entityPath&&(t.pathFromRoot=e.entityPath),e.encodedCreatedEntities&&(t.createdEntities=e.encodedCreatedEntities),e.entityUpdates&&(t.updates=e.entityUpdates),t})),i=JSON.stringify(ko.toJS(r),(function(e,t){return e&&f(t)?"<undefined>":t}),4);console.debug(i)}else console.debug("No edits")},t.nonPersistedPropertySentinel="EDITSCOPENOTPERSISTED";var T={entityType:!0};function R(){k.accessorLifetime()}function O(e){var t,r="";e&&e.stack&&(r+=" Inner exception:".concat(e.message," at ").concat(null===(t=e.stack)||void 0===t?void 0:t.slice(0,6e3))),k.resetObs(r)}var B={registerForDispose:R,createChildLifetime:R,isDisposed:R};function j(e,t,r){return void 0===t&&(t={}),void 0===r&&(r=!1),MsPortalFx.extend({shouldVisitObjectProperty:function(t,n,i){return X(t,i)&&e().shouldVisitObjectProperty(t,n,i)&&(!r||!E(P(i,t)))}},t)}var N=function(){function i(){this._isDisposed=!1,this._initializing=ko.observable(!0),this._saving=ko.observable(!1),this._refreshing=ko.observable(!1),this._refreshInProgressCount=0,this._resettingValue=ko.observable(!1),this._dirty=ko.observable(!1),this._edits=ko.observable([]),this.editsChanged=ko.observable()}return i.prototype.init=function(t,n,i,a){var o=this;v.markNonSerializable(this),t.createChildLifetime||(a=i,i=n,n=t,t=new e.TriggerableLifetimeManager);var s=this._ltm=t.createChildLifetime();this._createEditableAndOriginalData=a;var u=l(n)&&ko.unwrap(n);u&&(0===u.length||h(u[0]))||h(n)||k.scopeInputType();var c=(i=i||{}).typeMetadata;c?i.typeName&&k.scopeOptsTypes():i.typeName&&((c=r.getTypeMetadata(i.typeName))||k.missingMeta(i.typeName)),this._hasMetadata=!!c,c?c.entityType||(c=MsPortalFx.extend2(c,{entityType:!0})):c=T,this._inconsistent=ko.pureComputed((function(){return o._initializing()||o._refreshing()||o._saving()||o._resettingValue()})),this._getEditsVisitor=this._createGetEditsVisitor(!1),this._getPersistableEditsVisitor=this._createGetEditsVisitor(!0),this._applyEditsVisitor=this._createApplyPersistedEditsVisitor(),this._revertAllVisitor=this._createRevertAllVisitor(),this._generateValueBasedEntityIdVisitor=this._createGenerateValueBasedEntityIdVisitor(),this._mergeToEditableVisitor=this._createMergeToEditableVisitor(),ko.computed(s,(function(){o._inconsistent()?o._edits(null):(o._edits(o._getEdits(!1)),o.editsChanged.valueHasMutated())})),this._entityStateKey="aux-entityState"+y(),this._entityArrayStateKey="aux-entityArrayState"+y(),this._rootTypeMetadata=c,this._root=this._createEditableAndOriginalData(n,this._rootTypeMetadata).editable,this._refreshCallback=i.refresh||function(e){return k.noRefresh(),null},this._saveCallback=i.save||function(e,t,r){return k.noSave(),null},ko.computed(s,(function(){o._inconsistent()||o._dirty(o._edits().length>0)})),this._initializing(!1)},i.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this._deregisterNestedEntities(this._root,this._rootTypeMetadata,!1),this._ltm.dispose())},Object.defineProperty(i.prototype,"root",{get:function(){return this._assertNotDisposed(),this._root},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dirty",{get:function(){return this._dirty},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"refreshing",{get:function(){return this._refreshing},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"saving",{get:function(){return this._saving},enumerable:!1,configurable:!0}),i.prototype.markForDelete=function(e){this._assertNotDisposed();var t=this._getEntityState(e,!1),r=t.readOnlyEditState();r!==n.None&&this._revertEntity(e,t,r),r!==n.Created&&this._markAsDeletedOrUpdated(e,n.Deleted)},i.prototype.create=function(e){this._assertNotDisposed();var t=this._getEntityArrayType(e,!1);return r.createEmptyObject(t)},i.prototype.addCreated=function(e,t){this._assertNotDisposed(),this._getEntityState(e,!1,!1)&&k.entityDupe();var r=this._getCreatedEntities(t,!1);this._addEntityStateToCreatedEntity(e,t),r.push(e)},i.prototype.revert=function(e){this._assertNotDisposed();var t=this._getEntityState(e,!1),r=t.readOnlyEditState();this._revertEntity(e,t,r),t.writableEditState(n.None)},i.prototype.revertAll=function(){this._assertNotDisposed(),this._revertAll()},i.prototype.getEditState=function(e){return this._assertNotDisposed(),this._getEditState(e,!1)},i.prototype.getOriginal=function(e){return this._assertNotDisposed(),l(e)?this._getEntityArrayState(e,!1).original:this._getEntityState(e,!1).original},i.prototype.getCreated=function(e){return this._assertNotDisposed(),this._getCreatedEntities(e,!1)},i.prototype.mergeFromOriginal=function(){this._assertNotDisposed(),this._mergeFromOriginal()},i.prototype.refresh=function(){var e=this;this._assertNotDisposed(),this._refreshInProgressCount++,this._refreshing(!0);var t=this._refreshCallback(this._getRefreshableData())||Q(I),r=Q.defer(),n=function(){--e._refreshInProgressCount<=0&&(e._refreshInProgressCount=0,e._refreshing(!1))};return t.then((function(t){e._onRefreshComplete(t),e._isDisposed||(n(),r.resolve())})).catch((function(e){n(),r.reject(e)})),r.promise},i.prototype.save=function(){this.mergeFromOriginal(),this.revertAll()},i.prototype.saveChanges=function(){var e=this;this._assertNotDisposed(),this._inconsistent()&&k.saveInProg();var t=this._edits();if(0===t.length)return Q();this._saving(!0);var r=MsPortalFx.mapMany(t,(function(e){switch(e.state){case n.Created:return e.createdEntities.map((function(t){return{editState:n.Created,entityTypeName:e.typeMetadata.name,entity:t}}));case n.Updated:case n.Deleted:return[{editState:e.state,entityTypeName:e.typeMetadata.name,entity:e.updatedOrDeletedEntity}]}return[]})),i=this._saveCallback(this,r,this._getRefreshableData())||Q(I),o=Q.defer(),s=function(){e._revertAll(),e._isDisposed||(e._saving(!1),o.resolve())};return i.then((function(t){switch(t&&t.action||a.AcceptClientChanges){case a.AcceptClientChanges:e._acceptChanges();break;case a.DiscardClientChanges:break;case a.RefreshFromServerImplicitly:return e.refresh().then((function(){s()}));case a.ServerChangesAppliedManually:e._onRefreshComplete(null);break;case a.ServerDataReturned:var r=t.dataToMerge;r||k.nullMerge(),e._onRefreshComplete(r)}s()})).catch((function(t){e._isDisposed||(e._saving(!1),o.reject(t))})),o.promise},i.prototype.resetValue=function(e,t){var r,n,i=this;this._assertNotDisposed(),this._inconsistent.peek()&&k.resetInProg(),e.returnsObservablesFromEditScope||O();try{r=e.getOriginalObservable(B),n=e.getEditableObservable(B)}catch(e){O(e)}r&&n&&!ko.isComputed(r)&&!ko.isComputed(n)||O();var a,s,u,c;this._resettingValue(!0);try{var l=(u=n,(c=new o(null,j((function(){return c}),{visitObject:function(e,t,r){c.getObjectPropertiesToVisit(e,t).forEach((function(r){e[r]===u?(s=!0,a=P(t,r)):c.visitObjectPropertyValueDispatch(r,e,t)}))}}))).visit(i._root,i._rootTypeMetadata),s||k.noEntityRoot(),a);Z(l)&&k.resetType();var d=t.newInputValue;ko.isObservable(d)&&k.newInputObs();var f=this._createEditableAndOriginalData(d,l);if(n(f.editable),r(f.original),t.hasOwnProperty("newEditableValue")){var p=t.newEditableValue;ko.isObservable(p)&&k.newEditObs(),(x(p)||h(p))&&p===f.original&&k.diffEditInput(),n(t.newEditableValue)}}finally{this._resettingValue(!1)}},i.prototype.getEntityArrayWithEdits=function(e){var t=this,r=this._getCreatedEntities(e,!1)(),i=ko.unwrap(e);return{arrayWithEdits:i.filter((function(e){return t.getEditState(e)()!==n.Deleted})).concat(r),createdEntities:r,updatedEntities:i.filter((function(e){return t.getEditState(e)()===n.Updated})),deletedEntities:i.filter((function(e){return t.getEditState(e)()===n.Deleted}))}},i.prototype.applyArrayAsEdits=function(e,t){var n=this,i=this._getEntityArrayState(t,!1,!1);if(i){var a=t,o=i.typeMetadata;(!x(o.idProperties)||o.idProperties.length<1)&&k.missingIdProp();var u=[],c=[],l=this._getCreatedEntities(t,!0)().slice(0);e.forEach((function(e){var t=r.getItemId(e,o);f(t)?c.push(e):u.push(e)}));var d=function(e){ko.isObservable(a),n.addCreated(e,a)},p=MsPortalFx.extend({handleAdd:function(e){d(e)},handleDelete:function(e){n.markForDelete(e)}},this._createMergeEntityOnlyVisitorOptions()),h=new z(p,j((function(){return h})));h.applyEntityArrayAsEdits(u,a,i.typeMetadata),c.length&&c.forEach((function(e){d(e)})),l.forEach((function(e){n.revert(e)}))}else{ko.isObservable(t)||k.targetArrObs();var y=new s(null,j((function(){return y})));t(y.clone(e,null))}},i.prototype.getEdits=function(){return this._inconsistent()&&k.editsUnavail(),{edits:this._getEdits(!0).map((function(e){var t={state:e.state,entityReference:e.entityReference};switch(t.state){case n.Created:t.entityPath=e.entityPath,t.createdEntities=e.encodedCreatedEntities.map((function(e){return W(e)}));break;case n.Updated:t.entityUpdates=W(e.entityUpdates)}return t})),version:1}},i.prototype.applyEdits=function(e){this._assertNotDisposed();var t=Y(e,this._hasMetadata);return this._applyEdits(t,this._applyEditsVisitor,!1),!0},Object.defineProperty(i.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),i.prototype._mergeFromOriginal=function(){k.mergeUnavail()},i.prototype._getRefreshableData=function(){return k.noImpl(),null},i.prototype._onRefreshComplete=function(e){k.noImpl()},i.prototype._addEntityStateToEditableEntity=function(t,r,i){var a=this,o=this._addEntityState(t);o.original=r,o.typeMetadata=i,ko.computed(o.lifetimeManager=new e.TriggerableLifetimeManager,(function(){if(a._inconsistent());else{var e=a._getEntityState(t,!0),r=e.readOnlyEditState.peek();a._edits().some((function(e){return e.state===n.Updated&&e.updatedOrDeletedEntity===t}))?r===n.None?a._markAsDeletedOrUpdated(t,n.Updated):r!==n.Updated&&k.moveEditState(n[r],n[n.Updated]):r===n.Updated&&e.writableEditState(n.None)}}))},i.prototype._addEntityStateToCreatedEntity=function(e,t){var r=this._addEntityState(e);r.containingArray=t,r.writableEditState(n.Created)},i.prototype._addEntityState=function(e){var t=ko.observable(n.None),r={writableEditState:t,readOnlyEditState:ko.pureComputed((function(){return t()}))};return v.data(e,this._entityStateKey,r),r},i.prototype._getEntityState=function(e,t,r){void 0===r&&(r=!0);var n=e&&v.data(e,this._entityStateKey);if(!n&&r){var i=!l(e)&&h(e),a="";throw a=t?"Entity-typed object is not known to this edit scope.  Such entity-typed objects can only be added via 'editScope.addCreated', 'editScope.refresh' and any refresh concluding an async 'editScope.saveChanges' call.  Such objects cannot be added due to the addition of some object/array that nests this object.":i?this._rootTypeMetadata===T?"No type metadata was supplied to this EditScope.  Depending on scenario, be sure to supply either: (1) the 'editScopeMetadataType' option to your MsPortalFx.ViewModels.ParameterProvider or (2) the 'entityTypeName' option to your MsPortalFx.Data.EditScopeCache.":M?"":"Object passed as the 'entity' parameter either isn't reachable from 'editScope.root' or isn't entity-typed according to type metadata.":"Value passed as the 'entity' parameter must be an object.",M||(a=a+"  "+C),new Error(a)}return n},i.prototype._deregisterNestedEntities=function(e,t,r){var i=this;void 0===r&&(r=!0);var a=new V({getCreatedEntities:function(e){return i._getCreatedEntities(e,!0)}},j((function(){return a}),{visitEntityArray:function(e,t,r){a.visitEntityArray(e,t,r),i._disposeEntityArrayState(e)},visitEntity:function(e,t,r){(a.visitEntity(e,t,r),r)&&(i._getEditState(e,!0)()!==n.None&&S.error("Edited entities are being disconnected from the EditScope, losing user-authored edits."));i._disposeEntityState(e)}}));a.visit(e,t,r)},i.prototype._addEntityArrayState=function(e,t,r){var n={typeMetadata:r,original:t};v.data(e,this._entityArrayStateKey,n)},i.prototype._createVisitorCallbacks=function(e,t,r){return void 0===t&&(t={}),void 0===r&&(r=!1),j(e,t,r)},i.prototype._rootIsEntity=function(){return h(this._root)},i.prototype._rootAsEntity=function(e){return void 0===e&&(e=!0),h(this._root)?e?this._root:this._getOriginalEntity(this._root):null},i.prototype._rootAsArray=function(e){return void 0===e&&(e=!0),l(this._root)?e?this._root:this._getOriginalArray(this._root):null},i.prototype._getOriginalEntity=function(e){return this._getEntityState(e,!0).original},i.prototype._getOriginalArray=function(e){return this._getEntityArrayState(e,!0).original},i.prototype._revertEntity=function(e,t,r){switch(r){case n.Updated:this._mergeToEditableVisitor.mergeEntity(t.original,e,t.typeMetadata);break;case n.Created:var i=this._getCreatedEntities(t.containingArray,!0);i.splice(i().indexOf(e),1);case n.Deleted:case n.None:}},i.prototype._getEntityArrayState=function(e,t,r){void 0===r&&(r=!0);var n=v.data(e,this._entityArrayStateKey);if(!n&&r){var i=l(e),a="";throw a=t?"Entity-typed array is not known to this EditScope.  Such entity-typed arrays can only be added via 'editScope.refresh' and any refresh concluding an async 'editScope.saveChanges' call.  Such arrays cannot be added due to the addition of some object/array that nests this array.":i?this._rootTypeMetadata===T?"No type metadata was supplied to this EditScope.  Depending on scenario, be sure to supply either: (1) the 'editScopeMetadataType' option to your MsPortalFx.ViewModels.ParameterProvider or (2) the 'entityTypeName' option to your MsPortalFx.Data.EditScopeCache.":M?"":"Array passed as the 'entityArray' parameter either isn't reachable from 'editScope.root' or isn't entity-typed according to type metadata.":"Value passed as the 'entityArray' parameter must be an array or an observable array.",M||(a=a+"  "+C),new Error(a)}return n},i.prototype._disposeEntityArrayState=function(e){v.data(e,this._entityArrayStateKey,I)},i.prototype._disposeEntityState=function(e){var t=this._getEntityState(e,!0);t.lifetimeManager&&t.lifetimeManager.dispose(),v.data(e,this._entityStateKey,I)},i.prototype._markAsDeletedOrUpdated=function(e,t){var r=this._getEntityState(e,!0),i=r.readOnlyEditState.peek();i!==n.None&&i!==t&&k.entityEdit(n[i]),r.writableEditState(t)},i.prototype._getEntityArrayType=function(e,t){return this._getEntityArrayState(e,t).typeMetadata},i.prototype._getCreatedEntities=function(e,t){var r=this._getEntityArrayState(e,t),n=r.createdEntities;return n||(n=r.createdEntities=ko.observableArray()),n},i.prototype._revertAll=function(){this._revertAllVisitor.visit(this._root,this._rootTypeMetadata)},i.prototype._createRevertAllVisitor=function(){var e=this,t=new V({getCreatedEntities:function(t){return e._getCreatedEntities(t,!0)}},j((function(){return t}),{visitEntityArray:function(r,n){t.visitArray(r,n);for(var i=e._getCreatedEntities(r,!0);i().length>0;)e.revert(i()[0])},visitEntity:function(r,n){t.visitEntity(r,n),e.revert(r)}}));return t},i.prototype._getEdits=function(e){var t=[],r=this._rootIsEntity()?this._createEntityReference(this._rootAsEntity(),this._rootTypeMetadata,!1):null;return(e?this._getPersistableEditsVisitor:this._getEditsVisitor).visit(this._root,this._rootTypeMetadata,{edits:t,entityReference:r,entityPath:""}),t},i.prototype._createGetEditsVisitor=function(e){var t=this,r=new V({getCreatedEntities:function(e){return t._getCreatedEntities(e,!0)}},j((function(){return r}),{visitEntityArray:function(e,n){t._getEntityArrayState(e,!0),r.visitEntityArray(e,n)},visitEntity:function(e,n){t._getEntityState(e,!0),r.visitEntity(e,n)}})),i=this._createComputeEntityUpdatesVisitor(e),a=function(e,t,r){return i.visit(e,t,r)},s=new o(null,j((function(){return s}),{shouldVisitObjectProperty:function(e,r,n){return X(e,n)&&s.shouldVisitObjectProperty(e,r,n)&&t._objectPropertyNestsEntities(r,e,n)},visitArrayItem:function(e,t,r,n){s.visitArrayItem(e,t,r,{edits:n.edits,entityReference:n.entityReference,entityPath:n.entityPath+"."+t})},visitEntityArray:function(e,i,o){s.visitArray(e,i,o);var u=t._getCreatedEntities(e,!0);if(u().length){var c=o.edits,l=o.entityReference,d=o.entityPath;c.push({state:n.Created,entityReference:l,entityPath:d,encodedCreatedEntities:u().map((function(e){return a(e,i)})),typeMetadata:i,createdEntities:u()}),u().forEach((function(e){r.visit(e,i)}))}},visitObject:function(e,r,n){var i=E(r),a=n.edits,o=n.entityReference,u=n.entityPath;s.getObjectPropertiesToVisit(e,r).forEach((function(n){s.visitObjectPropertyValueDispatch(n,e,r,{edits:a,entityReference:i?t._createEntityReference(e,r,!1):o,entityPath:i?n:u+"."+n})}))},visitEntity:function(e,r,i){var o=i.edits,u=t._getEditState(e,!0)(),c=a(e,r,t._getOriginalEntity(e));F(c)?u===n.Deleted&&o.push({state:n.Deleted,entityReference:t._createEntityReference(e,r,!1),typeMetadata:r,updatedOrDeletedEntity:e}):o.push({state:n.Updated,entityReference:t._createEntityReference(e,r,!1),entityUpdates:c,typeMetadata:r,updatedOrDeletedEntity:e}),s.visitEntity(e,r,i)}}));return s},i.prototype._createApplyPersistedEditsVisitor=function(){var e=this;return this._createApplyEditsVisitor(!1,{applyCreate:function(t,r,n){e._removeNonPersistedPropertySentinels(r,n,!0),e.addCreated(r,t)},applyUpdate:function(t,r,n){e._removeNonPersistedPropertySentinels(r,n,!1),e._applyEntityUpdates(t,r,n)},applyDelete:function(t,r){e._markAsDeletedOrUpdated(r,n.Deleted)}})},i.prototype._createApplyEditsVisitor=function(e,t){var r=this,i=new o(null,j((function(){return i}),{visitArrayItem:function(e,t,r,n){i.visitArrayItem(e,t,r,{edits:n.edits,entityReference:n.entityReference,entityPath:n.entityPath+"."+t})},visitEntityArray:function(a,o,s){i.visitArray(a,o,s);for(var u=s.edits,c=ko.unwrap(a),l=function(i){var s=c[i],l=r._createEntityReference(s,o,e),d=MsPortalFx.findIndex(u,(function(e){return e.state===n.Deleted&&J(l,e.entityReference)}));d>=0&&(u.splice(d,1),t.applyDelete(a,s))},d=c.length-1;d>=0;d--)l(d);var f=s.entityReference,p=s.entityPath,h=MsPortalFx.findIndex(u,(function(e){if(e.state===n.Created)if(f){if(e.entityReference&&J(f,e.entityReference)&&p===e.entityPath)return!0}else if(!e.entityReference)return!0}));if(h>=0){var y=u[h];u.splice(h,1),y.encodedCreatedEntities.forEach((function(e){t.applyCreate(a,e,o)}))}},visitObject:function(a,o,s){var u=s.edits,c=s.entityReference,l=s.entityPath,d=E(o);if(d&&(c=r._createEntityReference(a,o,e)),i.getObjectPropertiesToVisit(a,o).forEach((function(e){i.visitObjectPropertyValueDispatch(e,a,o,{edits:u,entityReference:c,entityPath:d?e:l+"."+e})})),d){var f=MsPortalFx.findIndex(u,(function(e){return e.state===n.Updated&&J(c,e.entityReference)}));if(f>=0){var p=u[f];u.splice(f,1),t.applyUpdate(a,p.entityUpdates,o)}}}}));return i},i.prototype._acceptChanges=function(){var e=this._getEdits(!1);this._applyEdits(e.slice(0),this._createAcceptChangesVisitor(!0),!0),this._applyEdits(e,this._createAcceptChangesVisitor(!1),!1)},i.prototype._createAcceptChangesVisitor=function(e){var t=this;return this._createApplyEditsVisitor(e,{applyCreate:function(r,n,i){if(e);else{var a=r,o=t._createEditableAndOriginalData(n,i).editable,s=function(e,t){if(e.push)e.push(t);else{var r=e,n=r().slice(0);n.push(t),r(n)}};s(a,o),s(t._getOriginalArray(a),t._getOriginalEntity(o))}},applyUpdate:function(r,n,i){e&&t._applyEntityUpdates(r,n,i)},applyDelete:function(e,t){var r=ko.unwrap(e).indexOf(t);if(e.splice)e.splice(r,1);else{var n=e,i=n().slice(0);i.splice(r,1),n(i)}}})},i.prototype._applyEntityUpdates=function(e,t,r){this._mergeToEditableVisitor.mergeEntity(t,e,r)},i.prototype._removeNonPersistedPropertySentinels=function(e,r,n){var i=new o(null,{visitObjectPropertyValue:function(e,r,a){_(r,e)===t.nonPersistedPropertySentinel?ko.isObservable(r[e])?r[e](I):n?r[e]=I:delete r[e]:i.visitObjectPropertyValue(e,r,a)},visitArray:function(e,r){var n=g(e);1===n.length&&n[0]===t.nonPersistedPropertySentinel?n.splice(0,1):i.visitArray(e,r)}});i.visit(e,r)},i.prototype._generateValueBasedEntityId=function(e,t){return this._generateValueBasedEntityIdVisitor.visit(e,t)},i.prototype._createGenerateValueBasedEntityIdVisitor=function(){var e=new o(null,j((function(){return e}),{visitArray:function(t,r){var n="";return g(t).forEach((function(t,i){n+=e.visitArrayItem(t,i,r)})),$(n)},visitObject:function(t,r){var n=e.getObjectPropertiesToVisit(t,r).sort(),i="";return n.forEach((function(n){i+=e.visitObjectPropertyValueDispatch(n,t,r)})),$(i)},visitScalar:function(e){return $(""+e)},visitDate:function(e){return $(""+e)}},!0));return e},i.prototype._createEntityReference=function(e,t,n){var i;if(void 0===n&&(n=!1),this._rootAsEntity(!n)===e)i={type:I,id:I};else{var a=n?e:this._getOriginalEntity(e),o=void 0;t&&(t.name||t===this._rootTypeMetadata)||k.serialize(),o=r.typeHasId(t)?r.getItemId(a,t):this._generateValueBasedEntityId(a,t);var s=t.name||null;s||t===this._rootTypeMetadata||k.namedMeta(),i={type:s,id:o}}return i},i.prototype._createComputeEntityUpdatesVisitor=function(e){var r=this,n=new s(null,j((function(){return n}),{visitObject:function(i,a){var o={};return n.getObjectPropertiesToVisit(i,a).forEach((function(s){var u=n.visit(_(i,s),P(a,s));e&&(r._shouldPersistObjectPropertyEdits(s,a)||(u=t.nonPersistedPropertySentinel));var c,d=i[s];if(b(i,s))c=ko.observable(u);else if(l(d)&&u===t.nonPersistedPropertySentinel){var f=[t.nonPersistedPropertySentinel];c=ko.isObservable(d)?"splice"in d?ko.observableArray(f):ko.observable(f):f}else c=u;o[s]=c})),o}},!0)),i={},a=new o(null,j((function(){return a}),{visitObject:function(o,s,u){var c;return h(u)?(r._enumeratePropertiesForUpdates(o,u,a,s,(function(n){var l=a.visit(_(o,n),P(s,n),_(u,n));l!==i&&(c||(c={}),e&&(r._shouldPersistObjectPropertyEdits(n,s)||(l=t.nonPersistedPropertySentinel)),c[n]=l)})),c||i):n.visit(o,s)},visitArray:function(e,t,r){var o=!1;if(l(r))if(g(e).length!==g(r).length)o=!0;else{var s=g(r);o=g(e).some((function(e,r){return a.visitArrayItem(e,r,t,s[r])!==i}))}else o=!0;return o?n.visit(g(e),t):i},visitScalar:function(e,t){return d(e,t)?i:e},visitDate:function(e,t){return d(e,t)?i:e}},!0));return a},i.prototype._shouldPersistObjectPropertyEdits=function(t,r){if(!e.Data.allowNonPersistentEdits)return!0;var n=r&&r.properties&&r.properties[t];return!n||!1!==n.persistEdits},i.prototype._enumeratePropertiesForUpdates=function(e,t,r,n,i){r.getObjectPropertiesToVisit(e,n).forEach((function(e){t.hasOwnProperty(e)?i(e):S.warning("Encountered a property '"+e+"' on an editable object that is not present on the original object.  Updates to the property value are not being persisted along with other edits.")})),r.getObjectPropertiesToVisit(t,n).forEach((function(t){e.hasOwnProperty(t)||S.warning("Encountered a property '"+t+"' on an original object that is not present on the editable object.  Updates to the property value are not being persisted along with other edits.")}))},i.prototype._assertNotDisposed=function(){this._isDisposed&&k.disposed()},i.prototype._objectPropertyNestsEntities=function(e,t,r){var n=e[t];return ko.isObservable(n)&&(n=n.peek()),!(!x(n)&&!h(n))&&!!P(r,t)},i.prototype._getEditState=function(e,t){return this._getEntityState(e,t).readOnlyEditState},i.prototype._createMergeToEditableVisitor=function(){var e=new L(this._createMergeEntityOnlyVisitorOptions(),j((function(){return e})));return e},i.prototype._createMergeEntityOnlyVisitorOptions=function(){var e=new o(null,j((function(){return e}),{visitEntityTypedObjectPropertyValue:function(e,t,r){k.nestedEntities()}})),t=new s(null,j((function(){return t})));return{onDetach:function(t,r){e.visit(t,r)},clone:function(e,r){return t.clone(e,r)}}},i.prototype._applyEdits=function(e,t,r){var n=this._rootIsEntity()?this._createEntityReference(this._rootAsEntity(),this._rootTypeMetadata,r):null,i=r?this.getOriginal(this._root):this._root;t.visit(i,this._rootTypeMetadata,{edits:e,entityReference:n,entityPath:""})},i.prototype._addMetadataHelperMessage=function(e,t){return e},i=__decorate([__metadata("fx:diagnostics",[require,"EditScopeBase"]),MsPortalFx.Composition.ProxyCompatibilityMode],i)}(),H=function(e){function t(t,r,n){var i=e.call(this)||this;return i.init(t,r,n,(function(e,t){return{editable:i._getVisitor().clone(e,t),original:e}})),i}return __extends(t,e),t.prototype._mergeFromOriginal=function(e){void 0===e&&(e=!0);var t=this._rootTypeMetadata,r=this._createMergeEntitiesVisitor(e);this._rootIsEntity()?r.mergeEntity(this._rootAsEntity(!1),this._rootAsEntity(),t):r.mergeEntityArray(this._rootAsArray(!1),this._rootAsArray(),t)},t.prototype._getRefreshableData=function(){return this.getOriginal(this._root)},t.prototype._onRefreshComplete=function(e){e&&m.mergeWithoutAtomization(e,this.getOriginal(this._root),{type:this._rootTypeMetadata.name}),this._mergeFromOriginal(!1)},t.prototype._getVisitor=function(){var e=this,t=this._visitor;return t||(this._visitor=t=new s(null,j((function(){return t}),{visitEntityArray:function(r,n){var i=t.visitEntityArray(r,n);return e._addEntityArrayState(i,r,n),i},visitEntity:function(r,n){var i=t.visitEntity(r,n);return e._addEntityStateToEditableEntity(i,r,n),i}}))),t},t.prototype._createMergeEntitiesVisitor=function(e){var t=this,r=new q({onDetach:function(r,n){t._deregisterNestedEntities(r,n,e)},clone:function(e,r){return t._getVisitor().clone(e,r)},getSourceEntity:function(e,r){return t._getOriginalEntity(e)},isSourceForTargetEntity:function(e,r){return t._getOriginalEntity(r)===e}},j((function(){return r})));return r},t}(N),U=function(e){function t(t,r,n){var i=e.call(this)||this;return i.init(t,r,n,(function(e,t){return{editable:e,original:i._getVisitors().clone.clone(e,t)}})),i}return __extends(t,e),t.prototype._getRefreshableData=function(){return this._root},t.prototype._onRefreshComplete=function(e){e&&m.mergeWithoutAtomization(e,this._root,{type:this._rootTypeMetadata.name}),this._mergeToOriginal()},t.prototype._getVisitors=function(){var e=this,t=this._visitors;if(!t){var r=new s(null,j((function(){return r}),{visitEntityArray:function(t,n,i){var a=r.visitEntityArray(t,n,i);return e._addEntityArrayState(t,a,n),a},visitEntity:function(t,n,i){var a=r.visitEntity(t,n,i);return e._addEntityStateToEditableEntity(t,a,n),a}})),n=new q({onDetach:function(e,t){},clone:function(e,t){return r.clone(e,t)},getSourceEntity:function(t,r){return MsPortalFx.find(r,(function(r){var n=e._getEntityState(r,!0,!1);return n&&n.original===t}))},isSourceForTargetEntity:function(t,r){var n=e._getEntityState(t,!0,!1);return n&&n.original===r}},j((function(){return n})));this._visitors=t={clone:r,merge:n}}return t},t.prototype._mergeToOriginal=function(){var e=this._rootTypeMetadata,t=this._getVisitors().merge;this._rootIsEntity()?t.mergeEntity(this._rootAsEntity(),this._rootAsEntity(!1),e):t.mergeEntityArray(this._rootAsArray(),this._rootAsArray(!1),e)},t}(N),V=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n._getCreatedEntities=t&&t.getCreatedEntities,n}return __extends(t,e),t.prototype.visitEntityArray=function(t,r,n){var i=this._getCreatedEntities(t);return e.prototype.visitEntityArray.call(this,i,r,n),e.prototype.visitEntityArray.call(this,t,r,n)},t}(o),L=function(e){function t(t,r){return e.call(this,t,r)||this}return __extends(t,e),t.prototype.mergeEntity=function(t,r,n){e.prototype.merge.call(this,t,r,n)},t.prototype.visitEntityTypedObjectPropertyValue=function(e,t,r,n){return!0},t}(u),z=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n._handleAdd=t.handleAdd,n._handleDelete=t.handleDelete,n}return __extends(t,e),t.prototype.applyEntityArrayAsEdits=function(e,t,r){var n=this;this._mergeArray(e,r,t,{handleAdd:function(e,t){n._handleAdd(e)},handleDelete:function(e,t){n._handleDelete(e)}})},t}(u),q=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n._getSourceEntity=t.getSourceEntity,n._isSourceForTargetEntity=t.isSourceForTargetEntity,n}return __extends(t,e),t.prototype.mergeEntity=function(t,r,n){e.prototype.merge.call(this,t,r,n)},t.prototype.mergeEntityArray=function(t,r,n){e.prototype.merge.call(this,t,r,n)},t.prototype.visitEntityTypedObjectPropertyValue=function(e,t,r,n){var i=this._callbacks,a=_(t,e),o=_(n,e),s=!1;return l(a)?l(o)&&(s=i.visitEntityArray(a,r,o)):h(a)&&h(o)&&this._isSourceForTargetEntity(a,o)&&(s=i.visitEntity(a,r,o)),s},t.prototype.visitEntityArray=function(e,t,r){var n=this;return this._mergeArray(e,t,r,{getEdits:function(e,t){var r=function(t){return n._getSourceEntity(t,e)},i=t.map((function(e){return r(e)})),a=ko.utils.compareArrays(i,e);return a.forEach((function(e){if("deleted"===e.status||"retained"===e.status){var n=e.value;e.value=MsPortalFx.find(t,(function(e){return r(e)===n}))}})),a},getSourceItem:function(e,t){return n._getSourceEntity(e,t)}})},t}(u);function G(e){"object"!=typeof e&&k.makeObs(),w(e,(function(t,r){if(x(r))G(r),e[t]=ko.observableArray(r);else{var n=typeof r;"object"===n?G(r):"function"!==n&&(e[t]=ko.observable(r))}}))}function W(t){var r=e.toSerializableObject(t);return JSON.stringify(r)}function K(t,r,n){if(0===n)return function(e,t){var r=JSON.parse(e);t||G(r);return r}(t,r);var i=JSON.parse(t);return e.fromSerializableObject(i)}function J(e,t){var r=p(e.type)&&p(t.type)&&p(e.id)&&p(t.id),n=e.type===t.type&&e.id===t.id;return r||n}function $(e){var t=0;if(0===e.length)return t+"";for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t+""}function X(e,t){return!(t&&t.properties&&t.properties[e]&&!1===t.properties[e].trackEdits)}function Y(e,t){void 0===t&&(t=!0);var r=e.version||0;return e.edits.map((function(e){var i={state:e.state,entityReference:e.entityReference};switch(e.state){case n.Created:i.entityPath=e.entityPath,i.encodedCreatedEntities=e.createdEntities.map((function(e){return K(e,t,r)}));break;case n.Updated:i.entityUpdates=K(e.entityUpdates,t,r)}return i}))}function Z(e){return!!E(e)||!!e&&r.getProperties(e).some((function(t){return Z(P(e,t))}))}}(e.Data||(e.Data={}))}(FxImpl||(FxImpl={})),function(e){!function(e){!function(e){var t=FxImpl.Data;e.createNew=function(e){return new t.EditScopeCache(e)},e.create=function(e){return new t.EditScopeCacheOld(e)}}(e.EditScopeCache||(e.EditScopeCache={}))}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"editScope",{get:function(){return this._loadedCacheEntry},enumerable:!1,configurable:!0}),r.prototype.fetchForNewData=function(e){return this.fetch({editScopeId:e,params:void 0})},r.prototype.fetchForExistingData=function(t,r){return this.fetch({editScopeId:t,params:e.isNullOrUndefined(r)?null:r})},r=__decorate([__metadata("fx:diagnostics",[require,"EditScopeView"]),e.Composition.ProxyCompatibilityMode],r)}(FxImpl.Data.ObjectView);t.EditScopeView=r}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r={entityCacheWithLoader:"",missingObservableData:""},n=FxImpl.getErrorMap(r),i=function(r){function i(t){var i=r.call(this,e.clone(t))||this,a=t;return a.findCachedEntity&&a.loader&&!a.loader.establishDataSet&&n.entityCacheWithLoader(),i._findCachedEntity=a.findCachedEntity,i}return __extends(i,r),i.prototype.createView=function(e,r){return new t.EntityView(this,e,r)},i.prototype._tryFindDataInRelatedCache=function(e,t){var r,n=this._findCachedEntity;if(n)if(n.hasOwnProperty("queryCache")){var i=n;r=i.queryCache._findMatchingEntity(i.entityMatchesId,e)}else{var a=n;r=a.dataCache._findEntity(a.findMatchingEntityInCacheEntry,e)}return r},i.prototype._getDataFromDataSet=function(e){var t=e.data;return ko.isObservable(t)||n.missingObservableData(),e.data()},i}(FxImpl.Data.DataCache);t.EntityCache=i}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=function(t){function r(e,r,n){var i=t.call(this,e,r,n||{})||this;return i._item=ko.observable(null),ko.computed(r,(function(){var e=i._loadedCacheEntry();if(e){var t=e.data;if(!ko.isObservable(t))throw new Error("DataSets used with EntityView must contain observable data.");var r=t();i._item(r)}else i._item(null)})),i}return __extends(r,t),Object.defineProperty(r.prototype,"item",{get:function(){return this._item},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"data",{get:function(){return this._item()},enumerable:!1,configurable:!0}),r=__decorate([__metadata("fx:diagnostics",[require,"EntityView"]),e.Composition.ProxyCompatibilityMode,__metadata("design:paramtypes",[Object,Object,Object])],r)}(FxImpl.Data.DataView);t.EntityView=r}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r,n,i,a,o=e.Base,s=e.Data,u=o.Promises,c=o.Net2,l=e.isObject,d=e.deepEquals,f=Date.now,p=null,h={earlyRefresh:"",unknownDataSet:"",modifyLifetime:"",unaccessedDataSet:""},y=FxImpl.getErrorMap(h),m=new e.Base.Diagnostics.Log("Data.Loader"),v={},g={getFetchParameters:function(e,t,r){return r?{headers:t&&t.ajaxHeaders,data:t&&t.ajaxData}:p},fetchData:function(e,t,r,n,i,a){var o=p;r&&(o="string"==typeof r?r:JSON.stringify(r));var s="json",u=c.ajax({uri:t,type:i||"POST",dataType:s,cache:!1,headers:n,traditional:!0,contentType:"application/json",data:o,setAuthorizationHeader:a});return u.requestedDataType=s,u},processResult:[t.DataProvider.DataContractJsonSerializer.processResult]},_={},b={fastPollingInterval:1e4,pollingInterval:6e4,slowPollingInterval:3e5},x="slowPollingInterval",E="pollingInterval",P="fastPollingInterval",S=0,I=/^application\/json\b/,M=function(e){return I.test(e.getResponseHeader("Content-Type"))&&function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(e.responseText)},C=e.isFeatureEnabled("tracefetch");function w(e,t){return v[e]=new k(e,t)}function F(e,t){return(e in _&&_[e]||n||b)[t]}function D(e){return Math.max(e||0,i||b.fastPollingInterval)}function A(e,t,r){e.fetchingSameData&&(e.fetchingSameData=r),t&&(e.isForcedCacheRefresh=!0)}!function(e){e[e.Never=1]="Never",e[e.Normal=2]="Normal"}(a=t.PollFrequency||(t.PollFrequency={}));var k=function(){function t(e,t){var r;this._pollFrequency=a.Normal,this._fastPollingRefCount=0,this._pollCount=0,this._hasSnapshottedFetchOptions=!1,this._name=e,this._lifetimeManager=new FxImpl.TriggerableLifetimeManager,t&&(this._snapshotFetchOptions(t),r=t.type),this.dataSet=new s.DataSet(r||p,t.dataSetLifetime,t.atomizationOptions)}return t.prototype._hasRequestInFlight=function(){return!!this._currentFetchDeferred},t.prototype._getLastFetchState=function(){return this._lastFetchState},t.prototype.getCachedOrInFlightData=function(e){var t,r,n=e.uri,i=e.ajaxData,a=e.ajaxHeaders,o=e.httpMethod||p;return this._lastCompletedFetchStart&&n===this._uri&&o===this._httpMethod&&d(i,this._ajaxData)&&d(a,this._ajaxHeaders)?!this._expiry||this._expiry>f()?(e.forceCacheRefresh&&this.debounceServerFetch(!0,!0),(t=Q.defer()).resolve({name:this._name,value:this.dataSet})):this._currentFetchDeferred&&!e.forceCacheRefresh?t=this._currentFetchDeferred:(m.verbose("Cached data expired: '"+this._name+"'"),r=!0):(this._tryExecuteDebouncedServerFetch(),this._snapshotFetchOptions(e)),{promise:t?t.promise:p,fetchingSameData:r}},t.prototype.forceRefresh=function(){return this._hasSnapshottedFetchOptions||y.earlyRefresh(),c.invalidateCacheHeader(this._ajaxHeaders),this._tryExecuteDebouncedServerFetch(!0)?this._currentFetchDeferred.promise:this.debounceServerFetch(!0,!0)},t.prototype.debounceServerFetch=function(t,r){var n=this;if(this._debouncedFetch)A(this._debouncedFetch,r,t);else{this._currentFetchDeferred=Q.defer(),this._pollingTask&&e.Base.Scheduler.deleteTask(this._pollingTask);var i=function(){var e=n._debouncedFetch,t=e.isForcedCacheRefresh,r=e.fetchingSameData;n._debouncedFetch=p,n._fetchData(r,!0,t)};this._debouncedFetch={callback:i,timeoutId:setTimeout(i,0),isForcedCacheRefresh:r,fetchingSameData:t}}return this._currentFetchDeferred.promise},t.prototype.setFastPolling=function(e){e?this._fastPollingRefCount++:this._fastPollingRefCount>0&&this._fastPollingRefCount--},t.prototype.dispose=function(){this._lifetimeManager.dispose(),delete _[this._name],this._pollingTask&&e.Base.Scheduler.deleteTask(this._pollingTask)},t.prototype._tryExecuteDebouncedServerFetch=function(e){var t=this._debouncedFetch;return!!t&&(A(t,e,e),clearTimeout(t.timeoutId),t.callback(),!0)},t.prototype._snapshotFetchOptions=function(t){this._hasSnapshottedFetchOptions=!0,this._uri=t.uri,this._httpMethod=t.httpMethod||p,this._ajaxData=t.ajaxData,this._ajaxHeaders=t.ajaxHeaders,this._loaderOptions=t.loaderOptions,this._preserveNewItemsOrdering=t.preserveNewItemsOrdering,this._pollFrequency=t.pollFrequency||a.Normal,this._setAuthorizationHeader=t.setAuthorizationHeader;var r=t.fetchStartListener;this._fetchStartListener=r?function(e){r.fire(e)}:e.noop},t.prototype._fetchData=function(t,r,n){var i,a=this,o=this._name,s=this._getLoaderOptionFunction("getFetchParameters"),l=this._getLoaderOptionFunction("fetchData"),d=this._getLoaderOptionFunction("processResult"),h=f(),y=this._currentFetchDeferred,v=this._lastFetchState,_=e.Base.Diagnostics.Telemetry,b=this.dataSet;C&&(i=_.startTrace({source:"Data",action:"Fetch",name:this._name,data:this._uri})),n&&(this._lastForcedFetchStart=h),this._fetchStartListener({dataSetName:o,promise:y.promise,isClientInitiated:r});var x,E=s(o,v,t)||{},P=e.clone(this._ajaxData,!1,!0)||p;E.data&&(P=e.extend(P,E.data)),this._uri||l!==g.fetchData||m.error("Missing uri parameter in fetchData for '".concat(o,"' created by: ").concat(this._constructorCallStack||"")),u.cancelOnDispose(this._lifetimeManager,(function(){var t=l(o,a._uri,P,e.extend2(a._ajaxHeaders,E.headers),a._httpMethod,a._setAuthorizationHeader);return x="json"===t.requestedDataType,t})).then((function(n){var s,u,l=!0,f=n&&n.cachedAjax?n:{cachedAjax:!1,modified:!0,data:n,cacheTagValue:p},g={data:f.data};f.cacheTagValue&&(a._ajaxHeaders=c.setCacheHeader(a._ajaxHeaders,f.cacheTagValue));try{if(a._lifetimeManager.isDisposed())return;if(Array.isArray(d)||(d=[d]),f.modified)for(u=d.length,s=0;s<u;++s)if(!d[s](o,g,v,t,b.type)){l=!1;break}var x=!r&&S>0;a._onFetchCompleted(r,!0,y),f.modified&&l&&!x&&a._shouldAcceptFetchResult(h)&&a._acceptFetchResult(g,h)}catch(t){var E="Data merge failed for data set '"+o+"'.";e.isFeatureEnabled("detailedexternallog")&&(E+=" The error message was: "+e.getLogFriendlyMessage(t)),m.error(new e.Errors.Error({message:E,innerErrors:t}))}finally{C&&_.completeTrace(i);try{y.resolve({name:o,value:a.dataSet})}catch(t){var P=e.getLogFriendlyMessage(t),I="Data-load completed callback threw an exception for data set '"+o+"'. The error message was: "+P;m.error(new e.Errors.Error({message:I,innerErrors:t}))}}})).catch((function(t){if(!a._lifetimeManager.isDisposed()){a._onFetchCompleted(r,!1,y);var n=function(t,r,n){if(r){var i=r.status;if(401===i||403===i)return new e.Errors.UnauthorizedDataError({dataSetName:t,errorData:r,message:"UnauthorizedDataError: data set ".concat(t)});if(404===i&&(!n||M(r)))return new e.Errors.NotFoundDataError({dataSetName:t,errorData:r,message:"NotFoundDataError: data set ".concat(t)})}return new e.Errors.FetchDataError({dataSetName:t,errorData:r,message:"FetchDataError: data set ".concat(t)})}(o,t&&t.jqXHR||t,x);y.reject(n)}}))},t.prototype._onFetchCompleted=function(e,t,r){var n=this,i=this._pollFrequency!==a.Never;e&&t&&i&&!this._pollingTask&&(this._pollingTask={name:"poll data set: "+this._name,scheduledTask:function(){n._pollData()},recurring:!1,isAsync:!0,delayInMs:F(this._name,P),silent:!0}),r===this._currentFetchDeferred&&(this._currentFetchDeferred=p,this._reschedulePolling(!0))},t.prototype._reschedulePolling=function(t){this._pollingTask&&(t&&(this._pollCount=0),e.Base.Scheduler.scheduleTask(this._pollingTask))},t.prototype._shouldAcceptFetchResult=function(e){if(this._lastCompletedFetchStart){var t=e>this._lastCompletedFetchStart,r=this._lastForcedFetchStart&&e<this._lastForcedFetchStart;return t&&!r}return!0},t.prototype._acceptFetchResult=function(t,r){this.dataSet.merge(t.data,{type:t.type,fetchStart:r,preserveNewItemsOrdering:this._preserveNewItemsOrdering});var n=this.dataSet;n.navigationMetadata(t.navigationMetadata||p),n.partialErrors(t.partialErrors||[]),this._lastCompletedFetchStart=r,this._lastFetchState=t.fetchState,this._expiry=f()+3*F(this._name,x),e.isInWebWorker||$(n).trigger("mergeComplete")},t.prototype._determinePollingInterval=function(){return E},t.prototype._pollData=function(){var e,t,r,n;if(!this._lifetimeManager.isDisposed())return this._currentFetchDeferred||S||(this._pollCount++,this._isFastPollNeeded()?(e=!0,t=P):(e=!0,t=this._determinePollingInterval()),t&&(r=F(this._name,t)),e&&(n=Math.ceil(r/F(this._name,P)),e=this._pollCount%n==0)),e?(this._currentFetchDeferred=Q.defer(),this._fetchData(!0),this._currentFetchDeferred.promise):(this._reschedulePolling(),Q.resolve(null))},t.prototype._isFastPollNeeded=function(){return this._fastPollingRefCount>0||this.dataSet.hasUnmergedClientChanges()},t.prototype._getLoaderOptionFunction=function(e){var t;return this._loaderOptions&&(t=this._loaderOptions[e]),!t&&r&&(t=r[e]),t||g[e]},t}(),T=function(){function t(){}return t.getData=function(e,t){l(e)&&(e=(t=e).dataSetName||t.uri);var r,n,i=v[e];if(i){var a=i.getCachedOrInFlightData(t);r=a.promise,n=a.fetchingSameData}else i=w(e,t);return r||(r=i.debounceServerFetch(n,t.forceCacheRefresh)),r},t.forceRefresh=function(e){var t=v[e];if(t)return t.forceRefresh();y.unknownDataSet()},t.getDataSet=function(e,r,n,i,a){var o=!1,s={dataSetLifetime:i,atomizationOptions:a,uri:void 0};return"boolean"==typeof r?o=r:"string"==typeof r&&(o=!0,s.type=r),t.getDataSet2(e,o,s,n)},t.getDataSet2=function(e,t,r,n){var i=v[e],a=r.dataSetLifetime;i&&a&&a!==i.dataSet.lifetime&&y.modifyLifetime(),!i&&t&&(i=w(e,r));var o=i?i.dataSet:p;return o&&n&&o.merge(n),o},t.hasRequestInFlight=function(e){var t=v[e];return t&&t._hasRequestInFlight()},t.disposeDataSet=function(e){var t=v[e];t&&(t.dispose(),delete v[e])},t.setFastPolling=function(e,t){var r=v[e];r?r.setFastPolling(t):y.unaccessedDataSet()},t.pausePolling=function(){S++},t.resumePolling=function(){S>0&&S--},t.setDefaultLoaderOptions=function(e){r=e},t.setPollingIntervals=function(t,r){var i=t;l(t)&&(r=t,i=p),r=function(t){var r;return r=(t=e.clone(t)).fastPollingInterval=D(t.fastPollingInterval),r=t.pollingInterval=Math.max(D(t.pollingInterval),r),t.slowPollingInterval=Math.max(D(t.slowPollingInterval),r),t}(r),i?_[i]=r:n=r},t.resetPollingIntervals=function(e){"string"==typeof e?_[e]=null:n=null},t._internal={setDefaultPollingIntervals:function(e){b=e}},t.getMinPollingInterval=D,t}();t.Loader=T,function(e){!function(e){e.disposeAllCachedDataSetsForTests=function(){Object.getOwnPropertyNames(v).forEach((function(e){var t=v[e];t&&(t.dispose(),delete v[e])}))}}(e.Internal||(e.Internal={}))}(T=t.Loader||(t.Loader={}))}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=t.Loader,n=e.Data.PollFrequency,i={needBothOptions:"",minimumPoll:"",incompatibleOptions:""},a=FxImpl.getErrorMap(i),o=function(){function i(r){r.atomizationOptions&&!r.entityTypeName?a.needBothOptions():!r.atomizationOptions&&r.entityTypeName&&(r.atomizationOptions={}),this._dataType=r.entityTypeName,this._uriForParams=r.sourceUri,this._httpMethod=r.httpMethod,this._polls=!!r.poll,this._pollInterval=r.pollInterval||null,this._serializeParams=r.serializeParams,this._supplyData=r.supplyData,this._atomizationOptions=r.atomizationOptions,this._processServerResponse=r.processServerResponse,this._preservesClientOrder=!!r.pollPreservesClientOrdering,this._setAuthHeader=r.setAuthorizationHeader,e.Base.ProxiedObservables.markNonSerializable(this);var n=t.Loader.getMinPollingInterval();this._polls&&null!==this._pollInterval&&this._pollInterval<n&&a.minimumPoll(n),void 0!==this._setAuthHeader&&this._supplyData&&a.incompatibleOptions()}return i.prototype._doesPoll=function(){return this._polls},i.prototype.serializeParams=function(e){return this._serializeParams?this._serializeParams(e):this._uriForParams(e)},i.prototype.loadDataSetForParams=function(e,t,r){var n=this._getDataSetLoaderOptions(e,t,r);return this.loadDataSet(e,n)},i.prototype.loadDataSet=function(e,t){var n=r.getData(e,t).then((function(e){return e.value}));return n.dataSetName=e,n},i.prototype.refreshDataSet=function(e){return r.forceRefresh(e.dataSetName)},i.prototype.disposeDataSet=function(e){r.disposeDataSet(e.dataSetName)},i.prototype.getLoadedDataSet=function(e){var t=r.getDataSet(e);return t&&t.data?t:null},i.prototype.isLoadingDataSet=function(e){return r.hasRequestInFlight(e)},i.prototype._getDataSetLoaderOptions=function(e,i,a){var o=this,s={uri:this._uriForParams?this._uriForParams(i):null,type:this._dataType,httpMethod:this._httpMethod||"GET",pollFrequency:this._polls?n.Normal:n.Never,atomizationOptions:this._atomizationOptions,dataSetLifetime:a,preserveNewItemsOrdering:!this._preservesClientOrder,setAuthorizationHeader:this._setAuthHeader,loaderOptions:{processResult:[t.DataProvider.DataContractJsonSerializer.processResult]}},u=this._pollInterval;if(this._polls&&null!==u&&r.setPollingIntervals(e,{slowPollingInterval:u,pollingInterval:u,fastPollingInterval:u}),this._supplyData&&(s.loaderOptions.fetchData=function(e,t,r,n,s){return o._supplyData(s,t,n,r,i,a)}),this._processServerResponse){s.loaderOptions.processResult.unshift((function(e,t,r,n,i){var a=o._processServerResponse(t.data);return a&&(t.data=a.data,t.navigationMetadata=a.navigationMetadata,t.partialErrors=a.partialErrors),!0}))}return s},i}();t.DataCacheLoader=o;var s=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.establishDataSet=function(e,t,n,i){var a=this._getDataSetLoaderOptions(e,t,i);return r.getDataSet2(e,!0,a,n)},t}(o);t.DataCacheLoader2=s}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){!function(e){e[e.Add=0]="Add",e[e.Update=1]="Update"}(e.EditKind||(e.EditKind={}))}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){var t=FxImpl.Data,r=0,n=function(){function e(e){this._referrerUniqueId=0;var n=e.onEntryDisposed;this._referrerPropertyName="_objectCache_"+ ++r,this._serializeKey=e.serializeKey,this._supplyValue=e.supplyValue,this._tryFindValueInRelatedCache=e.tryFindValueInRelatedCache,this._entries=new t.RefCountCache({evictionDelay:e.evictionDelay,extendEntryLifetimes:e.extendEntryLifetimes,onEntryDisposed:function(e,t){e.lifetime&&e.lifetime.dispose(),n&&n(e.value,e.key)}})}return e.prototype.getValue=function(e,t){var r,n=this,i=this._serializeKey(e),a=t?this._getOrCreateReferrerId(t):null;return this._entries.getEntry(i,a,(function(){var t,i=new FxImpl.TriggerableLifetimeManager;if(n._tryFindValueInRelatedCache){var a=n._tryFindValueInRelatedCache(e,i);a&&(t=a.value,r=!0)}return r||(t=n._supplyValue(e,i)),{key:e,value:t,lifetime:i}})).value},e.prototype.insertValueIfNotPresent=function(e,t,r){var n=this._serializeKey(e),i=this._getOrCreateReferrerId(r);this._entries.getEntry(n,i,(function(){return{key:e,value:t,lifetime:null}}))},e.prototype.hasEntry=function(e){var t=this._serializeKey(e);return this._entries.hasEntry(t)},e.prototype.dissociateEntry=function(e,t){var r=this._serializeKey(e),n=this._getOrCreateReferrerId(t);n&&this._entries.dissociateEntry(r,n)},e.prototype.immediatelyEvictEntry=function(e){var t=this._serializeKey(e);this._entries.immediatelyEvictEntry(t)},e.prototype.forEachEntry=function(e){this._entries.forEachEntry((function(t,r){e(r.key,r.value)}))},e.prototype.dispose=function(){this._entries.dispose()},e.prototype._getOrCreateReferrerId=function(e){var t=this,r=e,n=r[this._referrerPropertyName];return this._referrerPropertyName in r||(r[this._referrerPropertyName]=n="referrer"+ ++this._referrerUniqueId,e.registerForDispose((function(){delete r[t._referrerPropertyName],t._entries.disposeReferrer(n),n=null}))),n},e}();e.ObjectCache=n}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=e.clone,n=function(n){function i(e){var t=n.call(this,e)||this;return t.navigationOptions=t._navigationOptions=e.navigation?r(e.navigation):null,t}return __extends(i,n),i.prototype.createView=function(e,r){return new t.QueryView(this,e,r)},i.prototype.createNavigator=function(e){return this.createNavigatorWithOptions(e,null)},i.prototype.createNavigatorWithOptions=function(e,r){var n=this._navigationOptions;if(n){var i={},a=this.createView(e),o=r&&r.createMapping?r.createMapping(e,a.items):a.items;return n.loadBySkipTake&&(i.loadBySkipTake=function(e,t,r,i,o,s){return n.loadBySkipTake(a,t,r,i,o,s)}),n.loadByContinuationToken&&(i.loadByContinuationToken=function(e,t,r,i,o){return n.loadByContinuationToken(a,t,r,i,o)}),new t.RemoteDataNavigator(e,o,a.metadata,i,a.partialErrors)}throw new Error("Cannot create a DataNavigator, because the QueryCache has no navigation options configured.")},i.prototype._findMatchingEntity=function(t,r){var n=function(e){return t(e,r)};return this._findEntity((function(t,r,i){var a=r&&ko.unwrap(r);return a&&e.find(a,n)}),r)},i.prototype._getDataFromDataSet=function(e){var t=e.data;if(!ko.isObservable(t)||"function"!=typeof t||!Array.isArray(t()))throw new Error("DataSets used with QueryCache must contain an observable-wrapped array.");return e.data},i}(FxImpl.Data.DataCache);t.QueryCache=n}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(t){var r=e.noop,n=function(t){function n(e,n,i){var a=t.call(this,e,n,i||{})||this;a._items=ko.observableArray(),a._metadata=ko.observable(null);var o=a._loadedCacheEntry,s=a._items,u=a._metadata;return ko.reactor(n,(function(){var e=[],t=o();if(t){var n=t.data;r(n),e=(e=n()).slice()}s(e)})),ko.reactor(n,(function(){var e=o(),t=e&&e.navigationMetadata();u(t||null)})),a}return __extends(n,t),Object.defineProperty(n.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this._items},enumerable:!1,configurable:!0}),n=__decorate([__metadata("fx:diagnostics",[require,"QueryView"]),e.Composition.ProxyCompatibilityMode,__metadata("design:paramtypes",[Object,Object,Object])],n)}(FxImpl.Data.DataView);t.QueryView=n}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={})),function(e){!function(e){e.uriFormatter=function(e,t){var r=t?encodeURIComponent:null;return function(t){var n=typeof t,i="string"===n||"number"===n?{id:t}:t;return e.format(i,r)}}}(e.Data||(e.Data={}))}(MsPortalFx||(MsPortalFx={}));