define("_generated/Less/MsPortalImpl/Controls/Controls.HotSpot.css",["module"],(function(o){"use strict";return{css:'.fxc-hotspot{position:relative;padding:5px 10px}.fxc-hotspot.fxc-hotspot-clickable:hover{cursor:pointer}.fxc-hotspot[aria-disabled="true"]{pointer-events:none}',moduleId:o.id}})),
define("MsPortalImpl/Controls/Controls.HotSpot",["require","exports","MsPortalImpl.Controls/Controls/Base/ViewModelBase","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar","MsPortalImpl/Base/Base.KeyboardHelper","FxInternal/Css","_generated/Less/MsPortalImpl/Controls/Controls.HotSpot.css"],(function(o,e,t,i,n,a,s,l,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Widget=void 0,(0,l.injectCss)(r);const c="fxc-hotspot",x="fxc-hotspot-selected fxs-portal-selected fxs-portal-activated",f="fxc-hotspot-clickable fxs-portal-hover",d="fxc-hotspot-customclick";class b extends t.Widget{constructor(o,e,t){let i;super(o,e,t);const s=e._msPortalFxOnClick;s?(s.bind(e),i=a.getSelectableWithClickHandler(t&&t.diContainer,e,o,s)):i=FxImpl.isSelectable2(e.selectable)?n.getOrCreate(t.diContainer,e.selectable):e.selectable||e;let l=null;e.uri?l=ko.observable(e):e.clickableLink&&(l=e.clickableLink),o.addClass(c).toggleClass(d,!!e.clickableDuringCustomize);const r=this.ltm;ko.reactor(r,(()=>{o.attr({tabindex:this.$tabIndex(),role:i||l?"link":null,"aria-disabled":this.$disabled()})})),l?this._initializeClickableLinkEvents(l):i&&this._initialiazeSelectableEvents(i),r.registerForDispose((()=>{o.removeAttr("tabindex role").removeClass([c,x,f,d].join(" "))}))}_initializeClickableLinkEvents(e){const t=this.element;t.addClass(f);const n=n=>{const a=e();if(a){const e=i.sanitizeLinkUri(ko.unwrap(a.uri),{diContainer:this._diContainer,localRequire:o,windowContext:t}),s="click"===n.type;if(e&&(s||13===n.keyCode||32===n.keyCode)){window.open(e,ko.unwrap(a.target),ko.unwrap(a.windowFeatures)||"")&&a.onLinkOpened&&a.onLinkOpened(!s)}n.stopPropagation()}};this.ltm.registerForDispose(t.setEvents(["click",n],["keypress",n]))}_initialiazeSelectableEvents(o){const e=this.element,t=this.ltm;t.registerForDispose(e.setEvents(["click",t=>{s.isCtrlOrCommandOnly(t)||t.shiftKey?$(t.target).trigger("fxopeninnewtab",{selectable:o}):(o.onClick(),e.trigger("fxensurebladevisible",{})),t.stopPropagation()}],["keypress",t=>{13!==t.keyCode&&32!==t.keyCode||(o.onClick(),e.trigger("fxensurebladevisible",{})),t.stopPropagation()}])),ko.computed(t,(()=>{const t=o.isClickable();e.toggleClass(f,t)})),o.isSelected.subscribeAndRun(t,(t=>{e.toggleClass(x,t),t&&e.trigger($.Event("fxselectableactivated",{activated:o.isSelected}))}))}}e.Widget=b})),
define("_generated/Less/MsPortalImpl/Controls/Controls.InfoBox.css",["module"],(function(o){"use strict";return{css:".fxs-portal-background-secondary .fxc-infoBox-image-container{display:flex}.fxc-infoBox{margin:19px 0}.fxc-infoBox .fxc-hotspot{padding:0}.fxs-portal-background-secondary .fxc-infoBox-link{margin-top:7px;height:12px;width:12px}.fxs-portal-background-secondary .fxc-infoBox-link>svg{height:12px;width:12px}.fxc-infoBox-link{position:relative;right:10px;margin-top:4px;height:8px;width:8px}.fxc-infoBox-link>img,.fxc-infoBox-link>svg{height:8px;width:8px}.fxc-infoBox-dismiss{cursor:pointer;height:24px;width:24px;min-width:24px;border:0;margin:4px 4px 0 0}.fxc-infoBox-dismiss svg{display:block;height:8px;width:8px;margin:auto}.fxc-infoBox-container{display:flex;width:100%}.fxc-infoBox-container.fxt-infoBox-container{width:calc(100% - 18px);border:1px solid;border-radius:2px;padding-right:16px}.fxc-infoBox-container.fxt-infoBox-container:focus{outline:0}.fxc-infoBox-container.fxt-infoBox-container.fxc-infobox-size-normal:focus{outline:0}.fxc-infoBox-container.fxt-infoBox-container.fxc-infobox-size-small{background-color:inherit;border:0}.fxc-infoBox-container.fxt-infoBox-container .fxc-infoBox-dismiss{margin-right:-12px}.fxc-infoBox-image-container,.fxc-infoBox-text{vertical-align:middle}.fxc-infoBox-image{margin:auto 0}.fxc-infoBox-text{width:100%;margin-bottom:auto;margin-top:auto;font-size:12px;line-height:15px;white-space:pre-wrap;overflow:hidden;text-overflow:ellipsis}.fxs-portal-background-secondary .fxc-infoBox-image{width:36px;height:36px;padding:7px}.fxs-portal-background-secondary.fxs-portal-background-secondary .fxc-infoBox-image-container{min-width:50px}.fxs-portal-background-secondary.fxs-portal-background-secondary .fxc-infoBox-text{padding:10px 10px 10px 14px}.fxs-portal-background-secondary .fxc-link-infoBox-text{padding-right:25px}.fxs-portal-background-secondary.fxc-infobox-size-small .fxc-infoBox-image{width:15px;height:15px;padding:4px}.fxs-portal-background-secondary.fxc-infobox-size-small.fxs-portal-background-secondary .fxc-infoBox-image-container{min-width:23px}.fxs-portal-background-secondary.fxc-infobox-size-small.fxs-portal-background-secondary .fxc-infoBox-text{padding:5px 5px 5px 8px}.fxs-portal-background-secondary.fxc-infobox-size-small .fxc-link-infoBox-text{padding-right:25px}.fxc-infoBox-clickable{cursor:pointer}.fxt-infoBox-container .fxc-infoBox-image{width:16px;height:16px;padding:16px}.fxt-infoBox-container.fxs-portal-background-secondary .fxc-infoBox-image-container{min-width:48px}.fxt-infoBox-container.fxs-portal-background-secondary .fxc-infoBox-text{padding:0 0 0 32px}.fxt-infoBox-container .fxc-link-infoBox-text{padding-right:25px}.fxt-infoBox-container .fxc-infoBox-image-container{min-width:40px;max-width:40px}.fxt-infoBox-container .fxc-infoBox-text{padding:16px 0 16px 0}.fxt-infoBox-container.fxc-infobox-size-small .fxc-infoBox-text{padding:0 0 0 0}.fxt-infoBox-container.fxc-infobox-size-small .fxc-infoBox-image-container{min-width:24px}.fxt-infoBox-container.fxc-infobox-size-small .fxc-infoBox-image{padding:0}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-container.fxc-infobox-size-normal:focus{border-color:#4894fe}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-Info.fxc-infobox-size-normal{background-color:#001433;border-color:#001433}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-Info .fxc-infoBox-image{fill:#015cda}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-Upsell.fxc-infobox-size-normal{background-color:#1f0a29;border-color:#1f0a29}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-Upsell .fxc-infoBox-image{fill:#8a2da5}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-Success.fxc-infobox-size-normal{background-color:#1b3300;border-color:#1b3300}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-Success .fxc-infoBox-image{fill:#57a300}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-Warning.fxc-infobox-size-normal{background-color:#331b00;border-color:#331b00}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-Warning .fxc-infoBox-image{fill:#db7500}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-Error.fxc-infobox-size-normal{background-color:#300306;border-color:#300306}.fxs-mode-dark .fxt-infoBox-container.fxc-infoBox-Error .fxc-infoBox-image{fill:#e00b1c}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-container.fxc-infobox-size-normal:focus{border-color:#015cda}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-Info.fxc-infobox-size-normal{background-color:#f0f6ff;border-color:#f0f6ff}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-Info .fxc-infoBox-image{fill:#015cda}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-Upsell.fxc-infobox-size-normal{background-color:#f9f3fc;border-color:#f9f3fc}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-Upsell .fxc-infoBox-image{fill:#8a2da5}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-Success.fxc-infobox-size-normal{background-color:#f8fff0;border-color:#f8fff0}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-Success .fxc-infoBox-image{fill:#57a300}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-Warning.fxc-infobox-size-normal{background-color:#fff8f0;border-color:#fff8f0}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-Warning .fxc-infoBox-image{fill:#db7500}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-Error.fxc-infobox-size-normal{background-color:#fef0f1;border-color:#fef0f1}.fxs-mode-light .fxt-infoBox-container.fxc-infoBox-Error .fxc-infoBox-image{fill:#e00b1c}.fxs-mode-dark .fxs-blade-status-text-container:focus .fxc-infoBox-container{border-color:#4894fe}.fxs-mode-light .fxs-blade-status-text-container:focus .fxc-infoBox-container{border-color:#015cda}",moduleId:o.id}})),
define("MsPortalImpl/Controls/Controls.InfoBox",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Base/Base.SvgHelper","_generated/MsPortalImpl/Svg/Startup/Close.svg","MsPortalImpl/Controls/Controls.HotSpot","_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.LinkHandler","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl.Controls/Controls/Base/Loadable","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Controls/Controls.InfoBox.css","MsPortalImpl/Interactions/Interactions.PortalReader","Fx/Controls/InfoBox"],(function(o,e,t,i,n,a,s,l,r,c,x,f,d,b,p,g,m,u,B){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InfoBox=e.Widget=e.createVm=void 0;var h=x.getFxClickSelectable;MsPortalFx.Base.Diagnostics;(0,g.injectCss)(m);var k=MsPortalFx.Base.Images;Object.defineProperty(e,"createVm",{enumerable:!0,get:function(){return B.create}});const C="group",I="status",v="fxc-infoBox",_="fxc-infobox-size-{0}",y="fxc-infoBox-container",P="fxt-infoBox-container",M=`.${y}`,S="fxc-infoBox-text",w="infobox",$="fxs-portal-background-secondary",z=MsPortalFx.isFeatureEnabled("SuppressInfoBoxRedesign");let L=0;const F={5:"Error",1:"Info",3:"Success",2:"Upsell",4:"Warning"},R={5:MsPortalFx.Base.Images.StatusBadge.Critical({customClass:"fxs-portal-svg"}),1:MsPortalFx.Base.Images.StatusBadge.Info({customClass:"fxs-portal-svg"}),3:MsPortalFx.Base.Images.StatusBadge.Success({customClass:"fxs-portal-svg"}),2:MsPortalFx.Base.Images.StatusBadge.Upsell({customClass:"fxs-portal-svg"}),4:MsPortalFx.Base.Images.StatusBadge.Warning({customClass:"fxs-portal-svg"})},E=t("div",{class:`${y} fxs-portal-border`,"data-bind":{attr:{id:"$ctl._containerId","aria-labelledby":"$ctl._containerId","aria-describedby":"$ctl._labelId","aria-label":"$ctl._ariaLabel","aria-disabled":"$disabled"},css:{"azc-disabled":"$disabled"}}},t("label",{class:"fxs-hide-accessible-label","data-bind":{attr:{id:"$ctl._labelId","aria-hidden":"true",title:"$ctl._labelContent"},text:"$ctl._labelContent"}}),t("div",{class:"fxc-infoBox-image-container"},t("div",{class:"fxc-infoBox-image","data-bind":{image:"$ctl._icon"}})),t(i.KoIfNot,{condition:"$ctl._clickableLink"},t("div",{class:`${S} msportalfx-tooltip-overflow`,"data-bind":{untrustedContent:"$ctl._text"}})),t(i.KoIf,{condition:"$ctl._clickableLink"},t("div",{class:`${S} fxc-link-infoBox-text msportalfx-tooltip-overflow`,"data-bind":{untrustedContent:"$ctl._text"}}),t(i.KoIfNot,{condition:"data.style"},t("div",{class:"fxc-infoBox-link","aria-hidden":"true"},n.getSvgReferenceOrFallBackToData(l).outerHTML))),t(i.KoIf,{condition:"data.canClose"},t("button",{class:"fxc-infoBox-dismiss","aria-label":r.InfoBox.ariaClose,"data-bind":{click:"$ctl._closeInfoBox",clickBubble:"false",attr:{tabindex:"$ctl.$tabIndex"}}},n.getSvgReferenceOrFallBackToData(a).outerHTML)));class W extends d.Widget{constructor(o,e,t){super(o,e,t),this._clickableLink=ko.observable(),this._containerId=`${MsPortalFx.newGuid()}-infobox-container`,this._labelId=`${MsPortalFx.newGuid()}-infobox-label`,this._labelContent=ko.observable(),this._text=ko.observable(""),this._hasStatusRole=ko.observable(!1),this._closeInfoBox=MsPortalFx.noop,this._urlCallout=ko.computed(this.ltm,(()=>{const o=ko.unwrap(e.clickableLink)||e.onClick;if((0,b.isLink)(o)){this._clickableLink(o);const e=o.uri()||null;return e&&r.Shell.linkNavigatesAway.format(e)||""}return""})),this._ariaLabel=ko.observable(null),this._ariaLabelUpdateTrigger=ko.observable(!0).extend({notify:"always"});const i=[this.options.text,this._urlCallout,this._ariaLabelUpdateTrigger],n=e.ariaLabel;n&&i.push(n),ko.computed(this.ltm,i,(o=>{const e=ko.unwrap(n);if(e)this._ariaLabel(e);else{let e=o;o&&o.htmlTemplate&&(e=this.element.find(`.${S}`).text()),this._ariaLabel(e?`${e}${this._urlCallout()}`:null)}})),this._initializeWidgets(e);const a=this.element.find(M),s=U(e);s?(a.addClass(P),this._icon=ko.observable(),e.canClose&&(this._closeInfoBox=()=>{this.dispose(),e.onCloseClickCallback&&e.onCloseClickCallback()}),e.style.subscribe(this.ltm,(o=>{a.removeClass(`fxc-infoBox-${F[o]}`)}),this,"beforeChange"),e.style.subscribeAndRun(this.ltm,(o=>{a.addClass(`fxc-infoBox-${F[o]}`),this._icon(R[o])})),e.image.subscribeAndRun(this.ltm,(o=>{if(o){let t=!1;z?(a.removeClass(P),a.addClass($)):(t=!0,A(k.Polychromatic.Info(),o)||A(k.StatusBadge.Info(),o)?e.style(1):A(k.StatusBadge.Warning(),o)?e.style(4):A(k.StatusBadge.Error(),o)||A(k.StatusBadge.Critical(),o)?e.style(5):A(k.StatusBadge.Success(),o)?e.style(3):t=!1),t||this._icon(o)}else this._icon(R[e.style()])}))):(a.addClass($),this._icon=e.image),this._bindDescendants(),this._ariaLabelUpdateTrigger(!0),s&&this._hasStatusRole()&&e.visible()&&(this._announce||(this._announce=new u.PortalReader(this.ltm,{removalDelayMs:1})),this._announce.read(a.text()))}dispose(){this._cleanElement(v),super.dispose()}get options(){return this._options}_initializeWidgets(e){const t=this.element;t.addClass(v).html(E);const i=t.find(M);let n;const a=this.ltm,l=()=>{n&&n.disabled(this.$disabled())},x=U(e),d=this.options.isInline;this.options.size.subscribeAndRun(this.ltm,(o=>{const e=x&&!d&&!(z&&0===o)||!x&&1===o,t=_.format(e?"normal":"small"),n=_.format(e?"small":"normal");i.removeClass(n),i.addClass(t)}));const p=e.clickableLink,g=e.onClick,m=MsPortalFx.initObservable(p,g);if(e.selectable){const o=e.selectable;o?((o=>{n&&(n.dispose(),n=null),o&&(n=new s.Widget(i,o),l())})(o),this.$disabled.subscribe(a,l),e.selectable.selectedValue.subscribeAndRun(a,(o=>{i.attr({role:o?C:I,tabindex:o?0:-1,"aria-describedby":o?this._labelId:null,"aria-live":o?null:"off"}),this._hasStatusRole(!o)})),a.registerForDispose((()=>t.removeAttr("role")))):i.attr({role:I,"aria-live":"off"})}else if(p||g){let n,s=(o,e,t)=>!0,l="";const x=h(this._diContainer,a,t,w,w+L++);m.subscribeAndRun(a,(d=>{if(d){n&&n.dispose(),n=a.createChildLifetime();let p=d;l=p&&p.telemetryName||"",ko.ignoreDependencies((()=>{if("function"==typeof p){const i=p;p=n=>{n.stopPropagation(),Q.isPromiseAlike(i)&&f.logToExtension(o,t,2,FxImpl.createError("InfoBox binding argument is not a callback function. The click handler is "+i)),x.invokeClick(e,i,n)}}const i=(0,c.getUriAndHandler)(n,this._diContainer,p,!0);i.errorMessage.subscribeAndRun(n,(e=>{e&&f.logToExtension(o,t,1,FxImpl.createError(`InfoBox failure: ${MsPortalFx.getLogFriendlyMessage(e)}`))})),i.uri.subscribeAndRun(n,(o=>{e.disabled(!o||!!this.$disabled())})),s=i.handler}));const g=o=>{e.disabled()||s(o,x,l)};this.ltm.registerForDispose(this.element.setEvents(["keypress",M,o=>{13!==o.keyCode&&32!==o.keyCode||g(o)}],["click",M,o=>{g(o)}]));const m=!!d&&!(0,b.isLink)(d);this._labelContent(m?r.InfoBox.ariaButtonContent:r.InfoBox.ariaLinkContent),this._hasStatusRole(!1),e.disabled.subscribeAndRun((o=>{i.attr({tabindex:o?-1:0})})),i.addClass("fxs-portal-hover fxc-infoBox-clickable"),i.attr({role:C})}else i.attr({role:I,"aria-live":"off"})}))}else i.attr({tabindex:-1,role:I,"aria-live":"off"}),this._hasStatusRole(!0);e.visible=MsPortalFx.initObservable(e.visible,!0),e.text.subscribeAndRun(a,this._text),ko.reactor(a,[this._hasStatusRole,e.visible],((o,e)=>{o&&e&&(this._announce||(this._announce=new u.PortalReader(this.ltm,{removalDelayMs:1})),this._announce.read(i.text()))}))}}function U(o){return o.hasOwnProperty("canClose")}function A(o,e){return o.type===e.type&&o.data===e.data}e.Widget=W,e.InfoBox=(0,p.createControlComponentForKO)({widgetCtor:W})}));