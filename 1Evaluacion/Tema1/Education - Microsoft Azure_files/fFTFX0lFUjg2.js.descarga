define("_generated/Less/MsPortalImpl/Widgets/Widgets.HoverCard.css",["module"],(function(e){"use strict";return{css:'@keyframes cardOpen{0%{opacity:0;transform:scale(.7)}100%{opacity:1;transform:scale(1)}}.fxs-hover-card-balloon{background-color:transparent;list-style-type:none;padding:0;margin:0}.fxs-hover-card-balloon .azc-balloon-pointer2{display:none}.fxs-hover-card-balloon.azc-balloon-hidden .fxs-hover-card{animation:none;display:none}.fxs-hover-card-balloon>.azc-balloon-content{padding:0;background-color:transparent;box-shadow:0 8px 16px 0 rgba(0,0,0,.28);animation-name:stretch;animation-duration:.2s;animation-timing-function:ease-out;animation-delay:0;animation-direction:alternate;animation-fill-mode:none;animation-play-state:running}@keyframes stretch{0%{transform:scale(.1);box-shadow:none}100%{transform:scale(1);box-shadow:0 8px 16px 0 rgba(0,0,0,.28)}}.fxs-hover-card-balloon.fxs-portal-bg-txt-br{background-color:transparent}.fxs-hover-card-balloon.azc-balloon-hidden .fxs-hover-card{animation:none;display:none}.fxs-hover-card-balloon>.azc-balloon-content{margin:0;background-color:transparent;box-shadow:0 8px 16px 0 rgba(0,0,0,.28);animation-name:stretch;animation-duration:.2s;animation-timing-function:ease-out;animation-delay:0;animation-fill-mode:none;animation-direction:alternate;animation-play-state:running}@keyframes stretch{0%{transform:scale(.1);box-shadow:none}100%{transform:scale(1);box-shadow:0 8px 16px 0 rgba(0,0,0,.28)}}.fxs-hover-card-container{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;border:1px solid #f3f2f1;font-size:13px;line-height:18px;color:inherit;width:320px;max-height:512px;overflow:hidden;cursor:default}.fxs-hover-card-header{display:flex;padding:0 0 10px}.fxs-hover-card-header .fxs-hover-card-h3 .fxs-hover-card-icon{float:left}.fxs-hover-card-favoriteicon{margin:0 0 auto auto;float:right;cursor:pointer}.fxs-hover-card-favoriteicon svg{height:14px;width:14px;opacity:.6;fill:#0078d4}.fxs-hover-card-favoriteicon:hover svg{opacity:1}.fxs-mode-dark .fxs-hover-card-favoriteicon svg{fill:#f2f2f2}.fxs-hover-card-icon{height:50px;width:50px;flex:0 0 auto;float:right;text-align:center;border:1px solid transparent;margin:0 20px 0 0;box-sizing:border-box}.fxs-hover-card-border{opacity:1;height:0;border-top:1px solid #f3f2f1}.fxs-hover-card{animation:cardExpand .467s ease 1500ms;animation-fill-mode:forwards;transition:opacity 1500ms cubic-bezier(.5,0,0,1) 3s;visibility:hidden;opacity:0;height:0;max-height:0;width:100%;overflow:hidden}@keyframes cardExpand{0%{opacity:0;height:0;max-height:0}99%{visibility:visible;opacity:1;height:100%;max-height:356px}100%{visibility:visible;opacity:1;height:100%;max-height:100%}}.fxs-hover-card-initial{padding:20px 20px 0 20px}.fxs-hover-card-additional{overflow-y:auto;max-height:376px;margin-top:-1px}.fxs-hover-card-padleftright{padding:0 20px}.fxs-hover-card-commands{position:relative;padding:0;margin-bottom:10px}.fxs-hover-card-training-icon{padding:0 5px 0 0;min-width:24px;min-height:24px;height:24px;width:24px}.fxs-hover-card-training-item{display:flex;align-items:center;padding:5px 20px}.fxs-hover-card-padless-header{padding:10px 0 0;margin:0 20px;border-top:1px solid #f3f2f1}.fxs-hover-card-training-link{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:-3px}.fxs-hover-card-training-sub{line-height:17px;margin-top:-2px;display:flex}.fxs-hover-card-list{list-style-type:none;padding-left:0}.fxs-hover-card-title{font-weight:600;font-size:18px;line-height:20px;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical;max-height:41px;display:-webkit-box}.fxs-hover-card-heading{font-weight:600;font-size:14px;line-height:20px;margin:4px 0}.fxs-hover-card-padbottom{padding-bottom:10px}.fxs-hover-card-section{padding:10px 0;margin:0 20px;border-top:1px solid #f3f2f1}.fxs-hover-card-description{display:block;display:-webkit-box;line-height:18px;max-height:90px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:5;-webkit-box-orient:vertical;max-width:263px}.fxs-hover-card-expanded-description{max-height:100%;overflow-y:auto;-webkit-line-clamp:initial;-webkit-box-orient:vertical}.fxs-hover-card-seemore-link{display:flex}.fxs-hover-card-see-more-less{padding-right:5px}.fxs-hover-card-expand-icon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:10px;width:10px}.fxs-hover-card-icon-vertical-transform{transform:scale(-1,-1);padding-bottom:8px}.fxs-hover-card-resource-property{padding:5px 0}.fxs-hover-card-property-name{color:#605e5c}.fxs-theme-dark .fxs-hover-card-property-name{color:#9fa1a3}.fxs-hover-card-property-value{display:flex}.fxs-hover-card-no-border{border:0}.fxs-hover-card-tags{display:flex}.fxs-hover-card-azure-copilot-icon{display:flex;align-items:center}.fxs-hover-card-azure-copilot-icon svg{height:17px;width:17px}.fxs-hover-card-azure-copilot-link{margin-left:8px;font-weight:600;font-size:14px}.fxs-hover-card-azure-copilot-link-section{display:flex;cursor:pointer;padding:20px 0}',moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.HoverCard",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","Viva.Controls/Controls/Viva.Balloon","MsPortalImpl/UI/UI.PopupPositioningMethods","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Base/Base.KeyboardHelper","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.HoverCard.css","Weave","Fx/Experimentation"],(function(e,t,o,i,a,r,n,s,l,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBalloonElement=t.attach=t.Widget=t.ViewModel=t.logTelemetry=void 0,(0,l.injectCss)(d);function h(e,t){return!(!e||!t)&&(t===e||$.contains(e,t))}function g(e,t,o){MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"HoverCard",name:t,action:e,actionModifier:"mark",data:o})}t.logTelemetry=g;class x extends o.ViewModel{constructor(){super(...arguments),this.positionHint=1,this.favoriteOnDismiss=!1,this.onClickCopilotButton=MsPortalFx.noop}}t.ViewModel=x;class m extends o.Widget{constructor(e,t,o){super(e,t),this._diContainer=o,t.onFavoritesChange&&(0,c.subscribeAndRun)(this.ltm,[this._diContainer.get(n.FavoritesManager).favorites],(e=>{t.onFavoritesChange(e)})),t.widget=this,this.element.addClass("fxs-home-hover-card"),this._initializeBalloonWidget()}_initializeBalloonWidget(){const e=this.element,t=new a.ViewModel({ltm:this.ltm}),o={htmlTemplate:this.options.template,viewModel:this.options};t.visible(!0),t.closeOtherBalloons=!0,t.renderMode(0),t.positionHint=this.options.positionHint,t.box((()=>(0,r.getBox)(this.options.dockingElement))),t.content(o);const n=new a.Widget(e,t,{isTrusted:!0},new a.WidgetUIState),l=new MsPortalFx.Base.Debouncer(((t,o)=>(t||[]).concat(o.filter((t=>h(e[0],t.currentTarget)||h(this.options.dockingElement[0],t.currentTarget))))),(e=>{if(!e.length)return Promise.resolve(null);const t=MsPortalFx.last(e);return["focusout","mouseleave","mouseout"].includes(t.type)&&!h(n.element[0],document.activeElement)&&(this.ltm.isDisposed()||this.dispose()),Promise.resolve(null)}),500,!0);this.ltm.registerForDispose([n,()=>{this.options.dockingElement[0].addEventListener("click",(e=>{h(this.element[0],e.currentTarget)&&(this.dispose(),e.stopPropagation())}),!0)},n.element.setEvents(["animationend",".fxs-hover-card",e=>{const t=$(window).height()+$(document).scrollTop(),o=n.element[0],i=(0,r.getBox)(o),a=i.top+i.height+30-t;a>0&&$(o).animate({top:i.top-a+"px"}),g("FullyRevealed",o.getAttribute("data-assetid")||o.getAttribute("data-name"),{hoverCardLocation:o.getAttribute("data-source")})}],["click",t=>{if(h(e[0],t.target)){($(t.target).parents("a")[0]||"a"===t.target.tagName.toLowerCase())&&this.dispose(),t.stopPropagation()}}],["mouseleave",e=>{l.execute([e]),e.stopPropagation()}],["focusout",e=>{l.execute([e]),e.stopPropagation()}],["mouseenter",e=>{l.execute([e]),e.stopPropagation()}],["focusin",e=>{l.execute([e]),e.stopPropagation()}],["keydown",e=>{27!==e.keyCode&&112!==e.keyCode||(this.dispose(),e.stopPropagation(),e.preventDefault()),32===e.keyCode&&4===(0,s.getModifierKeys)(e)&&(this.options.setFavorite&&this.options.setFavorite(),e.stopPropagation(),e.preventDefault())}],["focusin",".fxs-hover-card-favoriteicon",e=>{const t="true"===$(e.currentTarget).attr("aria-pressed");$(e.currentTarget).attr("aria-pressed",!t),e&&!h(n.element[0],e.relatedTarget)&&(this.options.dockingElement.blur(),$(e.relatedTarget).focus())}]),this.options.dockingElement.setEvents(["mouseleave",e=>{l.execute([e])}],["focusout",e=>{l.execute([e]),e.stopPropagation()}],["mouseenter",e=>{l.execute([e]),e.stopPropagation()}],["focusin",e=>{l.execute([e]),e.stopPropagation()}]),$(document).setEvents(["keydown",e=>{27===e.keyCode&&(this.dispose(),e.stopPropagation(),e.preventDefault()),32===e.keyCode&&4===(0,s.getModifierKeys)(e)&&(this.options.setFavorite(),e.stopPropagation(),e.preventDefault())}])]),new i.KeyboardNavigation(this.ltm,{element:this.element,tabTriggers:2});const d=this._diContainer.get(p.Experimentation).shellAssignments.getNumberValue("hovercardfullrevealsetdelay");"number"==typeof d&&this.element.find(".fxs-hover-card").css("animation-delay",`${d}ms`)}dispose(){h(this.options.dockingElement[0],document.activeElement)&&(this.options.dockingElement.findFirstTabbable().focus(),this.options.dockingElement.trigger("programmatic"),this.element.find(".fxs-hover-card-container").animate({height:0},501)),this.element.removeAttr("tabindex"),setTimeout((()=>{super.dispose(),this.options.favoriteOnDismiss&&this.options.updateFavorite&&this.options.updateFavorite(),this.options.dockingElement.removeAttr("title"),this._cleanElement(),f(void 0)}),501)}}t.Widget=m;const f=ko.observable();t.attach=function(e,t,o,i,a){if(a.get(FxImpl.Features).isEnabled("showhovercard")){let a=!1;const r=new MsPortalFx.Base.Debouncer(((e,o)=>(e||[]).concat(o.filter((e=>h(t[0],e.currentTarget))))),(t=>{const o=MsPortalFx.last(t);if(!t.length||"programmatic"===o.type||!e||e.isDisposed()||!$(o.currentTarget).is(":visible"))return Promise.resolve(null);const a=f();let r=a&&a.options.dockingElement[0];return r&&a.ltm.isDisposed()&&(r=null),"open"!==o.type&&!$(o.currentTarget).is(":hover")&&!h(o.currentTarget,document.activeElement)||h(r,o.currentTarget)||f(i(o)),Promise.resolve(null)}),500,!0),n=t=>{const o=f(),i=document.activeElement;if(o&&h(o.options.dockingElement[0],t))return o.options.focusContent.fxAwaitAndRun(e).then((()=>{o.element.find('[role="button"]').focus(),f.fxOnce(e,(e=>{$(i).focus()}))}));f(null),f.fxAwait(e).then((t=>{const o=document.activeElement;t&&t.options.focusContent.fxAwaitAndRun(e).then((()=>{t.element.find('[role="button"]').focus(),f.fxOnce(e,(e=>{$(o).focus()}))}))})),r.execute([$.Event("open",{currentTarget:t,target:t})]),r.flush()};return e.registerForDispose(t.setEvents(["click",o,e=>{r.flush().then((()=>{if($(e.target).parents("a")[0]||"a"===e.target.tagName.toLowerCase()){const e=f();e&&e.dispose(),a=!0}}))}],["mouseenter",o,e=>{$(e.currentTarget).find("[title]").each(((e,t)=>{$(t).attr("data-title",$(t).attr("title")),$(t).removeAttr("title")})),e.stopPropagation()}],["programmatic",o,e=>{r.execute([e])}],["mouseleave",o,e=>{a=!1,$(e.currentTarget).find("[data-title]").each(((e,t)=>{$(t).attr("title",$(t).attr("data-title")),$(t).removeAttr("data-title")})),e.stopPropagation()}],["mousemove",o,e=>{a||($(e.currentTarget).attr("aria-describedby","hoverCardDescriptionId"),r.execute([e]),e.stopPropagation())}],["keydown",o,e=>{$(e.currentTarget).attr("aria-describedby","hoverCardDescriptionId"),112===e.keyCode&&(n(e.currentTarget),e.stopImmediatePropagation(),e.preventDefault())}])),n}return MsPortalFx.identity},t.getBalloonElement=function(e,t,o){let i=$.querySelectorAll(`.fxs-hover-card-balloon[data-name='${e}']`);return i?.length||(i=$(FxImpl.createElement("div",{style:"display: none",class:"fxs-hover-card-balloon"})),i.attr("data-name",e),i.attr("data-source",t),o&&i.attr("data-assetid",o),function(){const e="fxs-hover-cards-main-container";let t=$.querySelectorAll(`.${e}`);return t?.length||(t=$(FxImpl.createElement("div",{class:e})),$.querySelectorAll("body").append(t)),t}().append(i)),i}}));