define("MsPortalImpl/Base/BladeWidthHelper",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.allWidthClasses=t.getBladeWidthInfo=t.contextPaneDefaultSizeClass=void 0;const s={};s[51]={css:"fxs-bladesize-menu",width:265},s[0]={css:"fxs-bladesize-small",width:315},s[1]={css:"fxs-bladesize-medium",width:585},s[2]={css:"fxs-bladesize-large",width:855},s[3]={css:"fxs-bladesize-xlarge",width:1125},t.contextPaneDefaultSizeClass="fxs-bladesize-contextpane-default",t.getBladeWidthInfo=function(e){return s[e]},t.allWidthClasses=MsPortalFx.map(s,(e=>e.css)).join(" ")})),
define("MsPortalImpl/Interactions/Interactions.FocusHandler",["require","exports","MsPortalImpl/Base/Base.Timers","Weave","MsPortalImpl/Widgets/Widgets.Common"],(function(e,t,s,i,a){"use strict";let o;Object.defineProperty(t,"__esModule",{value:!0}),t.FocusHandler=t.setFocusOnContainer=void 0,t.setFocusOnContainer=s.throttleByAnimationFrame(((e,t)=>function(e,t){const s=$(e);if(!$.contains(s[0],document.activeElement)){let e=s.findFirstTabbable((e=>e.isInScrollView(t)));if(!e.length&&s.hasClass("fxs-blade-content")){const t=s.closest(".fxs-blade"),i=t.hasClass("fxs-menublade")?[]:[t.find(".fxs-blade-close")];i.push(s.closest("[tabindex]"));const a=MsPortalFx.find(i,(e=>!!e.attr("tabindex")||e.is("button,a")));a&&(e=a)}if(e.length){if(e.hasClass("fxs-part")){const t=e.findFirstTabbable();1===t.length&&(e=t)}return e[0].focus(),e}}}(e,t)));class n{constructor(){if(this._containerTargets=[],this._mapTofocusableTargets=MsPortalFx.memoize((e=>[])),this._mapSkipAutoFocus=new Map,this._debounceMenuBladeCleanup=s.debounce((()=>{0!==this._containerTargets.length||this._masterMenuBladeToSetFocus?.isMenuBladeLoadingDetailBlade()||(this._menuBladeToSetFocus=void 0,this._masterMenuBladeToSetFocus=void 0)}),1e3),o)throw new Error("FocusHandler operates as a singleton.");this._ltm=new FxImpl.TriggerableLifetimeManager,o=this,this._ltm.registerForDispose([this._debounceMenuBladeCleanup,$.querySelectorAll("body").setEvents(["focusin",this._cancelAutofocus=e=>{this._mapTofocusableTargets.map().forEach(((t,s)=>{const i=!!e||s!==this._menuBladeToSetFocus;this._mapSkipAutoFocus.set(s,i)}))}])])}dispose(){this._ltm.dispose(),o=null}static get Instance(){return o||(o=new n)}registerContainerForFocus(e,t){if(e){if(!this._menuBladeToSetFocus){t.isMenuBladeLoadingDetailBlade()&&(this._menuBladeToSetFocus=e,this._masterMenuBladeToSetFocus=t)}this._cancelAutofocus(),MsPortalFx.pushUnique(this._containerTargets,[e])}}notifyContainerReadyForFocus(e){try{if(MsPortalFx.remove(this._containerTargets,e).length){if(!this._mapSkipAutoFocus.get(e)){let o=e;if(this._menuBladeToSetFocus&&this._menuBladeToSetFocus!==e){const t=this._menuBladeToSetFocus.element.closest(".fxs-blade-content-container");t[0]&&$.contains(t[0],e.element[0])&&(o=this._menuBladeToSetFocus)}o&&(t=o,s.requestAnimationFrame((()=>{Promise.allSettled([(0,a.waitForBindings)(t.element[0]),(0,i.waitForChangePropagation)()]).then((()=>{setTimeout((()=>{t.setFocus()}),50)}))})))}this._mapSkipAutoFocus.delete(e),this._mapTofocusableTargets.delete(e),this._menuBladeToSetFocus&&0===this._containerTargets.length&&this._debounceMenuBladeCleanup()}}catch(e){}var t}}t.FocusHandler=n})),
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeEditAssetButton",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","Fx","MsPortalImpl/Resources/ImplScriptResources","Weave"],(function(e,t,s,i,a,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BladeEditAssetButton=void 0;var l=MsPortalFx.Base;let d=class{constructor(e){this._diContainer=e,this.icon=(0,n.makeWritableComputation)(null),this.title=(0,n.makeWritableComputation)("")}configure(e,t){(0,a.isFeatureEnabled)("selfservice_editasset")?this._diContainer.getAsync(i.get("MsPortalImpl/Services/Services.AssetCustomization","AssetCustomization")).then((s=>{const i=s.isAvailable(e,t);i&&(this.icon(l.Images.Edit({palette:99})),this.onClick=()=>s.customizeAsset(),this.title(o.Blade.editAsset)),t.showEditAssetButton(i)})):t.showEditAssetButton(!1)}};t.BladeEditAssetButton=d,t.BladeEditAssetButton=d=__decorate([__metadata("fx:diagnostics",[e,"BladeEditAssetButton"]),s.Class(),__metadata("design:paramtypes",[s.Container])],d)})),
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeFavoriteResourceButton",["require","exports","Fx/DependencyInjection","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","Weave"],(function(e,t,s,i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BladeFavoriteResourceButton=void 0;var n=MsPortalFx.Base;let l=class{constructor(){this.icon=(0,o.makeWritableComputation)(null),this.title=(0,o.makeWritableComputation)(""),this._setFavoriteProperties=()=>{this.icon(n.Images.Star({palette:99})),this.onClick=()=>this._removeResourceFromFavorites(),this.title(a.Blade.removeFromFavorites)},this._setNotFavoriteProperties=()=>{this.icon(n.Images.Favorite({palette:99})),this.onClick=()=>this._addResourceToFavorites(),this.title(a.Blade.addToFavorites)},this._addResourceToFavorites=()=>{i.AssetTypes.addFavoriteResourceEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{resourceId:this._resourceId,name:this._resourceName.value,telemetrySource:"ResourceBlade"}).then((e=>{e&&this._setFavoriteProperties()}))},this._removeResourceFromFavorites=()=>{i.AssetTypes.removeFavoriteResourceEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{resourceId:this._resourceId,telemetrySource:"ResourceBlade"}).then((()=>{this._setNotFavoriteProperties()}))}}configure(e,t){if("resourcemenublade"===e?.bladeDefinition?.name?.toLowerCase()){const s=e?.getViewModel();s?.id&&s.id()&&"string"==typeof s.id()&&(this._resourceId=s.id(),this._resourceName=t.titleMain,i.AssetTypes.isResourceFavoriteEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{resourceId:this._resourceId}).then((e=>{e?this._setFavoriteProperties():this._setNotFavoriteProperties(),t.showFavoriteResourceButton(!0)})))}}};t.BladeFavoriteResourceButton=l,t.BladeFavoriteResourceButton=l=__decorate([__metadata("fx:diagnostics",[e,"BladeFavoriteResourceButton"]),s.Class()],l)})),
define("MsPortalImpl/Widgets/Widgets.BladeContent.Component",["require","exports","Weave/DirectMode","Weave","FxInternal/Weave/Util","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Weave/Components/LoadingIndicator","MsPortalImpl/Widgets/Widgets.PartError","FxInternal/Weave","MsPortalImpl/Weave/LazyControls","MsPortalImpl/Widgets/Widgets.CommandBar"],(function(e,t,s,i,a,o,n,l,d,r,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BladeContentInner=void 0,t.BladeContentInner=function(e){const{vm:t}=e,u=(0,d.toComputation)(t.title),b=u.compose((e=>o.Blade.collapseMenuAria.format(e))),h=u.compose((e=>o.Blade.expandMenuAria.format(e))),g=(0,d.toComputation)(t.shieldType).compose(p),v=t.noticeTmplVm,y=(0,d.toComputation)(t.statusBar.activatable),C=(0,i.composeComputation)([(0,d.toComputation)(t.contentState),(0,d.toComputation)(t.loaded),y],((e,t,s)=>0===e||1===e||s&&!t)),w=(0,d.toComputation)(t.renderCmdBarWhenNoCmd),I=(0,i.composeComputation)([(0,d.toComputation)(t.commandBar.items),w],((e,t)=>e.length>0||t)),k=["fxs-commandBar-target fxs-portal-border fxs-portal-background fxs-portal-svg",{"fxs-alwaysshowcommandbar":w}];return s(i.Fragment,null,s("div",{className:["fxs-blade-commandBarContainer fxs-portal-background az-noprint",{"fxs-display-none":(0,i.composeComputation)([v,t.errorTmplVm],((e,t)=>e||t))}]},s(i.If,{condition:I,concealmentBehavior:"remove",trueFn:()=>s(c.CommandBar,{className:k,vm:t.commandBar}),falseFn:()=>s("div",{className:k})})),s("div",{className:"fxs-blade-dialoghost az-noprint"},s("div",{className:"fxs-blade-dialog"})),s(i.If,{condition:(0,d.toComputation)(t.description).compose(a.isNonEmptyString),concealmentBehavior:"remove",trueFn:()=>s(i.LifetimeManagerScoped,{fn:e=>s(r.LazyInfoBox,{className:"fxs-blade-description-container",vm:s=>s.createVm(e,{style:1,text:{htmlTemplate:'<span data-bind="text: description"></span><a class="msportalfx-ext-link" data-bind="text: helpText, attr: { href: helpUri }, visible: helpUri().length > 0" target="_blank"></a>',viewModel:{description:t.description,helpUri:t.helpUri,helpText:o.Blade.helpText}}})})})}),s("div",{className:"fxs-blade-status-container"},s(i.If,{condition:C,falseFn:()=>s(i.LifetimeManagerScoped,{fn:e=>s(r.LazyInfoBox,{className:"fxs-blade-status-text-container",tagName:"div",vm:s=>s.createVm(e,{style:ko.computed(e,t.contentState,(e=>m[e]||1)),text:{htmlTemplate:'<span data-bind="text: text" style="overflow: hidden; text-overflow: ellipsis;"></span>&nbsp;<a class="msportalfx-ext-arrow ext-fxc-stretched-link" data-bind="image: arrowRight, visible: showArrow, attr: { \'aria-label\': text }" href="#"></a>',viewModel:{showArrow:t.statusBar.activatable,text:t.contentStateDisplayText,arrowRight:MsPortalFx.Base.Images.ArrowRight()}},ariaLabel:t.contentStateDisplayText})})})})),s("div",{className:"fxs-blade-content-wrapper",role:"presentation","data-contenttitle":u},s("div",{className:"fxs-blade-summary-container fxs-portal-border fxs-display-none"}),s("div",{className:"fxs-blade-content"},(0,i.composeComputation)([v,t.errorTmplVm],x).compose((e=>2===e?s("div",{className:"fxs-blade-stacklayout"}):0===e?s("div",{className:"msportalfx-padding msportalfx-fill"},s(i.GetContext,{fn:({diContainer:e})=>t.errorTmplVm.compose((t=>s("div",{className:"fxs-blade-errorcontent msportalfx-fill",afterMount:(s,i)=>{i.registerForDispose(new l.Widget($(s),t,e))}})))})):v.compose((e=>e?s(r.LazyNotice,{vm:e}):null)))),s("button",{className:"fxs-bladecontent-collapser fxs-portal-hover fxs-portal-svg","aria-expanded":"true",image:f,title:b,"aria-label":b}))),s("div",{className:"fxs-blade-actionBar fxs-display-none"}),s("button",{className:"fxs-blade-collapse-veil fxs-portal-hover fxs-portal-svg","aria-expanded":"false",image:f,title:h,"aria-label":h}),s(n.LoadingIndicator,{className:["fxs-bladecontent-progress",{"fxs-blade-shield-translucent fxs-tile-overlay":g,"fxs-portal-background":g.compose(a.negation),"fxs-display-none":(0,d.toComputation)(t.showLoadingIndicator).compose(a.negation)}]}))};const f=MsPortalFx.Base.Images.DoubleChevron();function p(e){return 1===e}function x(e,t){return t?0:e?1:2}const m={2:4,3:5,5:1,4:1,6:2,7:3}})),
define("_generated/MsPortalImpl/Svg/Library/People.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 24 24' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M5.5 8a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0ZM8 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm7.5 5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM17 6a3 3 0 1 0 0 6 3 3 0 0 0 0-6Zm-2.752 13.038c.703.285 1.604.462 2.753.462 2.282 0 3.586-.697 4.297-1.558.345-.418.52-.84.61-1.163a2.728 2.728 0 0 0 .093-.573v-.027A2.179 2.179 0 0 0 19.822 14H14.18c-.028 0-.055 0-.082.002.394.41.68.925.816 1.498h4.908c.372 0 .674.299.679.669a1.236 1.236 0 0 1-.04.212 1.6 1.6 0 0 1-.32.605c-.35.426-1.172 1.014-3.14 1.014-.98 0-1.676-.146-2.17-.345-.108.4-.286.883-.583 1.383ZM4.25 14A2.25 2.25 0 0 0 2 16.25v.278a2.073 2.073 0 0 0 .014.208 4.487 4.487 0 0 0 .778 2.07C3.61 19.974 5.172 21 8 21c2.828 0 4.39-1.025 5.208-2.195a4.484 4.484 0 0 0 .778-2.07 2.992 2.992 0 0 0 .014-.207v-.278A2.25 2.25 0 0 0 11.75 14h-7.5Zm-.75 2.507v-.257a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 .75.75v.257l-.007.08a2.986 2.986 0 0 1-.514 1.358C11.486 18.65 10.422 19.5 8 19.5s-3.486-.85-3.98-1.555a2.986 2.986 0 0 1-.513-1.358 1.527 1.527 0 0 1-.007-.08Z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/PeopleFilled.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 24 24' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8Zm9 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM4.25 14A2.25 2.25 0 0 0 2 16.25v.25S2 21 8 21s6-4.5 6-4.5v-.25A2.25 2.25 0 0 0 11.75 14h-7.5ZM17 19.5c-1.171 0-2.068-.181-2.755-.458a5.503 5.503 0 0 0 .736-2.207A3.987 3.987 0 0 0 15 16.55v-.3a3.24 3.24 0 0 0-.902-2.248A2.32 2.32 0 0 1 14.2 14h5.6a2.2 2.2 0 0 1 2.2 2.2s0 3.3-5 3.3Z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.CopilotMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.DropMenu.Component","Weave","MsPortalImpl/Widgets/Widgets.DropMenu","FxInternal/RpcEndPoints","Fx/Experimentation","_generated/MsPortalImpl/Svg/Library/People.svg","_generated/MsPortalImpl/Svg/Library/PeopleFilled.svg"],(function(e,t,s,i,a,o,n,l,d,r,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopilotMenu=void 0;var f=MsPortalFx.Base.Images,p=MsPortalFx.Base.Diagnostics.Telemetry;const x=window,m="AzureCopilot",u="CopilotMenuLinkClick",b="72f988bf-86f1-41af-91ab-2d7cd011db47",h="privacyStatement",g=MsPortalFx.getEnvironmentValue("copilotMenuLinks");function v(e){const{isExternalUri:t=!0}=e;return s("button",{type:"button",role:"menuitem",className:"fxs-blade-dropmenubutton fxs-copilot-menu-ext-link fxs-portal-hover",onClick:e.onClick,"aria-label":e.ariaLabel},s("span",{className:"fxs-blade-dropmenubuttonsvg fxs-copilot-menu-svg fxs-copilot-menu-icon",image:e.icon}),s("span",{className:"fxs-blade-dropmenubuttonsvg fxs-copilot-menu-filled-svg fxs-copilot-menu-icon",image:e.filledIcon}),s("span",{className:"fxs-blade-dropmenubuttontxt msportalfx-text-ellipsis"},e.label),s(o.If,{condition:(0,o.makeConstantComputation)(t),trueFn:()=>s("span",{className:"fxs-blade-dropmenubuttonsvg",image:f.Hyperlink()})}))}function y(e,t,s="_blank"){p.trace({source:m,action:u,name:t}),x.open(e,s)}t.CopilotMenu=function(e){const{vm:t}=e;return s("div",null,s(o.If,{condition:t.showCopilotContextMenu,trueFn:()=>{const e=i.Blade.Copilot,x={palette:99},C=new n.ViewModel(void 0,void 0,".fxs-blade-copilotdropdownmenu");return C.setItemFocusWhenOpen=!0,C.buttonLabel(e.actionsAria),C.buttonTooltip(e.actionsAria),C.alignMenu=1,C.containInViewport=!0,s("div",{className:"fxs-blade-copilotdropdownmenu msportalfx-hideonactivated",afterMount:(e,t)=>{const s=new n.Widget($(e),C,!0);t.registerForDispose(s),C.isMenuOpen.subscribe(t,(e=>{e||s.setFocus()}))}},s(a.DropMenuInner,{vm:C,button:s("div",{className:"fxs-blade-button fxs-blade-more fxs-portal-hover",image:f.Ellipsis(x)}),content:s("div",{className:"fxs-blade-dropmenucontent",role:"presentation"},s("button",{type:"button",role:"menuitem",onClick:()=>{C.close(),l.copilotResetConversationEndpoint.invoke(FxImpl.Rpc.client,"Microsoft_Azure_Copilot",null).then((()=>{p.trace({source:m,action:u,name:"NewChatCreated"})})).catch((e=>{p.trace({source:m,action:u,name:"NewChatCreationFailed",data:{error:e.message}})}))},className:"fxs-blade-dropmenubutton fxs-copilot-menu-newchat fxs-portal-hover","aria-label":e.MenuOption.newChatArialLabel},s("span",{className:"fxs-blade-dropmenubuttonsvg fxs-copilot-menu-newchat-svg fxs-copilot-menu-icon",image:f.NewChat(x)}),s("span",{className:"fxs-blade-dropmenubuttonsvg fxs-copilot-menu-newchatalternate-svg fxs-copilot-menu-icon",image:f.NewChatAlternate(x)}),s("span",{className:"fxs-blade-dropmenubuttontxt msportalfx-text-ellipsis"},e.MenuOption.newChat)),s(o.If,{condition:(0,o.makeConstantComputation)(t.diContainer.get(d.Experimentation).shellAssignments.getBooleanValue("copilotmanageabilityuimenu")),trueFn:()=>s(v,{ariaLabel:e.MenuOption.accessManagement,icon:f.CustomImageWithOptions(r,x),filledIcon:f.CustomImageWithOptions(c,x),label:e.MenuOption.accessManagement,isExternalUri:!1,onClick:()=>{C.close(),y("#view/HubsExtension/AssetMenuBlade/~/accessManagement/assetName/CopilotSettingsAsset/extensionName/Microsoft_Azure_Copilot","AccessManagement","_self")}})}),g?.map((t=>s(v,{ariaLabel:e.MenuOption[t.ariaLabelResxKey],icon:f[t.icon](x),filledIcon:f[t.iconFilled](x),label:e.MenuOption[t.titleResxKey],onClick:()=>function(e,t){e.close();const s="true"===String(t.newWindow)?"_blank":"_self";t.titleResxKey===h?MsPortalFx.Base.Security.getUserInfo().then((e=>{y((e?.directoryId||"").toLowerCase()===b?t.alternativeUri:t.uri,t.titleResxKey,s)})).catch((e=>{p.trace({source:m,action:u,name:`getUserInfo fetch failed for ${h}`,data:{error:e.message}}),y(t.uri,t.titleResxKey,s)})):y(t.uri,t.titleResxKey,s)}(C,t)}))))}))}}))}})),
define("MsPortalImpl/Widgets/Widgets.Blade.Component",["require","exports","Weave/DirectMode","Weave","FxInternal/Weave/Util","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Weave/Components/LoadingIndicator","MsPortalImpl/Widgets/Widgets.BladeContent.Component","MsPortalImpl/Widgets/Widgets.DropMenu.Component","MsPortalImpl/Widgets/Widgets.DropMenu","FxInternal/Weave","MsPortalImpl/Widgets/Widgets.CopilotMenu.Component"],(function(e,t,s,i,a,o,n,l,d,r,c,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BladeInner=void 0;var p=MsPortalFx.Base.Images;function x(e){if(e){return e.split(",").map((e=>"url('"+e.trim()+"')")).join(",")}}function m(e){return e&&e.directoryIcon}function u(e){return e&&e.directoryName}t.BladeInner=function(e){const{vm:t}=e,b={palette:99},h=o.Blade,g=(0,c.toComputation)(t.loaded),v=g.compose(a.negation),y=t.directoryInfo,C=t.title,w=t.titleMain,I=t.titleExtras,k=C.compose((e=>h.collapseAria.format(e))),_=C.compose((e=>h.pinAria.format(e))),B=h.shareItAria,M=C.compose((e=>h.editAria.format(e))),W=C.compose((e=>h.closeAria.format(e))),F=C.compose((e=>h.minimizeAria.format(e))),S=C.compose((e=>h.maximizeAria.format(e))),P=C.compose((e=>h.restoreAria.format(e))),z=C.compose((e=>h.expandAria.format(e))),N=t.pinEnabled.compose(a.negation),E=t.shareItEnabled.compose(a.negation),T=t.editEnabled.compose(a.negation),L=t.editState,D=p.DoubleChevron(b),R=(0,i.composeComputation)([t.showTranslucentSpinner,t.pinVisible],((e,t)=>e||!t)),A=(0,i.composeComputation)([t.showTranslucentSpinner,t.shareItVisible],((e,t)=>e||!t)),V=new r.ViewModel(void 0,void 0,".fxs-blade-dropmenubutton");return V.setItemFocusWhenOpen=!0,V.buttonLabel(h.moreContentActionAria),V.buttonTooltip(h.moreContentActionAria),V.alignMenu=0,V.containInViewport=!0,s(i.Fragment,null,s("header",{className:["fxs-blade-header fxs-header fxs-portal-svg fxs-portal-background",{"fxs-blade-loading-status":v,"fxs-blade-loaded":g}]},s("div",{className:["fxs-blade-progress-translucent fxs-loading5dots-container",{"fxs-display-none":t.showTranslucentSpinner.compose(a.negation)}]},s("div",null),s("div",null),s("div",null),s("div",null),s("div",null)),s("div",{className:"fxs-blade-title-content"},s(i.If,{condition:t.showTitleImage,concealmentBehavior:"remove",trueFn:()=>s("div",{role:"img",className:"fxs-blade-title-image","aria-label":C,style:{"background-image":t.titleImageUri.compose(x)}})}),s(i.If,{condition:t.showBladeIcon,concealmentBehavior:"remove",trueFn:()=>s("span",{className:"fxs-blade-header-icon",image:t.icon})}),s("div",{className:"fxs-blade-title"},s("div",{className:"fxs-blade-title-toprow"},s("h2",{className:"fxs-blade-title-titleText msportalfx-tooltip-overflow"},w,s("span",{className:"msportalfx-font-regular"},I)),s("div",{className:"fxs-blade-actions msportalfx-unselectable az-noprint"},s("button",{type:"button",className:["fxs-blade-button fxs-blade-collapser fxs-portal-hover",{"fxs-display-none":t.collapseVisible.compose(a.negation)}],"aria-expanded":"true",image:D,title:k,"aria-label":k}),s("button",{type:"button",className:["fxs-blade-button fxs-blade-shareit fxs-portal-hover msportalfx-hideonactivated",{"fxs-display-none":A}],title:h.shareIt,"aria-label":B,image:MsPortalFx.Base.Images.ShareIt(b),disabled:E,"aria-disabled":E}),s("button",{type:"button",className:["fxs-blade-button fxs-blade-pin fxs-portal-hover msportalfx-hideonactivated",{"fxs-display-none":R}],title:h.pin,"aria-label":_,image:p.Pin(b),disabled:N,"aria-disabled":N}),s(i.If,{condition:t.showFavoriteResourceButton,trueFn:()=>s("button",{type:"button",className:["fxs-blade-button fxs-blade-favorite fxs-portal-hover msportalfx-hideonactivated"],title:t.favoriteResourceButton.title,"aria-label":t.favoriteResourceButton.title,image:t.favoriteResourceButton.icon,onClick:()=>t.favoriteResourceButton.onClick()})}),s(i.If,{condition:t.showEditAssetButton,trueFn:()=>s("button",{type:"button",className:["fxs-blade-button fxs-blade-editasset fxs-portal-hover msportalfx-hideonactivated"],title:t.editAssetButton.title,"aria-label":t.editAssetButton.title,image:t.editAssetButton.icon,onClick:()=>t.editAssetButton.onClick()})}),s("button",{type:"button",className:["fxs-blade-button fxs-blade-edit fxs-portal-hover msportalfx-hideonactivated",{"fxs-display-none":t.editVisible.compose(a.negation)}],title:o.Blade.edit,"aria-label":M,image:L.compose((e=>e?p.Save({palette:99}):p.Edit({palette:99}))),disabled:T,"aria-disabled":T}),s("div",{className:"fxs-blade-actiondropmenu msportalfx-hideonactivated",afterMount:(e,t)=>{const s=new r.Widget($(e),V,!0);t.registerForDispose(s),V.isMenuOpen.subscribe(t,(e=>{e||s.setFocus()}))}},s(d.DropMenuInner,{vm:V,button:s("div",{className:"fxs-blade-button fxs-blade-more fxs-portal-hover",image:p.Ellipsis(b)}),content:s("div",{className:"fxs-blade-dropmenucontent",role:"presentation"},s("button",{type:"button",role:"menuitem",className:"fxs-blade-dropmenubutton fxs-blade-copyname fxs-portal-hover"},s("span",{className:"fxs-blade-dropmenubuttonsvg",image:p.Copy(b)}),s("span",{className:"fxs-blade-dropmenubuttontxt msportalfx-text-ellipsis"},h.copy)),s("button",{type:"button",role:"menuitem",className:["fxs-blade-dropmenubutton fxs-blade-print fxs-portal-hover",{"fxs-display-none":t.printEnabled.compose(a.negation)}]},s("span",{className:"fxs-blade-dropmenubuttonsvg",image:p.Print(b)}),s("span",{className:"fxs-blade-dropmenubuttontxt msportalfx-text-ellipsis"},h.print)),s("button",{type:"button",role:"menuitem",className:"fxs-blade-dropmenubutton fxs-blade-fullscreen fxs-portal-hover","aria-label":h.fullScreenAria},s("span",{className:"fxs-blade-dropmenubuttonsvg",image:p.Fullscreen(b)}),s("span",{className:"fxs-blade-dropmenubuttontxt msportalfx-text-ellipsis"},h.fullScreen)))})),s("div",{className:"fxs-blade-actions-spacefiller msportalfx-hideonactivated"}),s("div",{className:"fxs-blade-copilot-menu-container"},s(f.CopilotMenu,{vm:t})),s("button",{type:"button",className:["fxs-blade-button fxs-blade-minimize msportalfx-hideonactivated fxs-portal-hover",{"fxs-display-none":!t.showMinimize}],title:h.minimize,"aria-label":F,image:p.Minimize()}),s("button",{type:"button",className:"fxs-blade-button fxs-blade-maximized msportalfx-hideonactivated fxs-portal-hover fxs-display-none",title:h.maximize,"aria-label":S,image:p.Maximize()}),s("button",{type:"button",className:"fxs-blade-button fxs-blade-restore msportalfx-hideonactivated fxs-portal-hover fxs-display-none",title:h.restore,"aria-label":P,image:p.Restore()}),s("button",{type:"button",className:["fxs-blade-button fxs-blade-close msportalfx-hideonactivated",{"fxs-display-none":t.customHome}],title:h.close,"aria-label":W,image:p.Close()}))),s("div",{className:"fxs-blade-title-subtitle"},s("div",{className:["fxs-blade-title-subtitleText msportalfx-tooltip-overflow fxs-portal-subtext",{"fxs-display-none":t.subtitle.compose(a.negation)}]},t.subtitle),s(i.If,{condition:y,concealmentBehavior:"remove",trueFn:()=>s("div",{className:"fxs-blade-title-subtitleDirectory fxs-blade-title-subtitleText fxs-portal-subtext"},s("span",{className:"fxs-blade-title-subtitleDirectoryIcon fxs-blade-header-icon fxs-portal-border",image:y.compose(m),title:h.DelegatedDirectory.info}),s("div",{className:"fxs-blade-title-subtitleDirectoryText"},y.compose(u)))})))),s("button",{className:["fxs-blade-expander fxs-portal-hover",{"fxs-display-none":t.collapsed.compose(a.negation)}],"aria-expanded":"false",title:z,"aria-label":z,image:D})),s("div",{className:["fxs-blade-content-container",{"fxs-blade-disabled":(0,c.toComputation)(t.disabled)}]},s("div",{className:"fxs-blade-content-container-default"},s(l.BladeContentInner,{vm:t.defaultContent})),s("div",{className:"fxs-blade-content-container-default-details"},s("div",{className:"fxs-blade-content-container-header fxs-blade-content-container-header-primary fxs-display-none"}),s("div",{className:"fxs-blade-content-container-details fxs-blade-content-container-details-primary"})),s("button",{className:"fxs-blade-collapse-veil fxs-portal-hover fxs-portal-svg",tabindex:"-1","aria-hidden":"true",title:z})),s(n.LoadingIndicator,{className:["fxs-blade-progress fxs-portal-background",{"fxs-display-none":g}]}))}})),
define("MsPortalImpl/Widgets/Widgets.Lens.Component",["require","exports","Weave/DirectMode","Weave","FxInternal/Weave"],(function(e,t,s,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LensInner=void 0,t.LensInner=function(e){const{vm:t}=e,o=(0,a.toComputation)(t.title),n=(0,a.toComputation)(t.title);return s(i.Fragment,null,s("div",{className:"fxs-lens-title-container"},s("div",{className:"fxs-lens-title",visible:n},o)),s("div",{className:"fxs-lens-layout"}))}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Lens.css",["module"],(function(e){"use strict";return{css:".fxs-lens{position:relative;padding-bottom:10px}.fxs-lens-title-container{display:flex;align-items:center;height:30px}.fxs-lens-title{flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;line-height:30px;height:30px}.fxs-lens-fit{padding-bottom:0;height:100%}.fxs-lens-fit>.fxs-lens-title{display:none}.fxs-lens-fit>.fxs-lens-layout{height:100%}.fxs-bladestyle-create .fxs-lens.fxs-lens-fit{width:calc(100% + 2*20px);margin-left:-20px}.fxs-blade-locked .fxs-stacklayout-child:last-child.fxs-lens{padding-bottom:0}.fxs-bladecontent-unlocked .fxs-lens.fxs-lens-fit{padding-top:15px}.fxs-blade-locked .fxs-blade-stacklayout.fxs-stacklayout-vertical .fxs-lens>.fxs-lens-title-container{height:auto}.fxs-blade-stacklayout.fxs-stacklayout-horizontal .fxs-lens>.fxs-lens-layout{height:calc(100% - 30px)}.fxs-blade-content-container .fxs-bladestyle-hub .fxs-blade-summary-container,.fxs-blade-content-container .fxs-bladestyle-hubsubmenu .fxs-blade-summary-container{border:0}.fxs-blade-summary-container{position:relative;overflow:hidden;border-bottom-width:1px;border-bottom-style:solid}.fxs-blade-summary-container .fxs-lens{padding-bottom:0}.fxs-blade-summary-container .fxs-lens .fxs-lens-title-container{display:none}.fxs-blade-summary-container .fxs-lens .fxs-tile{min-height:35px;width:100%!important;height:auto}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-tile-progress{top:35px;height:calc(100% - 35px);overflow:hidden}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part{padding:0;box-shadow:none!important}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part.fxs-part-part-title-visible .fxs-part-content{top:0}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part .fxs-part-title{display:none}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part .fxs-part-blockui-shield{top:35px}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-tile-actionbar-actionlist{visibility:hidden}.fxs-lens-layout-flow .fxs-lens-layout{display:flex;flex-flow:row wrap;align-items:flex-start;margin:0 -5px -5px 0}.fxs-lens-layout-flow .fxs-tile{flex:0 0 auto;margin:0 5px 5px 0}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.Lens",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.Lens.Component","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.UIElementBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Lens.css"],(function(e,t,s,i,a,o,n,l,d,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,d.injectCss)(r);var c=a.Widget,f=l.Widget;const p=i.Widget.getWidget;class x extends l.ViewModel{constructor(e,t){super(e),this.diContainer=t,this.title=ko.observable()}getViewSettings(){return{}}applyViewSettings(e){}}t.ViewModel=x;t.Widget=class extends f{constructor(e,t){super(e,t),e.addClass("fxs-lens"),(0,n.applyToElement)({element:e[0],ltm:this.ltm,weaveNode:(0,o.LensInner)({vm:t}),weaveContext:{diContainer:t.diContainer},opName:"blade"}),ko.computed(this.ltm,[t.locked,t.title],((t,s)=>{const i=e.find(".fxs-lens-layout"),a=e.find(".fxs-lens-title");if(t||MsPortalFx.isNullOrWhiteSpace(s))i.removeAttr("aria-describedby"),a.removeAttr("id");else{const e=MsPortalFx.getUniqueId();i.attr("aria-describedby",e),a.attr("id",e)}}))}dispose(){this._cleanElement("fxs-lens","fxs-lens-fit","fxs-lens-layout-flow"),super.dispose()}addChild(e){if(!e)throw new Error("Can't add null child.");const t=e.element||e,i=p(t,c),a=i.options,o=s.isVariableSize(a.size()),n=9===a.size();o||this.element.addClass("fxs-lens-layout-flow");const l=this.element;l.find(".fxs-lens-layout").append(i.element),l.toggleClass("fxs-lens-fit",n)}removeChild(e,t){let s=!1;const i=function(e,t){const s=t.find(".fxs-lens-layout").children().toArray().map((e=>p($(e),c)));return MsPortalFx.find(s,(t=>t&&t.options&&t.options.id===e))}(e,this.element);if(i){const e=i.element;t?e.detach():e.remove(),s=!0}return s}setSize(e,t){this.element.find(".fxs-lens-layout").children().each(((e,t)=>{const s=p($(t),c);s&&s.element.trigger("fxsizechanged")}))}saveViewSettings(){return this.options.getViewSettings()}getTelemetrySource(){return"Lens"}}})),
define("MsPortalImpl/Widgets/Widgets.StackLayout",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.UIElementBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css"],(function(e,t,s,i,a,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StackLayoutPositioningEngine=t.Widget=t.ViewModel=void 0,(0,o.injectCss)(n);const l="fxs-stacklayout-horizontal",d="fxs-stacklayout-vertical",r="fxs-stacklayout-child";class c extends a.ViewModel{constructor(e,t,s){super(e),this._positions=[],this.orientation=ko.observable(i.Orientation.Vertical),this.childElements=ko.observableArray(),this.applyViewSettings(t),this.insertBeforeChildSelector=s}getViewSettings(){return{positions:this.positions}}applyViewSettings(e){e&&e.positions&&(this.positions=e.positions)}get positions(){return this._positions}set positions(e){this._positions=e||[]}}t.ViewModel=c;class f extends a.Widget{constructor(e,t){super(e,t),this._engine=new p,this._engine.positions=t.positions,e.addClass("fxs-stacklayout"),ko.computed(this.ltm,(()=>{const e=this.options.orientation();this.element.toggleClass(d,void 0===e||e===i.Orientation.Vertical).toggleClass(l,e===i.Orientation.Horizontal)})),this._bindDescendants()}dispose(){this.options.childElements().slice().forEach((function(e){ko.cleanNode(e[0]),e.remove()})),this._cleanElement(d,l,"fxs-stacklayout"),super.dispose()}addChild(e){this._addInsertChild(e)}insertChild(e,t){this._addInsertChild(e,t)}removeChild(e){const t=MsPortalFx.find(this.options.childElements(),(function(t){return a.Widget.getId(t)===e}));return!!t&&(s.hide(t).removeClass(r),setTimeout((()=>{t.remove()}),100),this.options.childElements().splice(this.options.childElements().indexOf(t),1),this._engine.remove(e),this._applyPositioning(),!0)}saveViewSettings(){return this.options.positions=this._engine.positions,this.options.getViewSettings()}discardStateOfUnusedChildren(){const e={stateDiscarded:!1};if(this._engine){const t=this._engine.discardUnusedPositions();t&&t.length&&(e.stateDiscarded=!0,e.message="Removed Positions: "+JSON.stringify(t))}return e}_addInsertChild(e,t){const s=this.options,i=this.element,o=s.childElements();if(!e)throw new Error("Cannot add a null child.");const n=e.element?e.element:e;n.addClass(r),o.push(n),this._engine.insert(a.Widget.getId(n),t);const l=i.children(`.${r}`).toArray().filter((e=>{const t=e&&e.style;return"none"!==(t&&t.display)})),d=s.insertBeforeChildSelector&&i.children(s.insertBeforeChildSelector);t>=0||(t=l.length),l.length>t?$(l[t]).before(n):d?.length?$(d[0]).before(n):l.length?$(l[l.length-1]).after(n):i.append(n),this._applyPositioning()}_applyPositioning(){const e=this.options.childElements,t=[];this._engine.positions.forEach(((s,i,o)=>{const n=MsPortalFx.find(e(),(function(e){return a.Widget.getId(e)===s.id}));n&&(e().splice(e().indexOf(n),1),t.push(n))})),Array.prototype.unshift.apply(e(),t),e.valueHasMutated()}}t.Widget=f;class p{constructor(){this._items=[],this._filledPositions={}}append(e){const t=this._getExistingItem(e);return this._filledPositions[e]=!0,t||this._insert(e),this._items}insert(e,t){const s=this._getExistingItem(e);return this._filledPositions[e]=!0,s&&this._items.splice(this._items.indexOf(s),1),this._insert(e,t),this._items}move(e,t){const s=this._getExistingItem(e),i=this._items.indexOf(s);return i>=0&&(this._items.splice(i,1),this._items.splice(t,0,s)),this._items}remove(e){const t=this._getExistingItem(e),s=this._items.indexOf(t);return s>=0&&(this._items.splice(s,1),this._filledPositions[e]=!1),this._items}get positions(){return this._items}set positions(e){this._items.length=0,this._items=e}discardUnusedPositions(){const e=[];return this._items.slice(0).forEach((t=>{this._filledPositions[t.id]||(e.push(t),this.remove(t.id))})),e}_insert(e,t){const s={id:e};t>=0&&t<this._items.length?this._items.splice(t,0,s):this._items.push(s)}_getExistingItem(e){return MsPortalFx.find(this._items,(function(t){return t.id===e}))}}t.StackLayoutPositioningEngine=p})),
define("MsPortalImpl/Widgets/Widgets.BladeContent",["require","exports","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.FocusHandler","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBar","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.Lens","MsPortalImpl/Widgets/Widgets.StackLayout","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/BladeWidthHelper","MsPortalImpl/Base/Base.BrowserDetection","Viva.Controls/Util/Viva.Resize","Weave","Fx"],(function(e,t,s,i,a,o,n,l,d,r,c,f,p,x,m,u,b,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=t.BladeStatusBarViewModel=t.combineAllCssClasses=t.defaultSvg=void 0;var v=MsPortalFx.Base,y=v.Diagnostics,C=MsPortalFx.Blades,w=C.Internal.BladeStyle,I=C.Internal.BladeWidth,k=C.Internal.DisplayState,_=v.Images,B=c.Orientation,M=l.Widget,W=f.Widget,F=x.Widget;const S=i.Blade.StatusBar,P=y.createLog(e),z=MsPortalFx.isNullOrUndefined,N=F.viewSettingsChanged,E="fxs-mode-locked",T="fxs-blade-unauthorized",L="fxs-blade-locked",D="fxs-blade-content",R="fxs-blade-summary-container",A=".fxs-blade-status-text-container .ext-fxc-stretched-link",V="fxs-blade-dialoghost",U="fxs-blade-dialogmodal",O="fxs-bladestyle-default",H="fxs-bladecontent",j="fxs-bladecontent-unlocked",q="fxs-blade-collapsed",Z="fxs-bladecontent-collapser",K="fxs-blade-collapse-veil",J={};J[2]=S.warning,J[3]=S.error,J[4]=S.dirty,J[5]=S.info,J[6]=S.upsell,J[7]=S.complete,t.defaultSvg=_.Polychromatic.DefaultBlade();const Q={rateLimit:{timeout:100,method:"notifyWhenChangesStop"}};t.combineAllCssClasses=function(e){return e.map((function(e){return e.css})).join(" ")};class G{constructor(){this.activatable=ko.observable(!1),this.activated=ko.observable(!1)}}t.BladeStatusBarViewModel=G;class X extends x.ViewModel{getTelemetryName(){return["Extension",this.bladeName.extensionName,"Blade",this.bladeName.name].join("/")}constructor(e,s,i){super(e),this.statusBar=new G,this.bladeStyle=(0,h.makeWritableComputation)(),this.title=ko.observable(),this.subtitle=ko.observable(),this.titleSuffix=ko.observable(),this.subtitleSuffix=ko.observable(),this.description=ko.observable(""),this.helpUri=ko.observable(""),this.contextMenu=new r.ViewModel,this.commandBar=new d.ViewModel,this.renderCmdBarWhenNoCmd=ko.observable(!1),this.icon=ko.observable(t.defaultSvg),this.contentState=ko.observable(0),this.contentStateDisplayText=ko.observable(),this.noticeTmplVm=(0,h.makeWritableComputation)(),this.errorTmplVm=(0,h.makeWritableComputation)(),this.statusIcon=ko.observable(),this.forcedMaximize=ko.observable(!1),this.bladeWidth=ko.observable(1),this.hasIcon=ko.observable(),this.isV2Blade=ko.observable(!1),this.reflowReady=ko.observable(!1),this.showLoadingIndicator=ko.observable(!1),s=s||{},this.loaded=s.loaded||ko.observable(!1),this.shieldType=s.shieldType||ko.observable(),this.displayState=s.displayState||ko.observable(1),this.isUiBlocked=s.isUiBlocked||ko.observable(!1),this.diContainer=s.diContainer,s.disabled&&(this.disabled=s.disabled);const a=new p.ViewModel("fxs-blade-stacklayout-instanceid");a.orientation(B.Vertical),this.stackLayoutOptions=a,this.bladeName=i||{name:e,extensionName:null}}getViewSettings(){this._viewSettings||(this._viewSettings=$.extend(this._viewSettings,{}));const e=this._viewSettings;return e.DisplayState=this.displayState(),e.BladeWidth=this.bladeWidth(),e.BladeStyle=this.bladeStyle.value,e}applyViewSettings(e){if(!e)return;const t=this._viewSettings=MsPortalFx.extend2(this._viewSettings,ko.toJS(e)),s=t.BladeWidth;I[s]&&this.bladeWidth(s);const i=t.BladeStyle;w[i]&&this.bladeStyle(i);const a=t.DisplayState;k[a]&&this.displayState(a)}}t.ViewModel=X;t.Widget=class extends F{constructor(e,t){super(e,t),this._initialRenderingComplete=ko.observable(!1),this.titleResolved=ko.observable(),this.timer=MsPortalFx.startTimer(),e.addClass(H);const i=this.ltm;let o;this._$bladeContent=this.element.find(`.${D}`),t.contextMenu.registerForCleanup(i),t.contentState.subscribe(i,(t=>{const s=!z(t)&&0!==t&&1!==t;e.toggleClass("fxs-blade-status-visible",s)})),ko.computed(i,[t.contentState,ko.computed(i,[t.contentStateDisplayText],(e=>e||"")),t.statusBar.activatable],((e,s,o)=>{if(1!==e&&s){this._statusBarMessageLifetime&&this._statusBarMessageLifetime.dispose(),this._statusBarMessageLifetime=i.createChildLifetime();const n=new a.PortalReader(this._statusBarMessageLifetime,{idPrefix:"statusbar"});ko.computed(this._statusBarMessageLifetime,[t.title],(t=>{let i=`${t}-${J[e]?J[e]:""}-${s}`;o&&(i+=`-${S.linkDesc}`),n.read(i)})).extend(Q)}})).extend(Q),ko.reactor(i,(()=>{const s=!!t.locked();t.stackLayoutOptions.locked(s),e.toggleClass(E,s).toggleClass(L,s).toggleClass(j,!s)})),(0,h.subscribeAndRun)(i,[t.noticeTmplVm],(s=>{e.toggleClass(T,!!s),s&&(t.locked(!0),t.loaded(!0),t.isUiBlocked(!1),t.bladeStyle(4),this.trigger("fxbladerepos"))})),ko.reactor(i,[t.forcedMaximize,t.bladeWidth,t.reflowReady],(()=>{this.applyBladeWidth(),e.trigger(N,this.saveViewSettings()),this.trigger("fxbladerepos")})),b.track(i,this.element.find(".fxs-blade-content").first(),(e=>{this.element.toggleClass("fxs-blade-layout-sm",e>=0).toggleClass("fxs-blade-layout-md",e>=480).toggleClass("fxs-blade-layout-lg",e>=640).toggleClass("fxs-blade-layout-xl",e>=1024).toggleClass("fxs-blade-layout-xxl",e>=1366).toggleClass("fxs-blade-layout-xxxl",e>=1920)}),{notifyInitialSize:!0}),i.registerForDispose([e.find(".fxs-blade-status-container").setEvents(["click",A,t=>{t.preventDefault(),e.trigger("fxbladestatusbarclicked")}],["keydown",A,t=>{13===t.which&&(t.preventDefault(),e.trigger("fxbladestatusbarclicked"))}]),e.setEvents(["keydown",t=>{if(e.find(A).length&&113===t.which)return e.trigger("fxbladestatusbarclicked"),!1}])]),(0,h.subscribeAndRun)(i,[t.errorTmplVm],(s=>{e.toggleClass(T,!!s),s&&(t.locked(!0),t.loaded(!0),t.isUiBlocked(!1),t.bladeStyle(4),this.trigger("fxbladerepos"))})),i.registerForDispose([s.setup(e,t.contextMenu.menuItems)]),t.contextMenu.menuItems.subscribeAndRun(i,(a=>{const n=!!o,l=a.length>0;n&&!l?o.dispose():!n&&l&&(o=i.createChildLifetime()).registerForDispose(s.setup(e,t.contextMenu.menuItems))})),this.applyBladeWidth();const n=this.element.find(`.${K}, .${Z}`);i.registerForDispose(n.setEvents(["click",e=>{const s=this.element.hasClass(q);this.element.toggleClass(q),this.trigger("fxbladerepos"),this.element.find(`.${s?Z:K}`).focus(),e.stopPropagation(),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:t.getTelemetryName(),action:"MenuCollapse",actionModifier:s?"Expand":"Collapse",name:"fxs-blade-menu-expandcollapse"})}])),ko.computed(this.ltm,[t.isUiBlocked,t.loaded],((e,t)=>{this.options.showLoadingIndicator(!t||e)}));const l=this._initialRenderingComplete=ko.observable(!1);ko.reactor(this.ltm,[this.options.showLoadingIndicator],(e=>{e||l(!0),this.options.commandBar.disabled(e)})),ko.reactor(this.ltm,[t.title,l],((e,t)=>{(e||t)&&this.titleResolved(!0)}))}dispose(){this._cleanElementClasses([m.allWidthClasses,E,H,this.bladeStyleClass,j,L,q]),super.dispose()}saveViewSettings(){return this.options.getViewSettings()}setSummary(e){const t=this.element.find(`.${R}`);n.hide(t),t.empty().append(e),n.unhide(t)}setActionBar(e){if(this._actionBar)return void P.error("The blade '{0}' already contains an action bar.".format(this.options.id));if(!this.ltm||this.ltm.isDisposed())return;const t=this.element.find(".fxs-blade-actionBar").removeClass("fxs-display-none"),s=$(FxImpl.createElement("div"));t.append(s),this.ltm.registerForDispose(this._actionBar=e(s))}getForm(){return{element:this.element.find(".fxs-blade-dialog")[0],ltm:this.ltm}}showForm(e,t){this.element.find(`.${V}`).toggleClass(U,t&&t.modal||!1)}hideForm(){this.element.find(`.${V}`).removeClass(U)}initializeLayout(){const e=this.element.find(".fxs-blade-stacklayout");if(this._layout)throw new Error("Blade widget's layout can only be initialized once.");const t=this.options.stackLayoutOptions;this._layout=new p.Widget(e,t),this.ltm.registerForDispose(this._layout),this.applyBladeWidth()}childRelayout(){this._layout&&this._layout.options.childElements().forEach((e=>{const t=M.getWidget(e,W);t&&t.setSize(-1,-1)}))}addChild(e){let t;if(!e)throw new Error("Can't add null child.");this._layout&&this._layout.addChild(e),t=e instanceof F?e:M.getWidget(e,F),t&&t.setSize(-1,-1)}removeChild(e){return!!this._layout&&this._layout.removeChild(e)}setFocus(){if(!u.isAndroidOrMobile&&this._layout){let e="fxs-lens";const t=this.element.find(`.${R}`).find(`.${e}`);let s;if(n.isVisible(t)?s=t:(e=D,s=this._$bladeContent),s.length){const t=document.activeElement;t&&$.contains(s[0],t)||this._initialRenderingComplete.fxAwaitAndRun(this.ltm).then((()=>{const t=()=>{const e=this._actionBar,t=e&&e.contentElement;if(t&&n.isVisible(t))return o.setFocusOnContainer(t[0],null);this.setFocusOnCommandBar()},i=()=>o.setFocusOnContainer(s[0],e);i().then((e=>{if(!e&&!$.contains(this.element[0],document.activeElement))return g.delay(150).then(i)})).then((e=>{e||$.contains(this.element[0],document.activeElement)||t()})).catch(t)}))}}else{const e=this._$bladeContent.closest(".fxs-blade").find(".fxs-blade-close");e.length&&e[0].focus()}}setFocusOnCommandBar(){const e=M.getWidget(this.element.find(".fxs-commandBar-target"),d.Widget);e&&e.setFocus()}initializeStyleReactor(){const e=this.element,t=this.options;(0,h.subscribeAndRun)(this.ltm,[t.bladeStyle],(t=>{let s=this.bladeStyleClass;e.removeClass(Object.keys(MsPortalFx.Blades.Internal.BladeStyle).filter((e=>!parseInt(e))).map((e=>"fxs-bladestyle-"+e.toLowerCase())).concat([O]).join(" "));const i=w[t];s=this.bladeStyleClass=i?"fxs-bladestyle-"+i.toLowerCase():O,e.addClass(s)}))}applyBladeWidth(){const e=this.options.bladeWidth.peek();let t;const s=(0,m.getBladeWidthInfo)(e);t=51!==e&&this.options.reflowReady.peek()?"fxs-blade-size-reflow":s.css,this.element.removeClass(m.allWidthClasses).addClass(t);const i=this.element.find(`.${D}`).removeClass(m.allWidthClasses).addClass(t);this.options.forcedMaximize.peek()&&i.css("width",s.width+"px")}}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css",["module"],(function(e){"use strict";return{css:'.fxs-blade{position:relative;height:100%;max-width:100%;display:flex;flex-direction:column}.fxs-blade.fxs-blade-initializing{transition:none!important}.fxs-blade-dialog{max-width:768px}.fxs-blade-dialoghost{display:block;position:relative;z-index:200;width:100%;left:0;overflow:visible;height:0}.fxs-blade-dialogmodal{display:flex;position:absolute;padding:25px;height:100%;box-sizing:border-box}.fxs-blade-dialogmodal::before{content:"";display:block;background:rgba(0,0,0,.35);position:absolute;top:0;right:0;bottom:0;left:0}.fxs-blade-dialogmodal .fxs-blade-dialog{position:relative;margin:auto}.fxs-blade-stacklayout{height:100%;-ms-overflow-style:auto;box-sizing:border-box;padding:10px 20px 20px 20px}.fxs-blade-header{position:relative;height:64px;flex-shrink:0;box-sizing:border-box}.fxs-blade-title{flex:1 1 auto;min-width:0;width:100%}.fxs-blade-title-toprow{display:flex}.fxs-blade-title-titleText,.fxs-blade-title-subtitleText{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-blade-title-subtitle,.fxs-blade-title-subtitleDirectory{display:flex;height:16px}.fxs-blade-title-subtitleText,.fxs-blade-title-subtitleDirectoryIcon{flex:0 0 auto}.fxs-blade-title-subtitleDirectoryIcon{border-left:solid 1px;height:14px;margin-left:20px;margin-right:5px;padding-left:5px;width:10px}.fxs-blade-title-subtitleDirectoryIcon>svg{height:100%;width:100%}.fxs-blade-title-titleText{font-weight:600;font-size:24px;line-height:28px;flex:0 1 auto;margin-right:16px}.fxs-blade-title-subtitleText{max-width:100%;font-size:12px;line-height:14px}.fxs-blade-header-icon{flex:0 0 auto;display:flex;align-items:center;justify-content:center;margin-right:10px;position:relative}.fxs-blade-header-icon img,.fxs-blade-header-icon svg{height:28px;width:28px}.fxs-blade-title-image{background-size:100%;width:48px;height:48px;display:block;margin-right:10px;flex:0 0 auto}.fxs-blade-title-content{display:flex;height:100%;box-sizing:border-box;padding:8px 20px}.fxs-commandBar-target{border-bottom-width:1px;border-bottom-style:solid;margin:0 20px}.fxs-commandBar-target.fxs-alwaysshowcommandbar{height:36px}.fxs-commandBar-target:empty{border:0}.fxs-blade-disabled .fxs-blade-commandBarContainer{display:none}.fxs-blade-content-container{height:100%;position:relative;display:flex;flex-direction:row;flex:1 1 auto;min-height:0}.fxs-blade-content-container>div{display:none}.fxs-blade-content-container .fxs-blade-content-container-default-details{display:flex;flex-direction:column;flex:1 1 100%;min-width:0}.fxs-blade-content-container .fxs-bladestyle-create .fxs-blade-stacklayout{padding-left:20px;padding-right:20px}.fxs-blade-content-container .fxs-bladestyle-create .fxs-blade-stacklayout .fxs-part{padding-left:0;padding-right:0}.fxs-blade-content-container-default-details>div{display:none}.fxs-blade-content-wrapper{height:100%;overflow:auto;display:flex;flex-direction:column;flex:1 1 auto;box-sizing:border-box;position:relative}.fxs-blade-status-text-container{position:relative}.fxs-blade-description-container.fxc-infoBox,.fxs-blade-status-text-container.fxc-infoBox{display:block;margin:0 20px}.fxs-blade-status-container .fxc-infoBox-text{align-items:center;display:flex}.fxs-blade-status-container .fxc-infoBox-text .msportalfx-ext-arrow{height:12px;flex:0 0 12px;margin-left:5px}.fxs-blade-status-container .fxc-infoBox-text .msportalfx-ext-arrow svg{height:12px;width:12px}.fxs-blade-status-container a.ext-fxc-stretched-link::after{position:absolute;top:0;right:0;bottom:0;left:0;z-index:1;content:""}.fxs-blade-button,.fxs-blade-dropmenubutton{cursor:pointer;padding:0;border:0;background-color:transparent;margin:0;transition:background-color .2s ease-out;height:32px;display:flex;align-items:center;justify-content:center}.fxs-blade-button svg,.fxs-blade-dropmenubutton svg{height:12px;width:12px}.fxs-blade-button{width:32px}.fxs-blade-dropmenucontent{display:flex;flex-direction:column;width:192px}.fxs-blade-actiondropmenu,.fxs-blade-copilotdropdownmenu{z-index:1}.fxs-mode-light .fxs-blade-actiondropmenu .fxs-dropmenu-button[aria-expanded="true"]{background-color:#eee}.fxs-mode-dark .fxs-blade-actiondropmenu .fxs-dropmenu-button[aria-expanded="true"]{background-color:#333}.fxs-blade-dropmenubutton{justify-content:flex-start;padding:7px 8px 7px 0;height:auto;box-sizing:border-box;text-align:left}.fxs-blade-dropmenubuttonsvg{height:18px;width:32px;flex:0 0 auto;display:flex;align-items:center;justify-content:center;align-self:flex-start}.fxs-blade-dropmenubuttontxt{flex:0 1 auto;overflow:hidden;text-overflow:ellipsis}.fxs-blade-button:not(.fxs-blade-close),.fxs-blade-title{visibility:hidden}.fxs-blade-loaded .fxs-blade-button,.fxs-blade-loaded .fxs-blade-title{visibility:visible}.fxs-blade-actions{display:flex;flex:1 0 auto;justify-content:flex-end}.fxs-blade-actions-spacefiller{flex:1 1 auto}.fxs-blade-pin[aria-disabled="true"]{cursor:default;opacity:.5}.fxs-blade-shareit[aria-disabled="true"]{cursor:default;opacity:.5}.fxs-blade-copyname svg,.fxs-blade-pin svg,.fxs-blade-shareit svg,.fxs-blade-print svg,.fxs-blade-favorite svg,.fxs-blade-editasset svg{height:14px;width:14px}.fxs-blade-close:hover{background-color:#ba141a;fill:#fff!important}.fxs-blade.fxs-blade-maximized{width:100%}.fxs-blade-content{height:100%;flex:1 1 auto;position:relative;box-sizing:border-box;min-height:0}.fxs-blade-content-container .fxs-bladecontent{display:flex;flex-direction:column;position:relative;flex:1 1 100%;min-width:0}.fxs-blade-content-container .fxs-bladecontent:first-child{flex:0 0 auto}.fxs-blade-progress,.fxs-part-frame.fxs-blade-floated-frame{top:64px;height:calc(100% - 64px)}.fxs-blade-progress{z-index:202}.fxs-part-frame.fxs-blade-floated-frame{z-index:0}.fxs-journey-nobladeheader .fxs-blade-header{display:none!important}.fxs-journey-nobladeheader .fxs-blade-progress,.fxs-journey-nobladeheader .fxs-part-frame.fxs-blade-floated-frame{top:0;height:100%}.fxs-bladecontent-progress{z-index:201}.fxs-blade-progress-translucent{height:8px;position:absolute;z-index:202;overflow:hidden;left:0;top:4px}.fxs-blade-progress-translucent>div{margin-left:6px}.fxs-blade-progress-translucent>div::after{height:4px;width:4px}.fxs-blade-hide-translucent .fxs-blade-progress-translucent{display:none}.fxs-blade-summary-container{flex:0 0 auto}.fxs-blade-content-container-header{height:44px}.fxs-blade-content-container-header .fxs-blade-content-wrapper{overflow:visible}.fxs-blade-content-container-header .fxs-bladecontent-progress{display:none}.fxs-blade-content-container-details{height:100%;min-height:0}.fxs-blade-content-container-details .fxs-part-resourcesummary-shortcuts,.fxs-blade-content-container-details .fxs-part-resourcesummary-bottom{display:none}.fxs-blade-content-container-details .fxs-part-resourcesummary .fxs-part-properties{margin-bottom:6px}.fxs-blade-appblade .fxs-blade-content{padding:0}.fxs-bladestyle-app .fxs-blade-stacklayout{padding:0;top:0;bottom:0}.fxs-bladestyle-app .fxs-part{padding:0!important;height:100%!important}.fxs-bladestyle-app .fxs-part-content{height:100%!important}.fxs-bladestyle-app .fxs-tile,.fxs-bladestyle-app .fxs-lens-layout,.fxs-bladestyle-app .fxs-lens{height:100%!important}.fxs-bladestyle-app .fxs-blade-summary-container{border-bottom-width:0}.fxs-bladestyle-basic .fxs-blade-content,.fxs-bladestyle-basicwithcommands .fxs-blade-content,.fxs-bladestyle-context .fxs-blade-content,.fxs-bladestyle-create .fxs-blade-content{padding:0}.fxs-bladestyle-basic .fxs-blade-stacklayout,.fxs-bladestyle-basicwithcommands .fxs-blade-stacklayout,.fxs-bladestyle-context .fxs-blade-stacklayout,.fxs-bladestyle-create .fxs-blade-stacklayout{padding:0}.fxs-bladestyle-context .fxs-blade-content .fxs-tile{background:none}.fxs-bladestyle-context .fxs-blade-content .fxs-part-content .fxc-hotspot{padding:0}.fxs-bladestyle-context .fxs-blade-content .fxs-part-content button.fxc-hotspot{padding:3px 10px 5px}.fxs-bladestyle-context .fxs-blade-content .fxs-part-content .msportalfx-partdivider::after{margin:0}.fxs-bladestyle-help .fxs-blade-content .fxs-tile{background:none}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h1,.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h2{font-weight:200}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h1{font-size:34px;margin:14px 0 33px}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h2{font-size:22px;margin:0 0 17px}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h3{font-size:14px;margin:10px 0 8px}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h4{text-transform:uppercase;font-weight:700;margin:0}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content button.fxc-hotspot{padding:3px 10px 5px}.fxs-bladestyle-hub .fxs-blade-content,.fxs-bladestyle-hubsubmenu .fxs-blade-content{padding:0}.fxs-bladestyle-hub .fxs-blade-stacklayout,.fxs-bladestyle-hubsubmenu .fxs-blade-stacklayout{padding:0}.fxs-bladestyle-hub .fxs-blade-actions .fxs-blade-pin,.fxs-bladestyle-hubsubmenu .fxs-blade-actions .fxs-blade-pin{display:none}.fxs-bladestyle-hub .fxs-blade-shareit,.fxs-bladestyle-hubsubmenu .fxs-blade-shareit{display:none}.fxs-bladestyle-hub .fx-text-title,.fxs-bladestyle-hubsubmenu .fx-text-title{display:none}.fxs-bladestyle-hub .fxs-blade-statusbar-wrapper,.fxs-bladestyle-hubsubmenu .fxs-blade-statusbar-wrapper{background-color:inherit}.fxs-blade-maximized .fxs-blade-stacklayout{width:100%}.fxs-blade-unauthorized .fxs-blade-summary-container,.fxs-blade-unauthorized .fxs-blade-status-container{display:none}.fxs-blade-unauthorized .fxc-notice{position:absolute;width:100%}.fxs-blade-has-activation .msportalfx-hideonactivated,.fxs-blade-has-activation .azc-collapsed-hidden{display:none!important}.fxs-blade-shield-translucent{pointer-events:none}.fxs-blade-shield-translucent .fxs-progress-dots{display:none}.fxs-blade-content-container-default{width:100%;height:100%}.fxs-bladesize-small .fxs-blade-content-container-header,.fxs-bladesize-small .fxs-blade-content-container-details{width:315px}.fxs-bladesize-small.fxs-blade-content{min-width:298px}.fxs-bladesize-medium .fxs-blade-content-container-header,.fxs-bladesize-medium .fxs-blade-content-container-details{width:585px}.fxs-bladesize-medium.fxs-blade-content{min-width:568px}.fxs-bladesize-large .fxs-blade-content-container-header,.fxs-bladesize-expandable .fxs-blade-content-container-header,.fxs-bladesize-large .fxs-blade-content-container-details,.fxs-bladesize-expandable .fxs-blade-content-container-details{width:855px}.fxs-bladesize-large.fxs-blade-content,.fxs-bladesize-expandable.fxs-blade-content{min-width:838px}.fxs-bladesize-xlarge .fxs-blade-content-container-header,.fxs-bladesize-xlarge .fxs-blade-content-container-details{width:1125px}.fxs-bladesize-xlarge.fxs-blade-content{min-width:1108px}.fxs-blade-has-activation .fxs-blade-content{min-width:auto}.fxs-menublade .fxs-blade-content-container-default{flex-shrink:0;width:265px}.fxs-menublade .fxs-blade-content-container-default .fxs-blade-content{min-width:248px}.fxs-menublade .fxs-blade-content-container-default.fxs-blade-unauthorized{width:100%}.fxs-menublade .fxs-blade-content-container-default.fxs-blade-collapsed{width:32px}.fxs-menublade .fxs-blade-content-container-default .fxs-blade-stacklayout{padding:0}.fxs-tabmenublade .fxs-blade-content-container-default .fxs-blade-content{min-width:auto}.fxs-menublade .fxs-blade-disabled .fxs-blade-content-container-default{width:100%}.fxs-blade-firstblade .fxs-blade-content-container-default.fxs-blade-collapsed{width:32px}.fxs-blade-firstblade .fxs-blade-content-container-default,.fxs-blade-firstblade .fxs-blade-header,.fxs-blade-firstblade>.fxs-progress,.fxs-blade-firstblade>fxs-progress{border-left-width:0}.fxs-bladecontent-unlocked .fxs-lens-layout-flow{margin-right:-15px}.fxs-blade-collapser svg,.fxs-bladecontent-collapser svg{transform:rotate(270deg)}.fxs-blade-actions .fxs-blade-collapser>svg{height:8px;width:8px}.fxs-blade-collapse-veil,.fxs-blade-expander{height:100%;width:100%}.fxs-blade-collapse-veil svg,.fxs-blade-expander svg{transform:rotate(90deg);height:8px;width:8px}.fxs-bladecontent-collapser svg{height:8px;width:8px}.fxs-blade-collapse-veil svg{position:absolute;top:12px;right:12px}.fxs-menu-show-search~.fxs-blade-collapse-veil svg{top:15px}.fxs-bladecontent-collapser,.fxs-blade-expander,.fxs-blade-collapse-veil{display:none;position:absolute;cursor:pointer;padding:0;width:100%;border-width:0}.fxs-menublade .fxs-blade-content-container-default .fxs-bladecontent-collapser{display:block;top:0;right:0;width:24px;height:24px;margin-top:6px}.fxs-menublade .fxs-blade-content-container-default .fxs-menu-show-search .fxs-bladecontent-collapser{width:32px;height:32px;top:2px;margin-top:0}.fxs-menublade .fxs-blade-content-container-default.fxs-blade-unauthorized .fxs-bladecontent-collapser,.fxs-menublade .fxs-blade-content-container-default.fxs-blade-collapsed .fxs-bladecontent-collapser{display:none}.fxs-blade-collapsed{width:32px}.fxs-blade-collapsed .fxs-blade-expander,.fxs-blade-collapsed .fxs-blade-collapse-veil{display:block}.fxs-blade-collapsed .fxs-blade-content-container-header,.fxs-blade-collapsed .fxs-blade-content-container-details,.fxs-blade-collapsed .fxs-blade-content-container-default,.fxs-blade-collapsed .fxs-blade-title-content{display:none}.fxs-blade-collapsed.fxs-blade-content-container-default>div{display:none}.fxs-contextpane .fxs-blade{max-width:100%}.fxs-contextpane .fxs-blade .fxs-blade-actions .fxs-blade-actiondropmenu{display:none}.fxs-contextpane .fxs-blade:not(.fxs-bladesize-contextpane-default) .fxs-blade-content-wrapper{overflow:auto}.fxs-contextpane .fxs-blade.fxs-bladesize-contextpane-default{max-width:435px}.fxs-part-frame.fxs-floated-frame{position:absolute;width:100%}.fxs-contextpane .fxs-blade.fxs-bladesize-medium,.fxs-contextpane-floated-frame.fxs-bladesize-medium{width:585px}.fxs-contextpane .fxs-blade.fxs-bladesize-small,.fxs-contextpane-floated-frame.fxs-bladesize-small{width:315px}.fxs-contextpane .fxs-blade.fxs-bladesize-large,.fxs-contextpane-floated-frame.fxs-bladesize-large{width:855px}.fxs-contextpane .fxs-blade.fxs-bladesize-xlarge,.fxs-contextpane-floated-frame.fxs-bladesize-xlarge{width:1125px}.fxs-blade.fxs-bladesize-contextpane-default .fxs-blade-content{min-width:auto}.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-content-container-details{flex:1 1 auto;display:block;position:relative}.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-progress{display:none}.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-content-container-default .fxs-bladecontent-progress,.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-content-container-default .fxs-bladecontent-collapser{display:none}.fxs-blade-copilotdropdownmenu{z-index:1;position:relative}.fxs-mode-light .fxs-blade-copilotdropdownmenu .fxs-dropmenu-button[aria-expanded="true"]{background-color:#eee}.fxs-mode-dark .fxs-blade-copilotdropdownmenu .fxs-dropmenu-button[aria-expanded="true"]{background-color:#333}.fxs-copilot-menu-newchat svg,.fxs-copilot-menu-ext-link svg{height:16px;width:16px}.fxs-copilot-menu-ext-link:hover .fxs-copilot-menu-svg,.fxs-copilot-menu-ext-link .fxs-copilot-menu-filled-svg,.fxs-copilot-menu-newchat:hover .fxs-copilot-menu-newchat-svg,.fxs-copilot-menu-newchat .fxs-copilot-menu-newchatalternate-svg{display:none}.fxs-copilot-menu-ext-link:hover .fxs-copilot-menu-filled-svg,.fxs-copilot-menu-ext-link .fxs-copilot-menu-svg,.fxs-copilot-menu-newchat:hover .fxs-copilot-menu-newchatalternate-svg,.fxs-copilot-menu-newchat .fxs-copilot-menu-newchat-svg{display:flex}.fxs-mode-light.fxs-theme-azure .fxs-copilot-menu-icon{color:#0078d4;fill:#0078d4}.fxs-mode-light.fxs-theme-blue .fxs-copilot-menu-icon{color:#424242;fill:#424242}.fxs-mode-dark.fxs-theme-dark .fxs-copilot-menu-icon{color:#fff;fill:#fff}.fxs-mode-light.fxs-theme-light .fxs-copilot-menu-icon{color:#424242;fill:#424242}',moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.Blade",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/BladeWidthHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Widgets/Widgets.BladeContent","MsPortalImpl/Interactions/Interactions.FocusHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Widgets/Widgets.UIElementBase","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Base/Base.Timers","FxInternal/Weave/Components/LoadingIndicator","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.BladeContent.Component","MsPortalImpl/Widgets/Widgets.Blade.Component","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css","MsPortalImpl/UI/Compositions/UI.Composition.BladeFavoriteResourceButton","MsPortalImpl/UI/Compositions/UI.Composition.BladeEditAssetButton","Weave"],(function(e,t,s,i,a,o,n,l,d,r,c,f,p,x,m,u,b,h,g,v,y,C,w,I,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createBladeWidget=t.Widget=t.ViewModel=t.getDefaultTitle=t.widgetProperties=t.DisplayStateHelper=void 0;var _=MsPortalFx.Base.Diagnostics.Telemetry,B=MsPortalFx.Blades.Internal.DisplayState;(0,y.injectCss)(C);const M=window,W=document,F=p.Widget.viewSettingsChanged,S=(0,a.getBladeWidthInfo)(0).width,P=(0,a.getBladeWidthInfo)(1).width,z=S,N=(0,a.getBladeWidthInfo)(51).width,E=z+N,T=i.Controls.Container.preview.toUpperCase(),L=i.Blade;t.DisplayStateHelper=[],t.DisplayStateHelper[1]={css:""},t.DisplayStateHelper[2]={css:"fxs-blade-maximized"},t.widgetProperties={title:"title",subtitle:"subtitle",titleSuffix:"menuContent.title",subtitleSuffix:"menuContent.subtitle",description:"description",helpUri:"helpUri",icon:"icon",showBladeIcon:"showBladeIcon",titleImageUri:"titleImageUri",contentState:"contentState",contentStateDisplayText:"contentStateDisplayText"},t.getDefaultTitle=function(e){return L.untitled.format(e)};class D extends p.ViewModel{getTelemetryName(){return["Extension",this.bladeName.extensionName,"Blade",this.bladeName.name].join("/")}constructor(e,t,s,i){super(e),this.diContainer=t,this.close=$.noop,this.closed=$.noop,this.pinblade=$.noop,this.shareItBlade=$.noop,this.editblade=$.noop,this.title=(0,k.makeWritableComputation)(),this.titleMain=(0,k.makeWritableComputation)(),this.titleExtras=(0,k.makeWritableComputation)(),this.crumb=ko.observable(),this.titleSuffix=ko.observable(),this.subtitle=(0,k.makeWritableComputation)(""),this.icon=(0,k.makeWritableComputation)(),this.titleImageUri=(0,k.makeWritableComputation)(),this.displayState=ko.observable(2),this.pinEnabled=(0,k.makeWritableComputation)(!1),this.shareItEnabled=(0,k.makeWritableComputation)(!1),this.editEnabled=(0,k.makeWritableComputation)(!1),this.editState=(0,k.makeWritableComputation)(!1),this.printEnabled=(0,k.makeWritableComputation)(!1),this.pinVisible=(0,k.makeWritableComputation)(!1),this.shareItVisible=(0,k.makeWritableComputation)(!1),this.editVisible=(0,k.makeWritableComputation)(!1),this.customHome=!1,this.collapseVisible=(0,k.makeWritableComputation)(!1),this.collapsed=(0,k.makeWritableComputation)(!1),this.loaded=ko.observable(!1),this.shieldType=ko.observable(),this.isUiBlocked=ko.observable(!1),this.showBladeIcon=(0,k.makeWritableComputation)(!1),this.associatedWithAsset=ko.observable(!1),this.showPreviewTag=ko.observable(!1),this.isMenuBlade=ko.observable(!1),this.isTabMenuBlade=ko.observable(!1),this.isDefaultItemSelected=ko.observable(!0),this.useActivationStyle=!1,this.showTranslucentSpinner=(0,k.makeWritableComputation)(!1),this.asSubJourney=!1,this.directoryInfo=(0,k.makeWritableComputation)(),this.deepLink=ko.observable("#"),this.showTitleImage=(0,k.makeIndirectComputation)(!1),this.hideCloseButton=(0,k.makeWritableComputation)(!1),this.showMinimize=!1,this.showMaximize=!0,this.showRestore=!0,this.showFavoriteResourceButton=(0,k.makeWritableComputation)(!1),this.showEditAssetButton=(0,k.makeWritableComputation)(!1),this.showCopilotContextMenu=(0,k.makeWritableComputation)(!1),this.bladeName=i||{name:e,extensionName:null};const a=this.defaultContent=new l.ViewModel(e,{diContainer:t,loaded:this.loaded,disabled:this.disabled,displayState:this.displayState,shieldType:this.shieldType,isUiBlocked:this.isUiBlocked},this.bladeName);if(s){const e=s.DisplayState;B[e]&&this.displayState(e)}a.applyViewSettings(s),this.favoriteResourceButton=t.get(w.BladeFavoriteResourceButton),this.editAssetButton=t.get(I.BladeEditAssetButton),"copilotfluentai.reactview"!==this.bladeName?.name.toLowerCase()||"HubsExtension"!==this.bladeName?.extensionName&&"Microsoft_Azure_Copilot"!==this.bladeName?.extensionName||this.showCopilotContextMenu(!0)}}function R(e){let t="";return e.forEach((e=>{e&&(t=t?L.titleFormat.format(t,e):e)})),t}t.ViewModel=D;class A extends p.Widget{constructor(e,t){super(e,t),this._headerContent=[],this._detailContent=[],e.addClass("fxs-blade-initializing").addClass("fxs-blade").addClass("msportalfx-shadow-level3").addClass("fxs-portal-bg-txt-br");const s=e.find(".fxs-blade-content-container-default"),i=this._defaultContent=new l.Widget(s,t.defaultContent);let a;i.initializeStyleReactor(),x.track(this.ltm,this.element.first(),(()=>this._relayoutChildren()),{ignoreInitialState:!0}),t.displayState.subscribeAndRun(this.ltm,(e=>{this.refreshDisplayState()})),t.defaultContent.locked.subscribeAndRun(this.ltm,(e=>{t.locked(e)})),this.ltm.registerForDispose(i),this._accessibility(),this._attachEventHandlers(),this._setupDefaultReactors(t),s.trigger(F,i.saveViewSettings()),this.options.displayState.subscribeAndRun(this.ltm,(()=>{this.trigger("fxbladerepos")})),this._setupLoadingReactor=()=>{const e=this.getContentWidget();a&&a.dispose(),a=this.ltm.createChildLifetime(),ko.computed(a,[this.options.loaded,e.options.showLoadingIndicator,e.options.shieldType],((e,t,s)=>{this.element.toggleClass("fxs-blade-hide-translucent",(!e||t)&&1!==s)}))},this._setupLoadingReactor()}dispose(){const e=this._defaultContent;this._cleanElementClasses(["fxs-blade","fxs-portal-bg-txt-br","fxs-menublade","fxs-blade-initializing",a.allWidthClasses,(0,l.combineAllCssClasses)(t.DisplayStateHelper),e.bladeStyleClass,"fxs-display-none","fxs-blade-collapsed","fxs-blade-firstblade","msportalfx-shadow-level3","fxs-blade-lastblade","fxs-blade-hide-translucent"]),this.trigger("fxloadingontopbar",{id:this.options.id,cancel:!0}),super.dispose()}refreshDisplayState(){this.element.trigger(F,this._defaultContent.saveViewSettings())}initializeLayout(e){const t=this.element;if(t.removeClass("fxs-blade-initializing"),e){const i=this.element.hasClass("fxs-menublade");e.callback&&e.callback(t);if(!i&&this.element.hasClass("fxs-menublade")&&x.track(this.ltm,this._defaultContent.element.first(),(()=>this._relayoutChildren()),{ignoreInitialState:!0}),e.hideDefaultContent&&(this._defaultContent.element.addClass("fxs-display-none"),this._defaultContent.options.loaded(!0)),e.setPlaceholderDetailContent){const e=t.find(".fxs-blade-content-container-details-primary").addClass("fxs-bladecontent fxs-blade-color-locked"),i=this._childLifetime.createChildLifetime();i.registerForDispose((()=>e.removeClass("fxs-bladecontent fxs-blade-color-locked"))),(0,b.applyToElement)({element:e[0],ltm:i,weaveNode:s(u.LoadingIndicator,{className:"fxs-bladecontent-progress fxs-portal-background"}),weaveContext:{diContainer:this.options.diContainer}}),this._detailContent.push({container:e,widget:null,lifetime:i,bindingLifetime:null})}}}resetInternalState(){this._$lastFocused=null,this._$lastFocusedChain=null}_openBladeContent(e,t){return(0,b.applyToElement)({element:e.container[0],ltm:e.lifetime,weaveNode:s(h.BladeContentInner,{vm:t}),weaveContext:{diContainer:t.diContainer},opName:"openBladeContent"}),e.widget=new l.Widget(e.container,t),e.widget.initializeStyleReactor(),e.lifetime.registerForDispose(e.widget),e.lifetime.registerForDispose((()=>{e.widget=null})),e.bindingLifetime=e.lifetime.createChildLifetime(),this._setupDetailReactors(e.bindingLifetime,this.options,t,this._detailContent.length>1),e.widget}_openBladeHeaderContent(e,t,i){return(0,b.applyToElement)({element:e.container[0],ltm:e.lifetime,weaveNode:s(h.BladeContentInner,{vm:t}),weaveContext:{diContainer:t.diContainer},opName:"openBladeContent"}),e.widget=new l.Widget(e.container,t),e.widget.initializeStyleReactor(),e.lifetime.registerForDispose(e.widget),e.lifetime.registerForDispose((()=>{e.widget=null})),e.bindingLifetime=e.lifetime.createChildLifetime(),i&&this._setupHeaderReactors(e.bindingLifetime,this.options,t),e.widget}focusSearchBox(){this.element.find(".fxc-search input").first().focus()}getContentWidget(){const e=MsPortalFx.last(this._detailContent);return e&&e.widget||this._defaultContent}setDetailContent(e){let t;this._detailContent.length?(t=this._detailContent[0],t.lifetime.dispose()):(t={lifetime:void 0,bindingLifetime:void 0,container:this.element.find(".fxs-blade-content-container-details-primary"),widget:void 0},this._detailContent.push(t)),t.lifetime=this._childLifetime.createChildLifetime();const s=this._openBladeContent(t,e);return this.trigger("fxbladerepos"),this._setupLoadingReactor(),s}setHeaderContent(e,t){let s;this._headerContent.length?(s=this._headerContent[0],s.lifetime.dispose()):(s={lifetime:void 0,bindingLifetime:void 0,container:this.element.find(".fxs-blade-content-container-header-primary"),widget:void 0},this._headerContent.push(s));const i=s.container.addClass("fxs-bladecontent fxs-blade-color-locked").removeClass("fxs-display-none"),a=this._childLifetime.createChildLifetime();return a.registerForDispose((()=>i.removeClass("fxs-bladecontent fxs-blade-color-locked").addClass("fxs-display-none"))),s.lifetime=a,s.widget=this._openBladeHeaderContent(s,e,t),s.widget}openBladeInPlace(e,t){const s=MsPortalFx.last(this._detailContent);s&&(s.container.addClass("fxs-display-none"),s.bindingLifetime&&s.bindingLifetime.dispose());const i=e.createChildLifetime(),a=this.element.find(".fxs-blade-content-container-default-details"),o=$(FxImpl.createElement("div",{class:"fxs-blade-content-container-details fxs-blade-border fxs-portal-border"}));a.append(o);const n={container:o,lifetime:i,bindingLifetime:null,widget:null};this._detailContent.push(n),i.registerForDispose((()=>{n.container.remove(),MsPortalFx.remove(this._detailContent,n);const e=MsPortalFx.last(this._detailContent);e&&e.widget&&(e.container.removeClass("fxs-display-none"),e.bindingLifetime=e.lifetime.createChildLifetime(),this._setupDetailReactors(e.bindingLifetime,this.options,e.widget.options))}));return this._openBladeContent(n,t)}clearDetailContent(e){this._setupDefaultReactors(this.options);const t=this._detailContent[0];t?.lifetime?.dispose(),this._detailContent=[],this.initializeLayout(e)}clearHeaderContent(){const e=this._headerContent[0];e?.lifetime?.dispose(),this._headerContent=[]}close(e){const t={id:p.Widget.getId(this.element),completed:e};this.trigger("close",t)&&this.trigger("closed",t)}minimize(){const e=p.Widget.getId(this.element);this.trigger("minimized",{id:e})}maximize(){const e=p.Widget.getId(this.element);this.trigger("maximized",{id:e})}restore(){const e=p.Widget.getId(this.element);this.trigger("restore",{id:e})}setFocus(){if(n.isAndroidOrMobile)this.element.find(".fxs-blade-close").focus();else{const e=W.activeElement;if(!e||!$.contains(this.element[0],e)){let e;this._$lastFocused&&$.contains(this.element[0],this._$lastFocused[0])&&(0,o.isVisible)(this._$lastFocused)&&(this._$lastFocused.focus(),e=!0),!e&&this._$lastFocusedChain&&(e=this._$lastFocusedChain.some((e=>!!(e.length&&$.contains(this.element[0],e[0])&&(0,o.isVisible)(e))&&(d.setFocusOnContainer(e[0],null),$.contains(this.element[0],W.activeElement))))),e||this.getContentWidget().setFocus()}}}idealWidth(e){const t=this.element.hasClass("fxs-menublade"),s=this._defaultContent,i=s.element.hasClass("fxs-blade-collapsed");if(e)return this.options.collapsed.value?32:t?i?32+S:E:z;{const e=this.getContentWidget();let o=(0,a.getBladeWidthInfo)(e.options.bladeWidth()).width;return t?s.options.noticeTmplVm.value||s.options.errorTmplVm.value||this.options.disabled()?(0,a.getBladeWidthInfo)(2).width:(o=e===s?e.element.siblings().hasClass("fxs-bladecontent")||this.element.hasClass("fxs-blade-initializing")?P:0:P,o+(i?32:N)):o}}setContextPaneWidth(e){this.element.removeClass(`${a.contextPaneDefaultSizeClass} ${a.allWidthClasses}`),MsPortalFx.isNullOrUndefined(e)?this.element.addClass(a.contextPaneDefaultSizeClass):(this.getContentWidget().options.bladeWidth(e),this.element.addClass((0,a.getBladeWidthInfo)(e).css))}isMenuBladeLoadingDetailBlade(){return(this.element.hasClass("fxs-menublade")||this.element.hasClass("fxs-tabmenublade"))&&this.getContentWidget()===this._defaultContent&&!this._defaultContent.options.noticeTmplVm.value&&!this._defaultContent.options.errorTmplVm.value&&!this.options.disabled()&&this._defaultContent.element.siblings().children().hasClass("fxs-bladecontent")}_setupDefaultReactors(e){const t=this._resetChildLifetime();if(!t)return;const s=e.defaultContent;ko.reactor(t,(()=>{const t=s.title();e.title(t),e.crumb(t),e.titleMain(t)})),ko.reactor(t,(()=>{const t=[s.subtitle()];e.showPreviewTag()&&t.push(T),e.subtitle(R(t))})),ko.reactor(t,(()=>{e.icon(s.icon()),e.showBladeIcon(s.isV2Blade()?s.hasIcon():e.associatedWithAsset())})),e.showTitleImage.reseat((0,k.composeComputation)([s.bladeStyle,e.titleImageUri],((e,t)=>2===e&&!!$.trim(t))))}_setupHeaderReactors(e,t,s){if(!e)return;const i=t.defaultContent;ko.reactor(e,(()=>{i.title(s.title())})),ko.reactor(e,(()=>{i.subtitle(s.subtitle())})),ko.reactor(e,(()=>{i.icon(s.icon())}))}_setupDetailReactors(e,t,s,i){if(!e)return;const a=t.defaultContent;ko.reactor(e,[a.title,s.title,s.titleSuffix,t.titleSuffix],(()=>{const e=R(i?[a.title(),s.title(),s.titleSuffix()]:[a.title(),t.titleSuffix(),s.titleSuffix()]);t.title(e),!i&&t.crumb(a.title()),t.titleMain(a.title()),t.titleExtras(e.replace(a.title(),""))})),ko.reactor(e,(()=>{const e=[a.subtitle(),s.subtitleSuffix()];t.showPreviewTag()&&e.push(T),t.subtitle(R(e))})),ko.reactor(e,(()=>{const e=s.hasIcon()?s:a;t.icon(e.icon()),t.showBladeIcon(e.isV2Blade()?e.hasIcon():t.associatedWithAsset())})),t.showTitleImage.reseat((0,k.composeComputation)([s.bladeStyle,t.titleImageUri],((e,t)=>2===e&&!!$.trim(t))))}_resetChildLifetime(){if(this.ltm)return MsPortalFx.disposeDisposable(this._childLifetime),this._childLifetime=this.ltm.createChildLifetime()}_accessibility(){const e=this.element.find(".fxs-blade-title-titleText"),t=MsPortalFx.getUniqueId();e.attr("aria-describedby",t),this.element.find(".fxs-blade-title-subtitleText").attr("id",t);const s=MsPortalFx.getUniqueId();e.attr("id",s),this.element.attr("aria-labelledby",s+" "+t),this.element.find(".fxs-blade-header").attr("aria-labelledby",s+" "+t)}_attachEventHandlers(){const e=this.element,t=()=>this.options.getTelemetryName();e.find(".fxs-blade-close").on("click",(e=>{_.trace({source:t(),action:"CommandExecuted",name:"fxs-blade-close"}),e.preventDefault(),this.close(!1)})),e.find(".fxs-blade-fullscreen").on("click",(()=>{_.trace({source:t(),action:"CommandExecuted",name:"fxs-blade-fullscreen"}),this.options.diContainer.get(c.FullScreenMode).toggle()})),e.find(".fxs-blade-minimize").on("click",(e=>{_.trace({source:t(),action:"CommandExecuted",name:"fxs-blade-minimize"}),e.preventDefault(),this.minimize()})),e.find(".fxs-blade-maximized").on("click",(e=>{_.trace({source:t(),action:"CommandExecuted",name:"fxs-blade-maximized"}),e.preventDefault(),this.maximize()})),e.find(".fxs-blade-pin").on("click",(()=>(_.trace({source:t(),action:"CommandExecuted",name:"fxs-blade-pin"}),this.options.pinblade(null),!1))),e.find(".fxs-blade-shareit").on("click",(()=>(_.trace({source:t(),action:"BladeOpened",name:"fxs-blade-shareit"}),this.options.shareItBlade(null),!1))),e.find(".fxs-blade-restore").on("click",(e=>{_.trace({source:t(),action:"CommandExecuted",name:"fxs-blade-restore"}),e.preventDefault(),this.restore()})),e.find(".fxs-blade-edit").on("click",(()=>(_.trace({source:t(),action:"CommandExecuted",name:"fxs-blade-edit"}),this.options.editblade(null),!1))),e.find(".fxs-blade-copyname").on("click",(()=>{_.trace({source:t(),action:"CommandExecuted",name:"fxs-blade-copyname"});const s=W.createRange();s.selectNodeContents(e.find(".fxs-blade-title-titleText")[0]);const i=M.getSelection();i.removeAllRanges(),i.addRange(s),W.execCommand("copy"),i.removeAllRanges();const a=this.ltm.createChildLifetime();new r.PortalReader(a).read(L.copyAriaResult),a.dispose()})),e.find(".fxs-blade-print").on("click",(()=>{_.trace({source:t(),action:"CommandExecuted",name:"fxs-blade-print"});const s=e.find("[data-react-id]")[0];if(s){const e=s.getAttribute("data-react-id");parent.window.frames[e].contentWindow.postMessage({signature:"Az",kind:3036,data:this.options.isMenuBlade()?{titleMain:this.options.titleMain.value,titleExtras:this.options.titleExtras.value,subtitle:this.options.subtitle.value}:null},"*")}else this.options.diContainer.get(f.PrintHandler).printBlade(e[0],{name:this.getContentWidget().options.getTelemetryName(),source:"BladeCommand",menuBladeCtx:this.options.isMenuBlade.peek()?t():null})}));const s=(0,m.throttle)(this.ltm,(e=>{let t=this._$lastFocused=$(e.target);const s=this._$lastFocusedChain=[];for(;t.length&&(t=t.parent().closest(".azc-control, .fxs-tile, .fxs-commandBar, .fxs-commandBar-item-expandList, .fxs-commandBar-item",this.element[0]),t.length);)s.push(t)}));this.ltm.registerForDispose(e.setEvents(["focusout",s],["click",".fxs-blade-collapser, .fxs-blade-expander, .fxs-blade-collapse-veil",e=>{const s=this.options.collapsed.value;this.options.collapsed(!s),this.trigger("fxbladerepos"),(0,v.tryFocusAfterChangePropagation)(this.element.find("."+(s?"fxs-blade-collapser":"fxs-blade-expander"))[0]),e.stopPropagation(),_.trace({source:t(),action:"BladeCollapse",actionModifier:s?"Expand":"Collapse",name:"fxs-blade-expandcollapse"})}],["fxupdatelastfocus",e=>{this._$lastFocused=e.$lastFocused}])),(0,k.subscribeAndRun)(this.ltm,[this.options.collapsed],(e=>{this.element.toggleClass("fxs-blade-collapsed",e)}))}goToDefaultItem(){this.options.isMenuBlade()?this.trigger("fxgotodefaultitem"):this.goToFirstDetailContent()}goToFirstDetailContent(){const e=this._detailContent[0];e&&e.widget&&this.goToDetailContent(e.widget.options.id)}goToDetailContent(e){const t=this._detailContent.length;let s=t;for(let i=0;i<t;++i){const t=this._detailContent[i];if(t.widget&&t.widget.options.id===e){s=i;break}}for(let e=t-1;e>s;--e)this._detailContent[e].lifetime.dispose();return s!==t}getBreadCrumbs(e){const t=this.options.titleExtras.value&&-1===this.options.title.value.indexOf(this.options.titleExtras.value)?ko.observable(this.options.title.value+this.options.titleExtras.value):ko.observable(this.options.title.value);return[{bladeId:this.options.id,bladeTitle:e||!this.options.titleExtras.value?this.options.crumb:t,bladeTitleResolved:this._defaultContent.titleResolved,isCustomHome:this.options.customHome,deepLink:this.options.deepLink,isDefaultItemSelected:this.options.isDefaultItemSelected}].concat(this._detailContent.filter(((e,t)=>t&&e.widget)).map((e=>({bladeId:e.widget.options.id,bladeTitle:e.widget.options.title,bladeTitleResolved:e.widget.titleResolved,isCustomHome:!1,deepLink:ko.observable("#"),isDefaultItemSelected:ko.observable(!0)}))))}setupAsKnownMenuBlade(){if(this.element.hasClass("fxs-blade-initializing")){this.element.addClass("fxs-blade-known-menu fxs-menublade");const e=this.element.find(".fxs-blade-content-container-details").empty();e.append(FxImpl.createElement("fxs-progress")),ko.applyBindingsToDescendants({},e[0])}}_relayoutChildren(){this._defaultContent.childRelayout(),this._headerContent.forEach((e=>{e.widget&&e.widget.childRelayout()})),this._detailContent.forEach((e=>{e.widget&&e.widget.childRelayout()}))}}t.Widget=A,t.createBladeWidget=function(e,t){const i=new FxImpl.TriggerableLifetimeManager;(0,b.applyToElement)({element:e[0],ltm:i,weaveNode:s(g.BladeInner,{vm:t}),weaveContext:{diContainer:t.diContainer},opName:"blade"});const a=new A(e,t);return a.ltm.registerForDispose(i),a}}));