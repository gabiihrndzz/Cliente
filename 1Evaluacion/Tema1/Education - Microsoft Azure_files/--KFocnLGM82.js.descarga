define("MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ExtensibleControl",["require","exports","MsPortalImpl.Controls/Controls/Base/Loadable"],(function(e,t,s){"use strict";var i;return function(e){var t=MsPortalFx.Base.Promises.cancelOnDispose;function i(e){const t=[],s={};return e.forEach((e=>{s[e.name]=e})),e.forEach((e=>{r(e,s,t)})),t.sort(((e,t)=>e.priority-t.priority)),t}function r(e,t,s,i=!1){e.load||!i&&!e.enabled||(e.load=!0,s.push(e),e.dependencies&&e.dependencies.length&&e.dependencies.forEach((e=>{r(t[e],t,s,!0)})))}class n extends s.Widget{constructor(e,t,s){super(e,t,s),this._pluginsDeferred=Promise.withResolvers()}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._plugins&&(this._plugins.reverse().forEach((e=>{e.dispose();e.cssClass&&this.element.removeClass(e.cssClass),this[e.name]=null})),this._plugins=null),super.dispose())}loadPlugins(e){const t=i(e.map(((e,t)=>({name:e.name,dependencies:e.dependencies,moduleId:e.moduleId,priority:t,enabled:e.isEnabled(this.options),load:!1}))));return this.waitFor(Promise.all(t.map((e=>MsPortalFx.require(e.moduleId).then((e=>new e.Plugin(this))))))).then((e=>{this._plugins=e,this._plugins.forEach((e=>{const t=e.cssClass;t&&this.element.addClass(t),this[e.name]=e})),this._pluginsDeferred.resolve(e)}),(e=>(this._pluginsDeferred.reject(e),Promise.reject(e))))}get options(){return this._options}_bindDescendants(e={}){this._plugins&&this._plugins.forEach((t=>{e[t.name]=t})),super._bindDescendants(e)}triggerPlugins(e,...t){const s=[];return this._plugins&&this._plugins.forEach((i=>{const r=i[e];r&&s.push(r.apply(i,t))})),s}waitForPlugins(){return this._pluginsDeferred.promise}}e.Widget=n;e.PluginBase=class{constructor(e){this.name=e.name,this.cssClass=e.cssClass,this.widget=e.widget;const t=this.ltm=this.widget.ltm.createChildLifetime();this.vmBasicOption={ltm:t}}waitFor(e){return t(this.ltm,e)}dispose(){this.ltm.dispose()}}}(i||(i={})),i})),
define("MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Base",["require","exports","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ExtensibleControl","Viva.Controls/Util/Viva.TemplateEngine","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ActionHandler"],(function(e,t,s,i,r){"use strict";var n;return function(e){var t=MsPortalFx.initObservable;e.Item=class{constructor(e){this.dataItem=ko.observable(e.dataItem),this.id=this.delayedProperty(void 0,(e=>e.id)),this.data=this.delayedProperty(void 0,(e=>e.data)),this.isDisabled=t(e.isDisabled,!1),this.isFocused=t(e.isFocused,!1),this.tabbable=t(e.tabbable,!1)}delayedProperty(e,t){let s=e;const i=ko.pureComputed((()=>{let e;const s=this.dataItem();if(s){const i=t(s);e=ko.isObservable(i)?i:ko.observable(i)}return e}));return ko.pureComputed({read:()=>{let e;const t=i();return e=t?t():s,e},write:e=>{const t=i();t?t(e):s=e}})}};class n extends s.Widget{constructor(e,t,s){super(e,t,s),this.waitForPlugins().then((()=>{this._actionHandler={focusFirstItem:()=>{this.triggerPlugins("focusFirstItem")},activateFirstItem:()=>{this.triggerPlugins("activateFirstItem")},pseudoFocusFirstItem:()=>{this.triggerPlugins("pseudoFocusFirstItem")},pseudoBlurFirstItem:()=>{this.triggerPlugins("pseudoBlurFirstItem")}},r.getOrCreateActionHandler(t)(this._actionHandler)})),this._eventHandlers=[],this.templateEngine=new i.HtmlTemplateEngine,this._items=ko.observableArray(),this._deferredLoad=Promise.withResolvers(),this._internalLoading=ko.observable(!1),this._loading=ko.pureComputed((()=>this._internalLoading()||this.options.loading()))}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._detachEvents(),this._eventHandlers=null,r.getOrCreateActionHandler(this.options)(null),this._deferredChange&&(this._deferredChange.reject(new MsPortalFx.Errors.DisposedCanceledError),this._deferredChange=null),super.dispose())}attachEvent(e,t,s,i){if(this._eventHandlers){const r=function(){Array.prototype.unshift.call(arguments,$(this)),i.apply(this,arguments)};e.on(t,s,r),this._eventHandlers.push({element:e,events:t,selector:s,handler:r})}}_attachEvents(){this.triggerPlugins("attachEvents")}_detachEvents(){if(this.triggerPlugins("detachEvents"),this._eventHandlers){const e=this._eventHandlers;this._eventHandlers=[],e.forEach((e=>{e.element.off(e.events,e.selector,e.handler)}))}}get options(){return this._options}createItem(e,t){throw new Error("override")}getItemByIndex(e){let t=null;const s=this._items();return e>=0&&e<s.length&&(t=s[e]),t}getEnabledVisibleItems(){const e=this._items.peek(),t=[];return e.forEach((e=>{e.isDisabled.peek()||t.push(e)})),t}getFirstEnabledVisibleItem(){return MsPortalFx.find(this._items.peek(),(e=>!e.isDisabled.peek()))}getFirstVisibleItem(){let e;const t=this._items.peek();return t.length&&(e=t[0]),e}getFocusableByPage(e,t){const s=this.getFocusedItemIndex(),i=this._getNumberOfItemsPerPage(e);let r;const n=this.getFocusableList();let o;return 33===t?(o=s-i,o=o>=0?o:0,r=n[o],this.getItemElement(e,r).scrollIntoView(!0)):34===t&&(o=s+i,o=o<n.length?o:n.length-1,r=n[o],this.getItemElement(e,r).scrollIntoView(!1)),r}getItemElement(e,t){return MsPortalFx.find(this.widget().find(e).toArray(),(function(e){return ko.dataFor(e)===t}))}getFocusableList(){return this.getEnabledVisibleItems()}getFocusedItemIndex(){return MsPortalFx.findIndex(this._items.peek(),(e=>e.isFocused.peek()))}getPagedFocusableList(e){const t=[],s=this.getFocusableList(),i=this._getNumberOfItemsPerPage(e);for(;s.length>0;)s.length<=i?t.push(s.splice(0)):t.push(s.splice(0,i));return t}getLastEnabledVisibleItem(){return MsPortalFx.last(this.getEnabledVisibleItems())}getOrCreateNextItem(e,t=!1,s=!0){let i;const r=this._items();for(let t=r.indexOf(e)-0+1;t<r.length;t++)if(!r[t].isDisabled.peek()){i=r[t];break}return i}getOrCreatePreviousItem(e,t=!0,s=!0){let i;const r=this._items();for(let t=r.indexOf(e)-0-1;t>=0;t--)if(!r[t].isDisabled.peek()){i=r[t];break}return i}resetForPendingLoad(){}resetContinuation(){this.resetForPendingLoad()}load(){return this._internalLoading(!0),Promise.resolve().then((e=>{this.triggerPlugins("onLoadComplete"),this._internalLoading(!1),this._deferredLoad.resolve(e)}),(e=>{this._internalLoading(!1),this._deferredLoad.reject(e)}))}waitForLoad(){return this._deferredLoad.promise}waitForPageLoad(){return(this._deferredPageLoad||(this._deferredPageLoad=Promise.withResolvers())).promise}waitForChange(){return this._deferredChange||(this._deferredChange=Promise.withResolvers()),this._deferredChange.promise}deferredPageLoadResolve(e){this._deferredPageLoad&&(this._deferredPageLoad.resolve(e),this._deferredPageLoad=null)}deferredPageLoadReject(e){this._deferredPageLoad&&(this._deferredPageLoad.reject(e),this._deferredPageLoad=null)}_getNumberOfItemsPerPage(e){const t=this.element.find(e);if(t.length>0){const e=t.scrollParent();if(e.length>0)return Math.floor(e.height()/t.height())}return n._defaultKeyboardPageSize}}n._defaultKeyboardPageSize=10,e.Widget=n;class o extends s.PluginBase{constructor(e){super(e)}dispose(){super.dispose()}}e.Plugin=o}(n||(n={})),n}));