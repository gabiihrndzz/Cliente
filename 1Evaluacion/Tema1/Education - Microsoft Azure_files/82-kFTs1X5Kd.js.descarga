define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters.Helpers",["require","exports"],(function(e,t){"use strict";var i;return function(e){const t=/[`><"'&\t\n\r\xa0-\xff]|([\x00-\x1f\x7f\x80-\x9f])|([\ud800-\udbff][\udc00-\udfff])/g,i={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&#34;","`":"&#96;"};function o(e,t,o){const s=e.charCodeAt(0);return i[e]||(i[e]="&#"+(t?0:o?1024*(s-55296)+e.charCodeAt(1)-56320+65536:s)+";")}function s(e){return null===e}function r(e){return void 0===e}function a(e){return null!=e?String(e).replace(t,o):""}e.isNull=s,e.isUndefined=r,e.isNullOrUndefined=function(e){return s(e)||r(e)},e.htmlEncode=a,e.attributeEncode=function(e){return a(e)},e.callFormatter=function(t,i,o){return t.apply(e,[i].concat(o))}}(i||(i={})),i})),
define("Viva.Controls/Util/Viva.DateUtil",["require","exports"],(function(e,t){"use strict";var i;return function(e){class t extends MsPortalFx.DateUtil.DateTimeRange{}e.DateTimeRange=t;const i=Date.prototype.toString,o=MsPortalFx.toSeconds;let s;function r(e,t,i){return function(e,t,i){return i=i||"0",t+1>=e.length&&(e=Array(t+1-e.length).join(i)+e),e}(e+"",t,i)}function a(e,t){return e.slice(Math.max(e.length-t,0))}function n(e,t){return a(e+"",t)}function l(e,t){return a(r(e,t,"0"),t)}function d(e){return 0===(e%=12)?12:e}function c(e){return e&&e.split("").reverse().join("")}function u(e){return e&&"\\"+e.split("").join("\\")}function h(t){return c(function(t){const i=t.length;let o,a,c,h;const g=e.getLocaleValues();switch(t[0]){case"y":switch(i){case 3:return r(s.getFullYear(),i);case 1:return parseInt(n(s.getFullYear(),2),10)+"";default:return l(s.getFullYear(),i)}case"M":switch(i){case 4:return u(g.months[s.getMonth()]);case 3:return u(g.monthsAbbr[s.getMonth()]);case 2:return l(s.getMonth()+1,2);default:return n(s.getMonth()+1,2)}case"d":switch(i){case 4:return u(g.days[s.getDay()]);case 3:return u(g.daysAbbr[s.getDay()]);case 2:return l(s.getDate(),2);default:return n(s.getDate(),2)}case"h":return 2===i?l(d(s.getHours()),2):n(d(s.getHours()),2);case"H":return 2===i?l(s.getHours(),2):n(s.getHours(),2);case"m":return 2===i?l(s.getMinutes(),2):n(s.getMinutes(),2);case"s":switch(i){case 4:return l(s.getMilliseconds(),3);case 3:return n(s.getMilliseconds(),3);case 2:return l(s.getSeconds(),2)}return n(s.getSeconds(),2);case"t":return 2===i?g.ampm[s.getHours()<12?0:1]:g.ampmAbbr[s.getHours()<12?0:1];case"z":return o=-s.getTimezoneOffset()/60,a=o<0,a&&(o=-o),c=parseInt(o+"",10),h=60*(o-c),3===i?(a?"-":"+")+r(c,2)+":"+r(h,2):(a?"-":"+")+r(c,i);case"/":return g.dateSeparator;case":":return g.timeSeparator}return""}(t))}e.getLocaleValues=MsPortalFx.getLocaleValues,e.setLocaleValues=MsPortalFx.setLocaleValues,e.toString=function(t,...o){if(o.length){let i=o[0];return i=e.getLocaleValues().standard[i]||i,i=i.replace(/'([^']*)'/g,(function(e,t){return u(t)})),s=t,c(c(i).replace(/(y{1,5}|M{1,4}|d{1,4}|h{1,2}|H{1,2}|m{1,2}|s{1,4}|t{1,2}|z{1,3}|\/|:)(?!\\)/g,h).replace(/\\(?!\\)/g,""))}return i.apply(t,arguments)},e.parse=MsPortalFx.dateParse,e.compareDatePartOnly=function(e,t){let i;return i=e&&t?e.getFullYear()===t.getFullYear()?e.getMonth()===t.getMonth()?e.getDate()===t.getDate()?0:e.getDate()<t.getDate()?-1:1:e.getMonth()<t.getMonth()?-1:1:e.getFullYear()<t.getFullYear()?-1:1:-1,i},e.compareTimePartOnly=function(e,t){let i;return i=e&&t?e.getHours()===t.getHours()?e.getMinutes()===t.getMinutes()?e.getSeconds()===t.getSeconds()?0:e.getSeconds()<t.getSeconds()?-1:1:e.getMinutes()<t.getMinutes()?-1:1:e.getHours()<t.getHours()?-1:1:-1,i},e.areDatesEqualBySeconds=function(e,t){return e instanceof Date&&t instanceof Date&&o(e)===o(t)}}(i||(i={})),i})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Formatters.css",["module"],(function(e){"use strict";return{css:".azc-grid table tbody td img.azc-grid-formatters-icon{margin-right:6px;display:flex}.azc-grid .azc-grid-formatters-sprite{position:relative;overflow:hidden;display:inline-block;margin-right:6px;vertical-align:middle}.azc-grid .azc-grid-formatters-sprite img{position:absolute}",moduleId:e.id}})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.PercentFormatter.css",["module"],(function(e){"use strict";return{css:".fxc-percent-formatter{white-space:nowrap;min-height:5px;min-width:5px}.fxc-percent-formatter .fxc-percent-formatter-container{overflow:hidden;width:100%;position:relative;padding:0}.fxc-percent-formatter .fxc-percent-formatter-value{background-color:#00bcf2;height:19px;position:absolute;left:0;display:inline}.fxc-percent-formatter .fxc-percent-formatter-background{width:100%;height:19px;background-color:transparent}.fxc-percent-formatter .fxc-percent-formatter-bottom-bar{height:5px;margin-top:24px}.fxc-percent-formatter .fxc-percent-formatter-top-bar{height:5px;margin-bottom:24px}.fxc-percent-formatter .fxc-percent-formatter-text{position:absolute;left:1px;top:1px;display:inline;margin-top:7px}.fxc-percent-formatter .fxc-percent-formatter-notext{display:none}",moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters",["require","exports","Viva.Controls/Util/Viva.DateUtil","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters.Helpers","MsPortalFx/Globalization","MsPortalImpl/Base/Base.ImplUtils","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Formatters.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.PercentFormatter.css"],(function(e,t,i,o,s,r,a,n,l){"use strict";var d;return(0,a.injectCss)(n,l),function(t){var a=MsPortalFx.Base.Diagnostics;const n=Array.prototype.slice,l=a.createLog(e),d={},c="azc-grid-formatters-icon",u=document.createRange();function h(e){return u.createContextualFragment(e)}function g(e){let t;return()=>(t||(t=e()),t)}const p=g((()=>h("<a class='msportalfx-link-primary' data-bind='attr:{tabindex:$tabIndex}'></a>"))),b=g((()=>h("<span class='azc-text-primary'></span>")));function m(e){const t=n.call(arguments,1),i=ko.unwrap(e);return`<span class='fx-grid-formatters-icon'>${!i||o.isUndefined(i.text)||o.isUndefined(i.uri)?`<img class='${c}' src='${o.attributeEncode(o.callFormatter(x,i,t))}' alt='' />`:`<img class='${c}' src='${o.attributeEncode(o.callFormatter(x,i.uri,t))}' alt='' /><span class='fx-grid-formatters-icon-text'>${o.callFormatter(_,i.text,t)}</span>`}</span>`}function f(e,t,i){if(!e)throw new Error("Display formatter has to be provided to create any formatters bundle.");const o=function(t,i){return e(t,i)};return t&&(o.sortFormatter="function"==typeof t?t:w(t)),i&&(o.filterFormatter="function"==typeof i?i:w(i)),o}function w(e){return function(t){return o.isNullOrUndefined(e[t])?e["##DEFAULT##"]?e["##DEFAULT##"]:t:e[t]}}function v(e){let t,o;switch(typeof e){case"number":t=new Date(e);break;case"string":o=i.parse(e),isNaN(o)||(t=new Date(o));break;case"object":null!==e&&e.constructor===Date&&(t=e)}return t}function x(e,t){const i=ko.unwrap(e);return o.isNullOrUndefined(i)?"":i+""}function _(e,t){const i=ko.unwrap(e);return o.isNullOrUndefined(i)?"":o.htmlEncode(i+"")}t.date=function(t,a){let d;"string"==typeof t?(l.assert(!1,"String formatters are being deprecated. Use Intl.DateTimeFormatOptions instead. Format string: {0}".format(t)),d=(e,t)=>i.toString(e,t)):d=(t,i)=>{let o="";try{o=s.DateTimeFormat.create(i).format(t)}catch(s){const n=`Intl failure. Given format: ${JSON.stringify(i)}; Date: ${t.toString()}`;isNaN(t.getTime())?r.logToExtension(e,a,2,n):l.error(n),o=t.toString()}return o};const c=function(e){const i=v(ko.unwrap(e)),s=n.call(arguments,1);return i?o.callFormatter(_,d(i,t),s):""};return f(c,v,c)},t.uri=function(e){const t=ko.unwrap(e),i=t&&"string"!=typeof t?t:{uri:t},o=ko.unwrap(i.text),s=ko.unwrap(i.uri),r=ko.unwrap(i.target);if(o||s){if(s){const e=p().cloneNode(!0).firstChild;return e.textContent=o||s,e.setAttribute("href",s),r&&e.setAttribute("target",r),e.outerHTML}{const e=b().cloneNode(!0).firstChild;return e.textContent=o,e.outerHTML}}return""},t.icon=m,t.iconLookup=function(e){return function(t){const i=n.call(arguments,1);let s=ko.unwrap(t);return o.isNullOrUndefined(e[s])?e["##DEFAULT##"]?(s=_(s),o.callFormatter(m,e["##DEFAULT##"].text?{uri:e["##DEFAULT##"].uri,text:e["##DEFAULT##"].text.replace(/##DEFAULT##/g,s)}:e["##DEFAULT##"],i)):"":o.callFormatter(m,e[s],i)}},t.percentageBar=function(e){return function(t){const i=n.call(arguments,1);let r,a=ko.unwrap(t),l="",d="",c=0;const u=i[0]&&o.attributeEncode(i[0].column.name())||"";if(e){if(e.backgroundColor&&(l="msportalfx-bgcolor-"+e.backgroundColor),e.barColorDefault&&(d="msportalfx-bgcolor-"+e.barColorDefault),e.barColorKey&&i[0].item&&i[0].item[e.barColorKey]){const t=ko.unwrap(i[0].item[e.barColorKey]);t&&(d="msportalfx-bgcolor-"+t)}e.textKey&&(r=i[0].item&&i[0].item[e.textKey]?ko.unwrap(i[0].item[e.textKey]):""),e.textLocation&&(c=e.textLocation)}let h="fxc-percent-formatter-text",g="";switch(c){case 1:g=" fxc-percent-formatter-bottom-bar";break;case 2:g=" fxc-percent-formatter-top-bar";break;default:h=null}(isNaN(a)||a instanceof Date)&&(a=0);let p="";if(h){if(!e.textKey){const e=a/100;r=s.NumberFormat.create({style:"percent"}).format(e)}r=o.callFormatter(_,r,i),p="<div class='"+h+"'>"+r+"</div>"}a=Math.min(100,Math.max(0,a));let b=" min-width: 1px;";0===a&&(b="");const m="<div class='azc-control fxc-percent-formatter' data-control='true' role='meter' aria-label='"+u+"' aria-valuemin='0' aria-valuemax='100' aria-valuenow='"+a+"'><div class='fxc-percent-formatter-container'><div class='fxc-percent-formatter-value"+g+" "+d+"' style='width: "+a+"%;"+b+"'></div>"+p+"<div class='fxc-percent-formatter-background"+g+" "+l+"'></div></div></div>";return o.callFormatter(x,m,i)}},t.textLookup=function(e){const t=w(e);return function(e){const i=n.call(arguments,1),s=ko.unwrap(e);return o.callFormatter(_,t(s),i)}},t.numberFormat=function(e){return function(t){const i=ko.unwrap(t);return"number"!=typeof i?i.toString():e?s.NumberFormat.create(e).format(i):s.NumberFormat.format(i)}},t.htmlBindings=function(e,t,i){const o=e.createChildLifetime();return function(e,s){let r,a=ko.bindingHandlers.vivaControl.registerCallback((function(){return r||ko.ignoreDependencies((function(){const a=o.createChildLifetime();return r={template:t,data:i(a,e,s),ltm:a}}))}));return s&&s.guidList?(ko.ignoreDependencies((()=>s.guidList[s.rowNumber()]=a)),a=s.rowNumberPath):a='"'+a+'"',"<div class='azc-vivaControl' data-bind='vivaControl: "+a+"'>"+t+"</div>"}},t.bundle=f,t.defaultAll=function(e){return f(e,e,e)},t._callBackLookup=function(e){return d[e]},t.html=x,t.text=_}(d||(d={})),d})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Formatters",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters.Helpers","MsPortalFx/Globalization","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Resources/ImplScriptResources","Fx/Controls/DropDown"],(function(e,t,i,o,s,r,a,n,l){"use strict";var d;return function(t){var d=MsPortalFx.ViewModels.Controls.Lists.Grid,c=d.Format,u=d.HtmlBindingsType,h=MsPortalFx.ViewModels.Forms.CheckBox.ViewModel;const g=MsPortalFx.ViewModels.Forms.TextBox,p={invalidBindingData:"The formatOptions property was not correctly set. The htmlBindingsData needs to be specified correctly for rendering the {0}."};let b;!function(e){function t(e,t,i,o,s){if(t.rowMetadata=o,o.editState&&0===o.editState()){t.performValidation(!1);const r=e.createChildLifetime();i.subscribe(r,(e=>{0!==o.editState()&&(t.performValidation()||t.performValidation(!0),t.ensureValidation())})),s&&ko.isObservable(s)&&(s.subscribe(e,(()=>{t.validate(t.validate()+1)})),o.editing.subscribe(r,(e=>{e||r.dispose()})))}}function i(e){return ko.isObservable(e)?e:ko.observable(e)}e.groupDropDown=function(e,o){return function(e,s,r){const a=i(s);if(!e||!o||!ko.isObservable(o.items))throw new Error(p.invalidBindingData.format("GroupDropDownFormField"));const n=ko.observable(a()),d={getOriginalObservable:e=>n,getEditableObservable:e=>a,createdByBaseFormClass:!0},c=ko.observableArray();ko.reactor(e,[o.items],(e=>{c(e)}));const u=new l.ViewModel(e,{label:ko.observable(o.label||""),items:c,validations:ko.observableArray(o.validations),infoBalloonContent:ko.observable(o.infoBalloonContent),filter:o.filter,filterPlaceholder:o.filterPlaceholder,customFilter:o.customFilter,multiselect:o.multiselect,selectAll:o.selectAll,selectAllOverride:o.selectAllOverride,ariaLabel:r&&r.column&&r.column.name});return u._setEditScopeAccessors(d),t(e,u,a,r&&r.rowMetadata,o&&o.validate),u}},e.textBox=function(e,o){return function(e,s,r){const a=i(s),n=ko.observable(a()),l={getOriginalObservable:e=>n,getEditableObservable:e=>a,createdByBaseFormClass:!0},d=new g.ViewModel(e,{shellUseOnly:!0,label:ko.observable(o&&o.label?o.label:""),valueUpdateTrigger:MsPortalFx.ViewModels.Controls.ValueUpdateTrigger.Input,validations:ko.observableArray(o?o.validations:null),emptyValueText:ko.observable(o?o.emptyValueText:null),infoBalloonContent:ko.observable(o?o.infoBalloonContent:null),ariaLabel:r&&r.column&&r.column.name});return d._setEditScopeAccessors(l),t(e,d,a,r&&r.rowMetadata,o&&o.validate),d}},e.checkBox=function(e,o){return function(e,s,r){const a=i(s),n=ko.observable(a()),l={getOriginalObservable:e=>n,getEditableObservable:e=>a,createdByBaseFormClass:!0},d=new h(e,{label:ko.observable(o&&o.label?o.label:""),validations:ko.observableArray(o?o.validations:null),infoBalloonContent:ko.observable(o?o.infoBalloonContent:null),inlineLabel:!0,ariaLabel:r&&r.column&&r.column.name});return d._setEditScopeAccessors(l),t(e,d,a,r&&r.rowMetadata,o&&o.validate),d}},e.dropDown=function(e,o){return function(e,s,r,a){const n=i(s);if(!o||!ko.isObservable(o.options))throw new Error(p.invalidBindingData.format("DropDownFormField"));void 0===n()&&n(o.options()[0].value);const d=ko.observable(n()),c={getOriginalObservable:e=>d,getEditableObservable:e=>n,createdByBaseFormClass:!0},u=new l.ViewModel(e,{label:ko.observable(o.label||""),items:o.options,validations:ko.observableArray(o.validations),infoBalloonContent:ko.observable(o.infoBalloonContent),ariaLabel:r&&r.column&&r.column.name});return u._setEditScopeAccessors(c),t(e,u,n,r&&r.rowMetadata,o&&o.validate),u}},e.rowSelectionCheckBox=function(e){return function(e,t,i){t=i.rowMetadata.selected;const o=new h(e,{ariaLabel:n.Grid.selectionCheckBoxAriaLabel});let s=!1,r=!0;return t.subscribe(e,(e=>{try{s=!0,o.value(e)}finally{s=!1}})),o.value.subscribe(e,(e=>{if(!r&&!s)try{s=!0,o.value(!e)}finally{s=!1}r=!1})),o}}}(b=t.ControlViewModels||(t.ControlViewModels={})),t.getFormatter=function(t,n,l,d,h,g){const p=!!g;switch(l){case c.ShortTime:return i.date(s.DateTimeFormat.shortTimePattern,d);case c.LongTime:return i.date(s.DateTimeFormat.longTimePattern,d);case c.ShortDate:return i.date(s.DateTimeFormat.shortDatePattern,d);case c.LongDate:return i.date(s.DateTimeFormat.longDatePattern,d);case c.MonthDay:return i.date(s.DateTimeFormat.monthDayPattern,d);case c.YearMonth:return i.date(s.DateTimeFormat.yearMonthPattern,d);case c.CustomDate:return i.date(h.dateFormat||"",d);case c.TextLookup:return i.textLookup(h.textLookup||{});case c.Text:return i.text;case c.Number:return i.numberFormat(h.numberFormat);case c.Icon:return s=>function(t,s,a){const n=ko.unwrap(s),l=o.isUndefined,d=!n||l(n.text)||l(n.uri)?n:n.uri;return r.sanitizeUri(d+"",null,{diContainer:t,localRequire:e,windowContext:a})?i.icon(s):""}(t,s,d);case c.HtmlBindings:return i.htmlBindings(n,function(t,i,o,s){const r=i||"";switch(t){case u.TextBox:case u.CheckBox:case u.DropDown:case u.CheckBoxRowSelection:return"<div data-bind='formElement: $data'></div>"}return o?r:a.sanitizeHTML(r,e,s).sanitizedMarkup}(h.htmlBindingsType,h.htmlBindingsTemplate,p,d),function(e,t,i){switch(t){case u.TextBox:return b.textBox(e,i);case u.CheckBox:return b.checkBox(e,i);case u.DropDown:return b.dropDown(e,i);case u.CheckBoxRowSelection:return b.rowSelectionCheckBox(e);case u.Default:default:return(e,t,i)=>({value:t,settings:i})}}(n,h.htmlBindingsType,h.htmlBindingsData));case c.PercentageBar:return i.percentageBar(h.percentageBar||{})}let m;switch(l){case c.Html:m=i.html;break;case c.IconLookup:m=i.iconLookup(h.iconLookup||{});break;case c.Uri:m=i.uri;break;default:m=i.text}return p||(m=function(t){return(o,s)=>{if(t===i.uri)(s=s||{}).cssClass="msportalfx-link-primary";const r=t(o,s);return a.sanitizeHTML(r,e).sanitizedMarkup}}(m)),m}}(d||(d={})),d})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility",["require","exports","MsPortalImpl.Controls/Controls/Base/Loadable"],(function(e,t,i){"use strict";var o;return function(e){const t=MsPortalFx.forEachKey;e.Extension=class{setInstance(e){this._widget=e}getName(){return null}getDependencies(){return null}};let o={};e.defaultPlugins=[],e.registerPlugin=function(e,t){o[e.toString()]=t},e.unregisterPlugin=function(e,t){o[e.toString()]===t&&delete o[e.toString()]},e.unregisterAllPlugins=function(){o={}};class s extends i.Widget{constructor(e,t,i){super(e,t,i),this._initializePlugins(t),function(e,t){e.forEach((e=>{t.addClass(e.getName())}))}(this._plugins,this.element)}dispose(){var e,t;this._checkExistsOrRegisterDestroyId(super.dispose)||(super.dispose(),e=this._plugins,t=this.element,e.forEach((e=>{t.removeClass(e.getName())})))}getPlugin(e){return MsPortalFx.find(this._plugins,(t=>t.getName()===e))||null}_initializePlugins(i){const s=[],r=[];e.defaultPlugins.forEach((e=>{s.push(new e)})),t(o,((e,t)=>{const o=parseInt(e,10);(i.extensions&o)===o&&s.push(new t)})),this._loadPlugins(s,r),this._plugins=r,r.sort(((e,t)=>{const i=e.getOrder?e.getOrder():null,o=t.getOrder?t.getOrder():null;return i===o?0:null!==i&&null===o?-1:null===i&&null!==o?1:i<o?-1:1})),r.forEach((e=>{e.setInstance(this)}))}_extensionTrigger(e,...t){const i=[];return this._plugins.forEach((o=>{o[e]&&i.push(o[e].apply(o,t))})),i}_loadPlugins(e,t){e.forEach((i=>{const o=i.getDependencies()||[],s=o.filter((i=>!e.some((e=>e.getName()===i.getName()))&&!t.some((e=>e.getName()===i.getName()))));t.some((e=>e.getName()===i.getName()))||t.push(i),s.length&&this._loadPlugins(o,t)}))}}e.Extensibility=s}(o||(o={})),o})),
define("Viva.Controls/Controls/Base/Viva.ExtensibleControl",["require","exports","Viva.Controls/Controls/Base/Viva.Base"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializePlugins=t.Widget=t.ViewModel=t.Extension=void 0;t.Extension=class{setInstance(e){(this._widget=e).ltm.registerForDispose(this._ltm)}getName(){return null}getDependencies(){return null}get ltm(){return this._ltm}constructor(){const e=this._ltm=new FxImpl.TriggerableLifetimeManager;this.vmBasicOption={ltm:e}}};class o extends i.ViewModel{constructor(e){super(e),this.extensions=e.extensions||[]}extensionTrigger(e,...t){const i=[];return this.extensions.forEach((o=>{const s=o[e];s&&i.push(s.apply(o,t))})),i}}t.ViewModel=o;class s extends i.Widget{constructor(e,t,i,s){(i=i||{}).viewModelType=i.viewModelType||o,super(e,t,i,s),this._initializePlugins(this.options),this._addExtensionClasses()}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(super.dispose(),this._removeExtensionClasses())}getPlugin(e){if(this.options.extensions)return MsPortalFx.find(this.options.extensions,(t=>t.getName()===e))}_initializePlugins(e){r(e.extensions),e.extensions.forEach((e=>{e.setInstance(this)}))}_addExtensionClasses(){this.options.extensions.forEach((e=>{this.element.addClass(e.getName())}))}_removeExtensionClasses(){this.options.extensions.forEach((e=>{this.element.removeClass(e.getName())}))}}function r(e){!function(e){for(let t=0;t<e.length;++t)for(const i of e[t].getDependencies()||[]){const t=i.getName();e.every((e=>e.getName()!==t))&&e.push(i)}}(e),e.sort(((e,t)=>{const i=e.getOrder?e.getOrder():null,o=t.getOrder?t.getOrder():null;return i===o?0:null!==i&&null===o?-1:null===i&&null!==o?1:i<o?-1:1}))}t.Widget=s,t.initializePlugins=r})),
define("Viva.Controls/Util/Viva.TemplateEngine",["require","exports","MsPortalImpl/Base/Base.LruMap"],(function(e,t,i){"use strict";var o;return function(e){const t=new i.LruMap(100),o=!MsPortalFx.isFeatureEnabled("nokosvgcaching"),s=ko.expressionRewriting.parseObjectLiteral;function r(e,t){let i=e.filter(t);return i.length||(i=e.find(t)),i}function a(e,t,i){const o=[];e.forEach((e=>{o.push.apply(o,s(e))}));const r=s(t);return o.forEach((e=>{const t=e.key,o=e.value;r.some((e=>{const s=e.value;if(e.key===t){let r=o;return 0===i?r="{"+a([o],s,i+1)+"}":"class"===t&&(r="ko.unwrap("+s+')+" "+ko.unwrap('+o+")"),e.value=r,!0}}))||r.push(e)})),r.map((e=>`'${e.key}':${e.value}`)).join(",")}function n(e,t){const i=a(t,e.attr("data-bind"),0);e.attr("data-bind",i)}class l{constructor(e,t){this._templateSources=e,this._key=t}addAttribute(e,t,i){const o=$(this._get()),a=e?r(o,e):o;let l=t;return"string"==typeof t&&(l={},l[t]=i),a.length&&(a.each(((e,t)=>{const i=$(t);MsPortalFx.forEachKey(l,((e,t)=>{"data-bind"===e?n(i,t):"class"===e?i.addClass(t.join(" ")):i.attr(e,MsPortalFx.last(t))})),function(e){const t=e[0].className,i=s(e.attr("data-bind")),o=[],r=[];let a=0,l=!1;if(i.forEach((e=>{const t=e.key,i=e.value;"css"===t?s(i).forEach((e=>{"key"in e&&o.push("(ko.unwrap("+e.value+')?"'+e.key+'":"")')})):("attr"===t&&s(i).some((e=>"class"===e.key))&&(l=!0),r.push(e))})),o.length&&a++,l&&a++,l&&""!==t&&a++,a>=2){const i=[];""!==t&&(i.push('"'+e[0].className+'"'),e[0].removeAttribute("class")),o.length&&(i.push.apply(i,o),e.attr("data-bind",ko.expressionRewriting.preProcessBindings(r))),n(e,["attr:{'class':"+i.join('+" "+')+"}"])}}(i)})),this._save(o)),this}html(e,t){const i=$(this._get());return r(i,e).html(t),this._save(i),this}prepend(e,t){const i=$(this._get());return r(i,e).prepend(t),this._save(i),this}append(e,t){const i=$(this._get());return r(i,e).append(t),this._save(i),this}_get(){return this._templateSources[this._key]}_save(e){let t="";for(let i=0;i<e.length;i++){const o=e[i],s=o.nodeType;8===s?t+="\x3c!--"+o.nodeValue+"--\x3e":1===s&&(t+=o.outerHTML)}this._templateSources[this._key]=t}}e.HtmlManipulation=l;class d extends ko.nativeTemplateEngine{constructor(){super(...arguments),this._templateSources={}}getTemplate(e){return this._templateSources[e]}setTemplate(e,t){const i=this._templateSources;return"string"==typeof e?i[e]=t:MsPortalFx.extend(i,e),this}makeTemplateSource(e,i){const s=this._templateSources[e];return{nodes:function(e){if(o){if(0===arguments.length)return t.getOrAdd(s,(()=>$(FxImpl.createElement("div")).append(ko.utils.parseHtmlFragment(s))[0]));throw new Error("Can't set node")}},text:function(t){const i=0===arguments.length;if(i&&s)return s;throw new Error(i?"Template name '"+e+"' does not exist.":"Can't set template")}}}}e.StringTemplateEngine=d;e.HtmlTemplateEngine=class extends d{getHtmlTemplate(e){return new l(this._templateSources,e)}}}(o||(o={})),o})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.css",["module"],(function(e){"use strict";return{css:".azc-grid{width:100%;position:relative;font-size:13px}.azc-grid.azc-grid-headerHidden thead{display:none}.azc-grid .azc-grid-cellContent,.azc-grid .azc-vivaControl{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.azc-grid .azc-grid-cell-fullheight{height:100%}.azc-grid .azc-grid-cell-ellipse{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.azc-grid table{width:100%;border:0;background-color:transparent;table-layout:fixed;border-spacing:0}.azc-grid table caption{display:none}.azc-grid table thead tr th{text-transform:none;text-align:left;font-size:13px;padding:0;height:35px;position:relative;font-weight:600;border-bottom-width:1px;border-bottom-style:solid;line-height:31px}.azc-grid table thead tr th a{position:relative}.azc-grid table thead tr th span{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.azc-grid table thead tr th .azc-grid-header-wrapper{padding:1px 0 1px 10px;position:relative}.azc-grid table thead tr th .azc-grid-header-wrapper span{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.azc-grid table thead tr th .azc-grid-header-wrapper .azc-grid-headerlabel{display:block}.azc-grid table td{padding:1px 0 1px 10px;height:29px;border-bottom-width:1px;border-bottom-style:solid;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.azc-grid table td input,.azc-grid table td select,.azc-grid table td textarea,.azc-grid table td button,.azc-grid table td .azc-button,.azc-grid table td .azc-editableCombo,.azc-grid table td .azc-fileUpload,.azc-grid table td .azc-dropdown,.azc-grid table td .azc-optionPicker{font-size:13px!important}.azc-grid table td .azc-dropdown{display:block}.azc-grid a img{border:0}.azc-grid-tableHead{overflow:hidden}.azc-grid-footer{overflow:hidden}.azc-grid-selectableRow:not(.azc-grid-activateableRow) .azc-grid-selectable .fxs-portal-hover:hover:not(.fxs-bg-error,.azc-bg-edited,.azc-disabled,.azc-row-disabled,.fxs-portal-selected) td.azc-br-muted,.azc-grid-selectableRow:not(.azc-grid-activateableRow) .azc-grid-selectable .azc-external-hovered:not(.fxs-bg-error,.azc-bg-edited,.azc-disabled,.azc-row-disabled,.fxs-portal-selected) td.azc-br-muted{border-color:#00bcf2}.azc-grid-selectableRow:not(.azc-grid-activateableRow) .azc-grid-selectable .fxs-portal-hover:hover:not(.fxs-bg-error,.azc-bg-edited,.azc-disabled,.azc-row-disabled,.fxs-portal-selected) td:first-of-type,.azc-grid-selectableRow:not(.azc-grid-activateableRow) .azc-grid-selectable .azc-external-hovered:not(.fxs-bg-error,.azc-bg-edited,.azc-disabled,.azc-row-disabled,.fxs-portal-selected) td:first-of-type{border-left-color:#00bcf2}.azc-grid-selectableRow:not(.azc-grid-activateableRow) .azc-grid-selectable .fxs-portal-hover:hover:not(.fxs-bg-error,.azc-bg-edited,.azc-disabled,.azc-row-disabled,.fxs-portal-selected) td:last-of-type,.azc-grid-selectableRow:not(.azc-grid-activateableRow) .azc-grid-selectable .azc-external-hovered:not(.fxs-bg-error,.azc-bg-edited,.azc-disabled,.azc-row-disabled,.fxs-portal-selected) td:last-of-type{border-right-color:#00bcf2}.fxs-blade-has-activation .azc-grid .azc-collapsed-hidden{display:none!important}.fxs-mode-light .azc-fabric th.azc-br-muted{border-color:#edebe9}.fxs-mode-light .azc-fabric .td.azc-br-muted{border-color:#f3f2f1}",moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1",["require","exports","Viva.Controls/Util/Viva.TemplateEngine","Viva.Controls/Controls/Base/Viva.ExtensibleControl","MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Base/Base.ImplUtils","Viva.Controls/Util/Viva.Resize","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.css","MsPortalImpl/Interactions/Interactions.PortalReader"],(function(e,t,i,o,s,r,a,n,l,d,c,u,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.parseWidth=t.ViewModel=t.Extension=void 0,(0,u.injectCss)(h);const p="azc-grid",b="azc-grid-headerHidden",m="azc-grid-selectableRow",f="azc-grid-scrollable",w="azc-br-muted",v=`<div class='azc-grid-container ${w}' role='presentation'><div class='azc-grid-header' role='presentation'></div><div class='azc-grid-tableContainer ${w}' role='presentation' data-bind='visible:$ctl.tableVisible'><div class='azc-grid-tableHead' role='presentation'><table class='azc-grid-tableHeader' role='presentation' data-bind='style: { width: $ctl.tableWidth }'><caption data-bind='text: data.summary'></caption>\x3c!-- ko template: 'header' --\x3e\x3c!-- /ko --\x3e</table></div><div class='azc-grid-tableScrollContainer ${w}' role='presentation'><div class='azc-grid-tableContent' role='presentation'><table class='azc-grid-full' role='presentation' data-bind='style: { width: $ctl.tableWidth }'>\x3c!-- ko template: 'colgroup' --\x3e\x3c!-- /ko --\x3e\x3c!-- ko template: 'body' --\x3e\x3c!-- /ko --\x3e</table></div></div></div><div class='azc-grid-footer' role='presentation'></div></div>`,x=`<th scope='col' role='presentation' data-bind='keyedCss: { grid1HeaderCell: "azc-grid-column-header ${w} " + cssClass}, css: { "azc-collapsed-hidden": $data.hiddenInCollapsed }'><div class='azc-grid-header-wrapper' role='presentation'>\x3c!-- ko template: "headerCellContent" --\x3e\x3c!-- /ko --\x3e</div></th>`,_=`\x3c!-- ko if: data.noRowsMessage --\x3e<tbody role='rowgroup' class='azc-grid-empty'><tr role='row' data-bind='attr: { tabindex: $tabIndex }'><td role='gridcell' class='${w} msportalfx-tooltip-overflow' data-bind='attr: { colspan: $ctl._getTotalColumns() }, html: data.noRowsMessage'></td></tr></tbody>\x3c!-- /ko --\x3e`,C=`<tbody role='rowgroup' class='azc-grid-empty'><tr role='row' data-bind='attr: { tabindex: $tabIndex }'><td role='gridcell' class='${w} msportalfx-tooltip-overflow' data-bind='attr: { colspan: $ctl._getTotalColumns() }'>${MsPortalFx.encodeAttribute(a.Grid.loading)}</td></tr></tbody>`,y=`<td role='gridcell' data-bind='template: { name: "bodyCellContent" }, css: { "azc-collapsed-hidden": $data.hiddenInCollapsed }, keyedCss: { grid1BodyCell: "azc-grid-cell ${w} " + cssClass + (itemKey === "infoBalloon" ? "azc-grid-infoBalloon" : "")}, attr: { "aria-describedby": columnId, "aria-label": $ctl._getCellAriaLabel($parent, $data) && $parent.cellAriaLabels[itemKey](), "aria-colindex" : $index() + 1, "aria-rowindex": $ctl.getRowIndex($parentContext.$index()), "aria-readonly": $ctl._ariaReadonly }'></td>`,z="$parentContext.$parentContext.$index",R='<div class=\'azc-grid-cellContent\' data-bind=\'css: { "azc-grid-cell-ellipse": $data.enableEllipse, "azc-grid-cell-fullheight": $data.fullHeight }, trustedCellBinding: $ctl._cellFormat('+z+", $index, $parent, $data)'></div>";let k=0;const M={em:13,ch:7,px:1,cm:37.79527559,mm:3.779527559,in:96,pt:1.333333333,pc:16};class E extends o.Extension{}t.Extension=E;class P extends o.ViewModel{constructor(e){super(e),this.summary=ko.observable(),this.showHeader=!0,this.columns=ko.observableArray(),this.items=ko.observableArray(),this.noRowsMessage=ko.observable(),this.events=$.noop,this.uri={},this.text={},this.sortByList=ko.observableArray()}}function F(e){return e?"true":"false"}function I(e){let t,i,o,s;e&&(o=/^\s*(\d+(?:\.\d*)?(?:[eE][-+]?\d+)?)(px|fr|%|cm|mm|in|pt|pc|em|ch)\s*$/.exec(e)),o&&3===o.length?(t=parseFloat(o[1]),i=o[2]):(t=1,i="fr");const r=M[i];return r&&(s=Math.round((t||0)*r)),{value:t,units:i,fixedPixels:s}}t.ViewModel=P,t.parseWidth=I;class L extends o.Widget{get allRowMetadata(){return this._allRowMetadata||(this._allRowMetadata=ko.observableArray()),this._allRowMetadata}constructor(e,t,o){(o=o||{}).viewModelType=o.viewModelType||P,super(e,t,o),this._ariaLive=ko.observable(""),this._ariaReadonly=ko.observable(F(this._readonly=!this.getPlugin("azc-grid-editableRow"))),this._readLoading=!1,this.id="grid1"+MsPortalFx.getUniqueId(),this.templateEngine=new i.HtmlTemplateEngine,this.width=o.width||ko.observable(),this.height=o.height||ko.observable(),this.collapsed=ko.observable(!1),this.scrollWidth=ko.observable(0),this.tableWidth=ko.pureComputed((()=>`${this.scrollWidth()}px`)),this._columns=this.options.columns.mapInto(this.ltm,((e,t)=>{const i=t.width||ko.observable(),o=ko.observable(function(){let e=FxImpl.features.isEnabled("minColumnWidth",!0);return e||(e=$.querySelectorAll("#web-container").hasClass("fxs-reflowminview")),e}()?t.minWidth||140:0);let s;const r=I(i.peek());s=void 0!==r.fixedPixels?r.fixedPixels:Math.round(o.peek()||0),s=Math.max(s,20);const a=ko.observable(`${s}px`);return{...t,width:i,nMinWidth:o,pxWidth:a,snapToMin:!1}}));const s=ko.pureComputed((()=>{const e=this.collapsed();return this._columns().filter((t=>!e||!t.hiddenInCollapsed||!t.hiddenInCollapsed()))}));this.tableVisible=ko.pureComputed((()=>s().length>0)),this.leftMarginWidth=ko.pureComputed((()=>{let e=0;return this.options.extensionTrigger("computeLeftMarginWidth").forEach((t=>{e+=ko.unwrap(t)})),e})),this.rightMarginWidth=ko.pureComputed((()=>{let e=0;return this.options.extensionTrigger("computeRightMarginWidth").forEach((t=>{e+=ko.unwrap(t)})),e})),this.totalMarginWidth=ko.pureComputed((()=>this.leftMarginWidth()+this.rightMarginWidth())),this.availableWidth=ko.pureComputed((()=>{let e=(this.width()||0)-this.totalMarginWidth();return e+=this.options.extensionTrigger("computeAvailableWidthDelta").reduce(((e,t)=>e+t),0),e>0?e:0})),this.allocatedWidth=ko.pureComputed((()=>{const e=this.availableWidth();return s().reduce(((t,i)=>t+function(e,t){let i=0;const{value:o,units:s,fixedPixels:r}=e;return void 0!==r?i=r:"%"===s&&(i=Math.max(o*t/100,20)),0|i}(I(i.width&&i.width()),e)),0)})),this.totalFractionalUnits=ko.pureComputed((()=>s().reduce(((e,t)=>{const i=I(t.width&&t.width());return"fr"===i.units&&(e+=i.value),e}),0))),ko.reactor(this.ltm,(()=>{let e=this.totalMarginWidth();s().forEach((t=>{e+=parseInt(t.pxWidth(),10)})),this.scrollWidth(e)})),ko.reactor(this.ltm,(()=>{const e=this.availableWidth(),t=this.totalMarginWidth(),i=s();let o=0,r=0,a=0;const n=i.map((t=>{const i=t.width();let s=t.nMinWidth.peek();s=this.hscroll()?Math.max(s,20):20;const n=I(i);"fr"===n.units?r+=n.value:"%"===n.units?a+=n.value:(o+=n.fixedPixels,s=20),t.availableWidthWhenSnappedToMin&&t.availableWidthWhenSnappedToMin!==e&&(t.availableWidthWhenSnappedToMin=void 0),t.snapToMin&&(t.availableWidthWhenSnappedToMin=e,t.snapToMin=!1);const l=this.hscroll()&&t.availableWidthWhenSnappedToMin===e;return{columnWidget:t,units:n.units,value:n.value,min:s,snapToMin:l,fixedPixels:n.fixedPixels}}));this._updateColumnWidths(n,e,t,r,a,o)})),this.options.extensionTrigger("beforeCreate"),this._showNoRows=ko.pureComputed((()=>{if(!this.options.items)return!0;const e=this.options.items();let t=e&&e.length||0;return this.options.extensionTrigger("modifyRowNumber").forEach((e=>{t+=e})),0===t})),this._setTemplates();const r=this.getPlugin(m);this.element.addClass(p).addClass("azc-fabric").attr({role:"grid","aria-multiselectable":F(r&&!!r._multiselect),"aria-readonly":this._ariaReadonly(),id:this.id}).html("<div class=\"azc-grid-root\" role='presentation'><div class=\"azc-grid-area\" role='presentation' data-bind=\"template:'table'\"></div></div>"),this.options.columns.subscribeAndRun(this.ltm,(e=>{this.element.attr("aria-colcount",e.length)}));const d=this.ariaRowCount=ko.observable(0);d.subscribeAndRun(this.ltm,(e=>{this.element.attr("aria-rowcount",e)}));const u=this.options.extensionTrigger("getAriaRowCount").filter((e=>!!e));1===u.length?u[0].subscribeAndRun(this.ltm,(e=>{d(e)})):0===u.length?this.options.items.subscribeAndRun(this.ltm,(e=>{d(e?e.length:0)})):d(-1);const h=this.options.extensionTrigger("getFirstObservableRowIndexObservable").filter((e=>!!e));let f;h.length>0&&h[0]?this.firstRowIndex=h[0]:this.firstRowIndex=ko.observable(1),this.options.showHeader||this.element.addClass(b),this._ariaLive.subscribe(this.ltm,(e=>{e&&e.length&&this.element.is(":visible")&&(f||(f=new g.PortalReader(this.ltm,{idPrefix:this.id,removalDelayMs:0})),f.read(e))})),this.options.loading.subscribe(this.ltm,(e=>{(e||this._readLoading)&&(this._readLoading=!0,e?this._ariaLive(a.Grid.Accessibility.loading):this._ariaLive(a.Grid.Accessibility.loaded))})),this._bindDescendants(),this._attachEvents(),this.options.summary.subscribeAndRun(this.subLifetime,(e=>{this.element.attr("aria-label",e),this.element.find(".azc-grid-groupdata").attr("aria-label",e)})),this.options.showHeader&&(0,l.waitForBindings)(this.element[0]).then((()=>{new n.KeyboardNavigation(this.ltm,{element:this.element.find("thead tr"),tabTriggers:8,itemSelector:".azc-grid-headerCell, .azc-checkBox",parentTabIndexContextObservable:this.$tabIndex})})),this.options.extensionTrigger("afterCreate"),c.track(this.ltm,e.first(),((e,t)=>{if(this.ltm&&!this.ltm.isDisposed()){const i=this.width.peek(),o=this.height.peek(),s=e!==i,r=t!==o,a=this.collapsed.peek(),n=s?this.element.closest(".fxs-blade").hasClass("fxs-blade-has-activation"):a;this.collapsed(n),this.width(e),this.height(t),this.element.children(".azc-grid-root").children(".azc-grid-area").width(e),this.options.extensionTrigger("onSizeChanged",t,e,r,s,o,i)}}),{notifyInitialSize:!0})}_updateColumnWidths(e,t,i,o,s,r){const a=t,n=Math.max(t-r-a*s/100,0);let l=0,d=0,c=0,u=0,h=[],g=[];const p=e.map((e=>{let t=0,i=0;"fr"===e.units?(t=n*e.value/o,i=Math.max(t-e.min,0),u+=i,i||(t=e.min),c+=t):"%"===e.units?(e.snapToMin||(t=a*e.value/100,i=Math.max(t-e.min,0),d+=i),i||(t=e.min),l+=t):t=e.fixedPixels;const s={...e,widthPixels:t,extraPixels:i};return"fr"===s.units?g.push(s):"%"===s.units&&h.push(s),s}));if(s<100&&!c&&l&&l<t-r){const e=t;let i=0,o=0,r=s;for(;h.length!==o;){o=h.length;const t=i,s=r;h=h.filter((o=>{let a=0,n=0;return o.snapToMin||(a=(e-t)*o.value/s,n=Math.max(a-o.min,0)),n||(a=o.min,r-=o.value,i+=a),o.extraPixels=n,o.widthPixels=a,!!n}))}}if(this.hscroll()){const e=l+c+r,i=d+u;if(i&&e>t&&e-t<i){let e=0;const i=c-u;if(d&&t-l-r<i&&(e=t-r-i),e){let t=0,i=0,o=s;for(;h.length!==i;){i=h.length;const s=t,r=o;h=h.filter((i=>{if(i.extraPixels){let t=(e-s)*i.value/r;const o=Math.max(t-i.min,0);if(t=o?t:i.min,i.widthPixels=t,i.extraPixels=o,o)return!0}return t+=i.widthPixels,o-=i.value,!1}))}}let a=0;const n=t-r-(e||l);if(u&&n>=i&&(a=n),a){let e=0,t=0,i=o;for(;g.length!==t;){t=g.length;const o=e,s=i;g=g.filter((t=>{if(t.extraPixels){let e=(a-o)*t.value/s;const i=Math.max(e-t.min,0);if(e=i?e:t.min,t.widthPixels=e,t.extraPixels=i,i)return!0}return e+=t.widthPixels,i-=t.value,!1}))}}}}let b,m=0,f=0;if(p.forEach((e=>{const t=e.widthPixels;let i;"%"===e.units||"fr"===e.units?(i=Math.round(t+m),m+=t-i,b=e):i=t,f+=i,e.widthPixels=i})),b){const e=t-f;1===Math.abs(e)&&(b.widthPixels+=e)}p.forEach((e=>{e.columnWidget.pxWidth(`${e.widthPixels}px`)}))}static getCell(e,t,i){return(e.find?e:e.element).find(`.azc-grid-row:eq(${t}) .azc-grid-cell:not([aria-hidden=true]):eq(${i})`)}getRowIndex(e){return this._readonly?this.firstRowIndex()+e:void 0}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this.options.extensionTrigger("beforeDestroy"),this._detachEvents(),this._cleanElement(p,"azc-fabric",b),super.dispose(),this.options.extensionTrigger("afterDestroy"))}get options(){return this._options}getRowMetadata(e){const t=this.options;if("object"!=typeof e||!e)return null;const i=function(t){return t&&t.item===e};let o,s=MsPortalFx.find(this._allRows,i);return s||(s=this._getNewRowMetadataEntries(),s.item=e,o=MsPortalFx.find(t.rowMetadata,i),o&&$.extend(!0,s,o),this._allRows.push(s),this.allRowMetadata.push(s)),s}previous(){return this.getPlugin(m).previous()}next(){return this.getPlugin(m).next()}_getAllRowMetadata(){return this._allRowsInited||(this._updateAllRowMetadata(),this._allRowsInited=!0),this._allRows}_initializePlugins(e){this._allRows=[],super._initializePlugins(e)}_initializeSubscriptions(e){super._initializeSubscriptions(e);const t=this.subLifetime;e.columns.subscribeAndRun(t,(e=>{this._normalizeColumns(e)})),this.$disabled.subscribeAndRun(t,(e=>{this.element.attr("aria-disabled",e)})),this.options.loading.subscribeAndRun(t,(e=>{this.element.attr("aria-busy",e?"true":null)})),e.items&&(e.items.subscribe(t,(e=>{const t=[],i=[];this._allRows.forEach((o=>{e.some((e=>o.item===e))?t.push(o):i.push(o)})),i.forEach((e=>{this.options.extensionTrigger("shouldRetainRowMetadata",e).some((function(e){return!0===e}))&&t.push(e)})),this._allRows=t,this.allRowMetadata(t.slice()),this._updateAllRowMetadata()})),this._itemsPerKeyboardPage=ko.computed(t,(()=>{const e=this.options.items();return e&&e.length>20?10:5})))}_attachEvents(){this.options.extensionTrigger("beforeAttachEvents"),this.element.on("mouseenter.azcGrid",">.azc-grid-root>.azc-grid-area>.azc-grid-container .azc-grid-full>tbody>tr>td .azc-grid-cellContent, >.azc-grid-root>.azc-grid-area>.azc-grid-container .azc-grid-tableHeader>thead>tr>th .azc-grid-headerlabel",this._onMouseEnter=function(){const e=$(this),t=e.attr("title");0===e.find(">div,>span").length&&t!==e.text()&&(this.offsetWidth<this.scrollWidth?e.attr("title",e.text()):t&&e.removeAttr("title"))}),this.options.extensionTrigger("afterAttachEvents")}_detachEvents(){this.options.extensionTrigger("beforeDetachEvents"),this._onMouseEnter&&(this.element.off("mouseenter.azcGrid",this._onMouseEnter),this._onMouseEnter=null),this.options.extensionTrigger("afterDetachEvents")}_getNewRowMetadataEntries(){const e={item:null,cssClass:ko.observable("")};return this.options.extensionTrigger("getDefaultRowMetadataProperties",e).forEach((function(t){$.extend(!0,e,t)})),e}_getNewColumnEntries(){const e={name:ko.observable(""),itemKey:"",formatter:r.text,cssClass:"",width:ko.observable(null),ariaLabel:null};return this.options.extensionTrigger("getDefaultColumnProperties").forEach((function(t){$.extend(!0,e,t)})),e}_normalizeColumns(e){let t=this._getNewColumnEntries();const i=Object.keys(t);let o=!1,s=e.length;for(;s--;){const r=e[s];i.forEach((function(e){void 0===r[e]&&(r[e]=t[e],o=!0)})),MsPortalFx.isNullOrUndefined(r.columnId)&&(r.columnId="fxgridcol"+k++),o&&(t=this._getNewColumnEntries(),o=!1)}}_getTotalColumns(){let e=this.options.columns().length;return this.options.extensionTrigger("getAdditionalColumns").forEach((t=>{e+=t})),e}_cellFormat(e,t,i,o){const s=o.guidList||(o.guidList=[]);return(o.formatter||r.text)(i.item[o.itemKey],{item:i.item,rowNumber:e,columnNumber:t,rowMetadata:i,column:o,guidList:s,rowNumberPath:`$data.guidList[${z}.peek()]`})}_getCellAriaLabel(e,t){return t.getCellAriaLabel?(e.cellAriaLabels&&e.cellAriaLabels[t.itemKey]||(e.cellAriaLabels||(e.cellAriaLabels={}),e.cellAriaLabels[t.itemKey]=ko.observable(),Promise.resolve(t.getCellAriaLabel(e.item)).then((i=>{e.cellAriaLabels[t.itemKey](i)}))),!0):null}_getRowAriaLabel(e){if(e.ariaLabel)return!0;const t=ko.observable();return this.options.getRowAriaLabel&&ko.computed(this.ltm,(()=>{this.options.rowAriaLabelDependencies&&this.options.rowAriaLabelDependencies.forEach((t=>{ko.unwrap(e.item[t])})),ko.ignoreDependencies((()=>{Promise.resolve(this.options.getRowAriaLabel(e.item)).then((e=>{t(e)}))}))})).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),e.ariaLabel=ko.computed(this.ltm,(()=>{const i=t();return this.options.extensionTrigger("getRowAriaLabelOverride",e)[0]||i||null})),!0}_setTemplates(){const e=this.templateEngine;this.options.extensionTrigger("beforeSetTemplates",e),e.setTemplate({table:v,header:"\x3c!-- ko template: 'colgroup' --\x3e\x3c!-- /ko --\x3e<thead><tr role='row'>\x3c!-- ko template: { name: \"headerCell\", foreach: $ctl._columns } --\x3e\x3c!-- /ko --\x3e</tr></thead>",headerColumn:'<col data-bind=\'keyedCss: { grid1HeaderColumn: "col" + $index() }, style: { width: pxWidth }, css: { "azc-collapsed-hidden": $data.hiddenInCollapsed }\' />',colgroup:'<colgroup>\x3c!-- ko template: { name: "headerColumn", foreach: $ctl._columns } --\x3e\x3c!-- /ko --\x3e</colgroup>',headerCell:x,headerCellContent:"<span role='columnheader' aria-readonly='true' class='azc-grid-headerlabel azc-grid-headerCell' data-bind='text: name, attr: { id: columnId, \"aria-hidden\": $ctl._ariaHiddenColumnHeader($data), \"aria-label\": ariaLabel }' tabindex='-1'></span>",body:"\x3c!-- ko template: { name: ko.pureComputed(function () { return data.loading() ? 'templateLoading' : ($ctl._showNoRows() ? 'bodyNoItems' : 'bodyCore'); }) } --\x3e\x3c!-- /ko --\x3e",bodyCore:"<tbody class='azc-grid-groupdata' role='rowgroup'>\x3c!-- ko template: { name: 'bodyRows', foreach: data.items } --\x3e\x3c!-- /ko --\x3e</tbody>",bodyNoItems:_,templateLoading:C,bodyRows:"\x3c!-- ko template: { name: 'bodyRowsCore', data: $ctl.getRowMetadata($data), context: function (metadata) { return { $disabled: metadata.disabled || $disabled }; } } --\x3e\x3c!-- /ko --\x3e",bodyRowsCore:"<tr role='row' data-bind='keyedCss: { grid1BodyRowsCore: \"azc-grid-row \" + cssClass()}, attr: { \"aria-label\": $ctl._getRowAriaLabel($data) && ariaLabel(), \"aria-rowindex\": $ctl.getRowIndex($index()) }'>\x3c!-- ko template: { name: 'bodyCell', foreach: $vm.columns } --\x3e\x3c!-- /ko --\x3e</tr>",bodyCell:y,bodyCellContent:R}),this.options.extensionTrigger("afterSetTemplates",e)}_updateAllRowMetadata(){const e=this.options;if(!e.items)return;const t=e.items();t&&t.length&&t.forEach((e=>{this.getRowMetadata(e)}))}_ariaHiddenColumnHeader(e){return!e||!ko.unwrap(e.name)&&!ko.unwrap(e.ariaLabel)||null}convertPixelsToUnits(e,t,i,o){let s;if("fr"===t){const r=this.totalFractionalUnits.peek(),a=Math.max(this.availableWidth.peek()-this.allocatedWidth.peek(),20);let n;n=this.hscroll()&&i!==r?e*r*(1-o/a)/(a-e):e*r/a,s={value:Math.round(1e4*n)/1e4,units:t}}else if("%"===t){const i=100*e/Math.max(this.availableWidth.peek(),20);s={value:Math.round(1e4*i)/1e4,units:t}}else{const i=e/M[t];s={value:Math.round(1e4*i)/1e4,units:t}}return s}hscroll(){const e=this.getPlugin(f);return!(!e||!e.hscroll)}vscroll(){const e=this.getPlugin(f);return!(!e||!e.vscroll)}}t.Widget=L;const S=ko.bindingHandlers.trustedHtml;ko.bindingHandlers.trustedCellBinding={init:S.init,update:function(t,i,o,s,r){try{return S.update(t,i,o,s,r)}catch(i){throw(i=i&&i.message?i:FxImpl.createError("Undefined cell binding error"))._sourceErrorLevel=0,d.logToExtension(e,t,2,i.message),i}}},ko.bindingHandlers.azcGrid=s.getBindingHandler(L)})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer"],(function(e,t,i,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrustedWidget=t.Widget=t.GridExtension=void 0;var a=MsPortalFx.Base.Diagnostics,n=MsPortalFx.ViewModels.Controls.Lists.Grid.Format;const l=MsPortalFx.forEachKey;class d extends i.Extension{}t.GridExtension=d;class c extends i.Extensibility{constructor(e,t,i){super(e,t,i),this._metadataDisposables=[],this._resetCallbackAdded=!1,this.width=ko.observable(),this.height=ko.observable(),this._extensionTrigger("beforeCreate"),this._initializeWidgets(),this._extensionTrigger("afterCreate")}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._extensionTrigger("beforeDestroy"),this._metadataDisposables&&(this._metadataDisposables.forEach((e=>{(e.disposables||[]).forEach((e=>{e.dispose()}))})),this._metadataDisposables=[]),this._resetCallbackAdded&&this.options.resetCallback(null),super.dispose(),this._extensionTrigger("afterDestroy"))}get options(){return this._options}getRowMetadata(e){return this._instance.getRowMetadata(e)}_twoWayBinding(e,t,i){const o=e.createChildLifetime(),s=t(),r=i();let a=!1;const n=function(e,t){if(!a)try{a=!0,e(t)}finally{a=!1}};return s?i(s):r&&t(r),t.subscribe(o,(e=>{n(i,e)})),i.subscribe(o,(e=>{n(t,e)})),o}_resetExtensions(){const e=this._extensionTrigger("resetExtension");return Promise.all(e)}_initializeWidgets(){this._initializeNestedViewModel(),this._instance=new o.Widget(this.element,this._nestedViewModel,{height:this.height,width:this.width}),this._widgets.push(this._instance),this._extensionTrigger("initializeExtension"),this._initializeVivaRowMetadata(),this.options.resetCallback()||(this.options.resetCallback((()=>this._resetExtensions())),this._resetCallbackAdded=!0)}_getFormatter(t,i){let o;switch(t){case n.Text:return s.text;case n.Uri:return s.uri}if(o=MsPortalFx.find(this._extensionTrigger("getSafeFormatter",t,i,this.isTrusted),(e=>null!==e)),o)return o;if(t===n.Html)o=s.html;else o=MsPortalFx.find(this._extensionTrigger("getUnsafeFormatter",t,i,this.isTrusted),(e=>null!==e)),o||(o=s.text);return this.isTrusted||(o=function(t,i){return(o,s)=>{const a=t(o,s);return r.sanitizeHTML(a,e,i).sanitizedMarkup}}(o,this.element)),o}_connectMetadataAndDisposeSubscriptions(e,t){const i=this._getVivaItem(t);i&&this._canConnectRowMetadataProperties(i,t)&&(this._connectRowMetadataProperties(i,t),e.dispose())}_disposeMetadataDisposables(e){let t,i=-1;this._metadataDisposables.some(((o,s)=>o.metadata===e&&(t=o,i=s,!0))),t&&((t.disposables||[]).forEach((e=>{e.dispose()})),this._metadataDisposables.splice(i,1))}_initializeNestedViewModel(){const t=new o.ViewModel(this.vmBasicOption),i=this.options,s=this.ltm;t.summary=i.summary,t.showHeader=i.showHeader,t.sortByList=i.sortByList,i.loading.subscribeAndRun(s,t.loading),t.actions=i._msPortalFxActions,t.getRowAriaLabel=i.getRowAriaLabel&&(e=>i.getRowAriaLabel(e)),t.rowAriaLabelDependencies=i.rowAriaLabelDependencies,t.noRowsMessage=ko.observable(),i.noRowsMessage&&ko.computed(s,(()=>{const o=i.noRowsMessage(),s=this.isTrusted?o:r.sanitizeHTML(o,e,this.element).sanitizedMarkup;t.noRowsMessage(s)}),this),t.columns=i.columns.mapInto(s,((e,t)=>{const i=this._toNestedColumn(t);return this._extensionTrigger("columnAdded",e,t,i),i})),t.items=i.items,t.extensions.push(...this._getExtensions(i.extensionsOptions||{})),t.disabled=i.disabled,this._nestedViewModel=t}_toNestedColumn(e){const t=l(e,((e,t,i)=>{i[e]=t}),{});return t.pcColumn=e,t.formatter=null,void 0!==e.format&&(t.formatter=this._getFormatter(e.format,e.formatOptions||{})),t}_initializeVivaRowMetadata(){const e=this.options.rowMetadata;e.subscribeArrayBulkChanges(this.ltm,((e,t)=>{t.forEach((e=>{this._disposeMetadataDisposables(e)})),e.forEach((e=>{this._connectPortalAndVivaRowMetadataAsync(e)}))})),e.peek().forEach((e=>{this._connectPortalAndVivaRowMetadataAsync(e)}))}_connectPortalAndVivaRowMetadataAsync(e){const t=this.ltm.createChildLifetime(),i=this._getVivaItem(e);i&&this._canConnectRowMetadataProperties(i,e)?this._connectRowMetadataProperties(i,e):(this._extensionTrigger("registerSubscriptionsToConnectMetadataProperties",t,e),this._nestedViewModel.items.subscribe(t,(i=>{this._connectMetadataAndDisposeSubscriptions(t,e)})))}_getVivaItem(e){let t=MsPortalFx.find(this._nestedViewModel.items(),(t=>e.item===t));if(!t){const i=this._extensionTrigger("getAdditionalItems");for(let o=0;o<i.length&&(!i[o]||(t=i[o].find((t=>{return i=t,o=e.item,i&&o&&i===o;var i,o})),!t));o++);}return t}_canConnectRowMetadataProperties(e,t){return!this._extensionTrigger("disallowConnectRowMetadataProperties",e,t).some((function(e){return!!e}))}_connectRowMetadataProperties(e,t){let i;const o=this.getRowMetadata(e);if(t)i=MsPortalFx.find(this._metadataDisposables,(e=>e.metadata===t)),i||(i={metadata:t,disposables:[]},this._metadataDisposables.push(i)),this._extensionTrigger("connectRowMetadataProperties",e,o,t).forEach((function(e){e&&i.disposables.push.apply(i.disposables,e)}));else{new a.Log("Grid").debug("Metadata was not present and could not connect rowmetadata.")}}_getExtensions(e){const t=[];return this._extensionTrigger("getExtension",e).forEach((e=>{e&&t.push(e)})),t}}t.Widget=c;t.TrustedWidget=class extends c{constructor(e,t){super(e,t,{isTrusted:!0})}}})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.FocusableRow.css",["module"],(function(e){"use strict";return{css:'.fxs-mode-standardcontrast .azc-grid-focusableRow tr[aria-disabled="true"] td>div{opacity:.5}.fxs-mode-standardcontrast .azc-grid-focusableRow tr[aria-disabled="true"] td.azc-grid-infoBalloon>div{opacity:1}.fxs-mode-standardcontrast .azc-grid-focusableRow tr[aria-disabled="true"] td .azc-dockedballoon{position:static}.azc-grid-focusableRow.azc-grid-mousedown{outline:0}.fxs-mode-light .azc-fabric .azc-grid-headerlabel:focus,.fxs-mode-light .azc-fabric .azc-grid-row:focus{outline-style:solid;outline-color:#605e5c}',moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.KeyboardHelper","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.FeatureDetection","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.FocusableRow.css","Fx"],(function(e,t,i,o,s,r,a,n,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FocusableRowExtension=void 0,(0,n.injectCss)(l);var c=MsPortalFx.isNullOrUndefined;const u=window,h="azc-grid-tableContainer",g="."+h,p=".azc-grid",b="rowFocus",m="tabindex";let f=!1;function w(e){return e.find("> tbody > tr[data-grid-focusable]:not([aria-disabled=true][tabindex=-1]):not(.fxc-row-hidden):visible")}function v(e,t){let i,o;const s=[],r=t&&t.preventScroll&&!(0,a.canPreventScrollOnFocus)();if(r){const t=document.scrollingElement||document.documentElement;for(i=e;(i=i.parentElement)&&e!==t;)s.push({parentElement:i,scrollLeft:i.scrollLeft,scrollTop:i.scrollTop});s.push({parentElement:t,scrollLeft:t.scrollLeft,scrollTop:t.scrollTop})}if(e.focus(t),e.focus(t),r){let e=!1;for(;o=s.pop();)i=o.parentElement,i.scrollTop!==o.scrollTop&&(i.scrollTop=o.scrollTop,e=!0),i.scrollLeft!==o.scrollLeft&&(i.scrollLeft=o.scrollLeft,e=!0);if(e)return d.delay(10)}return Promise.resolve()}class x extends i.Extension{constructor(e){super(),this._options=e=e||{},this._gridTabIndex=ko.observable(!0),this._lastTabbableRowMetadata=ko.observable(),e.focusableCursorEnabled=e.focusableCursorEnabled||ko.observable(!1),e.focusableCursorOptions=e.focusableCursorOptions||{hasPreviousFocusRow:ko.observable(!1),hasNextFocusRow:ko.observable(!1)}}get options(){return this._options}static isEditableControl(e){return e.is("input")||e.is("textarea")||e.is("select")||e.is("keygen")}setInstance(e){super.setInstance(e)}afterCreate(){const e=this._widget,t=e.element,i=this.options.disableFocusDistribution;ko.reactor(this.ltm,(()=>{t.attr(m,!i&&this._gridTabIndex()?e.$tabIndex():-1)}))}afterSetTemplates(e){const t=e.getHtmlTemplate("bodyRowsCore");t.addAttribute("tr","data-bind",['attr: { "aria-disabled": $disabled, "data-grid-focusable": true }',this._getRowFocusDataBindAttribute(),'css: { "azc-row-disabled": $disabled }']),this.externalHover||t.addAttribute("tr","class",["fxs-portal-hover","fxs-portal-focus"]),e.setTemplate("bodyRows","\x3c!-- ko template: { name: 'bodyRowsCore', data: $ctl.getRowMetadata($data), context: function (metadata) { return { $disabled: metadata.disabled || $disabled, $tabIndex: ko.unwrap(metadata.editing) ? 0 : metadata.focusIndex}; } } --\x3e\x3c!-- /ko --\x3e")}getDefaultRowMetadataProperties(e){const t=ko.observable(!1);let i;return i=this.options.disableFocusDistribution?ko.pureComputed({read:()=>{const i=this._lastTabbableRowMetadata();return i===e||!i&&!t()},write:t=>{t?this._lastTabbableRowMetadata(e):this._lastTabbableRowMetadata()===e&&this._lastTabbableRowMetadata(null)}}):ko.observable(!1),{disabled:t,focused:i,focusIndex:ko.pureComputed({read:()=>i()?this._widget.$tabIndex():-1,write:e=>{i(0===e)}})}}getOrder(){return 10}handleRemovedRow(e){const t=this._lastTabbableRowMetadata.peek();t&&e===t.item&&(this._gridTabIndex(!0),this._lastTabbableRowMetadata(null));const i=$(document.activeElement).closest(".azc-grid-row");i.length&&ko.dataFor(i[0]).item===e&&d.nextTick((()=>{const e=this._findFirstFocusableRow(this._widget.element);e.length?this._focusRow(e[0],ko.dataFor(e[0])):this._widget.element.focus()}))}beforeCreate(){this._widget.options.items.subscribeArrayDeletes(this.ltm,(e=>{this.handleRemovedRow(e)}))}afterAttachEvents(){const e=this,t=this._widget.element,i=this.ltm;i.registerForDispose(t.setEvents(["click.azcGrid","tbody tr[data-grid-focusable=true]:not([aria-disabled=true])",function(t){if(this===u.document.activeElement||$.contains(this,u.document.activeElement))e._updatePreviousNextFocusableState($(this));else{const i=ko.dataFor(this);i&&e._focusRow(this,i,t)}}],["keydown.azcGrid",function(t){const i=$(t.target),o=i.closest(p),r=i.is(p)?null:i.closest("tr[data-grid-focusable]");let a;const n=s.getModifierKeys(t);let l=!0;if(!x.isEditableControl(i))if(0===n){switch(t.which){case 38:a=e._findPreviousFocusableRow(o,r);break;case 40:a=e._findNextFocusableRow(o,r);break;case 36:a=e._findFirstFocusableRow(o);break;case 35:a=e._findLastFocusableRow(o);break;case 33:case 34:a=e._findFocusableRowByPage(o,t.which);break;default:l=!1}a&&a.length&&e._focusRow(a,ko.dataFor(a[0]),t),l&&t.preventDefault()}else e.options.disableFocusDistribution||4!==n||9!==t.which||e._focus(t)}],["mousedown.azcGrid",function(){t.addClass("azc-grid-mousedown"),$.querySelectorAll("body").one("mouseup",(function(){t.removeClass("azc-grid-mousedown")}))}],["focus.azcGrid",function(i){e.options.disableFocusDistribution||$.contains(t[0],i.relatedTarget)||(e._focus(i),(e._lastTabbableRowMetadata.peek()||$.contains(t[0],document.activeElement)&&$(document.activeElement).is("input, [tabindex=0]"))&&e._gridTabIndex(!1))}],["focusin.azcGrid",function(t){if(!e._lastTabbableRowMetadata.peek()){const t=e._findFirstFocusableRow(e._widget.element),i=t.length&&ko.dataFor(t[0]);i&&i.focused(!0),e._lastTabbableRowMetadata(i)}}])),this.options.disableFocusDistribution||this._widget.options.items.fxOnce(i,(e=>{this._widget.element[0]===u.document.activeElement&&d.nextTick((()=>{const e=this._findFirstFocusableRow(this._widget.element);e.length&&this._focusRow(e,ko.dataFor(e[0]))}))}),(e=>!(!e||!e.length)))}beforeDestroy(){this._widget.element.removeAttr(m).removeClass("azc-grid-mousedown")}getName(){return x.Name}focusRowByRowMetadata(e,t){const i=this._getRowByRowMetadata(e),o=u.document.activeElement;(i&&!t||i&&t&&o&&i!==o&&!$.contains(i,o))&&this._focusRow(i,e)}previous(e){if(!this.options.focusableCursorEnabled||!this.options.focusableCursorEnabled())throw new Error("Previous focusable cursor method will work only when focusableCursorEnabled option is set to true.");{const t=this._getRowByRowMetadata(e);if(t){const e=$(t),i=e.closest(p),o=this._findPreviousFocusableRow(i,e);o&&this._focusRow(o,ko.dataFor(o[0]),$.Event(b))}}return Promise.resolve()}next(e){if(!this.options.focusableCursorEnabled||!this.options.focusableCursorEnabled())throw new Error("Next focusable cursor method will work only when focusableCursorEnabled option is set to true.");{const t=this._getRowByRowMetadata(e);if(t){const e=$(t),i=e.closest(p),o=this._findNextFocusableRow(i,e);o&&this._focusRow(o,ko.dataFor(o[0]),$.Event(b))}}return Promise.resolve()}_findFirstFocusableRow(e){return w(e.find("table.azc-grid-full").eq(0)).first()}_findFocusableRowByPage(e,t){e=e.find("table.azc-grid-full").eq(0);const i=this._getPagedFocusableList(e),o=this._getFocusedItemIndex(e),s=this._widget._itemsPerKeyboardPage(),r=o<s?0:Math.floor(o/s),a=o%s;let n;if(i.length>0)switch(t){case 33:if(0===a&&i[r-1])n=MsPortalFx.first(i[r-1]);else{const e=i[r];n=MsPortalFx.first(e)}break;case 34:if(i[r+1])n=MsPortalFx.first(i[r+1]);else{const e=i[r];n=MsPortalFx.last(e)}}return n?$(n):void 0}_findLastFocusableRow(e){return w(e.find("table.azc-grid-full").eq(0)).last()}_findNextFocusableRow(e,t){const i=w(t?t.closest("table.azc-grid-full"):e.find("table.azc-grid-full").eq(0));let o;if(t){for(o=0;o<i.length;o++)if(t[0]===i[o]&&o<i.length-1)return $(i[o+1])}else if(i.length)return $(i[0]);return null}_findPreviousFocusableRow(e,t){const i=w(t?t.closest("table.azc-grid-full"):e.find("table.azc-grid-full").eq(0));let o;if(t)for(o=i.length-1;o>=0;o--)if(t[0]===i[o]&&o>0)return $(i[o-1]);return null}_focus(e){if(!this.options.disableFocusDistribution){let t;const i=this._widget.element,r=i.hasClass("azc-grid-mousedown"),a="focus"===e.type&&!r,n=s.getModifierKeys(e),l=0===n&&(9===e.which||40===e.which||38===e.which);if(r){const i=$(e.target).closest("tr:not([aria-disabled=true])")[0];i&&(t=this._widget.getRowMetadata(ko.dataFor(i).item),this._focusRow(i,t),0===n&&(e.preventDefault(),e.stopPropagation()))}else if(l||a){const t=i.find(`input, textarea, select, button, a, [tabindex=0], ${g}`).filter(((e,t)=>{const i=$(t);return(i.hasClass(h)||0===i.closest(g).length)&&o.isVisible(i)}));document.activeElement!==t[0]&&t[0]&&!$(t[0]).hasClass(h)?(v(t[0]),e.preventDefault(),e.stopPropagation()):this._focusCurrentlyFocusableRow(e)}}}_focusCurrentlyFocusableRow(e){let t,i;const o=this._widget.element,r=o.find(".azc-grid-row").eq(0),a=s.getModifierKeys(e),n=this._lastTabbableRowMetadata.peek();if(r.length)t=r[0];else if(n&&this._isRowDisplayed(n))t=this._getRowByRowMetadata(n),i=n;else{const e=this._findNextFocusableRow(o,null);t=e&&e.length?e[0]:null}t&&(i=i||this._widget.getRowMetadata(ko.dataFor(t).item),this._focusRow(t,i),0===a&&(e.preventDefault(),e.stopPropagation()))}_focusRow(e,t,i){const o=$(e);let s;const a=this._lastTabbableRowMetadata.peek();a&&a.focused(!1),c(t)?this._lastTabbableRowMetadata(null):(this._lastTabbableRowMetadata(t),t.focused(!0),s={focused:t,target:o},v(o[0]),i&&(this._widget.trigger(b,r.cloneEvent(i,b),s),this._widget.options.events("focus",s)),this._updatePreviousNextFocusableState(o))}_getFocusedItemIndex(e){const t=this._getPagedFocusableList(e);let i;const o=this._widget._itemsPerKeyboardPage();for(let e=0;e<t.length;e++)for(let s=0;s<t[e].length;s++)if(ko.dataFor(t[e][s])===this._lastTabbableRowMetadata.peek()){i=e*o+s;break}return i}_getFocusedRowMetadata(){return this._lastTabbableRowMetadata.peek()}_getRowByRowMetadata(e){return MsPortalFx.find(this._widget.element.find("tbody tr").toArray(),(function(t){return ko.dataFor(t)===e}))}_getRowFocusDataBindAttribute(){return"attr: { tabindex: focused() ? $ctl.$tabIndex() : '-1' }"}_findPreviousAndNextFocusableRow(e,t){const i=w(t?t.closest("table.azc-grid-full"):e.find("table.azc-grid-full").eq(0));let o,s,r;if(t)for(o=i.length-1;o>=0;o--)if(t[0]===i[o]){o>0&&(s=$(i[o-1])),o<i.length-1&&(r=$(i[o+1]));break}return{previous:s,next:r}}_updatePreviousNextFocusableState(e){if(this.options.focusableCursorEnabled&&this.options.focusableCursorEnabled()){const t=e.closest(".azc-grid"),i=this._findPreviousAndNextFocusableRow(t,e);this.options.focusableCursorOptions.hasPreviousFocusRow(!!i.previous),this.options.focusableCursorOptions.hasNextFocusRow(!!i.next)}}_getPagedFocusableList(e){const t=[],i=w(e).toArray(),o=this._widget._itemsPerKeyboardPage();for(;i.length>0;)i.length<=o?t.push(i.splice(0)):t.push(i.splice(0,o));return t}_isRowDisplayed(e){return this._widget.element.find("tbody tr[data-grid-focusable=true]:not([aria-disabled=true])").each(((t,i)=>{if(ko.dataFor(i)===e)return!0})),!1}saveFocus(){if(!this._savedFocusInfo){const e=this._widget.element[0],t=document.activeElement;if(t&&(e===t||$.contains(e,t))){const e=t.closest(".azc-grid-row,.azc-grid"),i=e&&e.classList.contains("azc-grid-row")?e:null,o=i?ko.dataFor(i):null;this._savedFocusInfo={activeElement:t,rowElement:i,rowMetadata:o}}}}restoreFocus(){if(this._savedFocusInfo){const{activeElement:e,rowElement:t,rowMetadata:i}=this._savedFocusInfo;if(this._savedFocusInfo=null,e){const o=document.activeElement;if(o!==e&&(!o||o===document.body)){let o;$.contains(this._widget.element[0],e)?o=e:$.contains(this._widget.element[0],t)?o=t:i&&(o=this._getRowByRowMetadata(i)),o&&!f&&(f=!0,v(o,{preventScroll:!0}).finally((()=>{f=!1})))}}}}}t.FocusableRowExtension=x,x.Name="azc-grid-focusableRow"})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRow",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow"],(function(e,t,i,o,s){"use strict";var r;return function(e){class t extends o.GridExtension{getName(){return"Focusable"}getOrder(){return 0}getExtension(e){return new s.FocusableRowExtension({disableFocusDistribution:!0})}}e.FocusableRowExtension=t,i.defaultPlugins.push(t)}(r||(r={})),r})),
define("_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid1.Formatters.css",["module"],(function(e){"use strict";return{css:".fxc-base.azc-grid .fx-grid-formatters-svg{display:flex;align-items:center;text-overflow:inherit;overflow:inherit}.fxc-base.azc-grid .fx-grid-formatters-svg.fx-grid-svgicon-center{justify-content:center;width:calc(100% + 10px);margin-left:-10px}.fxc-base.azc-grid .fx-grid-formatters-svg .fx-grid-formatters-svgtext{text-overflow:inherit;overflow:inherit}.fxc-base.azc-grid .fx-grid-formatters-svgicon{margin-right:6px;flex-shrink:0;width:12px;height:14px;position:relative}.fxc-base.azc-grid .fx-grid-formatters-icon{display:flex;align-items:center;text-overflow:inherit;overflow:inherit}.fxc-base.azc-grid .fx-grid-formatters-icon .fx-grid-formatters-icon-text{flex:1;min-width:0;text-overflow:inherit;overflow:inherit}",moduleId:e.id}})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Formatter",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters.Helpers","MsPortalImpl/Base/Base.Sanitization","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid1.Formatters.css"],(function(e,t,i,o,s,r,a,n,l){"use strict";var d;return(0,n.injectCss)(l),function(t){var n=FxImpl.Intl.DateTimeFormat,l=MsPortalFx.ViewModels.Controls.Lists.Grid.Format;const d=s.date,c=r.attributeEncode,u=r.callFormatter,h=r.isUndefined;function g(t,i,o){const s=ko.unwrap(i),r=!s||h(s.text)||h(s.uri)?s:s.uri;return a.sanitizeUri(r+"",null,{diContainer:t,localRequire:e,windowContext:o})}class p extends o.GridExtension{getName(){return"Formatter"}getOrder(){return 0}getSafeFormatter(e,t,i){const o=this._widget.element;switch(e){case l.ShortTime:return d(n.shortTimePattern,o);case l.LongTime:return d(n.longTimePattern,o);case l.ShortDate:return d(n.shortDatePattern,o);case l.LongDate:return d(n.longDatePattern,o);case l.MonthDay:return d(n.monthDayPattern,o);case l.YearMonth:return d(n.yearMonthPattern,o);case l.CustomDate:return d(t.dateFormat||"",o);case l.Number:return s.numberFormat(t.numberFormat);case l.TextLookup:return s.textLookup(t.textLookup||{});case l.Icon:return e=>function(e,t,i){return g(e,t,i)?s.icon(t):""}(this._widget._diContainer,e,o);case l.IconLookup:{const e=t.iconLookup||{};for(const t in e)e.hasOwnProperty(t)&&(g(this._widget._diContainer,e[t],o)||delete e[t]);return s.iconLookup(e)}case l.SvgIcon:return b.svgIcon;case l.SvgIconLookup:return b.svgIconLookup(t.svgIconLookup||{});case l.PercentageBar:return s.percentageBar(t.percentageBar||{})}return null}getUnsafeFormatter(e,t,i){switch(e){case l.Html:return s.html;case l.TextLookup:return s.textLookup(t.textLookup||{});case l.Uri:return s.uri}return null}}let b;t.FormatterExtension=p,i.defaultPlugins.push(p),function(e){e.svgIcon=function(e){const t=e=>e&&!h(e.type),i=(e,t,i)=>"<span class='fx-grid-formatters-svgicon' data-bind='"+("image: "+c(ko.toJSON(e)))+(i&&t?', style: { height:"'+c(t)+'", width: "'+c(i)+'" }':"")+"'></span>",o=Array.prototype.slice.call(arguments,1),r=ko.unwrap(e);let a="";r&&!h(r.center)&&r.center&&(a=" fx-grid-svgicon-center");const n="<div class='fx-grid-formatters-svg"+a+"'>";if(r&&!h(r.svg)&&t(r.svg)){let e="";return r.text&&!h(r.text)&&(e="<span class='fx-grid-formatters-svgtext'>"+u(s.text,r.text,o)+"</span>"),n+i(r.svg,r.height,r.width)+e+"</div>"}return t(r)?n+i(r)+"</div>":r&&!h(r.text)?n+"<span class='fx-grid-formatters-svgtext'>"+u(s.text,r.text,o)+"</span></div>":""},e.svgIconLookup=function(t){return(i,...o)=>{let a=ko.unwrap(i);if(!r.isNullOrUndefined(t[a]))return u(e.svgIcon,t[a],o);if(t["##DEFAULT##"]){a=s.text(a);let i=t["##DEFAULT##"];return i.text&&(i=MsPortalFx.extend2(i,{text:i.text.replace(/##DEFAULT##/g,a)})),u(e.svgIcon,i,o)}return""}}}(b=t.Formatters||(t.Formatters={}))}(d||(d={})),d})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SelectableRow.css",["module"],(function(e){"use strict";return{css:'.azc-grid-selectableRow-selectionCell-col{width:26px;max-width:26px}.azc-grid-selectableRow-selectAll{vertical-align:text-top}.azc-grid table th.azc-grid-selectableRow-selectionCell-header{padding-left:5px}.azc-grid table th.azc-grid-selectableRow-selectionCell-header .azc-checkBox{padding:1px;margin:1px}.azc-grid table th.azc-grid-selectableRow-selectionCell-header .azc-checkBox .azc-checkBox-svg{top:4.5px;left:4.5px}.azc-grid table td.azc-grid-selectableRow-selectionCell{padding-left:7px}.azc-grid-selectableRow-selectionCell-wrapper{border-width:1px;border-style:solid;border-radius:2px;box-sizing:border-box;width:18px;height:18px;display:block;transition-property:background-color,border-color;transition-duration:200ms;transition-timing-function:cubic-bezier(.4,0,.23,1)}.azc-grid-selectableRow-selectionCell-wrapper .fx-grid-formatters-svgicon{margin-top:2px;margin-left:2px;position:relative}.azc-grid-selectableRow-selectionCell-wrapper .fx-grid-formatters-svgicon svg{vertical-align:top}.azc-grid-selectableRow:not(.azc-grid-scrollable,.azc-grid-hierarchical) table{height:100%}.azc-grid-selectableRow:not(.azc-grid-scrollable,.azc-grid-hierarchical) table tbody{height:100%}.azc-grid-selectableRow:not(.azc-grid-scrollable,.azc-grid-hierarchical) table tbody tr{height:100%}.azc-grid-selectableRow table thead th.azc-grid-selectableRow-overlay-header{width:0}.azc-grid-selectableRow table tbody tr td.azc-grid-selectableRow-overlay-cell{overflow:visible;padding:0;vertical-align:top;width:0}.azc-grid-selectableRow table tbody tr td.azc-grid-selectableRow-overlay-cell div.azc-grid-selectableRow-overlay-origin{position:relative;overflow:visible;height:100%}.azc-grid-selectableRow table tbody tr td.azc-grid-selectableRow-overlay-cell div.azc-grid-selectableRow-overlay-origin div.azc-grid-selectableRow-overlay-container{position:absolute;top:0;right:0}.azc-grid-selectableRow table tbody tr td:first-of-type{border-left:0}.azc-grid-selectableRow table tbody tr td:last-of-type,.azc-grid-selectableRow table tbody tr td.azc-br-muted:last-of-type{border-right:0}.fxs-mode-light .azc-fabric .azc-grid-row .azc-grid-selectableRow-selectionCell-wrapper{background-color:#fff;border-color:#323130}.fxs-mode-light .azc-fabric .azc-grid-row[aria-selected="true"] .azc-grid-selectableRow-selectionCell-wrapper{background-color:#0078d4;border-color:#0078d4}.fxs-mode-light .azc-fabric .azc-grid-row[aria-selected="true"] .azc-grid-selectableRow-selectionCell-wrapper.azc-fill-text{fill:#fff}.fxs-mode-light .azc-fabric .azc-grid-row[aria-selected="true"] .azc-grid-selectableRow-selectionCell-wrapper:hover{border-color:#005a9e;background-color:#005a9e}.fxs-mode-light .azc-fabric .azc-grid-row[aria-selected="true"] td{border-color:transparent;background-clip:padding-box}.fxs-mode-light .azc-fabric .azc-grid-row[aria-disabled="true"] .azc-grid-selectableRow-selectionCell-wrapper{background-color:transparent;border-color:var(--colorControlBackgroundDisabledSelected)}.fxs-mode-light .azc-fabric .azc-grid-row[aria-disabled="true"] .azc-grid-selectableRow-selectionCell-wrapper:hover{background-color:transparent}.fxs-mode-light .azc-fabric .azc-grid-row[aria-selected="true"][aria-disabled="true"] .azc-grid-selectableRow-selectionCell-wrapper{background-color:var(--colorControlBackgroundDisabledSelected);border-color:var(--colorControlBackgroundDisabledSelected)}.fxs-mode-light .azc-fabric .azc-grid-row[aria-selected="true"][aria-disabled="true"] .azc-grid-selectableRow-selectionCell-wrapper.azc-fill-text{fill:#fff}.fxs-mode-light .azc-fabric .azc-grid-row[aria-selected="true"][aria-disabled="true"] .azc-grid-selectableRow-selectionCell-wrapper:hover{background-color:var(--colorControlBackgroundDisabledSelected)}',moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRow",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.KeyboardHelper","Viva.Controls/Controls/Forms/Viva.CheckBox","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Formatter","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SelectableRow.css","MsPortalImpl/Base/Base.KnockoutExtensions.Image"],(function(e,t,i,o,s,r,a,n,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectableRowExtension=t.RowSelectionMode=t.EventTypes=void 0,(0,d.injectCss)(c);var u=MsPortalFx.Base.Images,h=MsPortalFx.isNullOrUndefined,g=ko.dataFor;const p=window,b="azc-grid-selectableRow",m="tr[data-grid-selectable=true]:not([aria-disabled=true])",f=`tbody ${m}`,w=`${f} td.${b}-selectionCell`,v="11px",x='attr: { "data-grid-selectable": true, "aria-selected": selected() ? "true" : "false" }',_='keyedCss: { grid1RowSelected: { "fxs-portal-selected": selected() }}',C=`keyedCss:{ grid1SelectableRowTable: { "azc-grid-multiselectable": $ctl.getPlugin("${b}")._multiselect, "azc-grid-selectable": $ctl.getPlugin("${b}")._showSelectionExperience }}`,y=`<col class='${b}-selectionCell-col' />`,z=`<th class='${b}-selectionCell-header azc-br-muted' role='presentation'>\x3c!-- ko if: $ctl.getPlugin("${b}")._canSelectAll --\x3e<div class='${`${b}-selectAll`}' data-bind='azcCheckBox: $ctl.getPlugin("${b}")._selectAllCheckbox, attr:{ "aria-label": $ctl.getPlugin("${b}")._ariaLabel }'></div>\x3c!-- /ko --\x3e</th>`,R=`<td class='${b}-selectionCell azc-br-muted' role='presentation'><div class='${b}-selectionCell-wrapper fxs-portal-border azc-fill-text' aria-hidden='true'><div data-bind='trustedHtml: $ctl.getPlugin("${b}")._selectionCellFormat($data)'></div></div></td>`;function k(e){const t=g(e);return t&&t.selected&&!t.selected()}var M,E;!function(e){e.RowSelect="rowSelect",e.RowClick="rowClick"}(M||(t.EventTypes=M={})),function(e){e[e.Off=0]="Off",e[e.Single=1]="Single",e[e.MultipleAdd=2]="MultipleAdd",e[e.MultipleReplace=3]="MultipleReplace",e[e.AlwaysSingle=4]="AlwaysSingle"}(E||(t.RowSelectionMode=E={}));class P extends o.Extension{constructor(e){super(),this._ariaLabel=l.Grid.selectAllCheckboxLabel,this._showSelectionExperience=ko.observable(!1),this._options=e=e||{},e.mode=e.mode||ko.observable(E.Single),e.hideMultiSelectCheckbox=e.hideMultiSelectCheckbox||!1,e.enableSelectableCursor=e.enableSelectableCursor||ko.observable(!1),e.hasPreviousSelectableItem=e.hasPreviousSelectableItem||ko.observable(!1),e.hasNextSelectableItem=e.hasNextSelectableItem||ko.observable(!1),this._enableSelectableCursor=ko.computed(this.ltm,(()=>{this._updateSelectableCursor()}));(this._selectAllCheckbox=new a.ViewModel(this.vmBasicOption)).canUserSetIndeterminate(!1),this._multiselect=ko.pureComputed((()=>{const t=e.mode();return t===E.MultipleAdd||t===E.MultipleReplace})),this._canSelectAll=ko.pureComputed((()=>this._multiselect()&&!e.disableSelectAll&&!this._widget.options.extensionTrigger("shouldNotAllowSelectAll").some((e=>e)))),this._modeSubscription=e.mode.subscribe(this.ltm,(e=>{if(this._widget&&(e===E.AlwaysSingle||e===E.Single)){let t,i,o,s=this.getSelectedRows(),r=s?s.length:0;if(s=this.getSelectedRows(),r=s?s.length:0,r>=1)for(o=1;o<r;o++)s[o].selected(!1);else e===E.AlwaysSingle&&(t=this._widget.options.items(),t&&t.length>0&&(i=this._widget.getRowMetadata(t[0]),i.selected(!0)))}}))}get options(){return this._options}getSelectedRows(){return this._widget._getAllRowMetadata().filter((function(e){return e.selected.peek()}))}getSelectableRows(){return this._widget.options.items().filter((e=>!this._widget.getRowMetadata(e).disabled()))}selectAllRows(){this.selectRows.apply(this,this.getSelectableRows())}unselectAllRows(){this._widget._getAllRowMetadata().forEach((function(e){e.selected(!1)}))}unselectRows(...e){e.forEach((e=>{this._widget.getRowMetadata(e).selected(!1)}))}selectRows(...e){e.forEach((e=>{this._widget.getRowMetadata(e).selected(!0)}))}setInstance(e){super.setInstance(e),this._options.mode.valueHasMutated()}afterCreate(){this._widget.ltm.registerForDispose([this._showSelectionExperience,this._modeSubscription,this._enableSelectableCursor]),this._focusableRowPlugin=this._widget.getPlugin(i.FocusableRowExtension.Name),this._updateSelectableCursor()}afterSetTemplates(e){const t=e.getHtmlTemplate("bodyRowsCore"),i=e.getHtmlTemplate("header"),o=e.getHtmlTemplate("colgroup"),s=e.getHtmlTemplate("table"),r=e.getHtmlTemplate("editableBodyRowsCorePerColumn"),a=e.getHtmlTemplate("editableBodyRowsCoreForRow"),l=!h(r)&&!h(a),d="data-bind";t.addAttribute("tr",d,[x,_]),s.addAttribute("table",d,[C]),ko.reactor(this.ltm,(()=>{const e=this._options.mode(),t=e===E.Off,i=this._options.hideMultiSelectCheckbox,o=e===E.Single||e===E.AlwaysSingle,s=MsPortalFx.find(this._widget.options.extensions,(e=>"azc-grid-activateableRow"===e.getName())),r=!(t||i||o&&s);this._showSelectionExperience(r)})),this._showSelectionExperience()&&(t.prepend("tr",R),i.prepend("tr",z),o.prepend("colgroup",y),l&&(r.prepend("tr",R),a.prepend("tr",R))),l&&(r.addAttribute("tr",d,[x,_]),a.addAttribute("tr",d,[x,_])),this._selectionCellFormatter=n.Formatters.svgIconLookup({true:{svg:u.Check({palette:99}),height:v,width:v}}),ko.reactor(this.ltm,(()=>{if(this._canSelectAll()){let e,t=!0;this._widget.allRowMetadata().forEach((i=>{if(!i.disabled()){const o=i.selected();e=e||o,t=t&&o}}));const i=this._selectAllCheckbox;t&&e?i.value(1):e?i.value(2):i.value(0)}}))}getDefaultRowMetadataProperties(e){return{selected:ko.observable(!1)}}afterAttachEvents(){const e=this;this.ltm.registerForDispose(this._widget.element.setEvents(["click.azcGrid",f,function(t){p.getSelection().toString().trim()||($.contains(e._widget.element[0],this)&&e._onClick(this,t),t.stopPropagation())}],["click.selectionCell",w,function(t){const o=$(this).closest(m)[0],s=e._widget.getPlugin(i.FocusableRowExtension.Name);r.setCtrlOrCommandModifier(t),e._changeSelection(1,o,t,e._multiselect()),s._focusRow(o,g(o)),t.stopPropagation()}],["keydown.azcGrid",function(t){const o=$(t.target),s=o[0],a=g(s),n=a&&a.selected;let l,d;const c=e._widget._itemsPerKeyboardPage(),u=r.getModifierKeys(t),b=r.isCtrlOrCommandOnly(t);let f=!0;if(e._options.mode()!==E.Off&&!i.FocusableRowExtension.isEditableControl(o)){switch(t.which){case 32:if(d=p.document.activeElement,0===u||b&&o.is("tr[data-grid-selectable]")&&(t.target===d||$.contains(o[0],d))){const i=g(o[0]);i&&i.selected&&i.selected()&&r.setCtrlOrCommandModifier(t),e._changeSelection(2,o[0],t)}break;case 65:b?e._canSelectAll()&&e.selectAllRows():f=!1;break;case 68:b?e.unselectAllRows():f=!1;break;case 38:case 40:if(e._multiselect()&&4===u){let i;i=38===t.which?o.prevAll(m)[0]:o.nextAll(m)[0],n&&!n()&&e._changeSelection(3,s,t,!1,!0),h(i)||k(i)&&e._changeSelection(3,i,t,!1,!0)}break;case 33:case 34:if(e._multiselect()&&4===u){let i;i=33===t.which?o.prevAll(m):o.nextAll(m),l=i.length<c-1?i:i.slice(0,c-1),n&&!n()&&e._changeSelection(3,s,t,!1,!0),l.each(((i,o)=>{k(o)&&e._changeSelection(3,o,t,!1,!0)}))}break;case 36:case 35:e._multiselect()&&4===u&&(l=36===t.which?o.prevAll(m):o.nextAll(m),e.unselectAllRows(),n&&!n()&&e._changeSelection(3,s,t,!1,!0),l.each(((i,o)=>{k(o)&&e._changeSelection(3,o,t,!1,!0)})));break;default:f=!1}f&&(t.stopPropagation(),t.preventDefault())}}])),this._selectAllCheckbox.value.subscribe(this._widget.ltm,(e=>{switch(e){case 1:this.selectAllRows();break;case 0:this.unselectAllRows()}}))}getOrder(){return 20}getDependencies(){return[new i.FocusableRowExtension]}getName(){return P.Name}getAdditionalColumns(){let e=0;return this._showSelectionExperience()&&(e+=1),e}_changeSelection(e,t,o,a=!1,n=!1){const l=this.options.mode();let d;const c=!!this.options.disableRequireSingleModeAssistKey&&this.options.disableRequireSingleModeAssistKey.peek(),u=this._widget.getPlugin(i.FocusableRowExtension.Name),h=r.isCtrlOrCommand(o);if(this._widget.options.extensionTrigger("shouldNotChangeSelection",t,o).some((function(e){return!!e})))return;switch(l){case E.Off:return;case E.Single:case E.AlwaysSingle:d=!1;break;case E.MultipleAdd:d=!0;break;case E.MultipleReplace:d=h||o.shiftKey||32===o.which;break;default:throw new Error("Unknown selection mode: "+l+".")}a&&(d=!0);const p=g(t);let b=null,m=[];const f=p.selected&&p.selected();let w,v,x=-1;if(d)f?m=[p]:b=p;else{for(m=this.getSelectedRows(),v=m.length-1;v>=0;v--){m[v]!==p||(x=v)}x<0?b=p:l===E.Single&&(c||h||o.shiftKey)||(l===E.Single?(m.splice(x,1),b=p):m.splice(x,1))}(b||m.length>0)&&(w={selected:b,unselected:m,_reason:e},this._widget.trigger("beforeRowSelect",s.cloneEvent(o,"beforeRowSelect"),w),m.forEach((e=>{e.selected(!1)})),b&&b.selected&&(b.selected(!0),n&&u.focusRowByRowMetadata(b)),this._widget.trigger(M.RowSelect,s.cloneEvent(o,M.RowSelect),w),this._widget.options.events("select",w))}previous(){if(!this.options.enableSelectableCursor())throw new Error("Previous selectable cursor method will work only when enableSelectableCursor option is set to true.");return this._focusableRowPlugin.previous(this.getSelectedRows()[0]),Promise.resolve()}next(){if(!this.options.enableSelectableCursor())throw new Error("Next selectable cursor method will work only when enableSelectableCursor option is set to true.");return this._focusableRowPlugin.next(this.getSelectedRows()[0]),Promise.resolve()}_updateSelectableCursor(){if(this._widget){const e=this._widget.getPlugin(i.FocusableRowExtension.Name);if(this._options.enableSelectableCursor()){if(e.options.focusableCursorEnabled=this._options.enableSelectableCursor,e.options.focusableCursorOptions={hasPreviousFocusRow:this.options.hasPreviousSelectableItem||ko.observable(!1),hasNextFocusRow:this.options.hasNextSelectableItem||ko.observable(!1)},!this._rowFocusLifetime){(this._rowFocusLifetime=this.ltm.createChildLifetime()).registerForDispose(this._widget.element.setEvents(["rowFocus.azcGrid",(e,t)=>{const i=this.getSelectedRows();i&&i.length>0&&($(t.target[0]).click(),e.stopPropagation())}]))}}else this._options.hasPreviousSelectableItem(!1),this._options.hasNextSelectableItem(!1),e.options.focusableCursorEnabled(!1),e.options.focusableCursorOptions.hasPreviousFocusRow(!1),e.options.focusableCursorOptions.hasNextFocusRow(!1),this._rowFocusLifetime&&this._rowFocusLifetime.dispose()}}_onClick(e,t){const i={item:e,rowMetadata:g(e),clientX:t.clientX,clientY:t.clientY};this._widget.trigger(M.RowClick,s.cloneEvent(t,M.RowClick),i,t.target),this._widget.options.events(M.RowClick,i),this._changeSelection(4,e,t)}_selectionCellFormat(e){let t;return this._showSelectionExperience()&&(t=this._selectionCellFormatter(e.selected())),t}computeLeftMarginWidth(){return this._showSelectionExperience()?26:0}}t.SelectableRowExtension=P,P.Name=b})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SelectableRowActivate.css",["module"],(function(e){"use strict";return{css:'.azc-grid-activateableRow tr.azc-grid-row:not([aria-disabled="true"]) td[data-activatable="true"],.azc-grid-activateableRow .azc-grid-activateonselected tr.azc-grid-row:not([aria-disabled="true"]),.azc-grid-link{cursor:pointer}',moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRowActivate",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRow","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","MsPortalImpl/Base/Base.KeyboardHelper","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SelectableRowActivate.css"],(function(e,t,i,o,s,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectableRowActivateExtension=t.windowOpen=void 0,(0,a.injectCss)(n);var l=MsPortalFx.isNullOrUndefined,d=i.RowSelectionMode;const c="keypress.",u="azcActivation",h="azc-grid-virtualFocus",g="tbody tr[data-grid-activateable=true]",p=g+":not([aria-disabled=true])",b=p+" [data-activatable=true]",m=p+", "+b,f=MsPortalFx.disposeDisposable;t.windowOpen=function(e,t){window.open(e,t)};class w extends s.Extension{constructor(e){super(),this._disposables=[],this._options=e=e||{},this._activatedColumnKey=e.activatedColumnKey||ko.observable(),this._primaryActivateColumnKey=e.primaryActivateColumnKey||ko.observable(),this._activateOnSelected=e.activateOnSelected||ko.observable(!1),this._activatedRow=null,this._selfActivation=!1}get options(){return this._options}getActivatedRows(){return this._widget._getAllRowMetadata().filter((function(e){return!l(e.activated.peek())}))}afterSetTemplates(e){const t="data-bind",i=['attr: { "data-grid-activateable": "true", "data-grid-row-activated": activated() ? "true" : "false" }','keyedCss: { grid1SelectableRowActivatedBodyRow: { "azc-grid-link": !$disabled() && link() && link().uri }}','keyedCss: { grid1SelectableRowActivated: { "fxs-portal-selected fxs-portal-activated": activated() }}'];e.getHtmlTemplate("bodyRowsCore").addAttribute("tr",t,i);e.getHtmlTemplate("bodyCell").addAttribute("td",t,['attr: { "data-activatable": activatable(), "data-grid-cell-activated": $parent.activated() === $data.itemKey ? "true" : "false" }']);e.getHtmlTemplate("table").addAttribute("table",t,['keyedCss:{ grid1SelectableRowActivateTable: { "azc-grid-activateonselected": $ctl.getPlugin("azc-grid-activateableRow")._activateOnSelected }}'])}getDefaultRowMetadataProperties(e){return{activated:ko.observable(null),activatedInfo:ko.observable(null),link:ko.observable(null),useDefaultActivation:ko.observable(!0)}}getDefaultColumnProperties(){return{activatable:ko.observable(!!this.options.activateRow)}}afterAttachEvents(){const e=this;this._disposables.push(this._widget.element.setEvents(["click.azcActivationCell",b,function(t){window.getSelection().toString().trim()||e._handleActivationKeyPressOrClick(t,this)}],[c+"azcActivationRow","tbody tr[data-grid-activateable=true]:not([aria-disabled=true])",function(t){e._handleActivationKeyPressOrClick(t,this)}],[c+"azcActivationCell",b,function(t){e._handleActivationKeyPressOrClick(t,this),t.stopPropagation()}],["rowSelect."+u,function(t,i){e._onRowSelect(t,i)}],["focus."+u,m,e=>{$(e.currentTarget).closest(g).addClass(h)}],["blur."+u,m,e=>{$(e.currentTarget).closest(g).removeClass(h)}],["beforeRowSelect."+u,(e,t)=>{this._onBeforeRowSelect(e,t)}]))}afterCreate(){const e=this._widget.ltm,t=this._widget.options;this._selectableRowExtension=this._widget.getPlugin(i.SelectableRowExtension.Name),this._widget._getAllRowMetadata().filter((function(e){return!l(e.activated.peek())&&e.selected.peek()})).forEach((function(e){e.activated(null)})),ko.computed(e,(()=>{const e=t.columns();e&&e.length>0?this._firstColumnKey=e[0].itemKey:this._firstColumnKey=null})),t.items.map(e,((e,t)=>{const i=this._widget.getRowMetadata(t);let o=!1;i.selected.subscribe(e,(e=>{const t=this._activateOnSelected();if(e&&t)this._activateRow(i);else if(t&&!o)try{o=!0,i.activated(null)}finally{o=!1}})),i.activated.subscribe(e,(e=>{if(!l(e)){if(!o&&!this._selfActivation)try{o=!0,this._activateOnSelected()&&i.selected(!0),this._activatedColumnKey.peek()!==e&&this._activatedColumnKey(e)}finally{o=!1}this._activatedRow=i}}))})),ko.computed(e,(()=>{this._widget.element.toggleClass("azc-grid-selectionActivates",this._activateOnSelected())})),this._widget._getAllRowMetadata().forEach((e=>{e.activated()&&(this._activatedRow=e,this._activateOnSelected()&&e.selected(!0))}))}getOrder(){return 40}getDependencies(){return[new i.SelectableRowExtension(this.options)]}beforeDestroy(){f(this._disposables),this._disposables=[]}getName(){return w.Name}shouldNotAllowSelectAll(){return this._activateOnSelected()}shouldNotChangeSelection(e,t){const i=this.options,o=i.mode?i.mode():d.Off,s=o===d.MultipleAdd||o===d.MultipleReplace,a=r.isCtrlOrCommandOnly(t);if(i.activateRow&&s&&!i.hideMultiSelectCheckbox&&"click"===t.type&&"true"===$(t.target).closest("td").attr("data-activatable"))return!0;if(o===d.MultipleReplace){if("true"===$(e).attr("aria-selected")&&!t.shiftKey&&!a){const i=$(t.target),o="true"===i.attr("data-activatable")?i:i.closest("[data-activatable=true]");if(o.length>0&&$.contains(e,o[0]))return!0}}else if(o===d.Single||o===d.AlwaysSingle)return a||t.shiftKey;return!1}previous(){return this._selectableRowExtension.previous()}next(){return this._selectableRowExtension.next()}_changeActivation(e,t){const i=this.options,s=ko.dataFor(e),a=$(t.currentTarget),n=a.closest(".azc-grid-cell"),l=$(e).find(".azc-grid-cell"),c=n[0]?n:l,u=ko.dataFor(c[0]),h=s.selected.peek(),g=s.activated.peek();let p=!1;const b=u.itemKey;if(h&&(r.isCtrlOrCommand(t)||t.shiftKey)&&g===b&&(p=!0),!i.activateRow&&!h&&"keypress"===t.type){const i=o.cloneEvent(t,"keydown");i.which=32,$.extend(i,{which:32,target:e,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey}),$(e).trigger(i),t.stopPropagation(),t.preventDefault()}p||this._activatedColumnKey(b);const m=this._activatedRow;if(null!==m&&m!==s&&m.activated(null),null!==s)if(i.activateRow)s.activated()||i.activateRow(s);else{const e=s.useDefaultActivation;if(!e||e())try{this._selfActivation=!0;const e=i.mode()!==d.MultipleAdd||!(s.activated()!==b&&s.selected());this._activatedColumnKey(b),s.activated(b),e||t.stopPropagation()}finally{this._selfActivation=!1,a.trigger("fxensurebladevisible",{})}}}_handleActivationKeyPressOrClick(e,t){const i=r.isCtrlOrCommand(e);if("keypress"!==e.type||13===e.which&&!i||10===e.which&&i||32===e.which&&!this.options.activateRow){const i=$(t).closest("tr[data-grid-activateable=true]");i.length>0&&this._changeActivation(i[0],e)}}_onBeforeRowSelect(e,t){if(this._activateOnSelected()){const e=t&&t.selected,i=e&&e.selected;i&&i()&&this._activateRow(e)}}_onRowSelect(e,i){const o=i.selected;if(o){const e=o.link&&o.link();if(e){const i=e.uri;i&&((0,t.windowOpen)(i,e.target),this._selectableRowExtension.unselectAllRows())}}}_activateRow(e){this._lastActivatedRow&&this._lastActivatedRow.activated(null),this._lastActivatedRow=e;let t=this._activatedColumnKey();l(t)&&(t=this._primaryActivateColumnKey()||this._firstColumnKey),l(t)||e.activated()===t||e.useDefaultActivation&&!e.useDefaultActivation()||e.activated(t)}}t.SelectableRowActivateExtension=w,w.Name="azc-grid-activateableRow"})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SelectableRow",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRow","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRowActivate","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl/Base/Base.KeyboardHelper"],(function(e,t,i,o,s,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectableRowExtension=void 0;var d=MsPortalFx.ViewModels.Controls.Lists.Grid,c=r.RowSelectionMode,u=MsPortalFx.isNullOrUndefined;class h extends s.GridExtension{constructor(){super(...arguments),this._lifetime=new FxImpl.TriggerableLifetimeManager}beforeDestroy(){this._lifetime.dispose()}getExtension(e){const t=e,i=ko.observable(c.Off),o=t&&t.selectableRow;let s,r,n;if(o){switch(o.selectionMode||0){case 1:i(c.Single);break;case 2:i(c.MultipleReplace);break;case 3:i(c.MultipleAdd);break;default:i(c.Off)}this._activatedColumnKey=o.activatedColumnKey,this._primaryActivateColumnKey=o.primaryActivateColumnKey,this._activateOnSelected=o.activateOnSelected,s=o.disableRequireSingleModeAssistKey,r=o.enableSelectableCursor||ko.observable(!1)}return this._activatedColumnKey||(this._activatedColumnKey=ko.observable()),this._primaryActivateColumnKey||(this._primaryActivateColumnKey=ko.observable()),this._activateOnSelected||(this._activateOnSelected=ko.observable(!1)),t.onRowClicked&&(n=e=>{const t=this._selectable2ClickHandler;t&&t.onClick({item:e.item,metadata:e})}),new a.SelectableRowActivateExtension({mode:i,disableSelectAll:o.disableSelectAll,activatedColumnKey:this._activatedColumnKey,primaryActivateColumnKey:this._primaryActivateColumnKey,activateOnSelected:this._activateOnSelected,disableRequireSingleModeAssistKey:s,enableSelectableCursor:r,hasNextSelectableItem:ko.observable(!1),hasPreviousSelectableItem:ko.observable(!1),activateRow:n})}getActivatedColumnKey(){return this._activatedColumnKey.peek()||this._primaryActivateColumnKey.peek()}initializeExtension(){const e=this._widget,t=e.options.extensionsOptions,i=this._lifetime;let o,s;const a=t.onRowClicked;if(a){(this._selectable2ClickHandler=n.getListSelectableWithClickHandler(e._diContainer,e.options.selectableData,$(e.element),a)).activationState.subscribe(i,(e=>{const t=e.previous&&e.previous.metadata&&e.previous.metadata.activated;t&&t(null);const i=e.current&&e.current.metadata,o=i&&i.activated;!i||i.useDefaultActivation&&!i.useDefaultActivation()||o(this.getActivatedColumnKey())}))}const d=e._instance.element;d.on(r.EventTypes.RowSelect,o=(e,i)=>{e.stopPropagation();const o=t.selectableRow.rowSelect;o&&o(e,i)}),i.registerForDispose((()=>{d.off(r.EventTypes.RowSelect,o)})),d.on(r.EventTypes.RowClick,s=(t,i)=>{const o=$(t.target),s=i.rowMetadata,r=o.closest("a");if(!(r&&$(i.item).find(r).length>0)){if(1===e.options.extensionsOptions.selectableRow.selectionMode&&(l.isCtrlOrCommandOnly(t)||t.shiftKey)){t.stopPropagation(),t.preventDefault();const i=e.options.selectableData;$(t.target).trigger("fxopeninnewtab",{selectableSet:i,item:s.item})}}}),i.registerForDispose((()=>{d.off(r.EventTypes.RowClick,s)}))}getName(){return"Selectable"}getOrder(){return 1}getDependencies(){return[new o.FocusableRowExtension]}registerSubscriptionsToConnectMetadataProperties(e,t){const i=e.createChildLifetime();return this._widget.options.selectableData.selectableItems.subscribe(i,(e=>{this._widget._connectMetadataAndDisposeSubscriptions(i,t)})),i}disallowConnectRowMetadataProperties(e,t){let i=-1;const o=this._widget.options;if(o.selectableData.selectableItems().some(((e,o)=>e.data===t.item&&(i=o,!0))),i>=0){let t=-1;return o.items().some(((i,o)=>i===e&&(t=o,!0))),-1!==t&&i!==t}return!0}connectRowMetadataProperties(e,t,i){const o=this._widget,s=o.ltm.createChildLifetime(),r=MsPortalFx.find(o.options.selectableData.selectableItems(),(t=>t.data===e)),a=t,n=i;function l(e,t){o._twoWayBinding(s,e,t)}n.link&&a.link&&l(n.link,a.link),l(r.isSelected,t.selected),l(t.selected,n.selected);const d=ko.computed(s,{read:function(){const e=n.activated();return!(null==e)},write:e=>{if(e){if(!n.activated()){let e=this.getActivatedColumnKey();if(u(e)){const t=MsPortalFx.find(o.options.columns(),(e=>e.activatable&&e.activatable()));e=u(t)?null:t.itemKey}u(e)||n.activated(e)}}else n.activated(null)}});return l(t.activated,n.activated),l(r.isActivated,d),l(t.disabled,n.disabled),l(t.useDefaultActivation,n.useDefaultActivation),s}}t.SelectableRowExtension=h,i.registerPlugin(d.Extensions.SelectableRow,h)})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.RightClickableRow",["require","exports","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1"],(function(e,t,i,o){"use strict";var s;return function(e){const t=MsPortalFx.disposeDisposable;class s extends o.Extension{constructor(e){super(),this._disposables=[],void 0===(e=this._options=e||{}).disabled&&(e.disabled=ko.observable(!1))}get options(){return this._options}afterAttachEvents(){const e=this._options,t=this._widget,o="rowRightClick";this._disposables.push(t.element.setEvents(["fxcontextmenurequest.azcGrid","tbody[class!=azc-grid-empty] tr",function(s){let r;if(e.disabled())return;const a=ko.dataFor(this);!a||a.disabled&&a.disabled.peek()||a.canShowMenu&&!a.canShowMenu.peek()||(r={rowMetadata:a,clientX:s.clientX,clientY:s.clientY},t.trigger(o,i.cloneEvent(s,o),r,s.target),t.options.events(o,r))}],["keydown.azcGrid",function(e){if(121===e.which)if(e.shiftKey){const s=$(e.target).closest("tr")[0],r=ko.dataFor(s);if(r&&(!r.disabled||!r.disabled.peek())&&(!r.canShowMenu||r.canShowMenu.peek())){const a=$(s).offset(),n={rowMetadata:r,clientX:a.left+s.offsetWidth-232,clientY:a.top+10};t.trigger(o,i.cloneEvent(e,o),n,e.target),t.options.events(o,n),e.preventDefault(),e.stopPropagation()}}}]))}beforeDestroy(){t(this._disposables),this._disposables=[]}getName(){return s.Name}}s.Name="azc-grid-rightClickableRow",e.RightClickableRowExtension=s}(s||(s={})),s})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.RightClickableRow",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SelectableRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.RightClickableRow","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow"],(function(e,t,i,o,s,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RightClickableRowExtension=void 0;var n=MsPortalFx.ViewModels.Controls.Lists.Grid;class l extends s.GridExtension{beforeDestroy(){this._rightClickHandler&&(this._widget._instance.element.off("rowRightClick",this._rightClickHandler),this._rightClickHandler=null)}getExtension(e){return new r.RightClickableRowExtension}initializeExtension(){this._widget._instance.element.on("rowRightClick",this._rightClickHandler=(e,t)=>this._triggerRightClickEvent(e,t))}getName(){return"RightClickableRow"}getOrder(){return 1}getDependencies(){return[new o.SelectableRowExtension]}_triggerRightClickEvent(e,t){const i=this._widget,o=i.options,s=o.selectableData,r=t.rowMetadata;if(r&&r.item){if(this._updateSelectionFollowingRightClick(r),o.disabled()||r.disabled()||i._extensionTrigger("shouldHideContextMenu",r).some((function(e){return!!e})))return!1;const a=$.Event("rightclick",{target:e.target,clientX:t.clientX,clientY:t.clientY});return $(e.target).trigger(a,this._getCommandRightClickEventArgs(s,r.item)),e.preventDefault(),e.stopPropagation(),!0}return!1}_updateSelectionFollowingRightClick(e){if(!e.selected()){const t=this._widget,i=t.options;if(!i.disabled()){const o=i.selectableData.selectableItems();o.forEach((e=>{e.isSelected(!1)}));const s=MsPortalFx.find(o,(i=>!t.getRowMetadata(i.data).disabled()&&i.data===e.item));s&&(s.isSelected(!0),t._instance.getPlugin(a.FocusableRowExtension.Name).focusRowByRowMetadata(e,!0))}}}_getCommandRightClickEventArgs(e,t){const i=this._widget,o=e.selectableItems().filter((e=>e.isSelected())).map((e=>e.data)),s=o[0],r=i.getRowMetadata(t);let a,n;if(s){a=ko.unwrap(s.commandGroup),n=ko.unwrap(s.commandGroupOwner);o.some((e=>ko.unwrap(e.commandGroup)!==a||ko.unwrap(e.commandGroupOwner)!==n))&&(a=null,n=null)}const l={selectableSet:e,deleteRowCommandTitle:null,markForDelete:null};i._extensionTrigger("enableRowDelete",r).some((function(e){return!!e}))&&i._extensionTrigger("getListDataForRightClick",r).forEach((function(e){$.extend(l,e)}));return{entityType:1,commandGroup:a,commandGroupOwner:n,viewModel:t,listData:l}}}t.RightClickableRowExtension=l,i.registerPlugin(n.Extensions.RightClickableRow,l)})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ContextMenuShortcut.css",["module"],(function(e){"use strict";return{css:".azc-grid-contextMenuShortcut .azc-grid-contextMenuShortcut-col{width:32px}.azc-grid-contextMenuShortcut table tbody tr td.azc-grid-contextMenuShortcut-cell{padding:0 4px 0 0;text-align:center}.azc-grid-contextMenuShortcut table tbody tr td.azc-grid-contextMenuShortcut-cell a{display:inline-block;box-sizing:border-box;height:24px;width:24px;padding-top:4px}.azc-grid-contextMenuShortcut table tbody .azc-row-disabled .azc-grid-contextMenuShortcut-cell svg{display:none}.fxs-mode-light .azc-fabric .azc-grid-contextMenuShortcut-cell .azc-grid-ellipsis-svg{fill:#605e5c}",moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ContextMenuShortcut",["require","exports","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRow","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ContextMenuShortcut.css"],(function(e,t,i,o,s,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMenuShortcutExtension=void 0,(0,a.injectCss)(n);const l=`<td role='gridcell' class='azc-grid-contextMenuShortcut-cell azc-br-muted'><a class='azc-grid-ellipsis-svg msportalfx-inherit-color fxs-portal-svg' role='button' title='${i.ContextMenu.ariaLabel}' aria-label='${i.ContextMenu.ariaLabel}' data-bind='attr: { tabindex: focusIndex, "aria-disabled": $disabled }, visible: canShowMenu'><svg xmlns="http://www.w3.org/2000/svg" focusable="false" height="16" width="16" viewBox="0 0 16 16"><circle cx="14.4" cy="7.6" r="1.6"/><circle cx="8" cy="7.6" r="1.6"/><circle cx="1.6" cy="7.6" r="1.6"/></svg></a></td>`;class d extends r.Extension{constructor(e){super(),this._options=e||{}}get options(){return this._options}afterSetTemplates(e){const t=e.getHtmlTemplate("bodyRowsCore"),i=e.getHtmlTemplate("header"),o=e.getHtmlTemplate("colgroup"),s=e.getHtmlTemplate("editableBodyRowsCorePerColumn");t.addAttribute("tr","data-bind",['attr: { "data-grid-contextmenushortcut": true }']).append("tr",l),i.append("tr","<th aria-hidden='true' class='azc-grid-contextMenuShortcut-header azc-br-muted'></th>"),o.append("colgroup","<col class='azc-grid-contextMenuShortcut-col' />"),MsPortalFx.isNullOrUndefined(s)||s.append("tr",l)}afterAttachEvents(){const e=this._widget,t=function(t){const i=$(t.target),o=i.offset(),r=i.closest("tr")[0],a=ko.dataFor(r);if(a&&!a.disabled()&&!e.$disabled()){const i={rowMetadata:a,clientX:o.left,clientY:o.top},n="rowContextMenuShortcutClick";e.trigger(n,s.cloneEvent(t,n),i,t.target??r),e.options.events(n,i)}t.preventDefault()};this._widget.ltm.registerForDispose([this._widget.element.setEvents(["click.azcGridContextMenuShortcut","tbody tr[data-grid-selectable=true]:not([aria-disabled=true]) .azc-grid-contextMenuShortcut-cell a",t],["keydown.azcGridContextMenuShortcut","tbody tr[data-grid-selectable=true]:not([aria-disabled=true]) .azc-grid-contextMenuShortcut-cell a",e=>{32!==e.which&&13!==e.which||(t(e),e.stopPropagation(),e.preventDefault())}])])}getOrder(){return 40}getDependencies(){return[new o.SelectableRowExtension]}beforeDestroy(){this._detachEvents&&this._detachEvents()}getName(){return d.Name}shouldNotChangeSelection(e,t){const i=$(t.target),o="true"===i.closest("tr").attr("aria-selected"),s=!!i.closest(".azc-grid-contextMenuShortcut-cell").length;return!(!o||!s)}getAdditionalColumns(){return 1}computeRightMarginWidth(){return 32}getDefaultRowMetadataProperties(e){return{canShowMenu:ko.observable(!0)}}}t.ContextMenuShortcutExtension=d,d.Name="azc-grid-contextMenuShortcut"})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ContextMenuShortcut",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.RightClickableRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ContextMenuShortcut"],(function(e,t,i,o,s,r){"use strict";var a;return function(e){var t=MsPortalFx.ViewModels.Controls.Lists.Grid;class a extends s.GridExtension{beforeDestroy(){this._onClick&&(this._widget._instance.element.off("rowContextMenuShortcutClick",this._onClick),this._onClick=null)}getExtension(e){return new r.ContextMenuShortcutExtension}initializeExtension(){this._widget._instance.element.on("rowContextMenuShortcutClick",this._onClick=(e,t)=>{const i=this._widget.getPlugin("RightClickableRow");return!!i&&i._triggerRightClickEvent(e,t)})}getName(){return"ContextMenuShortcut"}getOrder(){return 1}getDependencies(){return[new o.RightClickableRowExtension]}connectRowMetadataProperties(e,t,i){ko.utils.twoWayBinding(this._widget.ltm.createChildLifetime(),i.canShowMenu,t.canShowMenu)}}e.ContextMenuShortcutExtension=a,i.registerPlugin(t.Extensions.ContextMenuShortcut,a)}(a||(a={})),a})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.EditableRow.css",["module"],(function(e){"use strict";return{css:".azc-grid-editableRow .azc-grid-editableRow-edited td:first-child{box-shadow:inset 3px 0 0 0 #c84fd7}.azc-grid-editableRow .azc-grid-editableRow-deleted{display:none}.azc-grid-editableRow .azc-grid-cell-hidden{display:none}.azc-grid-editableRow .azc-placeholdercell{display:none}.azc-grid-editableRow tr.azc-grid-editing .azc-placeholdercell{display:table-cell}.azc-grid-editableRow tr.azc-grid-editing .azc-grid-cell-editing+.azc-placeholdercell{display:none}",moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.EditableRow",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRow","Viva.Controls/Util/Viva.Util","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.EditableRow.css","Fx"],(function(e,t,i,o,s,r,a,n,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditableRowExtension=void 0,(0,d.injectCss)(c);var h=MsPortalFx.isNullOrUndefined;const g="azc-grid-selectableRow",p=".azc-grid-row",b=p+":not([aria-disabled=true])",m="tbody.azc-grid-groupdata",f="azc-grid-editableRow",w="azc-grid-editableRow-row",v="azc-grid-editableRow-addSection",x="."+v+" "+("."+w),_="azc-grid-editableRow-placement-top",C="azc-br-top-hovered",y="azc-br-bottom-hovered";function z(e){const t=$(e).parent();let i;return i=t.hasClass(_)?t.siblings(m).find(p).first():t.siblings(m).find(p).last(),i.find("td.azc-grid-cell")}function R(e){const t=$(e);return!t.find(".azc-validatableControl-invalid").length&&!t.find(".azc-validatableControl-pending").length}function k(e){return!!$(e).find(".azc-validatableControl-pending").length}function M(e,t){R(e)?t.resolve(!0):k(e)?setTimeout((()=>{M(e,t)}),50):t.resolve(!1)}function E(e){const t=Promise.withResolvers();return M(e,t),t.promise}function P(e){const t=$(e),i=t.find("input, select, textarea").serializeArray();return{rowMetadata:ko.dataFor(e),data:i,existingItem:!t.parent(`tbody.${v}`).length}}class F extends o.Extension{constructor(e){super(),this._isDisposed=!1,this._options=e=e||{},e.placement=e.placement||0,this._createdItems=ko.observableArray(),this._createdItems.subscribeArrayDeletes(this.ltm,(e=>{this._widget.getPlugin(i.FocusableRowExtension.Name).handleRemovedRow(e)})),this._orderedCreatedItems=ko.computed(this.ltm,(()=>{const e=this._createdItems();if(e.length<=1)return e;const t=e.slice(),i=MsPortalFx.findIndex(t,(e=>{const t=this._widget.getRowMetadata(e);return t&&t.emptyRow()}));if(-1!==i&&i!==t.length-1){const e=t.splice(i,1);t.push(e[0])}return 1===this.options.placement&&t.reverse(),t}))}get options(){return this._options}get createdItems(){return this._createdItems}afterSetTemplates(e){const t=`<tbody role='rowgroup' class='${v}' data-bind='css: { "${_}": $ctl.getPlugin("${f}").options.placement === 1 }'>\x3c!-- ko template: { name: 'bodyRows', foreach: $ctl.getPlugin("${f}")._orderedCreatedItems } --\x3e\x3c!-- /ko --\x3e</tbody>`,i=`css: { "azc-grid-editableRow-edited": $ctl.getPlugin("${f}")._isRowEdited($data), "azc-grid-editableRow-deleted": $ctl.getPlugin("${f}")._isRowDeleted($data), "fxs-suppresschildvalidation": $data.emptyRow }`,o=`<td role='gridcell' aria-readonly='false' data-bind='trustedHtml: $ctl.getPlugin("${f}")._editableCellFormat($parent, $data), keyedCss: { grid1EditableRowEditableBodyCellPerCol: ($parent.editing() ? "azc-grid-cell" : "azc-grid-cell-hidden") + " azc-br-muted azc-grid-cell-editing " + cssClass}, attr: { "aria-describedby": columnId, "aria-colindex" : $index() + 1 }'></td>`,s='<td role=\'gridcell\' data-bind=\'template: { name: "bodyCellContent" }, css: { "azc-collapsed-hidden": $data.hiddenInCollapsed }, keyedCss:{ grid1EditableRowCell: (!$parent.editing() ? "azc-grid-cell" : "azc-grid-cell-hidden") + " azc-br-muted " + cssClass + (itemKey === "infoBalloon" ? "azc-grid-infoBalloon" : "")}, attr: { "aria-describedby": columnId, "aria-label": $ctl._getCellAriaLabel($parent, $data) && $parent.cellAriaLabels[itemKey](), "aria-colindex" : $index() + 1 }\'></td>';e.setTemplate("editablePlaceholderBodyCell",s);const r="\x3c!-- ko if: $parent._rendered --\x3e"+o+'\x3c!-- /ko --\x3e<td role=\'gridcell\' data-bind=\'template: { name: "bodyCellContent" }, css: { "azc-collapsed-hidden": $data.hiddenInCollapsed }, keyedCss:{ grid1EditableRowPlaceHoder: " azc-placeholdercell azc-br-muted " + cssClass + (itemKey === "infoBalloon" ? "azc-grid-infoBalloon" : "")}, attr: { "aria-describedby": columnId, "aria-label": $ctl._getCellAriaLabel($parent, $data) && $parent.cellAriaLabels[itemKey](), "aria-colindex" : $index() + 1 }\'></td>'+s;e.setTemplate("bodyCell",r);const a=e.getHtmlTemplate("bodyRowsCore");a.addAttribute("tr","data-bind",[i]),a.addAttribute("tr","data-bind",[`css: {'azc-grid-editing': editing, ${w}: editing }`]);const n=e.getTemplate("body");e.setTemplate("body",1===this.options.placement?t+n:n+t)}getDefaultRowMetadataProperties(e){const t=ko.observable(!1),o=ko.observable(!1);t.fxAwaitAndRun(this._widget.ltm).then(o);const s={editState:ko.observable(0),editing:t,validationResult:ko.observable(0),emptyRow:ko.observable(!1),_addedOnce:!1,_rendered:o};return s.editState.subscribe(this.ltm,(t=>{3===t&&this._widget.getPlugin(i.FocusableRowExtension.Name).handleRemovedRow(e.item)})),s}modifyRowNumber(){const e=this._widget._getAllRowMetadata().filter((e=>3===e.editState())).length;return this.createdItems().filter((e=>!this._widget.getRowMetadata(e).emptyRow())).length-e}afterAttachEvents(){const e=ko.observable();let t=!1,i=!1,o=!1;const n=this,d=this._widget,c=d.element,p=this.ltm;function m(i){if(!o&&!d.$disabled()){const g=this,p=ko.dataFor(g),b=$(g),m=!!b.closest(`tbody.${v}`).length,f=d.getPlugin(s.SelectableRowExtension.Name),w=p;let x,_,C,y,z,R=i.clientX,k=i.clientY;if(!p.editing.peek()&&(n.options.allowEditExistingItems&&!m||n.options.allowEditCreatedItems&&m)){(h(R)||h(k))&&(z=$(i.target).position(),R=z.left,k=z.top),_=this;do{_=_.previousSibling}while(null!==_&&ko.dataFor(_)!==p.item);if(p.editing(!0),_){do{_=_.nextSibling}while(null!==_&&"tr"!==_.nodeName.toLowerCase());_&&(i.target=_,y=_,function(e){const t=Date.now()+200;return function i(){return Promise.all([a.waitForBindings(e),u.delay(20)]).then((()=>{if(Date.now()<t)return i()}))}()}(c[0]).then((function(){if(!n._isDisposed){for(x=document.elementFromPoint(R,k);x;){if(x=r.findContainingControl(x),$.contains(y,x)){if(x&&r.executeSetFocusOn(x)){try{t=!0,o=!0,e(y),C=r.cloneEvent(i,"click"),C.clientX=R,C.clientY=k,$(document.activeElement).trigger(C)}finally{t=!1,o=!1}break}break}break}e.peek()!==y&&e(y)}})),w.selected&&(f._changeSelection(4,y,i),i.stopPropagation(),i.preventDefault()))}else $.contains(g,document.activeElement)||a.waitForBindings(d.element[0]).then((function(){if(!n._isDisposed){for(x=document.elementFromPoint(R,k);x&&(x=r.findContainingControl(x),$.contains(g,x));)if(x&&r.executeSetFocusOn(x)){try{t=!0,e(b[0])}finally{t=!1}break}e.peek()!==b[0]&&e(b[0])}}))}else!p.emptyRow()&&p.editing.peek()&&w.selected&&l.isCtrlOrCommandOnly(i)&&"click"===i.type&&p.editing(!1)}}p.registerForDispose(c.setEvents(["mouseenter",x,function(e){c.hasClass(g)&&z(this).addClass(0==($(this).parent().hasClass(_)?0:1)?C:y)}],["mouseleave",x,function(e){c.hasClass(g)&&z(this).removeClass(C+" "+y)}],["focusout",`tr.${w}`,function(e){if(!i){const e=this,t=ko.dataFor(e);t&&t.editing&&t.editing.peek()&&setTimeout((()=>{const t=document.activeElement,o=()=>{try{i=!0,n._rowAdd(e)}finally{i=!1}};e===t||$.contains(e,t)||(k(e)?E(e).then((e=>{e&&o()})):o())}),10)}}],["keyup",b,function(e){switch(e.which){case 38:case 40:case 36:case 35:case 33:case 34:case 9:ko.dataFor(this).editing(!0),m.apply(this,[e])}}],["click",b,m])),e.subscribe(p,(e=>{t||h(e)||r.setFocusToFirstFocusableChild($(e),(e=>$(e).attr("data-editable")?e:null))}));const f=function(e){let t=!1;const i=$(e.target),o=e.target;if(!l.isNonWrittenCharacter(e.which)){if("keydown"===e.type||"keyup"===e.type||"input"===e.type){const s=i.data("editablerow-previous");"keydown"===e.type&&void 0===s?i.data("editablerow-previous",o.value):"keyup"!==e.type&&"input"!==e.type||(t=o.value!==(s||""))}else t=!0;if(t){const t=$(this).closest(`tr.${w}`)[0];t&&n._rowEdit(t,e.type)}}"fxvaluechanged"===e.type&&e.stopPropagation()};p.registerForDispose(d.element.setEvents(["keydown keyup change",`tr.${w} input, tr.${w} select, tr.${w} textarea`,f],["fxvaluechanged","tr",f]))}getOrder(){return 14}getDependencies(){return[new i.FocusableRowExtension]}beforeDestroy(){this._isDisposed=!0}shouldRetainRowMetadata(e){return this._createdItems().some((function(t){return e.item===t}))}getName(){return F.Name}getRowAriaLabelOverride(e){return e.emptyRow()?this._options.newRowAriaLabel||n.Grid.newRowAriaLabel:null}_rowAdd(e){const t=this._widget;let i=!0;const o=P(e),s={targets:$(e).find(">td.azc-grid-cell").children(),editableRow:o,preventExitEditing:function(){i=!1}};(o.existingItem||function(e){return e.rowMetadata&&0!==e.rowMetadata.editState()}(o))&&!h(o.rowMetadata)&&R(e)&&(o.rowMetadata._addedOnce=!0,t.trigger("rowAdd",null,s),t.options.events("rowAdd",s),i&&o.rowMetadata.editing(!1))}_rowEdit(e,t){const i={targets:$(e).find(">td.azc-grid-cell").children(),editableRow:P(e),type:t};i.editableRow.rowMetadata.editState(i.editableRow.existingItem?2:1),this._widget.trigger("rowEdit",null,i),this._widget.options.events("rowEdit",i)}_editableRowFormat(e){const t=this.options.editableFormatter;return t?t({rowMetadata:e}):""}_editableCellFormat(e,t){return t.editableFormatter?t.editableFormatter(e.item[t.itemKey],{item:e.item,rowMetadata:e,column:t}):""}_isRowEdited(e){return 0!==e.editState()}_isRowDeleted(e){return 3===e.editState()}}t.EditableRowExtension=F,F.Name=f})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.EditableRow",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRow","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.EditableRow","MsPortalImpl.Controls/Fields/TextField"],(function(e,t,i,o,s,r,a){"use strict";const n=MsPortalFx.ViewModels.Controls.Lists.Grid.Extensions.EditableRow;var l;return function(e){var t=MsPortalFx.Base.Diagnostics,l=MsPortalFx.Data.EditState,d=MsPortalFx.ViewModels.Controls.Lists.Grid,c=d.Format,u=d.HtmlBindingsType,h=MsPortalFx.isNullOrUndefined;new t.Log("ImplGrid.EditableRowExtension");const g=a.EditableRowExtension.Name;function p(e,t){return t=ko.unwrap(t),h(t)||e.length<t}function b(e){switch(e){case l.Created:return 1;case l.Deleted:return 3;case l.Updated:return 2;case l.None:default:return 0}}e.getVivaEditableRowState=b;const m="__gridGuid";function f(e,t){return e===t||e&&t&&e[m]&&e[m]===t[m]}class w extends r.GridExtension{constructor(){super(...arguments),this._creatingEmptyRow=!1}beforeDestroy(){const e=this._detach;e&&e()}getExtension(e){const t=e.editableRow||{},i={placement:t.placement,allowEditExistingItems:!!t.allowEditExistingItems,allowEditCreatedItems:!!t.allowEditCreatedItems,newRowAriaLabel:t.newRowAriaLabel};return this._editableExtn=new a.EditableRowExtension(i)}initializeExtension(){const e=this._widget,t=e.ltm,i=e.options,o=e._instance,s=o.getPlugin(g),r=i.extensionsOptions.editableRow,a=r.maxBufferedRows,n=s.createdItems,l={rowAdd:(e,t)=>{t.preventExitEditing(),this._ensureValidation(t.targets,s,(()=>{i.rowAdd&&i.rowAdd(e,t),t.editableRow.rowMetadata.editing(!1)}))},rowEdit:(e,t)=>{const o=t.editableRow,l=o.rowMetadata;if(l.emptyRow(!1),!o.existingItem){i.createdItems().some((e=>f(e,l.item)))||r.addCreated(l.item)}this._ensureValidation(null,s);0===(r.placement||0)&&p(n(),a)&&this._ensureNewRow(s)}},d=o.element;d.on(l),this._detach=()=>{this._detach=null,d.off(l)};const c=r.validate;c&&c.subscribe(t,(()=>{this._ensureValidation(e.element,s)})),ko.utils.arrayPushAll(n,i.createdItems()),i.addEmptyRow.subscribeAndRun(t,(e=>{if(e&&p(n(),a)){const t=o.getRowMetadata(e);t.editing(!0),t.emptyRow(!0),t?.canShowMenu?.(!1),n.push(e)}})),i.createdItems.subscribeArrayEdits(t,(t=>{if((t=ko.utils.adjustArrayEdits(t)).length){const i=n();let r=!1;n.valueWillMutate(),t.forEach((e=>{const t=!h(e.moved);if("added"===e.status){const o=i.some((t=>f(t,e.value)));!t&&o||i.splice(e.index,0,e.value)}else if("deleted"===e.status){const s=i.splice(e.index,1)[0];if(!t){r=!0;const e=o.getRowMetadata(s);e.editing(!1),e.editState(0)}}})),n.valueHasMutated(),r&&(p(i,a)&&this._ensureNewRow(s),this._ensureValidation(e.element,s))}})),ko.isObservable(a)&&a.subscribe(t,(e=>this._onMaxBufRowsChange(e)))}getName(){return"EditableRow"}getOrder(){return 1}getDependencies(){return[new o.FocusableRowExtension]}columnAdded(e,t,i){const o=this._widget;let s;const r=t.editableFormat;s=h(r)?o._getFormatter(c.HtmlBindings,{htmlBindingsType:u.TextBox}):o._getFormatter(r,t.editableFormatOptions||{}),i.editableFormatter=s}columnRemoved(e,t){}connectRowMetadataProperties(e,t,i){const o=this._widget.ltm.createChildLifetime();return ko.computed(o,(()=>{const e=i.editState();ko.ignoreDependencies((()=>{const i=b(e);t.editState(i),!t.editing()&&t.editing(e===l.Created||e===l.Updated),3===i&&this._ensureValidation(this._widget.element,this._widget._instance.getPlugin(a.EditableRowExtension.Name))}))})),o}getAdditionalItems(){return this._editableExtn.createdItems()}registerSubscriptionsToConnectMetadataProperties(e,t){const i=e.createChildLifetime();return this._editableExtn.createdItems.subscribe(i,(e=>{this._widget._connectMetadataAndDisposeSubscriptions(i,t)})),i}enableRowDelete(e){return!1!==this._widget.options.extensionsOptions.editableRow.enableRowDelete}shouldHideContextMenu(e){return e.item===this._getEmptyRowItem()}getListDataForRightClick(e){const t={},i=this._widget.options.extensionsOptions.editableRow;return t.deleteRowCommandTitle=i.deleteRowCommandTitle,t.markForDelete=e=>{i.markForDelete(e)},t}_ensureValidation(e,t,i){const o=this._widget.options.extensionsOptions;e&&(s.gatherFormFields(e).forEach((e=>{const t=e.viewmodel,i=t.rowMetadata;i.editState&&i.editState()!==l.None&&null!==t.performValidation()&&t.performValidation(!0)})),i&&s.ensureFormFieldValidation(e,!1).then((e=>{if(e){i();const e=o.editableRow;1===e.placement&&p(t.createdItems(),e.maxBufferedRows)&&this._ensureNewRow(t)}}))),s.ensureFormFieldValidation(this._widget.element,!1).then((e=>{const t=o.editableRow;t.valid&&t.valid(e)}))}_getEmptyRowItem(){return MsPortalFx.find(this._editableExtn.createdItems(),(e=>this._widget.getRowMetadata(e).editState()===l.None))}_ensureNewRow(e){if(!this._creatingEmptyRow){const t=this._widget.options.extensionsOptions;if(!1===t.editableRow.enableRowAdd)return;this._emptyNewRowExists(e)||(this._creatingEmptyRow=!0,t.editableRow.create().finally((()=>{this._creatingEmptyRow=!1})))}}_emptyNewRowExists(e){return e.createdItems().some((e=>this._widget._instance.getRowMetadata(e).emptyRow()))}_onMaxBufRowsChange(e){const t=this._widget._instance.getPlugin(g),i=t.createdItems(),o=i.length,s=this._emptyNewRowExists(t);!s&&p(i,e)?this._ensureNewRow(t):s&&!h(e)&&o>e&&t.createdItems.splice(o-1,1)}}e.EditableRowExtension=w,i.registerPlugin(n,w)}(l||(l={})),l})),
define("_generated/Less/Viva.Controls/Controls/Forms/Viva.Button.css",["module"],(function(e){"use strict";return{css:".azc-button{align-items:center;justify-content:center;border-width:1px;border-style:solid;box-sizing:border-box;overflow:hidden;min-width:80px;font-size:13px;padding:2px 20px 4px;height:24px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;text-align:center}.azc-button:focus{outline-width:1px}.azc-button img{margin-right:3px}.azc-button svg{height:100%;width:100%}",moduleId:e.id}})),
define("Viva.Controls/Controls/Forms/Viva.Button",["require","exports","Viva.Controls/Controls/Base/Viva.Base","MsPortalImpl/Base/JQueryHelper","MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Forms/Viva.Button.css"],(function(e,t,i,o,s,r,a){"use strict";var n;return(0,r.injectCss)(a),function(e){let t;!function(e){e[e.Initial=0]="Initial",e[e.Hover=1]="Hover",e[e.Active=2]="Active"}(t=e.MouseState||(e.MouseState={}));class r extends i.ViewModel{constructor(){super(...arguments),this.submit=!1,this.selector=ko.observable(null),this.toggle=ko.observable(!1),this.pressed=ko.observable(!1),this.state=ko.observable(t.Initial),this.click=$.noop,this.uri=ko.observable({}),this.text=ko.observable({}),this.tabindex=ko.observable(0),this.visible=ko.observable(!0),this.isDefault=ko.observable(!1)}}e.ViewModel=r;class a extends i.Widget{constructor(e,t,i){if((i=i||{}).viewModelType=i.viewModelType||r,super(e,t,i),this.element.addClass("azc-button fxt-button").attr({role:"button",type:"button"}).on("click",this._clickHandler=e=>this._click(e)).on("mousedown",this._mouseDownHandler=()=>{this._mouseDown()}).on("mouseenter",this._mouseEnterHandler=()=>{this._mouseEnter()}).on("mouseleave",this._mouseLeaveHandler=()=>{this._mouseLeave()}),!this.element.is("button")){let e=!1;this.element.on("keydown",this._keyDownHandler=t=>{const i=()=>{this.element.trigger("click",t)};13===t.which&&i(),e=!1,32===t.which&&(e=!0,t.stopPropagation())}).on("keyup",this._keyUpHandler=t=>{e&&32===t.which&&(e=!1,this.element.trigger("click",t),t.stopPropagation())})}this._initializeComputeds()}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._cleanElement("azc-button fxt-button fxs-inner-solid-border azc-button-default fxs-portal-button-primary fxs-button-default fxs-button-disabled azc-disabled"),this.element.removeAttr("role tabindex aria-pressed aria-disabled aria-label"),this._mouseLeaveHandler&&(this.element.off("mouseleave",this._mouseLeaveHandler),this._mouseLeaveHandler=null),this._mouseEnterHandler&&(this.element.off("mouseenter",this._mouseEnterHandler),this._mouseEnterHandler=null),this._mouseDownHandler&&(this.element.off("mousedown",this._mouseDownHandler),this._mouseDownHandler=null),this._removeMouseUpHandler(),this._keyUpHandler&&(this.element.off("keyup",this._keyUpHandler),this._keyUpHandler=null),this._keyDownHandler&&(this.element.off("keydown",this._keyDownHandler),this._keyDownHandler=null),this._clickHandler&&(this.element.off("click",this._clickHandler),this._clickHandler=null),super.dispose())}get options(){return this._options}_initializeComputeds(){const e=this.ltm,t=this.options,i=this.element;this.$tabIndex.subscribeAndRun(e,(e=>{i.attr("tabindex",e)})),ko.computed(e,(()=>{t.toggle()?i.attr("aria-pressed",t.pressed()):i.removeAttr("aria-pressed")})),ko.computed(e,(()=>{const e=t.selector();this._previousSelector!==e&&this._previousImg&&this._previousImg.attr({src:"",alt:""}),this._previousSelector=e,this._previousImg=i.find(e).attr({src:this._getUri(),alt:this._getAlt()})})),ko.computed(e,(()=>{const e=this.$disabled();i.toggleClass("fxs-button-disabled azc-disabled",e).toggleClass("fxs-inner-solid-border",!e).attr("aria-disabled",e).filter(":button").prop("disabled",e)})),ko.computed(e,(()=>{const e=t.isDefault();i.toggleClass("azc-button-default fxs-portal-button-primary",e).toggleClass("fxs-button-default",!e)})),ko.computed(e,(()=>{o.toggle(i,!1!==t.visible())})),t.tabindex.subscribeAndRun(e,(e=>{this.tabindex(e)}))}_click(e){return!this.$disabled()&&(this.options.pressed(!this.options.pressed()),this.options.click&&this.options.click.call(this.element,e),this.options.submit&&this.element.submit(),!0)}_getAlt(){const e=this.options.text();if("string"==typeof e)return e;if(!e)return null;const i=this._getObject(e),o=this.options.state();return i[t[o].toLowerCase()]||null}_getObject(e){return this.options.toggle()&&e.normal&&e.pressed&&(e=this.options.pressed()?e.pressed:e.normal),e.enabled&&e.disabled&&(e=this.$disabled()?e.disabled:e.enabled),e}_getUri(){const e=this.options.uri();if("string"==typeof e)return e;if(!e)return null;const i=this._getObject(e),o=this.options.state();return i[t[o].toLowerCase()]||null}_mouseDown(){this.element.addClass("azc-button-state-active"),this.options.state(t.Active),this._removeMouseUpHandler(),this._body&&1===this._body.length||(this._body=$.querySelectorAll("body")),this._body.on("mouseup",this._mouseUpHandler=()=>{this.element.removeClass("azc-button-state-active"),this.options.state(t.Initial),this.element.hasClass("azc-button-state-hover")?this._mouseEnter():this._mouseLeave(),this._removeMouseUpHandler()})}_mouseEnter(){this.element.addClass("azc-button-state-hover"),this.options.state()!==t.Active&&this.options.state(t.Hover)}_mouseLeave(){this.element.removeClass("azc-button-state-hover"),this.options.state()!==t.Active&&this.options.state(t.Initial)}_removeMouseUpHandler(){this._mouseUpHandler&&(this._body.off("mouseup",this._mouseUpHandler),this._mouseUpHandler=null)}}e.Widget=a,ko.bindingHandlers.azcButton=s.getBindingHandler(a,{controlsDescendantBindings:!1})}(n||(n={})),n})),
define("_generated/Less/Viva.Controls/Controls/Forms/Viva.SearchBox.css",["module"],(function(e){"use strict";return{css:".azc-searchBox{position:relative;display:inline-block;font-size:13px;padding-right:30px;height:23px}.azc-searchBox .azc-button{height:23px;width:23px;min-width:23px;font-size:16px;line-height:normal;vertical-align:top;margin-left:0;padding:0;border:0;top:0;position:absolute}.azc-searchBox-state-hidden{display:none}.azc-searchBox-button-state-hidden{padding-right:0}.azc-searchBox-button-state-hidden .azc-button{display:none}.azc-searchBox-button-icon{position:absolute;top:-1px;left:6px}.azc-searchBox-wrapper{width:100%;height:100%;position:relative;float:left;padding:0}.azc-searchBox-input{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:100%}.azc-searchBox-input .azc-textBox-wrapper{padding-right:0;width:100%}.azc-searchBox-input .azc-textBox-wrapper input{display:inline-block;padding-right:0}.azc-searchBox-search-icon{position:absolute;width:14px;height:14px;top:4px;left:6px;pointer-events:none;display:none}.azc-searchBox-description{display:none}.azc-searchBox-wrapper.azc-searchBox-search-icon-visible .azc-searchBox-search-icon{display:block}.azc-searchBox-wrapper.azc-searchBox-search-icon-visible .azc-textBox-wrapper input{padding-left:24px}.azc-fabric .azc-searchBox{height:24px}.azc-fabric .azc-searchBox .azc-button{height:24px;width:24px;min-width:24px}",moduleId:e.id}})),
define("Viva.Controls/Controls/Forms/Viva.SearchBox",["require","exports","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger","Viva.Controls/Controls/Forms/Viva.TextBox","Viva.Controls/Controls/Forms/Viva.Button","Viva.Controls/Controls/Base/Viva.ValidatableControl","MsPortalImpl/Base/Base.KeyboardHelper","Fx/Images","MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Forms/Viva.SearchBox.css"],(function(e,t,i,o,s,r,a,n,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,c.injectCss)(u);const h="azc-searchBox",g="azc-searchBox-state-hidden",p="azc-searchBox-button-state-hidden",b=`<div class='azc-searchBox-wrapper' data-bind='css: { "azc-searchBox-search-icon-visible": data.searchIconVisible }'><div class='azc-searchBox-search-icon fxs-portal-svg-secondary' aria-hidden='true' data-bind='image:$ctl.icon'></div><div class='azc-searchBox-input' data-bind='azcTextBox: $ctl._textBoxViewModel'></div><div class='azc-searchBox-description' aria-hidden='true' data-bind='attr:{id:$ctl.descriptionId},text:$ctl.description'></div></div><button aria-label='${i.SearchBox.deleteButtonName}' data-bind='azcButton: $ctl._buttonViewModel'><div class='azc-searchBox-button-icon'>&times;</div></button>`,m=MsPortalFx.getIdGenerator("azc-searchBox-descriptionId-");class f extends a.ViewModel{constructor(){super(...arguments),this.queryString=ko.observable(""),this.visible=ko.observable(!0),this.closeButtonVisible=ko.observable(!0),this.searchIconVisible=ko.observable(!0),this.placeholder=ko.observable("Search..."),this.useFilterIcon=!1,this.ariaLabel=null}}t.ViewModel=f;class w extends a.Widget{constructor(e,t,i){(i=i||{}).viewModelType=i.viewModelType||f,super(e,t,i),this.element.addClass(h).html(b),this._button=this.element.find("button"),this._input=this.element.find(".azc-searchBox-input"),this.options.keyDownEvent=this.options.keyDownEvent||$.noop,this.descriptionId=m(),this.description=ko.observable(),this.icon=this.options.useFilterIcon?l.Images.Filter({palette:99}):l.Images.Search({palette:99}),this._textBoxViewModel=new s.ViewModel({ltm:this.ltm,value:this.options.queryString,placeholder:this.options.placeholder,valueUpdateTrigger:o.ValueUpdateTrigger.Input}),this._buttonViewModel=new r.ViewModel(this.vmBasicOption),this._buttonViewModel.isDefault(!0),this._buttonViewModel.visible=this.options.closeButtonVisible,this._attachEvents(),this._initializeComputeds(),this._bindDescendants(),this._afterCreate();const a=this._input.find(".azc-input");this.options.ariaLabel&&(a.attr("aria-label",this.options.ariaLabel),a.attr("aria-describedby",this.descriptionId)),this.options.placeholder&&this.options.placeholder.subscribeAndRun(this.ltm,(e=>{this.options.ariaLabel?this.description(e):e&&a.attr("aria-label",e)})),this.options.ariaControls&&a.attr("aria-controls",this.options.ariaControls)}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._detachEvents(),this._cleanElement(h,"azc-searchBox-state-hover",g,p),super.dispose())}get options(){return this._options}_getElementToFocus(){const e=this.element.find("input");return e.length?e[0]:null}_initializeComputeds(){const e=this.ltm;ko.computed(e,(()=>{const e=this.$disabled();this._buttonViewModel.disabled(e),this._textBoxViewModel.disabled(e),this._textBoxViewModel.dirty(this.options.dirty())})),ko.computed(e,(()=>{this.element.toggleClass(g,!this.options.visible())})),ko.computed(e,(()=>{this.element.toggleClass(p,!this.options.closeButtonVisible())}))}_attachEvents(){this._detachEvents(),this._buttonClickHandler=e=>{this.options.queryString(""),this.options.visible(!1)},this._inputKeyDownHandler=e=>{$.contains(this._input[0],document.activeElement)&&(0===n.getModifierKeys(e)&&27===e.which&&(this.options.queryString(""),e.preventDefault()),this.options.keyDownEvent(e))},this._button.on("click."+h,this._buttonClickHandler),this.element.on("keydown.azcSearchBox",this._inputKeyDownHandler)}_detachEvents(){this._buttonClickHandler&&(this._button.off("click."+h,this._buttonClickHandler),this._buttonClickHandler=null),this._inputKeyDownHandler&&(this.element.off("keydown.azcSearchBox",this._inputKeyDownHandler),this._inputKeyDownHandler=null)}}t.Widget=w,ko.bindingHandlers.azcSearchBox=d.getBindingHandler(w)})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Filterable.css",["module"],(function(e){"use strict";return{css:".azc-grid-filterable.azc-grid.azc-grid-headerHidden:not(.azc-grid-groupable) .azc-grid-filterable-searchBox{margin-bottom:14px}.azc-grid-filterable.azc-grid.azc-grid-filterable-active .azc-grid-reorderRow-cell div{visibility:hidden}.azc-grid-filterable.azc-grid .azc-grid-filterable-searchBox{display:block}.azc-grid-filterable.azc-grid .azc-grid-filterable-searchBox.azc-searchBox-state-hidden{display:none}.azc-grid-filterable.azc-grid .azc-grid-filterable-match{font-style:normal}",moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Filterable",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","Viva.Controls/Controls/Forms/Viva.SearchBox","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Filterable.css"],(function(e,t,i,o,s,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterableExtension=void 0,(0,n.injectCss)(l);const d=/\s+/,c="azc-grid-filterable-active",u="azc-grid-filterable",h=`<div class='azc-grid-filterable-searchBox' data-bind='azcSearchBox: $ctl.getPlugin("${u}")._searchBoxVM'></div><div aria-live='polite' aria-atomic='true' class='azc-grid-filterable-live fxs-hide-accessible-label' data-bind='text: $ctl.getPlugin("${u}")._ariaLive'></div>`,g="###EXISTING_TEMPLATE_BODY_CORE###",p=`\x3c!-- ko ifnot: $ctl.getPlugin("${u}").options.serverFilter() --\x3e\x3c!-- ko if: $ctl.getPlugin("${u}").filterActive() --\x3e\x3c!-- ko if: $ctl.getPlugin("${u}").results().length --\x3e<tbody class='azc-grid-groupdata' role='rowgroup'>\x3c!-- ko template: { name: 'bodyRows', foreach: $ctl.getPlugin("${u}").results() } --\x3e\x3c!-- /ko --\x3e</tbody>\x3c!-- /ko --\x3e\x3c!-- ko ifnot: $ctl.getPlugin("${u}").results().length --\x3e\x3c!-- ko if: data.items().length --\x3e<tbody role='rowgroup' class='azc-grid-empty' data-bind='if: data.noRowsMessage'><tr role='row' data-bind='attr: { tabindex: $tabIndex }'><td role='gridcell' class='azc-br-muted' data-bind='attr: { colspan: $ctl._getTotalColumns() }, html: data.noRowsMessage'></td></tr></tbody>\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e\x3c!-- ko if: $ctl.getPlugin("${u}").options.serverFilter() || !$ctl.getPlugin("${u}").filterActive() --\x3e`+g+"\x3c!-- /ko --\x3e",b=`$1$2 $ctl.getPlugin("${u}").filterActive() ? $ctl.getPlugin("${u}")._filterableCellFormat($parentContext.$parentContext.$index, $index, $parent, $data) : $3,`,m=Array.prototype.slice;function f(e,t){const i=m.call(e.childNodes);let o;for(;o=i.pop();)switch(o.nodeType){case 3:t(o);break;case 1:{const e=o.classList;e.contains("msportalfx-nohighlighting")||e.contains("azc-control")||e.contains("fxc-control")||i.push(...m.call(o.childNodes));break}}}function w(e){const t=FxImpl.createElement("div",{trustedInnerHTML:e}),i=[];return f(t,(e=>{i.push(e.textContent)})),i.join(" ")}class v extends o.Extension{constructor(e){super(),this._options=$.extend(this._getDefaultFilterableOptions(),e),this._results=ko.observableArray(),this._filterActive=ko.observable(!1),this._displayedCols=[],this._colMap={},this._colNumMap={},this._resultTokenMap={},this._ariaLive=ko.observable(""),this._lastEncodedFilter=null}get filterActive(){return this._filterActive}get options(){return this._options}get results(){return this._results}afterSetTemplates(e){const t=e.getHtmlTemplate("table"),i=e.getTemplate("bodyCore"),o=p.replace(g,i),s=e.getTemplate("bodyCellContent"),r=new RegExp("(['|\"]?)([\"|']?trustedCellBinding[\"|']?:)(.*),");let a=s;r.test(s)&&(a=s.replace(r,b)),t.prepend(".azc-grid-header",h),e.setTemplate({bodyCore:o,bodyCellContent:a})}afterCreate(){const e=this._widget,t=this.ltm;[()=>{this._searchBoxVM.visible(this._options.searchBoxVisible())},()=>{const e=$.trim(this._searchBoxVM.queryString());this._queryTimeout&&clearTimeout(this._queryTimeout),this._queryTimeout=setTimeout((()=>{this._queryTimeout=null,this._resetResults(),this._filterHandler(e)}),this.options.valueUpdateDelayTimeout())},()=>{const t=e.options.columns();this._colMap={},this._colNumMap={},t.forEach(((e,t)=>{this._colMap[e.itemKey]=e,this._colNumMap[e.itemKey]=t,this._displayedCols.push(e.itemKey)}))},()=>{e.element.toggleClass(c,this._filterActive())},()=>{e.options.items(),this._filterActive.peek()&&this._results(this._getResultItems(this._parseQueryString(this._searchBoxVM.queryString.peek())))}].forEach((i=>{ko.computed(t,i,this,{disposeWhenNodeIsRemoved:e.element[0]})})),this.options.serverFilter.subscribe(t,(e=>{this._resetAndFilterResults($.trim(this._searchBoxVM.queryString()))}))}beforeCreate(){this._searchBoxVM=new a.ViewModel(this.vmBasicOption),this._searchBoxVM.queryString=this.options.queryString,this._searchBoxVM.closeButtonVisible=this.options.searchBoxCloseButtonVisible,this._searchBoxVM.placeholder=this.options.searchBoxPlaceholder,this._searchBoxVM.ariaControls=this._widget.id,this._searchBoxVM.useFilterIcon=!0,this._searchBoxVM.ariaLabel=s.Grid.filter,this._searchBoxVM.keyDownEvent=e=>{0===r.getModifierKeys(e)&&13===e.which&&this._resetAndFilterResults($.trim(this._searchBoxVM.queryString()))}}beforeDestroy(){this._widget.element.removeClass(c)}getDefaultRowMetadataProperties(e){return{}}getName(){return v.Name}getOrder(){return 100}shouldNotAllowDrag(){return!!this._widget.element.hasClass(c)}_parseQueryString(e){const t=new Map,i=e.toLowerCase().split(d).filter((e=>{const i=!t.has(e);return i&&t.set(e,e),i}));let o;for(o=0;o<i.length;o++)this._resultTokenMap[i[o]]=[];return i}_resetAndFilterResults(e){this._queryTimeout&&(clearTimeout(this._queryTimeout),this._queryTimeout=null,this._resetResults()),this._filterHandler(e)}_filterHandler(e){const t=e?MsPortalFx.encodeAttribute(e):null,i=this._lastEncodedFilter!==t;this._lastEncodedFilter=t;if(this.options.serverFilter()){const i=this.options.filterCallback()||this._widget.options.actions?.waitForExternalFiltering;if(i){const o=this._widget.options.actions?.waitForChanges||(()=>Promise.resolve());Promise.resolve(i(e)).then((()=>o())).then((()=>{const e=this._widget.options.extensionTrigger("handlesServerFilterAnnouncement");if(!e||!e.length||!e[0]){const e=this._widget.ariaRowCount();this._ariaLive(t?s.Grid.loadingCompleteFiltered.format(e,t):s.Grid.loadingComplete.format(e))}}))}}else t?(this._filterActive(!0),this._results(this._getResultItems(this._parseQueryString(e))),this._ariaLive(s.Grid.loadingCompleteFiltered.format(this._results().length,t))):(this._filterActive(!1),i&&this._ariaLive(s.Grid.loadingComplete.format(this._widget.ariaRowCount())))}_getResultItems(e){const t=this._getSearchableColumns();let i,o;const s=[];let r,a,n,l=[];return this._widget.options.items().forEach(((d,c)=>{for(l=[],a=0;a<t.length;a++)if(i=t[a],d.hasOwnProperty(i)){o=this._getFormattedItemValue(d[i],{item:d,rowMetadata:this._widget.getRowMetadata(d),rowNumber:()=>c,columnNumber:()=>this._colNumMap[i],column:this._colMap[i]});const t=w(o).toLowerCase();for(n=0;n<e.length;n++)r=e[n],t.includes(r)&&(l.includes(r)||l.push(r),-1===this._resultTokenMap[r].indexOf(d)&&this._resultTokenMap[r].push(d))}l.length===e.length&&s.push(d)})),s}_filterableCellFormat(e,t,i,o){const s=i.item,r=o.itemKey,a=s[r],n={item:i.item,rowNumber:e,columnNumber:t,rowMetadata:i,column:o};let l=this._getFormattedItemValue(a,n);const d=this._getSearchableColumns();let c;const u=[];for(const e in this._resultTokenMap)c=this._resultTokenMap.hasOwnProperty(e)&&-1!==this._resultTokenMap[e].indexOf(s)&&d.includes(r),c&&u.push(e);return u.length&&(l=this._highlightMatches(l,u)),l}_highlightMatches(e,t){t.sort(((e,t)=>t.length-e.length)),t=t.map((e=>MsPortalFx.regexEscape(e)));const i=new RegExp(t.join("|"),"gi"),o=FxImpl.createElement("div",{trustedInnerHTML:e});return f(o,(e=>{const t=e.textContent;let o=i.exec(t);if(o){const s=document.createDocumentFragment();let r=0;for(;o;){const e=o.index,a=o[0];e>r&&s.appendChild(document.createTextNode(t.slice(r,e)));const n=FxImpl.createElement("em",{class:"azc-grid-filterable-match fxs-highlight"});n.textContent=a,r=e+a.length,s.appendChild(n),o=i.exec(t)}t.length>r&&s.appendChild(document.createTextNode(t.slice(r)));e.parentNode.replaceChild(s,e)}})),o.innerHTML}_getFormattedItemValue(e,t){let o;if(t.column&&t.column.filterFormatter)o=t.column.filterFormatter(e,t);else{const s=ko.toJS(e);if("object"==typeof s)o=i.text(JSON.stringify(s),t);else o=i.text(s,t)}return o}_getSearchableColumns(){return this.options.searchableColumns().length?this.options.searchableColumns():this._displayedCols}_resetResults(){this._results.removeAll(),this._resultTokenMap={}}_getDefaultFilterableOptions(){return{searchableColumns:ko.observableArray(),searchBoxVisible:ko.observable(!0),searchBoxPlaceholder:ko.observable(s.Viva.Grid.Filterable.placeholder),searchBoxCloseButtonVisible:ko.observable(!0),queryString:ko.observable(""),serverFilter:ko.observable(!1),filterCallback:ko.observable(null),valueUpdateDelayTimeout:ko.observable(300)}}}t.FilterableExtension=v,v.Name=u})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Filterable",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Filterable"],(function(e,t,i,o,s,r){"use strict";var a;return function(e){var t=MsPortalFx.ViewModels.Controls.Lists.Grid;class a extends o.GridExtension{getExtension(e){const t=e&&e.filterable;let i;return t&&(i={searchBoxCloseButtonVisible:t.searchBoxCloseButtonVisible||ko.observable(!0),searchBoxPlaceholder:t.searchBoxPlaceholder||ko.observable(s.Viva.Grid.Filterable.placeholder),searchBoxVisible:t.searchBoxVisible||ko.observable(!0),searchableColumns:t.searchableColumns||ko.observableArray(),queryString:t.queryString||ko.observable(""),serverFilter:t.serverFilter||ko.observable(!1),valueUpdateDelayTimeout:t.valueUpdateDelayTimeout||ko.observable(300)}),new r.FilterableExtension(i)}getName(){return"Filterable"}getOrder(){return 0}columnAdded(e,t,i){i.filterFormatter=null;const o=t.filterableFormat;void 0!==o&&(i.filterFormatter=this._widget._getFormatter(o,t.filterableFormatOptions||{}))}}e.FilterableExtension=a,i.registerPlugin(t.Extensions.Filterable,a)}(a||(a={})),a})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRowHover",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1"],(function(e,t,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FocusableRowHoverExtension=void 0;class r extends s.Extension{constructor(e){super(),this._disposables=[],this._options=e||{},this._hoverIDKey=this._options.hoverIDKey||ko.observable(),this._hoveredID=this._options.hoveredID||ko.observable(),this._hoveredRowMetadata=ko.observable(null),this._backupIdMax=0}get options(){return this._options}beforeCreate(){this._focusableRowExtension=this._widget.getPlugin(i.FocusableRowExtension.Name),this._focusableRowExtension.externalHover=!0}afterSetTemplates(e){e.getHtmlTemplate("bodyRowsCore").addAttribute("tr","data-bind",['css: { "azc-external-hovered": $data === $ctl.getPlugin("azc-grid-hoverableRow")._hoveredRowMetadata() }'])}getDefaultRowMetadataProperties(e){return{hovered:ko.observable(!1)}}afterAttachEvents(){const e=this,t=this._widget.element;this._disposables.push(t.setEvents(["rowFocus.azcHovered",function(t,i){e._onRowFocus(t,i)}],["mouseenter.azcHovered",">.azc-grid-root>.azc-grid-area>.azc-grid-container .azc-grid-full>tbody>tr.azc-grid-row:not([aria-disabled=true])",t=>{let i;!this._preventMouseHandler&&t.currentTarget&&(i=ko.dataFor(t.currentTarget),e._hoveredRowMetadata(i))}],["mouseleave.azcHovered",t=>{this._preventMouseHandler||e._hoveredRowMetadata(null)}],["focus.azcHovered",t=>{if(!e._hoveredRowMetadata()){let i;t.currentTarget&&(i=ko.dataFor(t.currentTarget),e._hoveredRowMetadata(i),e._focusedByEvent=!0)}}],["blur.azcHovered","tbody.azc-grid-groupdata",t=>{e._focusedByEvent&&e._hoveredRowMetadata()&&(e._hoveredRowMetadata(null),e._focusedByEvent=!1)}]))}afterCreate(){let e,t;this._rebuildIdRowMetadaMap();const i=this._widget,o=this.ltm;i.options.items.subscribeArrayChanges(o,(o=>{t=ko.unwrap(o[this._hoverIDKey()]),t||(t=(this._backupIdMax++).toString()),e=i.getRowMetadata(o),e.hoverID=t,this._idRowMetadataMap[t]=e}),(t=>{e=i.getRowMetadata(t),delete this._idRowMetadataMap[e.hoverID]})),this._hoveredID.subscribe(o,(e=>{this.hoverRowByHoverId(e)})),this._hoveredRowMetadata.subscribe(o,(e=>{const t=e?e.hoverID:null;t!==this._hoveredID.peek()&&this._hoveredID(t)}))}getOrder(){return 30}getDependencies(){return[new i.FocusableRowExtension(this.options)]}beforeDestroy(){MsPortalFx.disposeDisposable(this._disposables),this._disposables=[],this._resetPreventMouseHandlerTimer()}getName(){return r.Name}hoverRowByHoverId(e){const t=this._getRowMetadataFromHoverID(e);this.hoverRowByRowMetadata(t)}hoverRowByRowMetadata(e,t){if(this._hoveredRowMetadata.peek()!==e){if(this._inHoverRowByRowMetadata)return void console.error(" FocusableRowHoverExtension hoverRowByRowMetadata go into recursive called. Please verify."+MsPortalFx.getCurrentCallStack(!0));try{if(this._inHoverRowByRowMetadata=!0,this._hoveredRowMetadata(e),e){const i={hovered:e};this._widget.trigger("rowHover",t?o.cloneEvent(t,"rowHover"):$.Event("rowHover"),i),this._widget.options.events("hover",i)}}finally{this._inHoverRowByRowMetadata=!1}}}_resetPreventMouseHandlerTimer(){this._preventMouseHandler=!1,null!==this._preventMouseHandlerTimer&&(clearTimeout(this._preventMouseHandlerTimer),this._preventMouseHandler=null)}_onRowFocus(e,t){let i;this._focusedByEvent=!!e,this._focusedByEvent&&(this._resetPreventMouseHandlerTimer(),this._preventMouseHandler=!0,this._preventMouseHandlerTimer=setTimeout((()=>{this._resetPreventMouseHandlerTimer()}),250)),t.focused?(i=t.focused,this.hoverRowByRowMetadata(i,e)):this.hoverRowByRowMetadata(null)}_getRowMetadataFromHoverID(e){let t;return MsPortalFx.isNullOrUndefined(e)||(t=this._idRowMetadataMap[e]),t||null}_rebuildIdRowMetadaMap(){const e=this._widget._getAllRowMetadata(),t=this._hoverIDKey.peek();let i;const o={};this._backupIdMax=0,e.forEach((e=>{i=ko.unwrap(e.item[t]),i=i?i.toString():(this._backupIdMax++).toString(),o[i]=e,e.hoverID=i})),this._idRowMetadataMap=o}}t.FocusableRowHoverExtension=r,r.Name="azc-grid-hoverableRow"})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRowHover",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRowHover"],(function(e,t,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FocusableRowHoverExtension=void 0;var r=MsPortalFx.ViewModels.Controls.Lists.Grid;class a extends o.GridExtension{beforeDestroy(){}getExtension(e){const t=e.hoverable||{};return new s.FocusableRowHoverExtension({focusable:t.focusable||ko.observable(!0),hoverIDKey:t.hoverIDKey||ko.observable(),hoveredID:t.hoveredID||ko.observable()})}initializeExtension(){}getName(){return"FocusableRowHover"}getOrder(){return 0}}t.FocusableRowHoverExtension=a,i.registerPlugin(r.Extensions.Hoverable,a)})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FormatterHtmlBindings",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Formatters","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer"],(function(e,t,i,o,s,r,a){"use strict";var n;return function(t){var n=MsPortalFx.ViewModels.Controls.Lists.Grid,l=n.Format,d=n.HtmlBindingsType,c=i.ControlViewModels;function u(e,t,i){switch(t){case d.TextBox:return c.textBox(e,i);case d.CheckBox:return c.checkBox(e,i);case d.DropDown:return c.dropDown(e,i);case d.GroupDropDown:return c.groupDropDown(e,i);case d.CheckBoxRowSelection:return c.rowSelectionCheckBox(e);case d.Default:default:return(e,t,i)=>({value:t,settings:i})}}t.getHtmlBindingsViewModel=u;class h extends s.GridExtension{getName(){return"FormatterHtmlBindings"}getOrder(){return 0}getSafeFormatter(t,i,o){if(t===l.HtmlBindings){const t=this._widget&&this._widget.element;return r.htmlBindings(this._widget.ltm,function(t,i,o,s){let r=i||"";switch(t){case d.TextBox:case d.CheckBox:case d.DropDown:case d.GroupDropDown:case d.CheckBoxRowSelection:return"<div data-bind='formElement: $data' data-grid-formelement='"+d[t]+"'></div>"}return o||(r=a.sanitizeHTML(r,e,s).sanitizedMarkup),r}(i.htmlBindingsType,i.htmlBindingsTemplate,o,t),u(this._widget.ltm,i.htmlBindingsType,i.htmlBindingsData))}return null}}t.FormatterHtmlBindingsExtension=h,o.defaultPlugins.push(h)}(n||(n={})),n})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Groupable.css",["module"],(function(e){"use strict";return{css:".azc-grid-groupable.azc-grid .azc-grid-groupdata .azc-grid-groupheader td{padding-top:1px;font-size:13px;font-weight:600;text-transform:none}.azc-grid-groupable.azc-grid .azc-grid-groupdata .azc-grid-groupheader:hover{background-color:inherit}.azc-grid-groupable.azc-grid .azc-grid-groupdata tr:not(.azc-grid-groupheader) td.azc-grid-cell:first-of-type{padding-left:30px}.azc-grid-groupable.azc-grid th.azc-grid-column-header:first-of-type .azc-grid-header-wrapper{padding-left:30px}",moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Groupable",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Groupable.css"],(function(e,t,i,o,s,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroupableExtension=t.Group=void 0,(0,r.injectCss)(a);var n=MsPortalFx.isNullOrUndefined;const l="azc-grid-groupable",d=`\x3c!-- ko if: data.items().length --\x3e\x3c!-- ko foreach: $ctl.getPlugin("${l}").groups --\x3e<tbody class='azc-grid-groupdata' role='rowgroup' data-bind='attr: { "aria-label": ariaLabel }' ><tr aria-hidden='true' class='azc-grid-groupheader'><td class='azc-br-muted' data-bind='trustedHtml: $ctl.getPlugin("${l}")._headerCellFormat(formatter, value), attr: { colspan: $ctl._getTotalColumns() }'></td></tr>\x3c!-- ko if: $ctl.getPlugin("${l}").getItemsByGroup(value)().length --\x3e\x3c!-- ko template: { name: 'bodyRows', foreach: $ctl.getPlugin("${l}").getItemsByGroup(value)() } --\x3e\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e\x3c!-- ko ifnot: $ctl.getPlugin("${l}").getItemsByGroup(value)().length --\x3e<tr role='row'><td role='gridcell' data-bind='attr: { colspan: $ctl._getTotalColumns() }, html: $vm.noRowsMessage' class='azc-br-muted'></td></tr>\x3c!-- /ko --\x3e</tbody>\x3c!-- /ko --\x3e\x3c!-- ko if: $ctl.getPlugin("${l}").getItemsByGroup("")().length --\x3e<tbody class='azc-grid-groupdata' role='rowgroup'><tr role='row' class='azc-grid-groupheader'><td rol='gridcell' class='azc-br-muted' data-bind='trustedHtml: $ctl.getPlugin("${l}").options.noGroupLabel(), attr: { "aria-label": $ctl.getPlugin("${l}").options.noGroupLabel(), colspan: $ctl._getTotalColumns() }'></td></tr>\x3c!-- ko template: { name: 'bodyRows', foreach: $ctl.getPlugin("${l}").getItemsByGroup("")() } --\x3e\x3c!-- /ko --\x3e</tbody>\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e`;function c(e){return e=ko.toJS(e),n(e)?"":e}class u{constructor(e,t,o,s){this.value=e,this.formatter=t||i.text,this.sortFormatter=o,this.ariaLabel=s}}t.Group=u;class h extends o.Extension{constructor(e){super(),this._groupItems={},this._options=$.extend(this._getDefaultGroupOptions(),e),n(this._options.groups)&&(this._options.groups=ko.observable(null))}get groups(){return this._groups}get options(){return this._options}afterSetTemplates(e){e.setTemplate("bodyCore",d)}beforeCreate(){const e=(e,t,i,o)=>{const s=[],r=[],a=[];return i.forEach((e=>{const i=c(e[t]),o=i.toString();r.includes(o)||(s.push(i),r.push(o))})),s.forEach((e=>{const t=ko.observable();this._options&&this._options.getGroupAriaLabel?Promise.resolve(this._options.getGroupAriaLabel(e)).then((e=>{t(e)})):t(e&&e.toString()),a.push(new u(e,o,null,t))})),a},t=this.ltm;let o;this._groups=ko.computed(t,(()=>{o&&o.dispose(),o=t.createChildLifetime();let s=[];const r=this.options.groups();let a;return r?s=r:(a=this.options.headerFormatter||i.text,s=e(0,this.options.groupKey(),this._widget.options.items(),a)),function(e,t,i){let o,s,r;e.options.items().forEach((a=>{o="",r=c(a[i]),t.forEach((e=>{s=c(e.value),r.toString()===s.toString()&&(o=s)})),e.getRowMetadata(a).groupId(o)}))}(this._widget,s,this.options.groupKey()),s=function(e,t,i){const o=[];let s=[];return 0===t?s=e:(e.forEach(((e,t)=>{e.sortFormatter?o.push(e.sortFormatter(ko.toJS(e.value))):o.push(ko.toJS(e.value))})),i?o.sort(i):o.sort(),2===t&&o.reverse(),o.forEach((t=>{e.forEach((e=>{const i=e.sortFormatter?e.sortFormatter(ko.toJS(e.value)):ko.toJS(e.value);t.toString()===i.toString()&&s.push(e)}))}))),s}(s,this.options.sortOrder(),this.options.sortFunction),s}))}beforeDestroy(){this._groupItems&&(Object.getOwnPropertyNames(this._groupItems).forEach((e=>{const t=this._groupItems[e];t&&($.isFunction(t.dispose)&&t.dispose(),this._groupItems[e]=null)})),this._groupItems=null)}getItemsByGroup(e){return e=ko.toJS(e),this._groupItems[e]||(this._groupItems[e]=function(e,t,i){if(null==i)throw new Error("groupId cannot be null or undefined when fetching group items.");return ko.computed(e,(()=>{const e=[],o=ko.toJS(i).toString();let s;return t.options.items().forEach((i=>{s=c(t.getRowMetadata(i).groupId),s.toString()===o&&e.push(i)})),e}))}(this.ltm,this._widget,e)),this._groupItems[e]}getDefaultRowMetadataProperties(e){return{groupId:ko.observable("")}}getName(){return h.Name}getOrder(){return 70}_getDefaultGroupOptions(){return{groupKey:ko.observable(""),headerFormatter:i.text,groups:ko.observable(null),noGroupLabel:()=>s.Viva.Grid.Groupable.noGroupLabel,sortOrder:ko.observable(1),sortFunction:null}}_headerCellFormat(e,t){return e(t)}computeLeftMarginWidth(){return 30}}t.GroupableExtension=h,h.Name=l})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Groupable",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Groupable","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,i,o,s,r){"use strict";var a;return function(e){var t=MsPortalFx.ViewModels.Controls.Lists.Grid;class a extends o.GridExtension{beforeDestroy(){}getExtension(e){const t=e||{},i=this._widget,o=i.ltm.createChildLifetime(),r=i.element[0],a=t.groupable,l=a.getGroupAriaLabel&&a.getGroupAriaLabel.bind(t);return new s.GroupableExtension({groupKey:a.groupKey,headerFormatter:i._getFormatter(a.headerFormat,a.headerFormatOptions),groups:ko.computed(o,(()=>{let e;return a&&a.groups&&(e=[],a.groups().forEach((t=>{const o=i._getFormatter(t.format,t.formatOptions);let r=null;t.sortFormat&&(r=i._getFormatter(t.sortFormat,t.sortFormatOptions));const a=ko.observable();l?Promise.resolve(l(t.value)).then((e=>{a(e)})):a(t.value&&t.value.toString()),e.push(new s.Group(t.value,o,r,a))}))),e}),this,{disposeWhenNodeIsRemoved:r}),noGroupLabel:i._getFormatter(a.noGroupLabelFormat,a.noGroupLabelFormatOptions),sortFunction:n(a.sortFunction),sortOrder:ko.computed(o,(()=>{let e=1;return a&&a.sortOrder&&(e=a.sortOrder()),e}),this,{disposeWhenNodeIsRemoved:r}),getGroupAriaLabel:l})}initializeExtension(){}getName(){return"Groupable"}getOrder(){return 0}connectRowMetadataProperties(e,t,i){const o=this._widget.ltm.createChildLifetime();return this._widget._twoWayBinding(o,i.groupId,t.groupId),o}}function n(e){let i;const o=t.SortFunction;switch(e){case o.DateTime:i=(e,t)=>{const i=new Date(e).getTime(),o=new Date(t).getTime();return i<o?-1:i>o?1:0};break;case o.SettingListGroupOrder:i=(e,t)=>{const i=r.Part.SettingList.Group.support;return e===i?-1:t===i?1:0};break;default:i=null}return i}e.GroupableExtension=a,e.getSortFunction=n,i.registerPlugin(t.Extensions.Groupable,a)}(a||(a={})),a})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Hierarchical.css",["module"],(function(e){"use strict";return{css:".azc-grid-hierarchical-cell-flexcontainer{display:flex;align-items:center}.azc-grid-hierarchical-cell-flexcontainer .azc-grid-cellContent{flex:1 1 auto}.azc-grid-hierarchical-header>a{padding-left:34px}.azc-grid-hierarchical-icon,.azc-grid-hierarchical-indent{display:inline-block;flex:0 0 auto;box-sizing:border-box;width:24px;height:24px;padding:4px}.azc-grid-hierarchical-icon-collapsed{margin-left:2px;width:16px;height:16px}.azc-grid-hierarchical-icon-expanded{margin-top:2px;width:16px;height:16px;transform:rotate(90deg)}",moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Hierarchical",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Hierarchical.css"],(function(e,t,i,o,s,r,a,n){"use strict";var l;return(0,a.injectCss)(n),function(e){const t=r.Grid.Accessibility,a=MsPortalFx.Base.Images.Chevron(),n="tr[data-grid-focusable]",l=".azc-grid-hierarchical-icon[data-grid-expandable]",d="azc-grid-hierarchical",c=`<div class='azc-grid-hierarchical-cell-flexcontainer'>\x3c!-- ko if: hierarchical --\x3e\x3c!-- ko foreach: new Array($parent.item.depth()) --\x3e<div class='azc-grid-hierarchical-indent'></div>\x3c!-- /ko --\x3e<div class='azc-grid-hierarchical-icon' role='button' data-bind='if: $ctl.getPlugin("${d}")._isExpandable($parent.item), clickBubble: false, attr: { "aria-label": $ctl.getPlugin("${d}")._expanderLabel($parent.item), "aria-expanded": $ctl.getPlugin("${d}")._isExpandable($parent.item) ? $parent.item.expanded().toString() : null, "data-grid-expandable": $ctl.getPlugin("${d}")._isExpandable($parent.item) ? "true" : null, "aria-hidden": $ctl.getPlugin("${d}")._isExpandable($parent.item) ? null : "true", tabindex: $ctl.getPlugin("${d}")._isExpandable($parent.item) && $tabIndex() }'><div data-bind='css: { "azc-grid-hierarchical-icon-collapsed": !$parent.item.expanded(), "azc-grid-hierarchical-icon-expanded": $parent.item.expanded() }, image: $ctl.getPlugin("${d}")._expansionImage($parent.item)'></div></div><div class='azc-grid-cellContent' data-bind='css: { "azc-grid-cell-ellipse": $data.enableEllipse, "azc-grid-cell-fullheight": $data.fullHeight }, trustedCellBinding: $ctl._cellFormat($parentContext.$parentContext.$index, $index, $parent, $data)'></div>\x3c!-- /ko --\x3e\x3c!-- ko ifnot: hierarchical --\x3e<div class='azc-grid-cellContent' data-bind='css: { "azc-grid-cell-ellipse": $data.enableEllipse, "azc-grid-cell-fullheight": $data.fullHeight }, trustedCellBinding: $ctl._cellFormat($parentContext.$parentContext.$index, $index, $parent, $data)'></div>\x3c!-- /ko --\x3e</div>`,u=MsPortalFx.disposeDisposable;class h extends i.Extension{constructor(e){super(),this._disposables=[],this._options=$.extend(this._getDefaultHierarchicalOptions(),e)}get options(){return this._options}afterSetTemplates(e){const t=e.getHtmlTemplate("bodyRowsCore");e.getHtmlTemplate("headerCell").addAttribute("th","data-bind",['css: { "azc-grid-hierarchical-header": hierarchical }']),t.addAttribute("tr","data-bind",['css: { "azc-grid-hierarchical-toplevel": item.depth() === 0 }']),e.setTemplate("bodyCellContent",c)}afterCreate(){}afterAttachEvents(){let e=!0;const t=this.options;this._disposables.push(this._widget.element.setEvents(["keydown.azcGrid",n,i=>{const o=$(i.target).closest(n),r=ko.dataFor(o[0]);if(0===s.getModifierKeys(i)&&o&&o.length>0){switch(i.which){case 37:e=this._expandOrCollapse(t,r,!1);break;case 39:e=this._expandOrCollapse(t,r,!0);break;default:e=!1}e&&(i.preventDefault(),i.stopPropagation())}}],["keydown.azcGrid",l,i=>{const o=$(i.target).closest(n),r=ko.dataFor(o[0]),a=r?r.item:null;if(0===s.getModifierKeys(i)&&o&&o.length>0){switch(i.which){case 13:case 32:e=this._expandOrCollapse(t,r,!a.expanded());break;default:e=!1}e&&(i.preventDefault(),i.stopPropagation())}}],["click.azcGrid",l,i=>{const o=$(i.target).closest(n),s=ko.dataFor(o[0]),r=s?s.item:null;o&&o.length>0&&(e=this._expandOrCollapse(t,s,!r.expanded())),e&&(i.preventDefault(),i.stopPropagation())}]))}beforeDestroy(){u(this._disposables),this._disposables=[]}getName(){return h.Name}getOrder(){return 18}getDependencies(){return[new o.FocusableRowExtension]}getDefaultColumnProperties(){return{hierarchical:!1}}shouldNotAllowSelectAll(){return!0}_expandOrCollapse(e,i,o){const s=i?i.item:null,r=e.hierarchy;return!(!s||!this._isExpandable(s))&&(o?s.expanded()||(r.expand(i.item),this._widget._ariaLive(t.expanded)):s.expanded()&&(r.collapse(i.item),this._widget._ariaLive(t.collapsed)),!0)}_getDefaultHierarchicalOptions(){return{hierarchy:null}}_isExpandable(e){return e.expandable&&(!0===e.expandable()||void 0===e.expandable())}_expansionImage(e){return a}_expanderLabel(e){return this._isExpandable(e)?r.Grid.Accessibility.expandOrCollapseRow:null}}h.Name="azc-grid-hierarchical",e.HierarchicalExtension=h}(l||(l={})),l})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Hierarchical",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Hierarchical"],(function(e,t,i,o,s){"use strict";var r;return function(e){var t=MsPortalFx.ViewModels.Controls.Lists.Grid;class r extends o.GridExtension{getExtension(e){const t=e&&e.hierarchical;return new s.HierarchicalExtension(t)}initializeExtension(){}beforeDestroy(){}getName(){return"Hierarchical"}getOrder(){return 0}}e.HierarchicalExtension=r,i.registerPlugin(t.Extensions.Hierarchical,r)}(r||(r={})),r})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Pageable.css",["module"],(function(e){"use strict";return{css:'.azc-grid-pageable.azc-grid .azc-grid-pageable-loadMoreContainer{display:block;height:38px;text-decoration:none;text-align:center}.azc-grid-pageable.azc-grid .azc-grid-pageable-loadMoreContainer .azc-grid-pageable-loadMoreLabel{font-size:13px;line-height:1.385;line-height:38px}.azc-grid-pageable.azc-grid .azc-grid-pageable-loadMoreContainer .azc-grid-pageable-loadMoreIcon{display:inline-block;margin-top:10px}.azc-grid-pageable.azc-grid .azc-grid-pageable-loadMoreContainer .azc-grid-pageable-loadMoreIcon::before{content:url("Content/static/azc-validatableControl-pending.gif")}.azc-grid-pageable.azc-grid .azc-grid-pageable-pager{padding:10px 5px}',moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Pageable",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Pageable.css"],(function(e,t,i,o,s,r,a){"use strict";var n;return(0,r.injectCss)(a),function(e){const t="azc-grid-pageable",r=`.${`${t}-loadMoreContainer`}[href]`,a="\x3c!-- ko ifnot: $ctl.getPlugin(\"azc-grid-pageable\").options.pager --\x3e<a role='button' aria-label='"+MsPortalFx.encodeAttribute(s.Grid.loadMoreAriaLabel)+"' class='azc-grid-pageable-loadMoreContainer' href='#' data-bind='attr: { \"aria-controls\": $ctl.id }, visible: $ctl.getPlugin(\"azc-grid-pageable\").options.showLabel'><span class='azc-grid-pageable-loadMoreLabel' data-bind='visible: !$ctl.getPlugin(\"azc-grid-pageable\").options.loading(), text: $ctl.getPlugin(\"azc-grid-pageable\").options.label'></span><span class='azc-grid-pageable-loadMoreIcon' data-bind='visible: $ctl.getPlugin(\"azc-grid-pageable\").options.loading, css: { \"azc-grid-pageable-showLoadingIcon\": $ctl.getPlugin(\"azc-grid-pageable\").options.loading }'></span></a>\x3c!-- /ko --\x3e\x3c!-- ko if: $ctl.getPlugin(\"azc-grid-pageable\").options.pager --\x3e<div class='azc-grid-pageable-pager' data-bind='pcControl: $ctl.getPlugin(\"azc-grid-pageable\").options.pager'></div>\x3c!-- /ko --\x3e";class n extends o.Extension{constructor(e){super(),this._options=$.extend({label:ko.observable(s.Grid.loadMore),showLabel:ko.observable(!0),loading:ko.observable(!1)},e)}get options(){return this._options}afterSetTemplates(e){e.getHtmlTemplate("table").append(".azc-grid-footer",a),e.setTemplate("body","\x3c!-- ko template: { name: ko.pureComputed(function () { return data.items().length ? 'bodyCore' : ($ctl.getPlugin(\"azc-grid-pageable\").options.loading() ? 'bodyCore' : 'bodyNoItems'); }), data: $data } --\x3e\x3c!-- /ko --\x3e")}afterAttachEvents(){this.ltm.registerForDispose(this._widget.element.setEvents(["click.azcPageableGrid",r,e=>{e.preventDefault(),e.stopPropagation();const t=this.options;if(!t.loading()&&t.onLoadMoreData){const e=this._widget.getPlugin(i.FocusableRowExtension.Name),o=e&&e._findLastFocusableRow(this._widget.element);e&&o.length&&e._focusRow(o,ko.dataFor(o[0])),t.onLoadMoreData()}}]))}getName(){return n.Name}getOrder(){return 20}getAriaRowCount(){return this.options.ariaRowCount}handlesServerFilterAnnouncement(){return this.options.handlesServerFilterAnnouncement}getFirstObservableRowIndexObservable(){return ko.pureComputed((()=>this.options.pager?.pageSize()?this.options.pager.startIndex()+1:1))}shouldNotAllowSelectAll(){return!0}}n.Name=t,e.PageableExtension=n}(n||(n={})),n})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Pageable",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","MsPortalImpl/Resources/ImplScriptResources","Fx/Controls/Pager2","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Filterable","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Pageable","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,i,o,s,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageableExtension=t.DefaultItemsPagePage=void 0;var d=MsPortalFx.ViewModels.Controls.Lists.Grid,c=d.PageableType,u=MsPortalFx.Base.Promises.cancelOnDispose;const h=s.Grid,g=MsPortalFx.getUniqueId;function p(e){if(e){const t=e.metadata();if(t){const e=t.totalItemCount;if(!MsPortalFx.isNullOrUndefined(e))return e}}return 0}t.DefaultItemsPagePage=10;class b extends o.GridExtension{constructor(){super(...arguments),this._options=null,this._type=null,this._dataNav=null,this._filterQS=ko.observable(null),this._currentRequestId=null}getExtension(e){const i=e&&e.pageable;if(i&&(this._dataNav=i.dataNavigator),!this._validateSequential()&&!this._validatePageable())throw new Error("Pageable extension cannot work without a valid data navigator. Provide a valid data navigator to fetch data.");this._type=i.type;const o=this._ariaRowCount=ko.observable();switch(i.type){case c.Pageable:{o(0);const e=ko.observable(!1);this._options={loading:e,pager:r.create(this._widget.ltm,{pageSize:i.itemsPerPage??t.DefaultItemsPagePage,loading:e,onLoadPage:async(e,t,i)=>{i.startIndex(e),i.totalCount(p(this._dataNav))}}),ariaRowCount:o,handlesServerFilterAnnouncement:!0};break}case c.Sequential:default:o(-1),this._options={label:i.label?i.label:ko.observable(h.loadMore),showLabel:i.showLabel?i.showLabel:ko.observable(!0),loading:ko.observable(!1),onLoadMoreData:()=>{this._currentRequestId=g(),this._onLoadMoreData(this._currentRequestId).catch((e=>{}))},ariaRowCount:o,handlesServerFilterAnnouncement:!0}}return new n.PageableExtension(this._options)}initializeExtension(){if(!(this._type===c.Sequential&&this._validateSequential()||this._type===c.Pageable&&this._validatePageable()))throw new Error("Pageable extension cannot work without a valid data navigator. Provide a valid data navigator to fetch data.");const e=this._filterableExtn=this._widget._instance.getPlugin(a.FilterableExtension.Name);e&&e.options.serverFilter()&&this._filterQS(e.options.queryString())}resetExtension(){const e=this._filterableExtn&&this._filterableExtn.options;let t;return e&&!e.filterCallback()&&e.filterCallback((e=>{if(this._filterQS()!==e)return this._filterQS(e),this.resetExtension()})),t=this._type===c.Sequential&&this._validateSequential()?this._resetAndLoadData():this._type===c.Pageable&&this._validatePageable()?this._resetLoadPage():Promise.resolve(),t.catch((e=>{})),t}beforeDestroy(){this._subLifetime&&this._subLifetime.dispose()}getName(){return"Pageable"}getOrder(){return 0}_validateSequential(){return this._dataNav&&!!this._dataNav.loadByContinuationToken}_validatePageable(){return this._dataNav&&!!this._dataNav.loadBySkipTake}_loadPage(){const e=g(),t=this._options;this._currentRequestId=e;const i=t.pager.startIndex(),o=t.pager.pageSize(),s=this._getSortData(),r=this._filterQS()?MsPortalFx.encodeAttribute(this._filterQS()):null;return t.loading(!0),this._widget._instance._ariaLive(""),this._widget._instance._ariaLive(l.Grid.loadingPage.format(Math.floor(i/o)+1)),u(this._widget.ltm,(()=>this._dataNav.loadBySkipTake(i,o,this._filterQS(),s))).then((()=>{if(this._currentRequestId===e){let e=this._dataNav.items();e=e?e.slice(0):[],this._widget.options.items(e)}return Promise.resolve()}),(e=>((e=e||FxImpl.createError("Undefined failure from loadBySkipTake"))._sourceErrorLevel=0,Promise.reject(e)))).finally((()=>{if(this._currentRequestId===e){t.loading(!1);const e=p(this._dataNav)||this._widget.options.items().length;this._ariaRowCount(e),this._widget._instance._ariaLive(r?l.Grid.loadingCompleteFiltered.format(e,r):l.Grid.loadingComplete.format(e))}}))}_attachSubscriptions(){if(this._subLifetime=this._widget.ltm.createChildLifetime(),this._type===c.Pageable){const e=this._options.pager;let t=0,i=e.pageSize(),o=e.pageNumber()||1;ko.reactor(this._subLifetime,(()=>{const s=p(this._dataNav),r=e.pageSize(),a=e.pageNumber()||1;ko.ignoreDependencies((()=>{s!==t&&e.totalCount(s),s===t&&r===i&&a===o||(t=s,i=r,o=a,r&&a&&this._loadPage().catch((e=>{})))}))}))}}_resetCurrentPageSubscription(){this._subLifetime&&this._subLifetime.dispose(),this._options.pager.startIndex(0),this._attachSubscriptions()}_resetLoadPage(){return this._resetCurrentPageSubscription(),this._loadPage()}_onLoadMoreData(e){const t=this._options;t.loading(!0),this._widget._instance._ariaLive(l.Grid.loadingMore);const i=this._filterQS()?MsPortalFx.encodeAttribute(this._filterQS()):null;return u(this._widget.ltm,(()=>this._dataNav.loadByContinuationToken())).then((()=>(this._currentRequestId===e&&this._widget.options.items.push.apply(this._widget.options.items,this._dataNav.items()),Promise.resolve())),(e=>((e=e||FxImpl.createError("Undefined failure from loadByContinuationToken"))._sourceErrorLevel=0,Promise.reject(e)))).finally((()=>{if(this._currentRequestId===e){t.loading(!1);const e=this._widget.options.items().length;this._dataNav.metadata()&&this._dataNav.metadata().continuationToken?(this._ariaRowCount(-1),this._widget._instance._ariaLive(i?l.Grid.loadingPartiallyCompleteFiltered.format(e,i):l.Grid.loadingPartiallyComplete.format(e))):(t.showLabel(!1),this._ariaRowCount(e),this._widget._instance._ariaLive(i?l.Grid.loadingCompleteFiltered.format(e,i):l.Grid.loadingComplete.format(e)))}}))}_resetAndLoadData(){const e=this._getSortData();return this._currentRequestId=g(),u(this._widget.ltm,(()=>{this._dataNav.resetLoadByContinuationToken&&this._dataNav.resetLoadByContinuationToken(this._filterQS(),e)})),this._options.showLabel(!0),this._widget.options.items([]),this._onLoadMoreData(this._currentRequestId)}_getSortData(){const e=this._widget.options.sortByList;return e?e():null}}t.PageableExtension=b,i.registerPlugin(d.Extensions.Pageable,b)})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ReorderRow.css",["module"],(function(e){"use strict";return{css:'.azc-grid-reorderRow .azc-grid-tableContent{position:relative}.azc-grid-reorderRow col.azc-grid-reorderRow-col{width:16px}.azc-grid-reorderRow table tbody tr[draggable]{-webkit-user-drag:element}.azc-grid-reorderRow table tbody tr td.azc-grid-reorderRow-cell{padding-left:5px;padding-right:6px}.azc-grid-reorderRow.azc-grid-reorderRow-enabled table tbody tr:not([aria-disabled="true"]):hover td.azc-grid-reorderRow-cell div{margin-top:4px}.azc-grid-reorderRow.azc-grid-reorderRow-enabled table tbody tr:not([aria-disabled="true"]):hover td.azc-grid-reorderRow-cell div::before{content:url("Content/static/azc.grid.reorderrowextension.handle-hover.svg");width:5px;height:17px}.azc-grid-reorderRow.azc-grid-reorderRow-enabled table tbody tr:not([aria-disabled="true"])[aria-selected="true"]:hover td.azc-grid-reorderRow-cell div::before{content:url("Content/static/azc.grid.reorderrowextension.handle-active.svg")}.azc-grid-reorderRow .azc-grid-reorderRow-line{position:absolute;width:100%;height:3px;display:none}.azc-grid-reorderRow.azc-grid-reorderRow-active .azc-grid-reorderRow-line{display:block}',moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ReorderRow",["require","exports","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ReorderRow.css"],(function(e,t,i,o,s,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReorderRowExtension=void 0,(0,r.injectCss)(a);const n="azc-grid-reorderRow-active",l="azc-grid-reorderRow-enabled";let d={};class c extends s.Extension{constructor(e){super(),this._options=e=e||{},void 0===e.disabled&&(e.disabled=ko.observable(!1)),this._gridGuid=MsPortalFx.getUniqueId()}get options(){return this._options}afterCreate(){this._widget.element.find(".azc-grid-tableContent").append(FxImpl.createElement("div",{class:"azc-grid-reorderRow-line azc-bg-muted","aria-hidden":"true"})),ko.computed(this.ltm,(()=>{this._widget.element.toggleClass(l,!this.options.disabled())}))}afterSetTemplates(e){const t=e.getHtmlTemplate("bodyRowsCore"),i=e.getHtmlTemplate("header"),o=e.getHtmlTemplate("colgroup");t.addAttribute("tr","data-bind",['attr: { "data-grid-reorder": true }']).prepend("tr","<td role='presentation' class='azc-grid-reorderRow-cell azc-br-muted'><div></div></td>"),i.prepend("tr","<th role='presentation' class='azc-grid-reorderRow-header azc-br-muted'></th>"),o.prepend("colgroup","<col class='azc-grid-reorderRow-col' />")}afterAttachEvents(){const e=this;this._widget.element.on("dragstart","[draggable]",this._dragstartEventHandler=e=>{if(this._widget.options.extensionTrigger("shouldNotAllowDrag").some((function(e){return!!e})))return;const t=MsPortalFx.getUniqueId(),i=e.target,o=e.originalEvent.dataTransfer,s=FxImpl.createElement("img");s.src="data:image/gif;base64,R0lGODlhAQABAJEAAAAAAP///////wAAACH5BAEAAAIALAAAAAABAAEAAAICVAEAOw==",d[t]={rowMetadata:ko.dataFor(i),element:i},o.effectAllowed="move",o.setDragImage(s,-25,-25),o.setData(this._getMimeType(),t)}).on("drop",this._dropEventHandler=e=>{const t=e.originalEvent.dataTransfer;if(t.types.some((e=>e===this._getMimeType()))){t.dropEffect="move";const o={rowMetadata:t.getData(this._getMimeType()).split(";").map((function(e){return d[e].rowMetadata})),clientX:e.originalEvent.pageX,clientY:e.originalEvent.pageY,position:this._positionLine(e)};e.preventDefault(),setTimeout((()=>{this._widget.trigger("rowReorder",i.cloneEvent(e,"rowReorder"),o),this._widget.options.events("reorder",o)}),0)}}).on("dragend",this._dragendEventHandler=e=>{d={},this._widget.element.removeClass(n)}).on("mouseenter.azcGrid","tbody tr[data-grid-reorder=true]:not([aria-disabled=true]) td.azc-grid-reorderRow-cell",this._mouseenterEventHandler=function(t){e.options.disabled()||$(this).closest(".azc-grid-row").attr("draggable","true")}).on("mouseleave.azcGrid","tbody tr[data-grid-reorder=true]:not([aria-disabled=true]) td.azc-grid-reorderRow-cell",this._mouseleaveEventHandler=function(e){$(this).closest(".azc-grid-row").removeAttr("draggable")}),$.querySelectorAll("html").on("dragover",this._dragoverEventHandler=e=>{if($.contains(this._widget.element[0],e.target)){const t=e.originalEvent.dataTransfer.types;t&&t.some((e=>e===this._getMimeType()))&&(this._positionLine(e),e.preventDefault())}else this._widget.element.hasClass(n)&&this._widget.element.removeClass(n)})}getOrder(){return 21}getDependencies(){return[new o.FocusableRowExtension]}beforeCreate(){const e=["azc-grid-editableRow"];this._widget.options.extensions.forEach((t=>{if(e.includes(t.getName()))throw new Error("The extension "+t.getName()+" is not compatible with the extension "+this.getName()+".")}))}beforeDestroy(){this._widget.element.removeClass(n).removeClass(l),this._dragstartEventHandler&&(this._widget.element.off("dragstart",this._dragstartEventHandler),this._dragstartEventHandler=null),this._dropEventHandler&&(this._widget.element.off("drop",this._dropEventHandler),this._dropEventHandler=null),this._dragendEventHandler&&(this._widget.element.off("dragend",this._dragendEventHandler),this._dragendEventHandler=null),this._dragoverEventHandler&&(this._widget.element.off("dragover",this._dragoverEventHandler),this._dragoverEventHandler=null),this._mouseenterEventHandler&&(this._widget.element.off("mouseenter.azcGrid",this._mouseenterEventHandler),this._mouseenterEventHandler=null),this._mouseleaveEventHandler&&(this._widget.element.off("mouseleave.azcGrid",this._mouseleaveEventHandler),this._mouseleaveEventHandler=null)}getName(){return c.Name}getAdditionalColumns(){return 1}_getMimeType(){return("application/x-azc-grid-row-"+this._gridGuid).toLowerCase()}_positionLine(e){const t=$(e.target);let i=null;if(t.hasClass("azc-grid-reorderRow-line"))i=this._savedIndex;else if($.contains(this._widget.element[0],e.target)){this._widget.element.hasClass(n)||this._widget.element.addClass(n);let o=t.closest("[data-grid-reorder=true]");const s=e.originalEvent;if(0===o.length){const e=this._widget.element.find("[data-grid-reorder=true]"),t=e.first(),i=e.last();o=s.pageY<=t.offset().top?t:i}i=o.index();const r=o.outerHeight(),a=o.offset(),l=o.position(),d=this._widget.element.find(".azc-grid-reorderRow-line");a.top=Math.floor(a.top),l.top=Math.floor(l.top),s.pageY-a.top<r/2?d.css("top",Math.round(l.top)):(d.css("top",Math.round(l.top+r)),i++),this._savedIndex=i}else this._widget.element.removeClass(n);return i}computeLeftMarginWidth(){return 16}}t.ReorderRowExtension=c,c.Name="azc-grid-reorderRow"})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ReorderRow",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ReorderRow"],(function(e,t,i,o,s){"use strict";var r;return function(e){var t=MsPortalFx.ViewModels.Controls.Lists.Grid;class r extends o.GridExtension{beforeDestroy(){this._handler&&(this._widget._instance.element.off("rowReorder",this._handler),this._handler=null)}getExtension(e){const t=((e||{}).reorderRow||{}).disabled;return new s.ReorderRowExtension({disabled:t})}initializeExtension(){const e=this._widget,t=e.options;e._instance.element.on("rowReorder",this._handler=(i,o)=>{const s=(t.extensionsOptions||{}).reorderRow||{},r=s.automaticallyReorderRows,a=s.rowReorder,n=o.rowMetadata;if(!1!==r){const e=t.items.peek(),i=[],s=Math.min(e.length,Math.max(0,o.position));n.forEach((function(e){i.push(e.item)}));const r=function(e){return!!i.includes(e)};let a=0,l=!1;for(let i=0,o=0;i<e.length;i++,o++){r(e[i])&&(l||(t.items.valueWillMutate(),l=!0),e.splice(i,1),i--,o<s&&a++)}l&&(e.splice.apply(e,[s-a,0].concat(i)),t.items.valueHasMutated())}if(a){a(i,{rowMetadata:n.map((t=>e.getRowMetadata(t.item))),position:o.position})}})}getName(){return"ReorderRowExtension"}getOrder(){return 0}}e.ReorderRowExtension=r,i.registerPlugin(t.Extensions.ReorderRow,r)}(r||(r={})),r})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Scrollable.css",["module"],(function(e){"use strict";return{css:".azc-grid-vscroll.azc-grid{height:100%}.azc-grid-vscroll .azc-grid-root{height:100%;overflow-y:hidden}.azc-grid-vscroll .azc-grid-area{height:100%;overflow-y:hidden}.azc-grid-vscroll .azc-grid-container{height:100%;overflow-y:hidden;display:flex;flex-direction:column}.azc-grid-vscroll .azc-grid-header{flex:1 0 auto;min-height:0}.azc-grid-vscroll .azc-grid-tableContainer{height:100%;overflow-y:hidden;flex:1 1 auto;min-height:0;display:flex;flex-direction:column}.azc-grid-vscroll .azc-grid-tableHead{flex:1 0 auto;min-height:0}.azc-grid-vscroll .azc-grid-tableScrollContainer{height:100%;flex:1 1 auto;min-height:0;overflow-y:auto}.azc-grid-vscroll .azc-grid-footer{flex:1 0 auto;min-height:0}.azc-grid-hscroll .azc-grid-root{overflow-x:hidden}.azc-grid-hscroll .azc-grid-area{overflow-x:hidden}.azc-grid-hscroll .azc-grid-container{overflow-x:hidden}.azc-grid-hscroll .azc-grid-tableContainer{overflow-x:hidden}.azc-grid-hscroll .azc-grid-tableHeader{margin-right:17px}.azc-grid-hscroll .azc-grid-tableScrollContainer{overflow-x:auto}",moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Scrollable",["require","exports","MsPortalImpl/Base/Base.FeatureDetection","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","MsPortalImpl/Base/Base.FeatureDetection","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Scrollable.css"],(function(e,t,i,o,s,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollableExtension=t.AsyncItem=void 0,(0,r.injectCss)(a);const n=Math.floor,l=Math.min,d=MsPortalFx.disposeDisposable;class c{constructor(e,t,i){this.index=e,this.item=ko.observable(i),this.state=ko.observable(t),this.template=ko.pureComputed((()=>{switch(this.state()){case 0:return"bodyRowsLoading";case 2:return"bodyRowsError";default:return"bodyRows"}}))}}t.AsyncItem=c;class u extends o.Extension{constructor(e){super(),this._disposables=[],e=this._options={dataProvider:null,horizontal:!0,vertical:!0,...e},this.hscroll=e.horizontal,this.vscroll=e.vertical,this._vscrollVirtualized=e.vertical&&!!e.dataProvider,this._rowHeight=ko.observable(e.defaultRowHeight||32),this._totalCount=ko.observable(0),this._viewportHeight=ko.observable(0),this._firstObservableRowIndex=ko.observable(1),this._vscrollVirtualized&&(this.asyncItems=ko.observableArray(),this._resetAsyncItemCache())}get options(){return this._options}afterCreate(){const e=this._widget.element;e.toggleClass("azc-grid-hscroll",this.hscroll),e.toggleClass("azc-grid-vscroll",this.vscroll),this.ltm.registerForDispose((()=>{e.removeClass("azc-grid-hscroll azc-grid-vscroll")})),this._scrollContainer=e.find(".azc-grid-tableScrollContainer"),this._scrollHeader=e.find(".azc-grid-tableHead");let t=0;this._disposables.push(this._scrollContainer.setEvents(["scroll.azcGridScrollable",()=>{const e=this._scrollContainer[0].scrollTop;e!==t?(t=e,this._update()):this._updateHeader(),this.hscroll&&(this._scrollHeader[0].scrollLeft=this._scrollContainer[0].scrollLeft)}])),this.hscroll&&this._disposables.push(this._scrollHeader.setEvents(["scroll.azcGridScrollable",()=>{this._scrollContainer[0].scrollLeft=this._scrollHeader[0].scrollLeft}])),this._vscrollVirtualized&&(this.options.dataProvider.totalItemCount.subscribe(this._widget.ltm,(e=>{this._activePageRequest||(this._resetAsyncItemCache(),this._update())})),this._widget.scrollWidth.subscribeAndRun(this._widget.ltm,(e=>{this._scrollContainer.find(".azc-grid-tableContent").width(e)}))),ko.reactor(this.ltm,(()=>{let e;if(this._options.dataProvider)e=this._options.dataProvider.totalItemCount();else{e=(this._widget.options.items()||[]).length}this._totalCount(e)})),this._update(!0)}afterSetTemplates(e){this._vscrollVirtualized&&e.setTemplate({body:"\x3c!-- ko template: { name: ko.pureComputed(function () { return  $ctl.getPlugin(\"azc-grid-scrollable\").asyncItems().length ? 'bodyCore' : 'bodyNoItems'; }), data: $data } --\x3e\x3c!-- /ko --\x3e",bodyCore:"<tbody class='azc-grid-groupdata' role='rowgroup'><tr role='presentation' class='azc-grid-scrollable-above' aria-hidden='true'></tr>\x3c!-- ko foreach: $ctl.getPlugin(\"azc-grid-scrollable\").asyncItems --\x3e\x3c!-- ko template: { name: template, data: item } --\x3e\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e</tbody>",bodyRowsLoading:"<tr role='row' class='azc-grid-scrollable-loading'><td role='gridcell' class='azc-br-muted' data-bind='attr: { colspan: $ctl._getTotalColumns() }'></td></tr>",bodyRowsError:"<tr role='row' class='azc-grid-scrollable-error'><td role='gridcell' class='azc-br-muted' data-bind='attr: { colspan: $ctl._getTotalColumns() }'></td></tr>"})}getDefaultColumnProperties(){return{}}beforeDestroy(){this._cancelAsyncUpdate(),d(this._disposables),this._disposables=[],this._asyncItemCache=null,this._activePageRequest=null}getName(){return u.Name}getOrder(){return 15}getAriaRowCount(){return this.options.dataProvider&&this.options.dataProvider.totalItemCount?this.options.dataProvider.totalItemCount:null}getFirstObservableRowIndexObservable(){return this._firstObservableRowIndex}shouldNotAllowSelectAll(){return this._vscrollVirtualized}reset(){this._resetAsyncItemCache(),this._vscrollVirtualized&&this._widget.options.items.removeAll();const e=this._scrollContainer;e&&(e.scrollLeft(0),e.scrollTop(0),this._update(!0))}onSizeChanged(e,t,i,o,s,r){this._vscrollVirtualized&&(i?(this._viewportHeight(this._scrollContainer&&this._scrollContainer[0]&&this._scrollContainer[0].offsetHeight||0),this._update()):o&&this._updateHeader())}_resetAsyncItemCache(){this._asyncItemCache=[],this._asyncItemCache.length=2048}_updateHeader(){const e=this._scrollContainer;if(e){const t=e.find(".azc-grid-tableHeader");if(t.length){const i=-e.scrollLeft();t.css("left",i<0?i+"px":"");const o=MsPortalFx.truncate(e[0].offsetWidth-e[0].clientWidth);t.css("width",o>0?"calc(100% - "+o+"px)":"");const s=this._widget.options.showHeader?t.outerHeight()||40:0;e.parent(".azc-grid-tableContainer").css("padding-top",s+"px")}}}_update(e){this._updateHeader(),this._vscrollVirtualized&&this._updateViewportAsync(e)}_updateViewportAsync(e){if(this._cancelAsyncUpdate(),e)try{this._updateViewport(e),this._updateHeader()}catch(e){}else{const e=this._options.updateViewportAsyncDebounceTime||256;this._updateViewportAsyncTimeout=setTimeout((()=>{if(this._updateViewportAsyncTimeout)try{this._updateViewport(),this._updateHeader()}catch(e){}}),e)}}_cancelAsyncUpdate(){this._updateViewportAsyncTimeout&&(clearTimeout(this._updateViewportAsyncTimeout),this._updateViewportAsyncTimeout=null)}_getRowHeight(){let e;const t=this._scrollContainer.find(".azc-grid-full .azc-grid-row:eq(0)");return t.length&&(e=t.height()),e=e||this._options.defaultRowHeight||32,this._rowHeight(e),e}_getTotalScrollHeight(e,t){const o=n(u._maxElementHeightFactor*i.getMaxElementHeight()),s=n(e*t);return l(s,o)}_updateContentHeight(e,t){const i=this._widget.element.find(".azc-grid-tableContent");i.height(e),i.css("overflow-y",t?"hidden":"")}_updateAboveRowHeight(e){this._scrollContainer.find(".azc-grid-scrollable-above").css("height",e||"")}_updateViewport(e){const t=this.options.dataProvider.totalItemCount();let i=t;MsPortalFx.isNullOrUndefined(i)&&(i=100);const o=this._getRowHeight();let s=this._getTotalScrollHeight(i,o);this._updateContentHeight(s,!0);const r=this._scrollContainer[0],a=r.offsetHeight||100*o/2,d=r.scrollTop||0,c=r.scrollHeight||s||a,u=n(i*d/c),h=Math.ceil(a/o),g=Math.max(u-h,0),p=l(u+h+h,i>100?i:100)-g,b=n(c*g/i);this._updateAboveRowHeight(b);const m=this._activePageRequest={};this._saveFocus();const f=Math.min(t||0,p),w=this._renderRows(g,p,f);this._request(m,w,g,p,f).finally((()=>{m===this._activePageRequest&&(this._activePageRequest=null,i=this.options.dataProvider.totalItemCount(),s=this._getTotalScrollHeight(i,o),this._updateContentHeight(s,!1),this._updateHeader(),this._firstObservableRowIndex(g+1),this._restoreFocus())}))}_renderRows(e,t,i){const o=[],s=this._asyncItemCache;for(let i=0;i<t;i++){const t=e+i;let r;const a=t%s.length;r=s[a],r&&r.index===t||(r=new c(t,0,null),s[a]=r,2===r.state()&&r.state(0)),o.push(r)}const r=ko.utils.compareArrays(this.asyncItems(),o.slice(0,i),{sparse:!0}),a=ko.utils.createArraySplices(r,!0);return ko.utils.applyArraySplices(this.asyncItems,a),o}_updateGridItems(e){let t,i;if((e=e||[]).length){const o=this._widget.options;t=o.items.peek(),t?(i=[t.length,0],e.forEach((e=>{t.includes(e)||i.push(e)})),i.length>2&&o.items.splice.apply(o.items,i)):o.items(e)}}_request(e,t,i,o,s){return this.options.dataProvider.fetch(i,o).then((i=>{const o=[];i=i||[],this._saveFocus(),t.forEach(((e,t)=>{const s=i[t];s?(e.item.peek()!==s&&e.item(s),1!==e.state.peek()&&e.state(1),o.push(s)):e.state(2)})),e===this._activePageRequest&&(i.length<s?this.asyncItems.splice(i.length,s-i.length):i.length>s&&this.asyncItems.splice(s,0,...t.slice(s,i.length)),this._updateGridItems(o)),this._restoreFocus()}),(()=>{t.forEach((e=>{1!==e.state()&&e.state(2)}))}))}shouldRetainRowMetadata(e){return this._vscrollVirtualized}scrollTo(e){this._scrollContainer[0].scrollTop=e/this._options.dataProvider.totalItemCount.peek()*this._scrollContainer[0].scrollHeight,this._updateViewport()}computeAvailableWidthDelta(){let e=0;if(this.vscroll){const t=this._totalCount();t&&t*this._rowHeight()>this._viewportHeight()&&(e=-(0,s.getScrollbarWidth)())}return e}_saveFocus(){this._widget.options.extensionTrigger("saveFocus")}_restoreFocus(){this._widget.options.extensionTrigger("restoreFocus")}}t.ScrollableExtension=u,u.Name="azc-grid-scrollable",u._maxElementHeightFactor=.8})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ResizableColumn.css",["module"],(function(e){"use strict";return{css:'.azc-grid.azc-grid-resizableColumn .azc-grid-tableContainer{position:relative}.azc-grid.azc-grid-resizableColumn .azc-grid-resizableColumn-handle{position:absolute;right:-5px;top:0;height:33px;width:10px;cursor:col-resize;z-index:1;display:flex;justify-content:center}.azc-grid.azc-grid-resizableColumn .azc-grid-resizableColumn-handle .azc-grid-resizableColumn-handle-line{width:1px;height:100%;opacity:0}.azc-grid.azc-grid-resizableColumn .azc-grid-resizableColumn-ghostLine{position:absolute;width:1px;top:0;z-index:1}.azc-grid.azc-grid-resizableColumn .azc-grid-show-handles .azc-grid-resizableColumn-handle .azc-grid-resizableColumn-handle-line{opacity:1}.azc-grid.azc-grid-resizableColumn thead:hover .azc-grid-resizableColumn-handle-line{opacity:1}.azc-grid.azc-grid-resizableColumn.azc-grid-resizing .azc-grid-resizableColumn-handle-line{opacity:1}.azc-grid.azc-grid-resizableColumn.azc-grid-resizing *{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.azc-grid.azc-grid-resizableColumn .azc-grid-headerlabel::after{content:""}',moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ResizableColumn",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","MsPortalImpl/Base/Base.KeyboardHelper","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Scrollable","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ResizableColumn.css"],(function(e,t,i,o,s,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizableColumnExtension=void 0,(0,r.injectCss)(a);const n=window,l="azc-grid-resizing";function d(e,t,i){let o=void 0!==t?Math.max(e,t):e;return o=void 0!==i?Math.min(o,i):o,o}class c extends i.Extension{constructor(e){super(),this._options=$.extend({resizable:ko.observable(!0)},e)}get options(){return this._options}afterSetTemplates(e){e.getHtmlTemplate("headerCell").append("div","\x3c!-- ko if: $ctl.getPlugin(\"azc-grid-resizableColumn\").options.resizable() && hasHandle() --\x3e<div class='azc-grid-resizableColumn-handle' role='presentation'><div class='azc-grid-resizableColumn-handle-line azc-bg-muted' role='presentation'></div></div>\x3c!-- /ko --\x3e")}afterCreate(){this._hscroll()||this._widget.options.columns.subscribeAndRun(this.ltm,(e=>{e.length&&(this._lastColumnObject&&this._lastColumnObject.hasHandle(!0),this._lastColumnObject=e[e.length-1],this._lastColumnObject.hasHandle(!1))}))}afterAttachEvents(){this._ltm.registerForDispose(this._widget.element.setEvents(["mousedown.azcGridResizableColumn",".azc-grid-resizableColumn-handle",e=>{this._mouseDownPosition=e.pageX,this._handle=$(e.currentTarget),this._columns=this._widget.element.find("th");const t=this._handle.parent().closest("th"),i=ko.dataFor(t[0]);if(e.preventDefault(),i.disableResizable())return;const o=this._getNextResizableColumn(this._columns,this._widget._columns.indexOf(i)+1);(this._hscroll()||o)&&this._resizeStart(t,o)}],["keydown.azcGridResizableColumn",".azc-grid-headerCell",e=>{if((0,o.isCtrlOrCommandOnly)(e)){let t=0;switch(e.keyCode){case 37:t=-20;break;case 39:t=20}if(t){this._columns=this._widget.element.find("th");const i=$(e.currentTarget).closest("th"),o=ko.dataFor(i[0]),s=this._widget._columns.indexOf(o),r=this._getNextResizableColumn(this._widget.element.find("th"),s+1);if(r){const e=ko.dataFor(r[0]),s=i.width(),a=r.width();let n=s+t,l=a-t;n<20?(l=a+s-20,n=20):l<20&&(n=s+a-20,l=20),this._setColumnWidth(o,s,n,e,a)}}}}]))}getName(){return c.Name}getOrder(){return 16}beforeDestroy(){this._mouseUpEventHandler&&($(n.document).off("mouseup.azcGridResizableColumn",this._mouseUpEventHandler),this._mouseUpEventHandler=null),this._mouseMoveEventHandler&&($(n.document).off("mousemove.azcGridResizableColumn",this._mouseMoveEventHandler),this._mouseMoveEventHandler=null),this._widget.element.removeClass(l)}getDefaultColumnProperties(){return{disableResizable:ko.observable(!1),hasHandle:ko.observable(!0)}}_resizeStart(e,t){const i=this._widget.element.find(".azc-grid-tableHeader"),o=this._widget.element.find(".azc-grid-tableContent"),s=$(FxImpl.createElement("div",{class:"azc-grid-resizableColumn-ghostLine fxs-portal-selected"})),r=this._widget.element.find(".azc-grid-tableContainer"),a=e.offset().left+20,c=this._hscroll()?void 0:t.offset().left+t.width()-20,u=this._handle.find(".azc-grid-resizableColumn-handle-line").offset().left,h=this._tableOffset(r,u);s.offset({left:h}),s.css("position","absolute");const g=i.height(),p=o.height();s.height(g+p),r.append(s),$(n.document).on("mousemove.azcGridResizableColumn",this._mouseMoveEventHandler=e=>{const t=d(e.pageX,a,c);e.preventDefault(),this._widget.element.addClass(l),s.offset({left:t})}),$(n.document).one("mouseup.azcGridResizableColumn",this._mouseUpEventHandler=i=>{const o=d(i.pageX,a,c),r=t?ko.dataFor(t[0]):void 0,u=ko.dataFor(e[0]);$(n.document).off("mousemove.azcGridResizableColumn",this._mouseMoveEventHandler),this._mouseMoveEventHandler=null,this._widget.element.removeClass(l),s.remove();const h=e.width(),g=t?t.width():void 0,p=h+(o-this._mouseDownPosition);this._setColumnWidth(u,h,p,r,g)})}_setColumnWidth(e,t,o,s,r){if(o!==t){const{units:a,value:n}=i.parseWidth(e.width&&e.width.peek()),l=this._widget.convertPixelsToUnits(o,a,n,t),d=o,c=`${l.value}${l.units}`;if(this._hscroll())e.nMinWidth(d),e.snapToMin=!0,e.width&&e.width(c);else{const a=s.nMinWidth.peek(),{units:n,value:l}=i.parseWidth(s.width&&s.width.peek()),u=r+t-o,h=this._widget.convertPixelsToUnits(u,n,l,r),g=u<a?u:a,p=`${h.value}${h.units}`;e.nMinWidth(d),s.nMinWidth(g),e.width&&e.width(c),s.width&&s.width(p)}}}_getNextResizableColumn(e,t){const i=this._widget._columns();let o,s,r;if(t===i.length)o=null;else{r=i[t];const a=!!r.disableResizable&&r.disableResizable(),n=!!r.hiddenInCollapsed&&r.hiddenInCollapsed();if(a||n&&this._widget.collapsed())t++,o=this._getNextResizableColumn(e,t);else{for(let t=0;t<e.length;t++)if(ko.dataFor(e.eq(t)[0]).columnId===r.columnId){s=e.eq(t);break}o=s}}return o}_hscroll(){const e=this._widget.getPlugin(s.ScrollableExtension.Name);return e&&e.options.horizontal}_tableOffset(e,t){return t-e.offset().left}}t.ResizableColumnExtension=c,c.Name="azc-grid-resizableColumn"})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ResizableColumn",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ResizableColumn"],(function(e,t,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizableColumnExtension=void 0;var r=MsPortalFx.ViewModels.Controls.Lists.Grid;class a extends o.GridExtension{getExtension(e){const t=e&&e.resizableColumn;return new s.ResizableColumnExtension(t)}getName(){return"ResizableColumn"}getOrder(){return 0}}t.ResizableColumnExtension=a,i.registerPlugin(r.Extensions.ResizableColumn,a)})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Scrollable",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Filterable","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Scrollable"],(function(e,t,i,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollableExtension=void 0;class a extends o.GridExtension{constructor(){super(...arguments),this._filterQueryString=ko.observable(null)}getExtension(e){const t=e&&e.scrollable,i={dataProvider:null,horizontal:t&&t.horizontal,vertical:t&&t.vertical},o=t&&t.dataNavigator;this._vscrollVirtualized=i.vertical&&!!o,o&&(i.dataProvider={totalItemCount:ko.pureComputed((()=>{let e;const t=o.metadata();return t&&(e=t.totalItemCount),e})),fetch:(e,t)=>{let i=null;const s=this._widget.options.sortByList;return s&&(i=s()),o.loadBySkipTake(e,t,this._filterQueryString(),i).then((()=>o.items()),(e=>{const t=FxImpl.createError("This error is due to a rejected loadBySkipTake call from a pageable grid.",{innerErrors:e});return t._sourceErrorLevel=0,Promise.reject(t)}))}});return this._azcScrollableExtension=new r.ScrollableExtension(i)}initializeExtension(){if(this._vscrollVirtualized){const e=this._widget._instance.getPlugin(s.FilterableExtension.Name);if(e){const t=this._filterQueryString,i=e.options;i.serverFilter()&&t(i.queryString());const o=i.filterCallback;o()||o((e=>{if(t()!==e)return t(e),this.resetExtension()}))}}}resetExtension(){return Promise.resolve().then((()=>{this._vscrollVirtualized&&this._azcScrollableExtension&&this._azcScrollableExtension.reset()}))}beforeDestroy(){this._azcScrollableExtension=null}getName(){return"Scrollable"}getOrder(){return 0}}t.ScrollableExtension=a,i.defaultPlugins.push(a)})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SortableColumn.css",["module"],(function(e){"use strict";return{css:".fxc-ascending .msportalfx-descend{opacity:.25}.fxc-descending .msportalfx-ascend{opacity:.25}.azc-grid-sortableColumn .azc-grid-sortableColumn-target{display:flex;flex:1 1 auto;cursor:pointer}.azc-grid-sortableColumn .azc-grid-sortableColumn-image-container{display:flex;flex:0 0 auto;align-items:center;justify-content:center;position:absolute;top:0;right:9px}.azc-grid-sortableColumn .azc-grid-sortableColumn-sortImage{width:16px;height:32px;padding-top:3px}.azc-grid-sortableColumn .azc-grid-headerlabel{flex:1 1 calc(100% - 11px);margin-right:22px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:15px}",moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SortableColumn",["require","exports","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","_generated/MsPortalImpl/Svg/Startup/SortArrows.svg","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SortableColumn.css"],(function(e,t,i,o,s,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortableColumnExtension=void 0,(0,n.injectCss)(l);const d="azc-grid-sortableColumn",c=`${d}-target`,u=`.${c}`,h=s.Viva.Grid.Sortable,g=`<span role='columnheader' aria-readonly='true' class='azc-grid-headerCell' data-bind='keyedCss: { grid1SortableColumn: $ctl.getPlugin("${d}")._getSortClasses(sortOrder())}, attr: { id: columnId, "aria-hidden": $ctl._ariaHiddenColumnHeader($data), "aria-label": ariaLabel, "aria-sort": $ctl.getPlugin("${d}")._getAriaSort(sortOrder()) }'><div data-bind='text: name' class='azc-grid-headerlabel'></div><div class='azc-grid-sortableColumn-image-container'><div class='azc-grid-sortableColumn-sortImage' data-bind='image: $ctl.getPlugin("${d}").sortIcon'></div></div></span>`;class p extends o.Extension{constructor(e){super(),this.sortIcon=a,this._disposables=[],this._sortByList=[],this._sortInProgress=!1,this._options=e||{}}setInstance(e){super.setInstance(e)}get options(){return this._options}afterSetTemplates(e){const t=e.getTemplate("headerCellContent");e.setTemplate("headerCellContent","\x3c!-- ko if: sortable --\x3e"+g+"\x3c!-- /ko --\x3e\x3c!-- ko ifnot: sortable --\x3e"+t+"\x3c!-- /ko --\x3e")}afterCreate(){const e=this._options,t=this._widget,i=t.options,o=this._sortByList=i.sortByList();e.sortClientSide&&o.length&&this._sortCallback(o),i.sortByList.subscribe(t.ltm,(e=>{e!==this._sortByList&&this._sortCallback(e)}))}_sortCallback(e){this._sortInProgress||(this._sortInProgress=!0,this._sortByList=e,this._widget.options.actions.sort(e).finally((()=>{this._sortInProgress=!1})),this._ariaLiveUpdate(e))}afterAttachEvents(){const e=this,t=this._widget.getPlugin(i.FocusableRowExtension.Name),o=this._widget.element;this._disposables.push(o.setEvents(["click",u,function(t){const i=ko.dataFor(this),o=i.itemKey;let s=e._sortByList.slice();const a=r.isCtrlOrCommandOnly(t),n=1===i.sortOrder()?2:1,l={itemKey:i.itemKey,sortOrder:n};if(t.preventDefault(),!e._sortInProgress){if(a){const e=MsPortalFx.findIndex(s,(e=>e.itemKey===o));e>=0?s[e]=l:s.push(l)}else e._resetColumns(),s=[l];i.sortOrder(n),e._sortCallback(s)}}],["keydown",u,function(e){0!==r.getModifierKeys(e)||13!==e.which&&32!==e.which||($(this).trigger("click"),e.preventDefault())}],["keydown.azc-grid-sortableColumn",u,t?e=>{9===e.which&&0===r.getModifierKeys(e)&&t._focusCurrentlyFocusableRow(e)}:null]))}_ariaLiveUpdate(e){const t=[];e.map((e=>({displayName:MsPortalFx.find(this._widget.options.columns(),(t=>t.itemKey===e.itemKey)).name(),sortBy:e}))).forEach(((e,i)=>{0===i?t.push(h.sortingby):t.push(h.then);const o="ascending"===this._getAriaSort(e.sortBy.sortOrder)?h.ascending:h.descending;t.push(e.displayName,o)}));const i=t.join(" ");this._widget._ariaLive(i)}_resetColumns(){const e=this._widget.options;0!==e.sortByList().length&&e.columns().forEach((e=>{e.sortOrder(0)}))}_getAriaSort(e){switch(e){case 1:return"ascending";case 2:return"descending"}return"none"}_getSortClasses(e){return c+" fxc-"+this._getAriaSort(e)}getDefaultColumnProperties(){return{sortable:!0,sortOrder:ko.observable(0)}}beforeDestroy(){MsPortalFx.disposeDisposable(this._disposables),this._disposables=[]}getName(){return p.Name}}t.SortableColumnExtension=p,p.Name=d})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SortableColumn",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SortableColumn"],(function(e,t,i,o,s){"use strict";var r;return function(e){var t=MsPortalFx.ViewModels.Controls.Lists.Grid;class r extends o.GridExtension{getExtension(e){const t=e&&e.sortableColumn,i=t.dataNavigator;return new s.SortableColumnExtension({sortClientSide:!i,sortCallback:t.sortCallback||null})}getName(){return"SortableColumn"}getOrder(){return 0}}e.SortableColumnExtension=r,i.registerPlugin(t.Extensions.SortableColumn,r)}(r||(r={})),r})),
define("MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1",["require","exports","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","MsPortalImpl/Weave/Util","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ContextMenuShortcut","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.EditableRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Filterable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRowHover","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Formatter","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FormatterHtmlBindings","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Groupable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Hierarchical","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Pageable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ReorderRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ResizableColumn","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.RightClickableRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Scrollable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SelectableRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SortableColumn"],(function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Grid1=t.TrustedWidget=t.Widget=t.GridExtension=t.x=void 0,t.x=5;class s extends i.GridExtension{}t.GridExtension=s;class r extends i.Widget{}t.Widget=r;class a extends i.TrustedWidget{}t.TrustedWidget=a,t.Grid1=(0,o.createControlComponentForKO)({widgetCtor:r})}));